IMPORT Transunion_PTrak;

in_file0 := Transunion_PTrak.File_Transunion_DID_Out;

flat_layout := RECORD
unsigned8                dt_first_seen;
unsigned8                dt_last_seen;
unsigned8                dt_vendor_first_reported;
unsigned8                dt_vendor_last_reported;
string1                filetype;
string8                filedate;
string12                vendordocumentidentifier;
string10                transferdate;
string15                currentname_firstname;
string15                currentname_middlename;
string2                currentname_middleinitial;
string25                currentname_lastname;
string3                currentname_suffix;
string                currentname_gender;
string2                currentname_dob_mm;
string2                currentname_dob_dd;
string4                currentname_dob_yyyy;
string                currentname_deathindicator;
string11                ssnfull;
string6                ssnfirst5digit;
string5                ssnlast4digit;
string10                consumerupdatedate;
string8                telephonenumber;
string                citedid;
string                fileid;
string                publication;
string                currentaddress_address1;
string                currentaddress_address2;
string                currentaddress_city;
string                currentaddress_state;
string                currentaddress_zipcode;
string                currentaddress_updateddate;
string6                housenumber;
string2                streettype;
string2                streetdirection;
string27                streetname;
string5                apartmentnumber;
string27                city;
string2                state;
string5                zipcode;
string4                zip4u;
string                previousaddress_address1;
string                previousaddress_address2;
string                previousaddress_city;
string                previousaddress_state;
string                previousaddress_zipcode;
string                previousaddress_updateddate;
string15                formername_firstname;
string15                formername_middlename;
string2                formername_middleinitial;
string25                formername_lastname;
string3                formername_suffix;
string15                aliasname_firstname;
string15                aliasname_middlename;
string2                aliasname_middleinitial;
string25                aliasname_lastname;
string3                aliasname_suffix;
string15                additionalname_firstname;
string15                additionalname_middlename;
string2                additionalname_middleinitial;
string25                additionalname_lastname;
string3                additionalname_suffix;
string32                aka1;
string32                aka2;
string32                aka3;
string1                recordtype;
string1                addressstandardization;
string8                filesincedate;
string8                compilationdate;
string1                birthdateind;
string1                orig_deceasedindicator;
string8                deceaseddate;
unsigned1                addressseq;
string                normaddress_address1;
string                normaddress_address2;
string                normaddress_city;
string                normaddress_state;
string                normaddress_zipcode;
string                normaddress_updateddate;
string73                name;
string2                nametype;
string5                title;
string20                fname;
string20                mname;
string20                lname;
string5                name_suffix;
string3                name_score;
string10                prim_range;
string2                predir;
string28                prim_name;
string4                addr_suffix;
string2                postdir;
string10                unit_desig;
string8                sec_range;
string25                p_city_name;
string25                v_city_name;
string2                st;
string5                zip;
string4                zip4;
string4                cart;
string1                cr_sort_sz;
string4                lot;
string1                lot_order;
string2                dbpc;
string1                chk_digit;
string2                rec_type;
string5                county;
string10                geo_lat;
string11                geo_long;
string4                msa;
string7                geo_blk;
string1                geo_match;
string4                err_stat;
string8                transferdate_unformatted;
string8                birthdate_unformatted;
string8                dob_no_conflict;
string8                updatedate_unformatted;
string8                consumerupdatedate_unformatted;
string8                filesincedate_unformatted;
string8                compilationdate_unformatted;
string9                ssn_unformatted;
string9                ssn_no_conflict;
string8                telephone_unformatted;
string1                deceasedindicator;
unsigned6                did;
unsigned8                did_score_field;
boolean                is_current;
END;

flat_layout flatten(in_file0 L) := transform

SELF.currentname_firstname:=L.currentname.firstname;
SELF.currentname_middlename:=L.currentname.middlename;
SELF.currentname_middleinitial:=L.currentname.middleinitial;
SELF.currentname_lastname:=L.currentname.lastname;
SELF.currentname_suffix:=L.currentname.suffix;
SELF.currentname_gender:=L.currentname.gender;
SELF.currentname_dob_mm:=L.currentname.dob_mm;
SELF.currentname_dob_dd:=L.currentname.dob_dd;
SELF.currentname_dob_yyyy:=L.currentname.dob_yyyy;
SELF.currentname_deathindicator:=L.currentname.deathindicator;
SELF.currentaddress_address1:=L.currentaddress.address1;
SELF.currentaddress_address2:=L.currentaddress.address2;
SELF.currentaddress_city:=L.currentaddress.city;
SELF.currentaddress_state:=L.currentaddress.state;
SELF.currentaddress_zipcode:=L.currentaddress.zipcode;
SELF.currentaddress_updateddate:=L.currentaddress.updateddate;
SELF.previousaddress_address1:=L.previousaddress[1].address1;
SELF.previousaddress_address2:=L.previousaddress[1].address2;
SELF.previousaddress_city:=L.previousaddress[1].city;
SELF.previousaddress_state:=L.previousaddress[1].state;
SELF.previousaddress_zipcode:=L.previousaddress[1].zipcode;
SELF.previousaddress_updateddate:=L.previousaddress[1].updateddate;
SELF.formername_firstname:=L.formername.firstname;
SELF.formername_middlename:=L.formername.middlename;
SELF.formername_middleinitial:=L.formername.middleinitial;
SELF.formername_lastname:=L.formername.lastname;
SELF.formername_suffix:=L.formername.suffix;
SELF.aliasname_firstname:=L.aliasname.firstname;
SELF.aliasname_middlename:=L.aliasname.middlename;
SELF.aliasname_middleinitial:=L.aliasname.middleinitial;
SELF.aliasname_lastname:=L.aliasname.lastname;
SELF.aliasname_suffix:=L.aliasname.suffix;
SELF.additionalname_firstname:=L.additionalname.firstname;
SELF.additionalname_middlename:=L.additionalname.middlename;
SELF.additionalname_middleinitial:=L.additionalname.middleinitial;
SELF.additionalname_lastname:=L.additionalname.lastname;
SELF.additionalname_suffix:=L.additionalname.suffix;
SELF.normaddress_address1:=L.normaddress.address1;
SELF.normaddress_address2:=L.normaddress.address2;
SELF.normaddress_city:=L.normaddress.city;
SELF.normaddress_state:=L.normaddress.state;
SELF.normaddress_zipcode:=L.normaddress.zipcode;
SELF.normaddress_updateddate:=L.normaddress.updateddate;
SELF:=L;

end;

EXPORT In_File := project(in_file0,flatten(LEFT));