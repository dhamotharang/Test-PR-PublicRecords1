EXPORT mac_append_provider_attributes (Infile, Input_Lnpid, UseIndexThreshold=5000000, appendPrefix = '\'\'') := FUNCTIONMACRO
		
		OutPut_Rec := RECORD
			RECORDOF (Infile);
			UNSIGNED8 #EXPAND(appendPrefix + 'LexID');
			STRING1	  #EXPAND(appendPrefix + 'EntityType');
			STRING20  #EXPAND(appendPrefix + 'FNAME');
			STRING20  #EXPAND(appendPrefix + 'MNAME');
			STRING28  #EXPAND(appendPrefix + 'LNAME'); 
			STRING5	  #EXPAND(appendPrefix + 'SNAME');
			STRING9	  #EXPAND(appendPrefix + 'SSN');
			STRING9	  #EXPAND(appendPrefix + 'ConsumerSSN');
			UNSIGNED4 #EXPAND(appendPrefix + 'DateOfBirth');
			UNSIGNED4 #EXPAND(appendPrefix + 'ConsumerDateOfBirth');
			STRING25  #EXPAND(appendPrefix + 'LicenseNumber');
			STRING25  #EXPAND(appendPrefix + 'CleanedLicenseNumber');
			STRING2	  #EXPAND(appendPrefix + 'LicenseState');
			STRING60  #EXPAND(appendPrefix + 'LicenseType');
			STRING60  #EXPAND(appendPrefix + 'LicenseStatus');
			UNSIGNED4 #EXPAND(appendPrefix + 'DateLicenseExpired'); 
			UNSIGNED4 #EXPAND(appendPrefix + 'LicenseCount');
			UNSIGNED4 #EXPAND(appendPrefix + 'LicenseStateCount');
			UNSIGNED4 #EXPAND(appendPrefix + 'ActiveLicenseCount');
			UNSIGNED4 #EXPAND(appendPrefix + 'InactiveLicenseCount');
			UNSIGNED4 #EXPAND(appendPrefix + 'RevokedLicenseCount');
			STRING2		#EXPAND(appendPrefix + 'InactiveLicenseState');	
			STRING1		#EXPAND(appendPrefix + 'InactiveLicenseFlag');	
			STRING1		#EXPAND(appendPrefix + 'RevokedLicenseFlag');	
			STRING1		#EXPAND(appendPrefix + 'ExpiredLicenseFlag');	
			STRING1	  #EXPAND(appendPrefix + 'DeathIndicator');
			UNSIGNED4 #EXPAND(appendPrefix + 'DateOfDeath');
			UNSIGNED4 #EXPAND(appendPrefix + 'BillingTaxID');
			STRING10  #EXPAND(appendPrefix + 'Phone');
			STRING10  #EXPAND(appendPrefix + 'Fax');
			STRING6	  #EXPAND(appendPrefix + 'UPIN');
			STRING10  #EXPAND(appendPrefix + 'NPINUMBER');
			STRING8   #EXPAND(appendPrefix + 'NPIEnumerationDate');
			STRING8   #EXPAND(appendPrefix + 'NPIDeactivationDate');
			STRING8   #EXPAND(appendPrefix + 'NPIReactivationDate');
			STRING1	  #EXPAND(appendPrefix + 'NPIFlag');
			UNSIGNED4 #EXPAND(appendPrefix + 'DeactivedNPICount');		
			STRING1	  #EXPAND(appendPrefix + 'DEABusinessActivityIndicator');		
			STRING10  #EXPAND(appendPrefix + 'DEANumber');
			UNSIGNED4 #EXPAND(appendPrefix + 'DateDEAExpired');
			UNSIGNED4 #EXPAND(appendPrefix + 'DEACount');
			UNSIGNED4 #EXPAND(appendPrefix + 'ActiveDEACount');
			UNSIGNED4 #EXPAND(appendPrefix + 'ExpiredDEACount');
			STRING1		#EXPAND(appendPrefix + 'DEAExpiredFlag');
			STRING1	  #EXPAND(appendPrefix + 'isStateSanction');
			STRING1	  #EXPAND(appendPrefix + 'isOIGSanction');
			STRING1	  #EXPAND(appendPrefix + 'isOPMSanction');
			STRING10  #EXPAND(appendPrefix + 'Taxonomy');
			STRING50  #EXPAND(appendPrefix + 'TaxonomyDescription');		
			STRING3	  #EXPAND(appendPrefix + 'SpecialityCode');	
			STRING1	  #EXPAND(appendPrefix + 'ProviderStatus');
			STRING40  #EXPAND(appendPrefix + 'GroupKey');
			STRING1	  #EXPAND(appendPrefix + 'hasActiveLicenseRevocation');
			STRING2	  #EXPAND(appendPrefix + 'ActiveLicenseRevocationState');			
			STRING8		#EXPAND(appendPrefix + 'ActiveLicenseRevocationDate');			
			STRING1	  #EXPAND(appendPrefix + 'hasActiveStateExclusion');
			STRING2	  #EXPAND(appendPrefix + 'ActiveLicenseExclusionState');
			STRING8	  #EXPAND(appendPrefix + 'ActiveStateExclusionDate');			
			STRING1	  #EXPAND(appendPrefix + 'hasActiveOIGExclusion');	
			STRING8	  #EXPAND(appendPrefix + 'ActiveOIGExclusionDate');
			STRING1	  #EXPAND(appendPrefix + 'hasActiveOPMExclusion');
			STRING8	  #EXPAND(appendPrefix + 'ActiveOPMExclusionDate');
			STRING8	  #EXPAND(appendPrefix + 'ActiveStateSanctionExclusionDate');
			STRING8	  #EXPAND(appendPrefix + 'ActiveOIGSanctionExclusionDate');
			STRING8	  #EXPAND(appendPrefix + 'ActiveOPMSanctionExclusionDate');
			STRING1	  #EXPAND(appendPrefix + 'hasLicenseRevocationReinstated');
			STRING2	  #EXPAND(appendPrefix + 'LicenseRevocationReinstatedState');
			STRING1	  #EXPAND(appendPrefix + 'hasStateExclusioinReinstated');
			STRING2	  #EXPAND(appendPrefix + 'StateExclusionReinstatedState');
			STRING8		#EXPAND(appendPrefix + 'StateExclusionReinstatedDate');
			STRING1	  #EXPAND(appendPrefix + 'hasOIGExclusioinReinstated');
			STRING2	  #EXPAND(appendPrefix + 'OIGExclusionReinstatedState');
			STRING8		#EXPAND(appendPrefix + 'OIGExclusionReinstatedDate');			
			STRING1	  #EXPAND(appendPrefix + 'hasOPMExclusioinReinstated');
			STRING2	  #EXPAND(appendPrefix + 'OPMExclusionReinstatedState');
			STRING8		#EXPAND(appendPrefix + 'OPMExclusionReinstatedDate');			
			STRING10  #EXPAND(appendPrefix + 'ResidentialPrimaryRange');
			STRING2   #EXPAND(appendPrefix + 'ResidentialPreDirectional');
			STRING28  #EXPAND(appendPrefix + 'ResidentialPrimaryName');
			STRING4   #EXPAND(appendPrefix + 'ResidentialAddressSuffix');
			STRING2   #EXPAND(appendPrefix + 'ResidentialPostDirectional');
			STRING8   #EXPAND(appendPrefix + 'ResidentialSecondaryRange');
			STRING25  #EXPAND(appendPrefix + 'ResidentialCityName');
			STRING2   #EXPAND(appendPrefix + 'ResidentialState');
			STRING5   #EXPAND(appendPrefix + 'ResidentialZip5');
			UNSIGNED3 #EXPAND(appendPrefix + 'ResidentialAddressLastSeen');
			STRING1	  #EXPAND(appendPrefix + 'ProviderWithSingleAddress');
			STRING1	  #EXPAND(appendPrefix + 'hasBankruptcy');
			STRING1	  #EXPAND(appendPrefix + 'hasCriminalHistory');			
			STRING1	  #EXPAND(appendPrefix + 'hasRelativeBankruptcy');
			STRING1	  #EXPAND(appendPrefix + 'hasRelativeCriminalHistory');			
			STRING1		#EXPAND(appendPrefix + 'hasAssocActiveStateExclusion');
			STRING1		#EXPAND(appendPrefix + 'hasAssocActiveLicenseRevocation');		
			STRING1		#EXPAND(appendPrefix + 'hasAssocStateExclusionReinstated');
			STRING1		#EXPAND(appendPrefix + 'hasAssocLicenseRevocationReinstated');
			STRING1		#EXPAND(appendPrefix + 'hasAssocBankruptcy');
			STRING1		#EXPAND(appendPrefix + 'hasAssocCriminalHistory');
		END;
		
		Add_Seq_REC := RECORD
			UNSIGNED8 Seq;
			OutPut_Rec;
		END;
		
		Add_Seq_DS := PROJECT (Infile,TRANSFORM(Add_Seq_REC, SELF.Seq := COUNTER; SELF := LEFT; SELF := []));
		
		Add_Seq_REC	tOutputPrep_Rec (Add_Seq_DS L, AppendProviderAttributes.Key_Provider_Attributes R) := TRANSFORM
			SELF.#EXPAND(appendPrefix + 'LexID')						     	:= R.LexID;
			SELF.#EXPAND(appendPrefix + 'EntityType')					    := R.EntityType;
			SELF.#EXPAND(appendPrefix + 'FNAME')						     	:= R.FNAME;
			SELF.#EXPAND(appendPrefix + 'MNAME')						     	:= R.MNAME;
			SELF.#EXPAND(appendPrefix + 'LNAME') 						     	:= R.LNAME; 
			SELF.#EXPAND(appendPrefix + 'SNAME')						     	:= R.SNAME;
			SELF.#EXPAND(appendPrefix + 'SSN')						     		:= R.SSN;
			SELF.#EXPAND(appendPrefix + 'ConsumerSSN')					  := R.ConsumerSSN;
			SELF.#EXPAND(appendPrefix + 'DateOfBirth')					  := R.DateOfBirth;
			SELF.#EXPAND(appendPrefix + 'ConsumerDateOfBirth')		:= R.ConsumerDateOfBirth;
			SELF.#EXPAND(appendPrefix + 'LicenseNumber')					:= R.LicenseNumber;
			SELF.#EXPAND(appendPrefix + 'CleanedLicenseNumber')		:= R.CleanedLicenseNumber;
			SELF.#EXPAND(appendPrefix + 'LicenseState')					  := R.LicenseState;
			SELF.#EXPAND(appendPrefix + 'LicenseType')					  := R.LicenseType;
			SELF.#EXPAND(appendPrefix + 'LicenseStatus')					:= R.LicenseStatus;
			SELF.#EXPAND(appendPrefix + 'DateLicenseExpired') 		:= R.DateLicenseExpired; 
			SELF.#EXPAND(appendPrefix + 'LicenseCount')					  := R.LicenseCount;
			SELF.#EXPAND(appendPrefix + 'LicenseStateCount')			:= R.LicenseStateCount;
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseCount')			:= R.ActiveLicenseCount;
			SELF.#EXPAND(appendPrefix + 'InactiveLicenseCount')		:= R.InactiveLicenseCount;
			SELF.#EXPAND(appendPrefix + 'RevokedLicenseCount')		:= R.RevokedLicenseCount;
			SELF.#EXPAND(appendPrefix + 'InactiveLicenseState')		:= R.InactiveLicenseState;	
			SELF.#EXPAND(appendPrefix + 'InactiveLicenseFlag')		:= R.InactiveLicenseFlag;
			SELF.#EXPAND(appendPrefix + 'RevokedLicenseFlag')			:= R.RevokedLicenseFlag;
			SELF.#EXPAND(appendPrefix + 'ExpiredLicenseFlag')			:= R.ExpiredLicenseFlag;
			SELF.#EXPAND(appendPrefix + 'DeathIndicator')					:= R.DeathIndicator;
			SELF.#EXPAND(appendPrefix + 'DateOfDeath')					  := R.DateOfDeath;
			SELF.#EXPAND(appendPrefix + 'BillingTaxID')					  := R.BillingTaxID;
			SELF.#EXPAND(appendPrefix + 'Phone')						     	:= R.Phone;
			SELF.#EXPAND(appendPrefix + 'Fax')						     		:= R.Fax;
			SELF.#EXPAND(appendPrefix + 'UPIN')						     		:= R.UPIN;
			SELF.#EXPAND(appendPrefix + 'NPINUMBER')					    := R.NPINUMBER;
			SELF.#EXPAND(appendPrefix + 'NPIEnumerationDate')			:= R.NPIEnumerationDate;
			SELF.#EXPAND(appendPrefix + 'NPIDeactivationDate')		:= R.NPIDeactivationDate;
			SELF.#EXPAND(appendPrefix + 'NPIReactivationDate')		:= R.NPIReactivationDate;
			SELF.#EXPAND(appendPrefix + 'NPIFlag')						    := R.NPIFlag;
			SELF.#EXPAND(appendPrefix + 'DeactivedNPICount')			:= R.DeactivedNPICount; 
			SELF.#EXPAND(appendPrefix + 'DEABusinessActivityIndicator')		:= R.DEABusinessActivityIndicator;
			SELF.#EXPAND(appendPrefix + 'DEANumber')					    := R.DEANumber;
			SELF.#EXPAND(appendPrefix + 'DateDEAExpired')					:= R.DateDEAExpired;
			SELF.#EXPAND(appendPrefix + 'DEACount')						    := R.DEACount;
			SELF.#EXPAND(appendPrefix + 'ActiveDEACount')					:= R.ActiveDEACount;
			SELF.#EXPAND(appendPrefix + 'ExpiredDEACount')				:= R.ExpiredDEACount;
			SELF.#EXPAND(appendPrefix + 'DEAExpiredFlag')					:= R.DeaExpiredFlag;
			SELF.#EXPAND(appendPrefix + 'isStateSanction')				:= R.isStateSanction;
			SELF.#EXPAND(appendPrefix + 'isOIGSanction')	 				:= R.isOIGSanction;
			SELF.#EXPAND(appendPrefix + 'isOPMSanction')					:= R.isOPMSanction;
			SELF.#EXPAND(appendPrefix + 'Taxonomy')						     := R.Taxonomy;
			SELF.#EXPAND(appendPrefix + 'TaxonomyDescription')		 := R.TaxonomyDescription; 
			SELF.#EXPAND(appendPrefix + 'SpecialityCode')					 := R.SpecialityCode;
			SELF.#EXPAND(appendPrefix + 'ProviderStatus')					 := R.ProviderStatus;
			SELF.#EXPAND(appendPrefix + 'GroupKey')						     := R.GroupKey;
			SELF.#EXPAND(appendPrefix + 'hasActiveLicenseRevocation')			 	:= R.hasActiveLicenseRevocation;	
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseRevocationState')		 	:= R.ActiveLicenseRevocationState;			
			SELF.#EXPAND(appendPrefix + 'hasActiveStateExclusion')		 			:= R.hasActiveStateExclusion;			
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseExclusionState')		 	:= R.ActiveLicenseExclusionState;			
			SELF.#EXPAND(appendPrefix + 'ActiveStateExclusionDate')		 			:= R.ActiveStateExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'hasActiveOIGExclusion')		 				:= R.hasActiveOIGExclusion;			
			SELF.#EXPAND(appendPrefix + 'ActiveOIGExclusionDate')		 				:= R.ActiveOIGExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'hasActiveOPMExclusion')						:= R.hasActiveOPMExclusion;			
			SELF.#EXPAND(appendPrefix + 'ActiveOPMExclusionDate')		 				:= R.ActiveOPMExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseRevocationDate')		 	:= R.ActiveLicenseRevocationDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveStateSanctionExclusionDate')	:= R.ActiveStateExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveOIGSanctionExclusionDate')		:= R.ActiveOIGExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveOPMSanctionExclusionDate')		:= R.ActiveOPMExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'hasLicenseRevocationReinstated')		:= R.hasLicenseRevocationReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'LicenseRevocationReinstatedState')	:= R.LicenseRevocationReinstatedState_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'hasStateExclusioinReinstated')		 	:= R.hasActiveStateExclusionReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'StateExclusionReinstatedState')		:= R.StateExclusionReinstatedState_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'StateExclusionReinstatedDate')		 	:= R.StateExclusionReinstatedDate_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'hasOIGExclusioinReinstated')		 		:= R.hasActiveOIGExclusionReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'OIGExclusionReinstatedDate')		 		:= R.OIGExclusionReinstatedDate_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'hasOPMExclusioinReinstated')		 		:= R.hasActiveOPMExclusionReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'OPMExclusionReinstatedDate')		 		:= R.OPMExclusionReinstatedDate_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'ResidentialPrimaryRange')				     						:= R.ResidentialPrimaryRange;
			SELF.#EXPAND(appendPrefix + 'ResidentialPreDirectional')			     						:= R.ResidentialPreDirectional;
			SELF.#EXPAND(appendPrefix + 'ResidentialPrimaryName')				     							:= R.ResidentialPrimaryName;
			SELF.#EXPAND(appendPrefix + 'ResidentialAddressSuffix')				     						:= R.ResidentialAddressSuffix;
			SELF.#EXPAND(appendPrefix + 'ResidentialPostDirectional')			     						:= R.ResidentialPostDirectional;
			SELF.#EXPAND(appendPrefix + 'ResidentialSecondaryRange')			     						:= R.ResidentialSecondaryRange;
			SELF.#EXPAND(appendPrefix + 'ResidentialCityName')				     								:= R.ResidentialCityName;
			SELF.#EXPAND(appendPrefix + 'ResidentialState')					     									:= R.ResidentialState;
			SELF.#EXPAND(appendPrefix + 'ResidentialZip5')					     									:= R.ResidentialZip5;
			SELF.#EXPAND(appendPrefix + 'ResidentialAddressLastSeen')			 						    := R.ResidentialAddressLastSeen;
			SELF.#EXPAND(appendPrefix + 'ProviderWithSingleAddress')			   						  := R.ProviderWithSingleAddress;
			SELF.#EXPAND(appendPrefix + 'hasBankruptcy')			 						    						:= R.hasBankruptcy;
			SELF.#EXPAND(appendPrefix + 'hasCriminalHistory')			 						  					:= R.hasCriminalHistory;
			SELF.#EXPAND(appendPrefix + 'hasRelativeCriminalHistory')			 						   	:= R.hasRelativeConvictions;
			SELF.#EXPAND(appendPrefix + 'hasRelativeBankruptcy')			 						   			:= R.hasRelativeBankruptcy;
			SELF.#EXPAND(appendPrefix + 'hasAssocActiveStateExclusion')			 						  := R.hasAssocActiveStateExclusion;
			SELF.#EXPAND(appendPrefix + 'hasAssocActiveLicenseRevocation')			 					:= R.hasAssocActiveLicenseRevocation;		
			SELF.#EXPAND(appendPrefix + 'hasAssocStateExclusionReinstated')							 	:= R.hasAssocStateExclusionReinstated_Past5Y;
			SELF.#EXPAND(appendPrefix + 'hasAssocLicenseRevocationReinstated')						:= R.hasAssocLicenseRevocationReinstated_Past5Y;
			SELF.#EXPAND(appendPrefix + 'hasAssocBankruptcy')			 						    				:= R.hasAssocBankruptcy;
			SELF.#EXPAND(appendPrefix + 'hasAssocCriminalHistory')			 						   		:= R.hasAssocCriminalHistory;
			SELF :=  L;
			SELF :=  R;
			SELF :=  [];
		END;
  
		Output_REC	tOutput_Rec (Infile L, AppendProviderAttributes.Key_Provider_Attributes R) := TRANSFORM
			SELF.#EXPAND(appendPrefix + 'LexID')						     	:= R.LexID;
			SELF.#EXPAND(appendPrefix + 'EntityType')					    := R.EntityType;
			SELF.#EXPAND(appendPrefix + 'FNAME')						     	:= R.FNAME;
			SELF.#EXPAND(appendPrefix + 'MNAME')						     	:= R.MNAME;
			SELF.#EXPAND(appendPrefix + 'LNAME') 						     	:= R.LNAME; 
			SELF.#EXPAND(appendPrefix + 'SNAME')						     	:= R.SNAME;
			SELF.#EXPAND(appendPrefix + 'SSN')						     		:= R.SSN;
			SELF.#EXPAND(appendPrefix + 'ConsumerSSN')					  := R.ConsumerSSN;
			SELF.#EXPAND(appendPrefix + 'DateOfBirth')					  := R.DateOfBirth;
			SELF.#EXPAND(appendPrefix + 'ConsumerDateOfBirth')		:= R.ConsumerDateOfBirth;
			SELF.#EXPAND(appendPrefix + 'LicenseNumber')					:= R.LicenseNumber;
			SELF.#EXPAND(appendPrefix + 'CleanedLicenseNumber')		:= R.CleanedLicenseNumber;
			SELF.#EXPAND(appendPrefix + 'LicenseState')					  := R.LicenseState;
			SELF.#EXPAND(appendPrefix + 'LicenseType')					  := R.LicenseType;
			SELF.#EXPAND(appendPrefix + 'LicenseStatus')					:= R.LicenseStatus;
			SELF.#EXPAND(appendPrefix + 'DateLicenseExpired') 		:= R.DateLicenseExpired; 
			SELF.#EXPAND(appendPrefix + 'LicenseCount')					  := R.LicenseCount;
			SELF.#EXPAND(appendPrefix + 'LicenseStateCount')			:= R.LicenseStateCount;
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseCount')			:= R.ActiveLicenseCount;
			SELF.#EXPAND(appendPrefix + 'InactiveLicenseCount')		:= R.InactiveLicenseCount;
			SELF.#EXPAND(appendPrefix + 'RevokedLicenseCount')		:= R.RevokedLicenseCount;
			SELF.#EXPAND(appendPrefix + 'InactiveLicenseState')		:= R.InactiveLicenseState;	
			SELF.#EXPAND(appendPrefix + 'InactiveLicenseFlag')		:= R.InactiveLicenseFlag;
			SELF.#EXPAND(appendPrefix + 'RevokedLicenseFlag')			:= R.RevokedLicenseFlag;
			SELF.#EXPAND(appendPrefix + 'ExpiredLicenseFlag')			:= R.ExpiredLicenseFlag;
			SELF.#EXPAND(appendPrefix + 'DeathIndicator')					:= R.DeathIndicator;
			SELF.#EXPAND(appendPrefix + 'DateOfDeath')					  := R.DateOfDeath;
			SELF.#EXPAND(appendPrefix + 'BillingTaxID')					  := R.BillingTaxID;
			SELF.#EXPAND(appendPrefix + 'Phone')						     	:= R.Phone;
			SELF.#EXPAND(appendPrefix + 'Fax')						     		:= R.Fax;
			SELF.#EXPAND(appendPrefix + 'UPIN')						     		:= R.UPIN;
			SELF.#EXPAND(appendPrefix + 'NPINUMBER')					    := R.NPINUMBER;
			SELF.#EXPAND(appendPrefix + 'NPIEnumerationDate')			:= R.NPIEnumerationDate;
			SELF.#EXPAND(appendPrefix + 'NPIDeactivationDate')		:= R.NPIDeactivationDate;
			SELF.#EXPAND(appendPrefix + 'NPIReactivationDate')		:= R.NPIReactivationDate;
			SELF.#EXPAND(appendPrefix + 'NPIFlag')						    := R.NPIFlag;
			SELF.#EXPAND(appendPrefix + 'DeactivedNPICount')			:= R.DeactivedNPICount; 
			SELF.#EXPAND(appendPrefix + 'DEABusinessActivityIndicator')		:= R.DEABusinessActivityIndicator;
			SELF.#EXPAND(appendPrefix + 'DEANumber')					    := R.DEANumber;
			SELF.#EXPAND(appendPrefix + 'DateDEAExpired')					:= R.DateDEAExpired;
			SELF.#EXPAND(appendPrefix + 'DEACount')						    := R.DEACount;
			SELF.#EXPAND(appendPrefix + 'ActiveDEACount')					:= R.ActiveDEACount;
			SELF.#EXPAND(appendPrefix + 'ExpiredDEACount')				:= R.ExpiredDEACount;
			SELF.#EXPAND(appendPrefix + 'DEAExpiredFlag')					:= R.DeaExpiredFlag;
			SELF.#EXPAND(appendPrefix + 'isStateSanction')				:= R.isStateSanction;
			SELF.#EXPAND(appendPrefix + 'isOIGSanction')	 				:= R.isOIGSanction;
			SELF.#EXPAND(appendPrefix + 'isOPMSanction')					:= R.isOPMSanction;
			SELF.#EXPAND(appendPrefix + 'Taxonomy')						     := R.Taxonomy;
			SELF.#EXPAND(appendPrefix + 'TaxonomyDescription')		 := R.TaxonomyDescription; 
			SELF.#EXPAND(appendPrefix + 'SpecialityCode')					 := R.SpecialityCode;
			SELF.#EXPAND(appendPrefix + 'ProviderStatus')					 := R.ProviderStatus;
			SELF.#EXPAND(appendPrefix + 'GroupKey')						     := R.GroupKey;
			SELF.#EXPAND(appendPrefix + 'hasActiveLicenseRevocation')			 	:= R.hasActiveLicenseRevocation;	
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseRevocationState')		 	:= R.ActiveLicenseRevocationState;			
			SELF.#EXPAND(appendPrefix + 'hasActiveStateExclusion')		 			:= R.hasActiveStateExclusion;			
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseExclusionState')		 	:= R.ActiveLicenseExclusionState;			
			SELF.#EXPAND(appendPrefix + 'ActiveStateExclusionDate')		 			:= R.ActiveStateExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'hasActiveOIGExclusion')		 				:= R.hasActiveOIGExclusion;			
			SELF.#EXPAND(appendPrefix + 'ActiveOIGExclusionDate')		 				:= R.ActiveOIGExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'hasActiveOPMExclusion')						:= R.hasActiveOPMExclusion;			
			SELF.#EXPAND(appendPrefix + 'ActiveOPMExclusionDate')		 				:= R.ActiveOPMExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveLicenseRevocationDate')		 	:= R.ActiveLicenseRevocationDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveStateSanctionExclusionDate')	:= R.ActiveStateExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveOIGSanctionExclusionDate')		:= R.ActiveOIGExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'ActiveOPMSanctionExclusionDate')		:= R.ActiveOPMExclusionDate;			
			SELF.#EXPAND(appendPrefix + 'hasLicenseRevocationReinstated')		:= R.hasLicenseRevocationReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'LicenseRevocationReinstatedState')	:= R.LicenseRevocationReinstatedState_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'hasStateExclusioinReinstated')		 	:= R.hasActiveStateExclusionReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'StateExclusionReinstatedState')		:= R.StateExclusionReinstatedState_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'StateExclusionReinstatedDate')		 	:= R.StateExclusionReinstatedDate_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'hasOIGExclusioinReinstated')		 		:= R.hasActiveOIGExclusionReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'OIGExclusionReinstatedDate')		 		:= R.OIGExclusionReinstatedDate_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'hasOPMExclusioinReinstated')		 		:= R.hasActiveOPMExclusionReinstated_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'OPMExclusionReinstatedDate')		 		:= R.OPMExclusionReinstatedDate_Past5Y;			
			SELF.#EXPAND(appendPrefix + 'ResidentialPrimaryRange')				     						:= R.ResidentialPrimaryRange;
			SELF.#EXPAND(appendPrefix + 'ResidentialPreDirectional')			     						:= R.ResidentialPreDirectional;
			SELF.#EXPAND(appendPrefix + 'ResidentialPrimaryName')				     							:= R.ResidentialPrimaryName;
			SELF.#EXPAND(appendPrefix + 'ResidentialAddressSuffix')				     						:= R.ResidentialAddressSuffix;
			SELF.#EXPAND(appendPrefix + 'ResidentialPostDirectional')			     						:= R.ResidentialPostDirectional;
			SELF.#EXPAND(appendPrefix + 'ResidentialSecondaryRange')			     						:= R.ResidentialSecondaryRange;
			SELF.#EXPAND(appendPrefix + 'ResidentialCityName')				     								:= R.ResidentialCityName;
			SELF.#EXPAND(appendPrefix + 'ResidentialState')					     									:= R.ResidentialState;
			SELF.#EXPAND(appendPrefix + 'ResidentialZip5')					     									:= R.ResidentialZip5;
			SELF.#EXPAND(appendPrefix + 'ResidentialAddressLastSeen')			 						    := R.ResidentialAddressLastSeen;
			SELF.#EXPAND(appendPrefix + 'ProviderWithSingleAddress')			   						  := R.ProviderWithSingleAddress;
			SELF.#EXPAND(appendPrefix + 'hasBankruptcy')			 						    						:= R.hasBankruptcy;
			SELF.#EXPAND(appendPrefix + 'hasCriminalHistory')			 						  					:= R.hasCriminalHistory;
			SELF.#EXPAND(appendPrefix + 'hasRelativeCriminalHistory')			 						   	:= R.hasRelativeConvictions;
			SELF.#EXPAND(appendPrefix + 'hasRelativeBankruptcy')			 						   			:= R.hasRelativeBankruptcy;
			SELF.#EXPAND(appendPrefix + 'hasAssocActiveStateExclusion')			 						  := R.hasAssocActiveStateExclusion;
			SELF.#EXPAND(appendPrefix + 'hasAssocActiveLicenseRevocation')			 					:= R.hasAssocActiveLicenseRevocation;		
			SELF.#EXPAND(appendPrefix + 'hasAssocStateExclusionReinstated')							 	:= R.hasAssocStateExclusionReinstated_Past5Y;
			SELF.#EXPAND(appendPrefix + 'hasAssocLicenseRevocationReinstated')						:= R.hasAssocLicenseRevocationReinstated_Past5Y;
			SELF.#EXPAND(appendPrefix + 'hasAssocBankruptcy')			 						    				:= R.hasAssocBankruptcy;
			SELF.#EXPAND(appendPrefix + 'hasAssocCriminalHistory')			 						   		:= R.hasAssocCriminalHistory;
			SELF :=  L;
			SELF :=  R;
			SELF :=  [];
		END;

		Append_Provider_Attributes_Prep := JOIN(AppendProviderAttributes.Key_Provider_Attributes, Add_Seq_DS, 
                     RIGHT.Input_Lnpid > 0 AND RIGHT.Input_Lnpid = LEFT.LNPID,
                     tOutputPrep_Rec (RIGHT, LEFT),
                     SMART, KEEP(1));

		Larger_DS := JOIN (Add_Seq_DS, Append_Provider_Attributes_Prep, LEFT.Seq = RIGHT.Seq, TRANSFORM(OutPut_Rec, SELF := IF(Right.Seq > 0, RIGHT, LEFT)), LEFT OUTER, HASH);
		
		Smaller_DS := JOIN(Infile, AppendProviderAttributes.Key_Provider_Attributes,
                     KEYED(LEFT.Input_Lnpid > 0 AND LEFT.Input_Lnpid = RIGHT.LNPID),
                     tOutput_Rec(LEFT, RIGHT),
                     KEEP(1), LEFT OUTER, KEYED);

		Append_Provider_Attributes_DS := IF(COUNT(Infile) > (INTEGER)UseIndexThreshold, Larger_DS, Smaller_DS);
		
		RETURN Append_Provider_Attributes_DS;
ENDMACRO;

