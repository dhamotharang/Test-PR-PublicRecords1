//This is the code to execute in a builder window
#OPTION('multiplePersistInstances', FALSE);
#workunit('name','Scrubs_BIPV2.Ingest_BWR_Hygiene - Hygiene & Stats - SALT V3.11.4');
IMPORT Scrubs_BIPV2,SALT311;
// First create an instantiated hygiene module
  infile := Scrubs_BIPV2.Ingest_In_BIPV2;
  ip := DISTRIBUTE(infile, SKEW(0.1));
  h := Scrubs_BIPV2.Ingest_hygiene(ip);
  p := h.AllProfiles; // Detailed profile of every field
  OUTPUT(h.Summary('SummaryReport'),ALL,NAMED('Summary'));
  OUTPUT(h.SourceCounts,ALL,NAMED('SourceCounts'));
  OUTPUT(h.CrossLinkingPotential,ALL,NAMED('CrossLinkingPotential'));
  OUTPUT(h.invSummary,NAMED('InvertedSummary'),ALL);
  OUTPUT(p,NAMED('AllProfiles'),ALL); // Detailed profile of every field
  OUTPUT(h.Correlations,NAMED('Correlations'),ALL); // Which fields are related to which other fields
  OUTPUT(h.ValidityErrors,NAMED('ValidityErrors'),ALL); // Violations of FieldType statements
  OUTPUT(SALT311.MAC_Character_Counts.EclRecord(p,'Ingest_Layout_BIPV2'),NAMED('OptimizedLayout'));// File layout suggested by data
  // Produces field types that match the most common 99.9% of your data. Change to 100 to match all your data
  OUTPUT(SALT311.MAC_Character_Counts.FieldTypes(p,99.9),NAMED('Types'));
  // ****** Cross Tabs *******
  // It is possible to create a cross table between any two fields, see documentation on SALT311.MAC_CrossTab
  // These commented out lines will create crosstabs from the sourcefield to each individual field
  // IF you find yourself using ALL of these a LOT - let me know, I can make the 'all' case faster
   Examples := 10;
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,source,Examples),NAMED('sourceBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_first_seen,Examples),NAMED('dt_first_seenBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_last_seen,Examples),NAMED('dt_last_seenBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_vendor_first_reported,Examples),NAMED('dt_vendor_first_reportedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_vendor_last_reported,Examples),NAMED('dt_vendor_last_reportedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,rcid,Examples),NAMED('rcidBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_bdid,Examples),NAMED('company_bdidBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_name,Examples),NAMED('company_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_name_type_raw,Examples),NAMED('company_name_type_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_rawaid,Examples),NAMED('company_rawaidBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_prim_range,Examples),NAMED('company_address_prim_rangeBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_predir,Examples),NAMED('company_address_predirBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_prim_name,Examples),NAMED('company_address_prim_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_addr_suffix,Examples),NAMED('company_address_addr_suffixBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_postdir,Examples),NAMED('company_address_postdirBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_unit_desig,Examples),NAMED('company_address_unit_desigBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_sec_range,Examples),NAMED('company_address_sec_rangeBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_p_city_name,Examples),NAMED('company_address_p_city_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_v_city_name,Examples),NAMED('company_address_v_city_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_st,Examples),NAMED('company_address_stBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_zip,Examples),NAMED('company_address_zipBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_zip4,Examples),NAMED('company_address_zip4Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_cart,Examples),NAMED('company_address_cartBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_cr_sort_sz,Examples),NAMED('company_address_cr_sort_szBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_lot,Examples),NAMED('company_address_lotBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_lot_order,Examples),NAMED('company_address_lot_orderBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_dbpc,Examples),NAMED('company_address_dbpcBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_chk_digit,Examples),NAMED('company_address_chk_digitBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_rec_type,Examples),NAMED('company_address_rec_typeBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_fips_state,Examples),NAMED('company_address_fips_stateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_fips_county,Examples),NAMED('company_address_fips_countyBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_geo_lat,Examples),NAMED('company_address_geo_latBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_geo_long,Examples),NAMED('company_address_geo_longBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_msa,Examples),NAMED('company_address_msaBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_geo_blk,Examples),NAMED('company_address_geo_blkBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_geo_match,Examples),NAMED('company_address_geo_matchBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_err_stat,Examples),NAMED('company_address_err_statBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_type_raw,Examples),NAMED('company_address_type_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_category,Examples),NAMED('company_address_categoryBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_country_code,Examples),NAMED('company_address_country_codeBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_fein,Examples),NAMED('company_feinBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,best_fein_indicator,Examples),NAMED('best_fein_indicatorBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_phone,Examples),NAMED('company_phoneBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,phone_type,Examples),NAMED('phone_typeBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_org_structure_raw,Examples),NAMED('company_org_structure_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_incorporation_date,Examples),NAMED('company_incorporation_dateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_sic_code1,Examples),NAMED('company_sic_code1Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_sic_code2,Examples),NAMED('company_sic_code2Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_sic_code3,Examples),NAMED('company_sic_code3Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_sic_code4,Examples),NAMED('company_sic_code4Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_sic_code5,Examples),NAMED('company_sic_code5Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_naics_code1,Examples),NAMED('company_naics_code1Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_naics_code2,Examples),NAMED('company_naics_code2Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_naics_code3,Examples),NAMED('company_naics_code3Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_naics_code4,Examples),NAMED('company_naics_code4Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_naics_code5,Examples),NAMED('company_naics_code5Bysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_ticker,Examples),NAMED('company_tickerBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_ticker_exchange,Examples),NAMED('company_ticker_exchangeBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_foreign_domestic,Examples),NAMED('company_foreign_domesticBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_url,Examples),NAMED('company_urlBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_inc_state,Examples),NAMED('company_inc_stateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_charter_number,Examples),NAMED('company_charter_numberBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_filing_date,Examples),NAMED('company_filing_dateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_status_date,Examples),NAMED('company_status_dateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_foreign_date,Examples),NAMED('company_foreign_dateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,event_filing_date,Examples),NAMED('event_filing_dateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_name_status_raw,Examples),NAMED('company_name_status_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_status_raw,Examples),NAMED('company_status_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_first_seen_company_name,Examples),NAMED('dt_first_seen_company_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_last_seen_company_name,Examples),NAMED('dt_last_seen_company_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_first_seen_company_address,Examples),NAMED('dt_first_seen_company_addressBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_last_seen_company_address,Examples),NAMED('dt_last_seen_company_addressBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,vl_id,Examples),NAMED('vl_idBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,current,Examples),NAMED('currentBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,source_record_id,Examples),NAMED('source_record_idBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,glb,Examples),NAMED('glbBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dppa,Examples),NAMED('dppaBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,phone_score,Examples),NAMED('phone_scoreBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,match_company_name,Examples),NAMED('match_company_nameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,match_branch_city,Examples),NAMED('match_branch_cityBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,match_geo_city,Examples),NAMED('match_geo_cityBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,duns_number,Examples),NAMED('duns_numberBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,source_docid,Examples),NAMED('source_docidBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,is_contact,Examples),NAMED('is_contactBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_first_seen_contact,Examples),NAMED('dt_first_seen_contactBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,dt_last_seen_contact,Examples),NAMED('dt_last_seen_contactBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_did,Examples),NAMED('contact_didBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_name_title,Examples),NAMED('contact_name_titleBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_name_fname,Examples),NAMED('contact_name_fnameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_name_lname,Examples),NAMED('contact_name_lnameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_name_lname,Examples),NAMED('contact_name_lnameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_name_name_suffix,Examples),NAMED('contact_name_name_suffixBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_name_name_score,Examples),NAMED('contact_name_name_scoreBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_type_raw,Examples),NAMED('contact_type_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_job_title_raw,Examples),NAMED('contact_job_title_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_ssn,Examples),NAMED('contact_ssnBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_dob,Examples),NAMED('contact_dobBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_status_raw,Examples),NAMED('contact_status_rawBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_email,Examples),NAMED('contact_emailBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_email_username,Examples),NAMED('contact_email_usernameBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_email_domain,Examples),NAMED('contact_email_domainBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_phone,Examples),NAMED('contact_phoneBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,cid,Examples),NAMED('cidBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_score,Examples),NAMED('contact_scoreBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,from_hdr,Examples),NAMED('from_hdrBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_department,Examples),NAMED('company_departmentBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_aceaid,Examples),NAMED('company_aceaidBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_name_type_derived,Examples),NAMED('company_name_type_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_address_type_derived,Examples),NAMED('company_address_type_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_org_structure_derived,Examples),NAMED('company_org_structure_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_name_status_derived,Examples),NAMED('company_name_status_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,company_status_derived,Examples),NAMED('company_status_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,proxid_status_private,Examples),NAMED('proxid_status_privateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,powid_status_private,Examples),NAMED('powid_status_privateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,seleid_status_private,Examples),NAMED('seleid_status_privateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,orgid_status_private,Examples),NAMED('orgid_status_privateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,ultid_status_private,Examples),NAMED('ultid_status_privateBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,proxid_status_public,Examples),NAMED('proxid_status_publicBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,powid_status_public,Examples),NAMED('powid_status_publicBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,seleid_status_public,Examples),NAMED('seleid_status_publicBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,orgid_status_public,Examples),NAMED('orgid_status_publicBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,ultid_status_public,Examples),NAMED('ultid_status_publicBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_type_derived,Examples),NAMED('contact_type_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_job_title_derived,Examples),NAMED('contact_job_title_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,contact_status_derived,Examples),NAMED('contact_status_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,address_type_derived,Examples),NAMED('address_type_derivedBysource_expanded'));
  //  OUTPUT(SALT311.MAC_CrossTab(infile,source_expanded,is_vanity_name_derived,Examples),NAMED('is_vanity_name_derivedBysource_expanded'));
