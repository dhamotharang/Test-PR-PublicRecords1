 import	_control;

export Proc_Build_DiversityCert_Keys(string pIndexVersion) := function

rKeyDiversityCert__autokey__address := RECORD
  string28 prim_name;
  string10 prim_range;
  string2 st;
  unsigned4 city_code;
  string5 zip;
  string8 sec_range;
  string6 dph_lname;
  string20 lname;
  string20 pfname;
  string20 fname;
  unsigned8 states;
  unsigned4 lname1;
  unsigned4 lname2;
  unsigned4 lname3;
  unsigned4 lookups;
  unsigned6 did;
 END;
 
rKeyDiversityCert__autokey__addressb2 := RECORD
  string28 prim_name;
  string10 prim_range;
  string2 st;
  unsigned4 city_code;
  string5 zip;
  string8 sec_range;
  string40 cname_indic;
  string40 cname_sec;
  unsigned6 bdid;
  unsigned4 lookups;
 END;


rKeyDiversityCert__autokey__citystname := RECORD
  unsigned4 city_code;
  string2 st;
  string6 dph_lname;
  string20 lname;
  string20 pfname;
  string20 fname;
  integer4 dob;
  unsigned8 states;
  unsigned4 lname1;
  unsigned4 lname2;
  unsigned4 lname3;
  unsigned4 city1;
  unsigned4 city2;
  unsigned4 city3;
  unsigned4 rel_fname1;
  unsigned4 rel_fname2;
  unsigned4 rel_fname3;
  unsigned4 lookups;
  unsigned6 did;
 END;


rKeyDiversityCert__autokey__citystnameb2 := RECORD
  unsigned4 city_code;
  string2 st;
  string40 cname_indic;
  string40 cname_sec;
  unsigned6 bdid;
  unsigned4 lookups;
 END;




rKeyDiversityCert__autokey__name:= RECORD
  string6 dph_lname;
  string20 lname;
  string20 pfname;
  string20 fname;
  string1 minit;
  unsigned2 yob;
  unsigned2 s4;
  integer4 dob;
  unsigned8 states;
  unsigned4 lname1;
  unsigned4 lname2;
  unsigned4 lname3;
  unsigned4 city1;
  unsigned4 city2;
  unsigned4 city3;
  unsigned4 rel_fname1;
  unsigned4 rel_fname2;
  unsigned4 rel_fname3;
  unsigned4 lookups;
  unsigned6 did;
 END;


rKeyDiversityCert__autokey__nameb2 := RECORD
  string40 cname_indic;
  string40 cname_sec;
  unsigned6 bdid;
  unsigned4 lookups;
 END;



rKeyDiversityCert__autokey__ssn2 := RECORD
  string1 s1;
  string1 s2;
  string1 s3;
  string1 s4;
  string1 s5;
  string1 s6;
  string1 s7;
  string1 s8;
  string1 s9;
  string6 dph_lname;
  string20 pfname;
  unsigned6 did;
  unsigned4 lookups;
 END;

 

rKeyDiversityCert__autokey__stname := RECORD
  string2 st;
  string6 dph_lname;
  string20 lname;
  string20 pfname;
  string20 fname;
  string1 minit;
  unsigned2 yob;
  unsigned2 s4;
  integer4 zip;
  integer4 dob;
  unsigned8 states;
  unsigned4 lname1;
  unsigned4 lname2;
  unsigned4 lname3;
  unsigned4 city1;
  unsigned4 city2;
  unsigned4 city3;
  unsigned4 rel_fname1;
  unsigned4 rel_fname2;
  unsigned4 rel_fname3;
  unsigned4 lookups;
  unsigned6 did;
 END;

 

rKeyDiversityCert__autokey__stnameb2:= RECORD
  string2 st;
  string40 cname_indic;
  string40 cname_sec;
  unsigned6 bdid;
  unsigned4 lookups;
 END;


rKeyDiversityCert__autokey__zip := RECORD
  integer4 zip;
  string6 dph_lname;
  string20 lname;
  string20 pfname;
  string20 fname;
  string1 minit;
  unsigned2 yob;
  unsigned2 s4;
  integer4 dob;
  unsigned8 states;
  unsigned4 lname1;
  unsigned4 lname2;
  unsigned4 lname3;
  unsigned4 city1;
  unsigned4 city2;
  unsigned4 city3;
  unsigned4 rel_fname1;
  unsigned4 rel_fname2;
  unsigned4 rel_fname3;
  unsigned4 lookups;
  unsigned6 did;
 END;



rKeyDiversityCert__autokey__zipb2 := RECORD
  integer4 zip;
  string40 cname_indic;
  string40 cname_sec;
  unsigned6 bdid;
  unsigned4 lookups;
 END;


rKeyDiversityCert__autokey__payload := RECORD
  unsigned6 fakeid;
  string dartid;
  string dateadded;
  string dateupdated;
  string website;
  string state;
  string profilelastupdated;
  string county;
  string servicearea;
  string region1;
  string region2;
  string region3;
  string region4;
  string region5;
  string fname;
  string lname;
  string mname;
  string suffix;
  string title;
  string ethnicity;
  string gender;
  string address1;
  string address2;
  string addresscity;
  string addressstate;
  string addresszipcode;
  string addresszip4;
  string building;
  string contact;
  string phone1;
  string phone2;
  string phone3;
  string cell;
  string fax;
  string email1;
  string email2;
  string email3;
  string webpage1;
  string webpage2;
  string webpage3;
  string businessname;
  string dba;
  string businessid;
  string businesstype1;
  string businesslocation1;
  string businesstype2;
  string businesslocation2;
  string businesstype3;
  string businesslocation3;
  string businesstype4;
  string businesslocation4;
  string businesstype5;
  string businesslocation5;
  string industry;
  string trade;
  string resourcedescription;
  string natureofbusiness;
  string businessdescription;
  string businessstructure;
  string totalemployees;
  string avgcontractsize;
  string firmid;
  string firmlocationaddress;
  string firmlocationaddresscity;
  string firmlocationaddresszip4;
  string firmlocationaddresszipcode;
  string firmlocationcounty;
  string firmlocationstate;
  string certfed;
  string certstate;
  string contractsfederal;
  string contractsva;
  string contractscommercial;
  string contractorgovernmentprime;
  string contractorgovernmentsub;
  string contractornongovernment;
  string registeredgovernmentbus;
  string registerednongovernmentbus;
  string clearancelevelpersonnel;
  string clearancelevelfacility;
  string certificatedatefrom1;
  string certificatedateto1;
  string certificatestatus1;
  string certificationnumber1;
  string certificationtype1;
  string certificatedatefrom2;
  string certificatedateto2;
  string certificatestatus2;
  string certificationnumber2;
  string certificationtype2;
  string certificatedatefrom3;
  string certificatedateto3;
  string certificatestatus3;
  string certificationnumber3;
  string certificationtype3;
  string certificatedatefrom4;
  string certificatedateto4;
  string certificatestatus4;
  string certificationnumber4;
  string certificationtype4;
  string certificatedatefrom5;
  string certificatedateto5;
  string certificatestatus5;
  string certificationnumber5;
  string certificationtype5;
  string certificatedatefrom6;
  string certificatedateto6;
  string certificatestatus6;
  string certificationnumber6;
  string certificationtype6;
  string starrating;
  string assets;
  string biddescription;
  string competitiveadvantage;
  string cagecode;
  string capabilitiesnarrative;
  string category;
  string chtrclass;
  string productdescription1;
  string productdescription2;
  string productdescription3;
  string productdescription4;
  string productdescription5;
  string classdescription1;
  string subclassdescription1;
  string classdescription2;
  string subclassdescription2;
  string classdescription3;
  string subclassdescription3;
  string classdescription4;
  string subclassdescription4;
  string classdescription5;
  string subclassdescription5;
  string classifications;
  string commodity1;
  string commodity2;
  string commodity3;
  string commodity4;
  string commodity5;
  string commodity6;
  string commodity7;
  string commodity8;
  string completedate;
  string crossreference;
  string dateestablished;
  string businessage;
  string deposits;
  string dunsnumber;
  string enttype;
  string expirationdate;
  string extendeddate;
  string issuingauthority;
  string keywords;
  string licensenumber;
  string licensetype;
  string mincd;
  string minorityaffiliation;
  string minorityownershipdate;
  string siccode1;
  string siccode2;
  string siccode3;
  string siccode4;
  string siccode5;
  string siccode6;
  string siccode7;
  string siccode8;
  string naicscode1;
  string naicscode2;
  string naicscode3;
  string naicscode4;
  string naicscode5;
  string naicscode6;
  string naicscode7;
  string naicscode8;
  string prequalify;
  string procurementcategory1;
  string subprocurementcategory1;
  string procurementcategory2;
  string subprocurementcategory2;
  string procurementcategory3;
  string subprocurementcategory3;
  string procurementcategory4;
  string subprocurementcategory4;
  string procurementcategory5;
  string subprocurementcategory5;
  string renewal;
  string renewaldate;
  string unitedcertprogrampartner;
  string vendorkey;
  string vendornumber;
  string workcode1;
  string workcode2;
  string workcode3;
  string workcode4;
  string workcode5;
  string workcode6;
  string workcode7;
  string workcode8;
  string exporter;
  string exportbusinessactivities;
  string exportto;
  string exportbusinessrelationships;
  string exportobjectives;
  string reference1;
  string reference2;
  string reference3;
  unsigned6 bdid;
  unsigned6 did;
  unsigned6 unique_id;
  string10 prim_range;
  string2 predir;
  string28 prim_name;
  string4 addr_suffix;
  string2 postdir;
  string10 unit_desig;
  string8 sec_range;
  string25 p_city_name;
  string25 v_city_name;
  string2 st;
  string5 zip;
  string4 zip4;
  string4 cart;
  string1 cr_sort_sz;
  string4 lot;
  string1 lot_order;
  string2 dbpc;
  string1 chk_digit;
  string2 rec_type;
  string2 fips_state;
  string3 fips_county;
  string10 geo_lat;
  string11 geo_long;
  string4 msa;
  string7 geo_blk;
  string1 geo_match;
  string4 err_stat;
  unsigned8 __internal_fpos__;
 END;

rKeyDiversityCert__autokey__namewords2 := RECORD
  string40 word;
  string2 state;
  unsigned1 seq;
  unsigned6 bdid;
  unsigned4 lookups;
 END;
 
rKeyDiversityCert__autokey__phone2 := RECORD
  string7 p7;
  string3 p3;
  string6 dph_lname;
  string20 pfname;
  string2 st;
  unsigned6 did;
  unsigned4 lookups;
 END;
rKeyDiversityCert__autokey__phoneb2 := RECORD
  string7 p7;
  string3 p3;
  string40 cname_indic;
  string40 cname_sec;
  string2 st;
  unsigned6 bdid;
  unsigned4 lookups;
 END;


rKeyDiversityCert__bdid	:=RECORD
,maxLength(9999)
  unsigned6 bdid;
  unsigned6 did;
  string8 dt_first_seen;
  string8 dt_last_seen;
  string8 dt_vendor_first_reported;
  string8 dt_vendor_last_reported;
  string dartid;
  string dateadded;
  string dateupdated;
  string website;
  string state;
  string profilelastupdated;
  string county;
  string servicearea;
  string region1;
  string region2;
  string region3;
  string region4;
  string region5;
  string fname;
  string lname;
  string mname;
  string suffix;
  string title;
  string ethnicity;
  string gender;
  string address1;
  string address2;
  string addresscity;
  string addressstate;
  string addresszipcode;
  string addresszip4;
  string building;
  string contact;
  string phone1;
  string phone2;
  string phone3;
  string cell;
  string fax;
  string email1;
  string email2;
  string email3;
  string webpage1;
  string webpage2;
  string webpage3;
  string businessname;
  string dba;
  string businessid;
  string businesstype1;
  string businesslocation1;
  string businesstype2;
  string businesslocation2;
  string businesstype3;
  string businesslocation3;
  string businesstype4;
  string businesslocation4;
  string businesstype5;
  string businesslocation5;
  string industry;
  string trade;
  string resourcedescription;
  string natureofbusiness;
  string businessdescription;
  string businessstructure;
  string totalemployees;
  string avgcontractsize;
  string firmid;
  string firmlocationaddress;
  string firmlocationaddresscity;
  string firmlocationaddresszip4;
  string firmlocationaddresszipcode;
  string firmlocationcounty;
  string firmlocationstate;
  string certfed;
  string certstate;
  string contractsfederal;
  string contractsva;
  string contractscommercial;
  string contractorgovernmentprime;
  string contractorgovernmentsub;
  string contractornongovernment;
  string registeredgovernmentbus;
  string registerednongovernmentbus;
  string clearancelevelpersonnel;
  string clearancelevelfacility;
  string certificatedatefrom1;
  string certificatedateto1;
  string certificatestatus1;
  string certificationnumber1;
  string certificationtype1;
  string certificatedatefrom2;
  string certificatedateto2;
  string certificatestatus2;
  string certificationnumber2;
  string certificationtype2;
  string certificatedatefrom3;
  string certificatedateto3;
  string certificatestatus3;
  string certificationnumber3;
  string certificationtype3;
  string certificatedatefrom4;
  string certificatedateto4;
  string certificatestatus4;
  string certificationnumber4;
  string certificationtype4;
  string certificatedatefrom5;
  string certificatedateto5;
  string certificatestatus5;
  string certificationnumber5;
  string certificationtype5;
  string certificatedatefrom6;
  string certificatedateto6;
  string certificatestatus6;
  string certificationnumber6;
  string certificationtype6;
  string starrating;
  string assets;
  string biddescription;
  string competitiveadvantage;
  string cagecode;
  string capabilitiesnarrative;
  string category;
  string chtrclass;
  string productdescription1;
  string productdescription2;
  string productdescription3;
  string productdescription4;
  string productdescription5;
  string classdescription1;
  string subclassdescription1;
  string classdescription2;
  string subclassdescription2;
  string classdescription3;
  string subclassdescription3;
  string classdescription4;
  string subclassdescription4;
  string classdescription5;
  string subclassdescription5;
  string classifications;
  string commodity1;
  string commodity2;
  string commodity3;
  string commodity4;
  string commodity5;
  string commodity6;
  string commodity7;
  string commodity8;
  string completedate;
  string crossreference;
  string dateestablished;
  string businessage;
  string deposits;
  string dunsnumber;
  string enttype;
  string expirationdate;
  string extendeddate;
  string issuingauthority;
  string keywords;
  string licensenumber;
  string licensetype;
  string mincd;
  string minorityaffiliation;
  string minorityownershipdate;
  string siccode1;
  string siccode2;
  string siccode3;
  string siccode4;
  string siccode5;
  string siccode6;
  string siccode7;
  string siccode8;
  string naicscode1;
  string naicscode2;
  string naicscode3;
  string naicscode4;
  string naicscode5;
  string naicscode6;
  string naicscode7;
  string naicscode8;
  string prequalify;
  string procurementcategory1;
  string subprocurementcategory1;
  string procurementcategory2;
  string subprocurementcategory2;
  string procurementcategory3;
  string subprocurementcategory3;
  string procurementcategory4;
  string subprocurementcategory4;
  string procurementcategory5;
  string subprocurementcategory5;
  string renewal;
  string renewaldate;
  string unitedcertprogrampartner;
  string vendorkey;
  string vendornumber;
  string workcode1;
  string workcode2;
  string workcode3;
  string workcode4;
  string workcode5;
  string workcode6;
  string workcode7;
  string workcode8;
  string exporter;
  string exportbusinessactivities;
  string exportto;
  string exportbusinessrelationships;
  string exportobjectives;
  string reference1;
  string reference2;
  string reference3;
  unsigned6 unique_id;
  string100 append_prep_mailaddress1;
  string50 append_prep_mailaddresslast;
  unsigned8 append_mailrawaid;
  string100 append_prep_phyaddress1;
  string50 append_prep_phyaddresslast;
  unsigned8 append_phyrawaid;
  string phone;
  string email;
  string8 expiration_date;
  string120 siccode1_desc;
  string120 siccode2_desc;
  string120 siccode3_desc;
  string120 siccode4_desc;
  string120 siccode5_desc;
  string120 siccode6_desc;
  string120 siccode7_desc;
  string120 siccode8_desc;
  string120 naicscode1_desc;
  string120 naicscode2_desc;
  string120 naicscode3_desc;
  string120 naicscode4_desc;
  string120 naicscode5_desc;
  string120 naicscode6_desc;
  string120 naicscode7_desc;
  string120 naicscode8_desc;
  string10 m_prim_range;
  string2 m_predir;
  string28 m_prim_name;
  string4 m_addr_suffix;
  string2 m_postdir;
  string10 m_unit_desig;
  string8 m_sec_range;
  string25 m_p_city_name;
  string25 m_v_city_name;
  string2 m_st;
  string5 m_zip;
  string4 m_zip4;
  string4 m_cart;
  string1 m_cr_sort_sz;
  string4 m_lot;
  string1 m_lot_order;
  string2 m_dbpc;
  string1 m_chk_digit;
  string2 m_rec_type;
  string2 m_fips_state;
  string3 m_fips_county;
  string10 m_geo_lat;
  string11 m_geo_long;
  string4 m_msa;
  string7 m_geo_blk;
  string1 m_geo_match;
  string4 m_err_stat;
  string10 p_prim_range;
  string2 p_predir;
  string28 p_prim_name;
  string4 p_addr_suffix;
  string2 p_postdir;
  string10 p_unit_desig;
  string8 p_sec_range;
  string25 p_p_city_name;
  string25 p_v_city_name;
  string2 p_st;
  string5 p_zip;
  string4 p_zip4;
  string4 p_cart;
  string1 p_cr_sort_sz;
  string4 p_lot;
  string1 p_lot_order;
  string2 p_dbpc;
  string1 p_chk_digit;
  string2 p_rec_type;
  string2 p_fips_state;
  string3 p_fips_county;
  string10 p_geo_lat;
  string11 p_geo_long;
  string4 p_msa;
  string7 p_geo_blk;
  string1 p_geo_match;
  string4 p_err_stat;
  unsigned8 __internal_fpos__;
 END;
 rKeyDiversityCert__uniqueid:=RECORD
,maxLength(9999)
  unsigned6 unique_id;
  unsigned6 bdid;
  unsigned6 did;
  string8 dt_first_seen;
  string8 dt_last_seen;
  string8 dt_vendor_first_reported;
  string8 dt_vendor_last_reported;
  string dartid;
  string dateadded;
  string dateupdated;
  string website;
  string state;
  string profilelastupdated;
  string county;
  string servicearea;
  string region1;
  string region2;
  string region3;
  string region4;
  string region5;
  string fname;
  string lname;
  string mname;
  string suffix;
  string title;
  string ethnicity;
  string gender;
  string address1;
  string address2;
  string addresscity;
  string addressstate;
  string addresszipcode;
  string addresszip4;
  string building;
  string contact;
  string phone1;
  string phone2;
  string phone3;
  string cell;
  string fax;
  string email1;
  string email2;
  string email3;
  string webpage1;
  string webpage2;
  string webpage3;
  string businessname;
  string dba;
  string businessid;
  string businesstype1;
  string businesslocation1;
  string businesstype2;
  string businesslocation2;
  string businesstype3;
  string businesslocation3;
  string businesstype4;
  string businesslocation4;
  string businesstype5;
  string businesslocation5;
  string industry;
  string trade;
  string resourcedescription;
  string natureofbusiness;
  string businessdescription;
  string businessstructure;
  string totalemployees;
  string avgcontractsize;
  string firmid;
  string firmlocationaddress;
  string firmlocationaddresscity;
  string firmlocationaddresszip4;
  string firmlocationaddresszipcode;
  string firmlocationcounty;
  string firmlocationstate;
  string certfed;
  string certstate;
  string contractsfederal;
  string contractsva;
  string contractscommercial;
  string contractorgovernmentprime;
  string contractorgovernmentsub;
  string contractornongovernment;
  string registeredgovernmentbus;
  string registerednongovernmentbus;
  string clearancelevelpersonnel;
  string clearancelevelfacility;
  string certificatedatefrom1;
  string certificatedateto1;
  string certificatestatus1;
  string certificationnumber1;
  string certificationtype1;
  string certificatedatefrom2;
  string certificatedateto2;
  string certificatestatus2;
  string certificationnumber2;
  string certificationtype2;
  string certificatedatefrom3;
  string certificatedateto3;
  string certificatestatus3;
  string certificationnumber3;
  string certificationtype3;
  string certificatedatefrom4;
  string certificatedateto4;
  string certificatestatus4;
  string certificationnumber4;
  string certificationtype4;
  string certificatedatefrom5;
  string certificatedateto5;
  string certificatestatus5;
  string certificationnumber5;
  string certificationtype5;
  string certificatedatefrom6;
  string certificatedateto6;
  string certificatestatus6;
  string certificationnumber6;
  string certificationtype6;
  string starrating;
  string assets;
  string biddescription;
  string competitiveadvantage;
  string cagecode;
  string capabilitiesnarrative;
  string category;
  string chtrclass;
  string productdescription1;
  string productdescription2;
  string productdescription3;
  string productdescription4;
  string productdescription5;
  string classdescription1;
  string subclassdescription1;
  string classdescription2;
  string subclassdescription2;
  string classdescription3;
  string subclassdescription3;
  string classdescription4;
  string subclassdescription4;
  string classdescription5;
  string subclassdescription5;
  string classifications;
  string commodity1;
  string commodity2;
  string commodity3;
  string commodity4;
  string commodity5;
  string commodity6;
  string commodity7;
  string commodity8;
  string completedate;
  string crossreference;
  string dateestablished;
  string businessage;
  string deposits;
  string dunsnumber;
  string enttype;
  string expirationdate;
  string extendeddate;
  string issuingauthority;
  string keywords;
  string licensenumber;
  string licensetype;
  string mincd;
  string minorityaffiliation;
  string minorityownershipdate;
  string siccode1;
  string siccode2;
  string siccode3;
  string siccode4;
  string siccode5;
  string siccode6;
  string siccode7;
  string siccode8;
  string naicscode1;
  string naicscode2;
  string naicscode3;
  string naicscode4;
  string naicscode5;
  string naicscode6;
  string naicscode7;
  string naicscode8;
  string prequalify;
  string procurementcategory1;
  string subprocurementcategory1;
  string procurementcategory2;
  string subprocurementcategory2;
  string procurementcategory3;
  string subprocurementcategory3;
  string procurementcategory4;
  string subprocurementcategory4;
  string procurementcategory5;
  string subprocurementcategory5;
  string renewal;
  string renewaldate;
  string unitedcertprogrampartner;
  string vendorkey;
  string vendornumber;
  string workcode1;
  string workcode2;
  string workcode3;
  string workcode4;
  string workcode5;
  string workcode6;
  string workcode7;
  string workcode8;
  string exporter;
  string exportbusinessactivities;
  string exportto;
  string exportbusinessrelationships;
  string exportobjectives;
  string reference1;
  string reference2;
  string reference3;
  string100 append_prep_mailaddress1;
  string50 append_prep_mailaddresslast;
  unsigned8 append_mailrawaid;
  string100 append_prep_phyaddress1;
  string50 append_prep_phyaddresslast;
  unsigned8 append_phyrawaid;
  string phone;
  string email;
  string8 expiration_date;
  string120 siccode1_desc;
  string120 siccode2_desc;
  string120 siccode3_desc;
  string120 siccode4_desc;
  string120 siccode5_desc;
  string120 siccode6_desc;
  string120 siccode7_desc;
  string120 siccode8_desc;
  string120 naicscode1_desc;
  string120 naicscode2_desc;
  string120 naicscode3_desc;
  string120 naicscode4_desc;
  string120 naicscode5_desc;
  string120 naicscode6_desc;
  string120 naicscode7_desc;
  string120 naicscode8_desc;
  string10 m_prim_range;
  string2 m_predir;
  string28 m_prim_name;
  string4 m_addr_suffix;
  string2 m_postdir;
  string10 m_unit_desig;
  string8 m_sec_range;
  string25 m_p_city_name;
  string25 m_v_city_name;
  string2 m_st;
  string5 m_zip;
  string4 m_zip4;
  string4 m_cart;
  string1 m_cr_sort_sz;
  string4 m_lot;
  string1 m_lot_order;
  string2 m_dbpc;
  string1 m_chk_digit;
  string2 m_rec_type;
  string2 m_fips_state;
  string3 m_fips_county;
  string10 m_geo_lat;
  string11 m_geo_long;
  string4 m_msa;
  string7 m_geo_blk;
  string1 m_geo_match;
  string4 m_err_stat;
  string10 p_prim_range;
  string2 p_predir;
  string28 p_prim_name;
  string4 p_addr_suffix;
  string2 p_postdir;
  string10 p_unit_desig;
  string8 p_sec_range;
  string25 p_p_city_name;
  string25 p_v_city_name;
  string2 p_st;
  string5 p_zip;
  string4 p_zip4;
  string4 p_cart;
  string1 p_cr_sort_sz;
  string4 p_lot;
  string1 p_lot_order;
  string2 p_dbpc;
  string1 p_chk_digit;
  string2 p_rec_type;
  string2 p_fips_state;
  string3 p_fips_county;
  string10 p_geo_lat;
  string11 p_geo_long;
  string4 p_msa;
  string7 p_geo_blk;
  string1 p_geo_match;
  string4 p_err_stat;
  unsigned8 __internal_fpos__;
 END;

 rKeyDiversityCert__did:=RECORD,maxLength(9999)
  unsigned6 did;
  unsigned6 bdid;
  string8 dt_first_seen;
  string8 dt_last_seen;
  string8 dt_vendor_first_reported;
  string8 dt_vendor_last_reported;
  string dartid;
  string dateadded;
  string dateupdated;
  string website;
  string state;
  string profilelastupdated;
  string county;
  string servicearea;
  string region1;
  string region2;
  string region3;
  string region4;
  string region5;
  string fname;
  string lname;
  string mname;
  string suffix;
  string title;
  string ethnicity;
  string gender;
  string address1;
  string address2;
  string addresscity;
  string addressstate;
  string addresszipcode;
  string addresszip4;
  string building;
  string contact;
  string phone1;
  string phone2;
  string phone3;
  string cell;
  string fax;
  string email1;
  string email2;
  string email3;
  string webpage1;
  string webpage2;
  string webpage3;
  string businessname;
  string dba;
  string businessid;
  string businesstype1;
  string businesslocation1;
  string businesstype2;
  string businesslocation2;
  string businesstype3;
  string businesslocation3;
  string businesstype4;
  string businesslocation4;
  string businesstype5;
  string businesslocation5;
  string industry;
  string trade;
  string resourcedescription;
  string natureofbusiness;
  string businessdescription;
  string businessstructure;
  string totalemployees;
  string avgcontractsize;
  string firmid;
  string firmlocationaddress;
  string firmlocationaddresscity;
  string firmlocationaddresszip4;
  string firmlocationaddresszipcode;
  string firmlocationcounty;
  string firmlocationstate;
  string certfed;
  string certstate;
  string contractsfederal;
  string contractsva;
  string contractscommercial;
  string contractorgovernmentprime;
  string contractorgovernmentsub;
  string contractornongovernment;
  string registeredgovernmentbus;
  string registerednongovernmentbus;
  string clearancelevelpersonnel;
  string clearancelevelfacility;
  string certificatedatefrom1;
  string certificatedateto1;
  string certificatestatus1;
  string certificationnumber1;
  string certificationtype1;
  string certificatedatefrom2;
  string certificatedateto2;
  string certificatestatus2;
  string certificationnumber2;
  string certificationtype2;
  string certificatedatefrom3;
  string certificatedateto3;
  string certificatestatus3;
  string certificationnumber3;
  string certificationtype3;
  string certificatedatefrom4;
  string certificatedateto4;
  string certificatestatus4;
  string certificationnumber4;
  string certificationtype4;
  string certificatedatefrom5;
  string certificatedateto5;
  string certificatestatus5;
  string certificationnumber5;
  string certificationtype5;
  string certificatedatefrom6;
  string certificatedateto6;
  string certificatestatus6;
  string certificationnumber6;
  string certificationtype6;
  string starrating;
  string assets;
  string biddescription;
  string competitiveadvantage;
  string cagecode;
  string capabilitiesnarrative;
  string category;
  string chtrclass;
  string productdescription1;
  string productdescription2;
  string productdescription3;
  string productdescription4;
  string productdescription5;
  string classdescription1;
  string subclassdescription1;
  string classdescription2;
  string subclassdescription2;
  string classdescription3;
  string subclassdescription3;
  string classdescription4;
  string subclassdescription4;
  string classdescription5;
  string subclassdescription5;
  string classifications;
  string commodity1;
  string commodity2;
  string commodity3;
  string commodity4;
  string commodity5;
  string commodity6;
  string commodity7;
  string commodity8;
  string completedate;
  string crossreference;
  string dateestablished;
  string businessage;
  string deposits;
  string dunsnumber;
  string enttype;
  string expirationdate;
  string extendeddate;
  string issuingauthority;
  string keywords;
  string licensenumber;
  string licensetype;
  string mincd;
  string minorityaffiliation;
  string minorityownershipdate;
  string siccode1;
  string siccode2;
  string siccode3;
  string siccode4;
  string siccode5;
  string siccode6;
  string siccode7;
  string siccode8;
  string naicscode1;
  string naicscode2;
  string naicscode3;
  string naicscode4;
  string naicscode5;
  string naicscode6;
  string naicscode7;
  string naicscode8;
  string prequalify;
  string procurementcategory1;
  string subprocurementcategory1;
  string procurementcategory2;
  string subprocurementcategory2;
  string procurementcategory3;
  string subprocurementcategory3;
  string procurementcategory4;
  string subprocurementcategory4;
  string procurementcategory5;
  string subprocurementcategory5;
  string renewal;
  string renewaldate;
  string unitedcertprogrampartner;
  string vendorkey;
  string vendornumber;
  string workcode1;
  string workcode2;
  string workcode3;
  string workcode4;
  string workcode5;
  string workcode6;
  string workcode7;
  string workcode8;
  string exporter;
  string exportbusinessactivities;
  string exportto;
  string exportbusinessrelationships;
  string exportobjectives;
  string reference1;
  string reference2;
  string reference3;
  unsigned6 unique_id;
  string100 append_prep_mailaddress1;
  string50 append_prep_mailaddresslast;
  unsigned8 append_mailrawaid;
  string100 append_prep_phyaddress1;
  string50 append_prep_phyaddresslast;
  unsigned8 append_phyrawaid;
  string phone;
  string email;
  string8 expiration_date;
  string120 siccode1_desc;
  string120 siccode2_desc;
  string120 siccode3_desc;
  string120 siccode4_desc;
  string120 siccode5_desc;
  string120 siccode6_desc;
  string120 siccode7_desc;
  string120 siccode8_desc;
  string120 naicscode1_desc;
  string120 naicscode2_desc;
  string120 naicscode3_desc;
  string120 naicscode4_desc;
  string120 naicscode5_desc;
  string120 naicscode6_desc;
  string120 naicscode7_desc;
  string120 naicscode8_desc;
  string10 m_prim_range;
  string2 m_predir;
  string28 m_prim_name;
  string4 m_addr_suffix;
  string2 m_postdir;
  string10 m_unit_desig;
  string8 m_sec_range;
  string25 m_p_city_name;
  string25 m_v_city_name;
  string2 m_st;
  string5 m_zip;
  string4 m_zip4;
  string4 m_cart;
  string1 m_cr_sort_sz;
  string4 m_lot;
  string1 m_lot_order;
  string2 m_dbpc;
  string1 m_chk_digit;
  string2 m_rec_type;
  string2 m_fips_state;
  string3 m_fips_county;
  string10 m_geo_lat;
  string11 m_geo_long;
  string4 m_msa;
  string7 m_geo_blk;
  string1 m_geo_match;
  string4 m_err_stat;
  string10 p_prim_range;
  string2 p_predir;
  string28 p_prim_name;
  string4 p_addr_suffix;
  string2 p_postdir;
  string10 p_unit_desig;
  string8 p_sec_range;
  string25 p_p_city_name;
  string25 p_v_city_name;
  string2 p_st;
  string5 p_zip;
  string4 p_zip4;
  string4 p_cart;
  string1 p_cr_sort_sz;
  string4 p_lot;
  string1 p_lot_order;
  string2 p_dbpc;
  string1 p_chk_digit;
  string2 p_rec_type;
  string2 p_fips_state;
  string3 p_fips_county;
  string10 p_geo_lat;
  string11 p_geo_long;
  string4 p_msa;
  string7 p_geo_blk;
  string1 p_geo_match;
  string4 p_err_stat;
  unsigned8 __internal_fpos__;
 END;
 
 rKeyDiversityCert__linkIDs:=RECORD
  unsigned6 ultid;
  unsigned6 orgid;
  unsigned6 seleid;
  unsigned6 proxid;
  unsigned6 powid;
  unsigned6 empid;
  unsigned6 dotid;
  unsigned2 ultscore;
  unsigned2 orgscore;
  unsigned2 selescore;
  unsigned2 proxscore;
  unsigned2 powscore;
  unsigned2 empscore;
  unsigned2 dotscore;
  unsigned2 ultweight;
  unsigned2 orgweight;
  unsigned2 seleweight;
  unsigned2 proxweight;
  unsigned2 powweight;
  unsigned2 empweight;
  unsigned2 dotweight;
  unsigned6 bdid;
  unsigned6 did;
  string8 dt_first_seen;
  string8 dt_last_seen;
  string8 dt_vendor_first_reported;
  string8 dt_vendor_last_reported;
  string dartid;
  string dateadded;
  string dateupdated;
  string website;
  string state;
  string profilelastupdated;
  string county;
  string servicearea;
  string region1;
  string region2;
  string region3;
  string region4;
  string region5;
  string fname;
  string lname;
  string mname;
  string suffix;
  string title;
  string ethnicity;
  string gender;
  string address1;
  string address2;
  string addresscity;
  string addressstate;
  string addresszipcode;
  string addresszip4;
  string building;
  string contact;
  string phone1;
  string phone2;
  string phone3;
  string cell;
  string fax;
  string email1;
  string email2;
  string email3;
  string webpage1;
  string webpage2;
  string webpage3;
  string businessname;
  string dba;
  string businessid;
  string businesstype1;
  string businesslocation1;
  string businesstype2;
  string businesslocation2;
  string businesstype3;
  string businesslocation3;
  string businesstype4;
  string businesslocation4;
  string businesstype5;
  string businesslocation5;
  string industry;
  string trade;
  string resourcedescription;
  string natureofbusiness;
  string businessdescription;
  string businessstructure;
  string totalemployees;
  string avgcontractsize;
  string firmid;
  string firmlocationaddress;
  string firmlocationaddresscity;
  string firmlocationaddresszip4;
  string firmlocationaddresszipcode;
  string firmlocationcounty;
  string firmlocationstate;
  string certfed;
  string certstate;
  string contractsfederal;
  string contractsva;
  string contractscommercial;
  string contractorgovernmentprime;
  string contractorgovernmentsub;
  string contractornongovernment;
  string registeredgovernmentbus;
  string registerednongovernmentbus;
  string clearancelevelpersonnel;
  string clearancelevelfacility;
  string certificatedatefrom1;
  string certificatedateto1;
  string certificatestatus1;
  string certificationnumber1;
  string certificationtype1;
  string certificatedatefrom2;
  string certificatedateto2;
  string certificatestatus2;
  string certificationnumber2;
  string certificationtype2;
  string certificatedatefrom3;
  string certificatedateto3;
  string certificatestatus3;
  string certificationnumber3;
  string certificationtype3;
  string certificatedatefrom4;
  string certificatedateto4;
  string certificatestatus4;
  string certificationnumber4;
  string certificationtype4;
  string certificatedatefrom5;
  string certificatedateto5;
  string certificatestatus5;
  string certificationnumber5;
  string certificationtype5;
  string certificatedatefrom6;
  string certificatedateto6;
  string certificatestatus6;
  string certificationnumber6;
  string certificationtype6;
  string starrating;
  string assets;
  string biddescription;
  string competitiveadvantage;
  string cagecode;
  string capabilitiesnarrative;
  string category;
  string chtrclass;
  string productdescription1;
  string productdescription2;
  string productdescription3;
  string productdescription4;
  string productdescription5;
  string classdescription1;
  string subclassdescription1;
  string classdescription2;
  string subclassdescription2;
  string classdescription3;
  string subclassdescription3;
  string classdescription4;
  string subclassdescription4;
  string classdescription5;
  string subclassdescription5;
  string classifications;
  string commodity1;
  string commodity2;
  string commodity3;
  string commodity4;
  string commodity5;
  string commodity6;
  string commodity7;
  string commodity8;
  string completedate;
  string crossreference;
  string dateestablished;
  string businessage;
  string deposits;
  string dunsnumber;
  string enttype;
  string expirationdate;
  string extendeddate;
  string issuingauthority;
  string keywords;
  string licensenumber;
  string licensetype;
  string mincd;
  string minorityaffiliation;
  string minorityownershipdate;
  string siccode1;
  string siccode2;
  string siccode3;
  string siccode4;
  string siccode5;
  string siccode6;
  string siccode7;
  string siccode8;
  string naicscode1;
  string naicscode2;
  string naicscode3;
  string naicscode4;
  string naicscode5;
  string naicscode6;
  string naicscode7;
  string naicscode8;
  string prequalify;
  string procurementcategory1;
  string subprocurementcategory1;
  string procurementcategory2;
  string subprocurementcategory2;
  string procurementcategory3;
  string subprocurementcategory3;
  string procurementcategory4;
  string subprocurementcategory4;
  string procurementcategory5;
  string subprocurementcategory5;
  string renewal;
  string renewaldate;
  string unitedcertprogrampartner;
  string vendorkey;
  string vendornumber;
  string workcode1;
  string workcode2;
  string workcode3;
  string workcode4;
  string workcode5;
  string workcode6;
  string workcode7;
  string workcode8;
  string exporter;
  string exportbusinessactivities;
  string exportto;
  string exportbusinessrelationships;
  string exportobjectives;
  string reference1;
  string reference2;
  string reference3;
  unsigned6 unique_id;
  string100 append_prep_mailaddress1;
  string50 append_prep_mailaddresslast;
  unsigned8 append_mailrawaid;
  string100 append_prep_phyaddress1;
  string50 append_prep_phyaddresslast;
  unsigned8 append_phyrawaid;
  string phone;
  string email;
  string8 expiration_date;
  string120 siccode1_desc;
  string120 siccode2_desc;
  string120 siccode3_desc;
  string120 siccode4_desc;
  string120 siccode5_desc;
  string120 siccode6_desc;
  string120 siccode7_desc;
  string120 siccode8_desc;
  string120 naicscode1_desc;
  string120 naicscode2_desc;
  string120 naicscode3_desc;
  string120 naicscode4_desc;
  string120 naicscode5_desc;
  string120 naicscode6_desc;
  string120 naicscode7_desc;
  string120 naicscode8_desc;
  string10 m_prim_range;
  string2 m_predir;
  string28 m_prim_name;
  string4 m_addr_suffix;
  string2 m_postdir;
  string10 m_unit_desig;
  string8 m_sec_range;
  string25 m_p_city_name;
  string25 m_v_city_name;
  string2 m_st;
  string5 m_zip;
  string4 m_zip4;
  string4 m_cart;
  string1 m_cr_sort_sz;
  string4 m_lot;
  string1 m_lot_order;
  string2 m_dbpc;
  string1 m_chk_digit;
  string2 m_rec_type;
  string2 m_fips_state;
  string3 m_fips_county;
  string10 m_geo_lat;
  string11 m_geo_long;
  string4 m_msa;
  string7 m_geo_blk;
  string1 m_geo_match;
  string4 m_err_stat;
  string10 p_prim_range;
  string2 p_predir;
  string28 p_prim_name;
  string4 p_addr_suffix;
  string2 p_postdir;
  string10 p_unit_desig;
  string8 p_sec_range;
  string25 p_p_city_name;
  string25 p_v_city_name;
  string2 p_st;
  string5 p_zip;
  string4 p_zip4;
  string4 p_cart;
  string1 p_cr_sort_sz;
  string4 p_lot;
  string1 p_lot_order;
  string2 p_dbpc;
  string1 p_chk_digit;
  string2 p_rec_type;
  string2 p_fips_state;
  string3 p_fips_county;
  string10 p_geo_lat;
  string11 p_geo_long;
  string4 p_msa;
  string7 p_geo_blk;
  string1 p_geo_match;
  string4 p_err_stat;
  integer1 fp;
 END;

 
								ds_address 				:=dataset([],rKeyDiversityCert__autokey__address);
								ds_addressb2			:=dataset([],rKeyDiversityCert__autokey__addressb2);
                ds_citystname			:=dataset([],rKeyDiversityCert__autokey__citystname);
                ds_citystnameb2		:=dataset([],rKeyDiversityCert__autokey__citystnameb2);
                ds_name						:=dataset([],rKeyDiversityCert__autokey__name);
                ds_nameb2					:=dataset([],rKeyDiversityCert__autokey__nameb2);
								ds_stname					:=dataset([],rKeyDiversityCert__autokey__stname); 
                ds_stnameb2				:=dataset([],rKeyDiversityCert__autokey__stnameb2);
                ds_zip1						:=dataset([],rKeyDiversityCert__autokey__zip); 
                ds_zipb2					:=dataset([],rKeyDiversityCert__autokey__zipb2);
                ds_payload				:=dataset([],rKeyDiversityCert__autokey__payload);
                ds_namewords2			:=dataset([],rKeyDiversityCert__autokey__namewords2);	
								ds_phone2					:=dataset([],rKeyDiversityCert__autokey__phone2);
								ds_phoneb2				:=dataset([],rKeyDiversityCert__autokey__phoneb2);
								ds_bdid						:=dataset([], rKeyDiversityCert__bdid);
								ds_uniqueid1			:=dataset([], rKeyDiversityCert__uniqueid);
								ds_did						:=dataset([], rKeyDiversityCert__did);
								ds_linkIDs				:=dataset([], rKeyDiversityCert__linkIDs);
								
								address_IN				:=index(ds_address, {prim_name,prim_range,st,city_code,zip,sec_range,dph_lname,lname,pfname,fname,states,lname1,lname2,lname3,lookups}, {ds_address}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::address');
								addressb2_IN			:=index(ds_addressb2, {prim_name,prim_range,st,city_code,zip,sec_range,cname_indic,cname_sec,bdid}, {ds_addressb2}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::addressb2');
								citystname_IN			:=index(ds_citystname, {city_code,st,dph_lname,lname,pfname,fname,dob,states,lname1,lname2,lname3,city1,city2,city3,rel_fname1,rel_fname2,rel_fname3,lookups}, {ds_citystname}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::citystname');
								citystnameb2_IN		:=index(ds_citystnameb2, {city_code,st,cname_indic,cname_sec,bdid}, {ds_citystnameb2}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::citystnameb2');
								name_IN						:=index(ds_name, {dph_lname,lname,pfname,fname,minit,yob,s4,dob,states,lname1,lname2,lname3,city1,city2,city3,rel_fname1,rel_fname2,rel_fname3,lookups}, {ds_name}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::name');
								nameb2_IN					:=index(ds_nameb2, {cname_indic,cname_sec,bdid}, {ds_nameb2}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::nameb2');
								namewords2_IN			:=index(ds_namewords2, {word,state,seq,bdid}, {ds_namewords2}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::namewords2');
								payload_IN				:=index(ds_payload, {fakeid}, {ds_payload}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::payload');
								phone2_IN					:=index(ds_phone2, {p7,p3,dph_lname,pfname,st,did}, {ds_phone2}, '~prte::key::Diversity_Certification::' + pIndexVersion + '::autokey::phone2');
								phoneb2_IN				:=index(ds_phoneb2, {p7,p3,cname_indic,cname_sec,st,bdid}, {ds_phoneb2}, '~prte::key::Diversity_Certification::' + pIndexVersion + '::autokey::phoneb2');
								stname_IN					:=index(ds_stname, {st,dph_lname,lname,pfname,fname,minit,yob,s4,zip,dob,states,lname1,lname2,lname3,city1,city2,city3,rel_fname1,rel_fname2,rel_fname3,lookups}, {ds_stname}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::stname');
								stnameb2_IN				:=index(ds_stnameb2, {st,cname_indic,cname_sec,bdid}, {ds_stnameb2}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::stnameb2');
								zip_IN						:=index(ds_zip1, {zip,dph_lname,lname,pfname,fname,minit,yob,s4,dob,states,lname1,lname2,lname3,city1,city2,city3,rel_fname1,rel_fname2,rel_fname3,lookups}, {ds_zip1}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::zip');
								zipb2_IN					:=index(ds_zipb2, {zip,cname_indic,cname_sec,bdid}, {ds_zipb2}, '~prte::key::Diversity_Certification::'+pIndexVersion+'::autokey::zipb2');
								bdid_IN						:=index(ds_bdid, {bdid}, {ds_bdid}, '~prte::key::Diversity_Certification::' + pIndexVersion + '::bdid');
								did_IN					  :=index(ds_did, {did}, {ds_did}, '~prte::key::Diversity_Certification::' + pIndexVersion + '::did');
								uniqueid_IN				:=index(ds_uniqueid1, {unique_id}, {ds_uniqueid1}, '~prte::key::Diversity_Certification::' + pIndexVersion + '::uniqueid');
								linkIDs_IN				:=index(ds_linkids, {ultid,orgid,seleid,proxid,powid,empid,dotid}, {ds_linkids}, '~prte::key::diversity_certification::'+pIndexVersion+'::linkids');																 

			
															 
return	sequential(
													parallel(		
																build(address_IN			, update),																
																build(addressb2_IN	, update),																
																build(citystname_IN			, update),																
																build(citystnameb2_IN			, update),	
																build(name_IN			, update),																
																build(nameb2_IN	, update),															
																build(stname_IN			, update),	
																build(stnameb2_IN			, update),																
																build(zip_IN	, update),																
																build(zipb2_IN				, update),																
																build(payload_IN			, update),
																build(namewords2_IN, update),
																build(phone2_IN	, update),
																build(phoneb2_IN	, update),
																build(bdid_IN, update),
																build(did_IN, update),
																build(uniqueid_IN, update),
																build(linkIDs_IN, update)
															 ),
								
								PRTE.UpdateVersion('DiversityCertKeys',										//	Package name
																    pIndexVersion,											 //	  Package version
																   _control.MyInfo.EmailAddressNormal,	//	  Who to email with specifics
																	 'B',														     //	B = Boca, A = Alpharetta
																	 'N',								                //	N = Non-FCRA, F = FCRA
																	 'N'								               // 	N = Do not also include boolean, Y = Include boolean, too
																		)
										 );

end;
