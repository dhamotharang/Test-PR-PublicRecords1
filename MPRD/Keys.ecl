import doxie, tools, MPRD;

export Keys(string pversion	= '', boolean pUseProd = false) := module
	
	export facility_in					    						:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_facility;
	export facility_base												:= MPRD.Files(pversion,pUseProd).facility_base.built;
	export fac_joined_grp_key  									:= MPRD.special_keys(pversion,pUseProd).facility_joined_key;
	export fac_in_gk														:= facility_in(group_key <> '');
	export fac_in_sugk													:= facility_in(surrogate_key <>'');
	export fac_in_joinedgk			  							:= fac_joined_grp_key(group_key <> '');
	export fac_joined_filecode_key  						:= fac_joined_grp_key(group_affiliation<>'' or hosp_affiliation<>'');
	export fac_base_lnpid												:= facility_base(lnpid > 0);
	export individual_in					  						:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_individual;
	export individual_base											:= MPRD.Files(pversion,pUseProd).individual_base.built;
	export ind_joined_grp_key       						:= MPRD.special_keys(pversion,pUseProd).individual_joined_key;
	export ind_in_gk														:= individual_in(group_key <> '');
	export ind_in_sugk													:= individual_in(surrogate_key <> '');
	export ind_in_joinedgk			  							:= ind_joined_grp_key(group_key <> '');
	export ind_base_lnpid												:= individual_base(lnpid > 0);
	export basc_cp_in					      						:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_choice_point;
	export basc_cp_base													:= MPRD.Files(pversion,pUseProd).basc_cp_base.built;
	export basc_cp_in_gk												:= basc_cp_in(group_key <> '');
	export basc_cp_in_sugk											:= basc_cp_in(surrogate_key <>'');
	export basc_cp_base_lnpid										:= basc_cp_base(lnpid > 0);
	export basc_claims_in					  						:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_basc_claims;
	export basc_claims_base											:= MPRD.Files(pversion,pUseProd).basc_claims_base.built;
	export basc_claims_in_gk										:= basc_claims_in(group_key <> '');
	export basc_claims_in_sugk									:= basc_claims_in(surrogate_key <>'');
	export basc_claims_base_lnpid								:= basc_claims_base(lnpid > 0);
	export npi_extension_in				  						:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_npi_extension;
	export npi_extension_base										:= MPRD.Files(pversion,pUseProd).npi_extension_base.built;
	export npi_extension_in_npinum							:= npi_extension_in(npi_num <> '');
	export npi_extension_base_lnpid							:= npi_extension_base(lnpid > 0);
	export npi_extension_facility_in					 	:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_npi_extension_facility;
	export npi_extension_facility_base					:= MPRD.Files(pversion,pUseProd).npi_extension_facility_base.built;
	export npi_extension_facility_in_npinum 		:= npi_extension_facility_in(npi_num <> '');
	export npi_extension_facility_base_lnpid		:= npi_extension_facility_base(lnpid > 0);
  export claims_addr_master_in				  			:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_claims_address_master;
	export claims_addr_master_base							:= MPRD.Files(pversion,pUseProd).claims_addr_master_base.built;
	export claims_addr_master_in_billtin				:= claims_addr_master_in(bill_tin <> '');
  export claims_addr_master_in_billnpi				:= claims_addr_master_in(bill_npi <> '');	
	export claims_addr_master_in_renderingnpi		:= claims_addr_master_in(rendering_npi <> '');	
	export claims_addr_master_in_addr_key				:= claims_addr_master_in(addr_key <> '');
	export claims_addr_master_base_lnpid				:= claims_addr_master_base(lnpid > 0);
	export claims_by_month_in				    				:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_claims_by_month;
  export claims_by_month_in_billtin						:= claims_by_month_in(bill_tin <> '');
	export claims_by_month_in_billnpi						:= claims_by_month_in(bill_npi <> '');
	export claims_by_month_in_renderingnpi			:= claims_by_month_in(rendering_npi <> '');
	export claims_by_month_in_addr_key					:= claims_by_month_in(addr_key <> '');
  export npi_tin_xref_in				  						:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_npi_tin_xref;
  export npi_tin_xref_in_billnpi							:= npi_tin_xref_in(bill_npi <> '');
	export taxonomy_equiv_in				  	  			:= MPRD.Files(pversion,pUseProd).taxonomy_equiv_file;
  export taxonomy_equiv_in_taxonomy						:= taxonomy_equiv_in(taxonomy <> '');
	export source_confidence_lu_in					  	:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_source_confidence_lu;
	export source_confidence_lu_in_fcode				:= source_confidence_lu_in(filecode<> '');
	export ignore_terms_in				  		        := MPRD.Files(pversion,pUseProd).ignore_terms_lu_file;
	export ignore_terms_in_code	        			  := ignore_terms_in(code<> '');
  export abbr_lu_in				           	      	:= MPRD.Files(pversion,pUseProd).abbr_lu_file;
	export abbr_lu_in_code	            	     	:= abbr_lu_in(code<> '');
  export taxon_lu_in				          				:= MPRD.Files(pversion,pUseProd).taxon_lu_file;
	export taxon_lu_in_code	         						:= taxon_lu_in(code<> '');
	export basc_deceased_in				    					:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_basc_deceased;
	export basc_deceased_base										:= MPRD.Files(pversion,pUseProd).basc_deceased_base.built;
	export basc_deceased_in_gk	        				:= basc_deceased_in(group_key <> '');
	export basc_deceased_base_lnpid							:= basc_deceased_base(lnpid > 0);
	export basc_addr_in				        					:= MPRD.Files(pversion,pUseProd).basc_addr_file;
	export basc_addr_base												:= MPRD.Files(pversion,pUseProd).basc_addr_base.built;						
	export basc_addr_in_sgk	          					:= basc_addr_in(surrogate_key <> '');
	export basc_addr_base_lnpid									:= basc_addr_base(lnpid > 0);
	export client_data_in				       		 			:= MPRD.Files(pversion,pUseProd).client_Data_file;
	export client_data_base											:= MPRD.Files(pversion,pUseProd).client_data_base.built;
	export client_data_in_sgk	          				:= client_data_in(surrogate_key <> '');
	export client_data_base_lnpid								:= client_data_base(lnpid > 0);
	export std_terms_lu_in				        	  	:= MPRD.Files(pversion,pUseProd).std_terms_lu_file;
	export std_terms_lu_in_code	        	  		:= std_terms_lu_in(code <> '');
	export taxonomy_full_lu_in				    			:= MPRD.Files(pversion,pUseProd).taxonomy_full_lu_file;
	export taxonomy_full_lu_in_taxonomy 				:= taxonomy_full_lu_in(taxonomy <> '');
	export specialty_lu_in				        			:= MPRD.Files(pversion,pUseProd).specialty_lu_file;
	export specialty_lu_in_specialty	  				:= specialty_lu_in(specialty <> '');
	export group_lu_in				        	    		:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_group_lu;
	export group_lu_in_code	            				:= group_lu_in(code <> '');
	export hospital_lu_in				     		   			:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_hospital_lu;
	export hospital_lu_in_code	        				:= hospital_lu_in(code <> '');
	export dea_xref_in				          	  		:= MPRD.Files(pversion,pUseProd).dea_xref_file;
	export dea_xref_in_gk	              				:= dea_xref_in(group_key <> '');
	export lic_xref_in				            			:= MPRD.Files(pversion,pUseProd).lic_xref_file;
	export lic_xref_in_gk	              				:= lic_xref_in(group_key <> '');
	export facility_name_xref_in				  	  	:= MPRD.Files(pversion,pUseProd).facility_name_xref_file;
	export facility_name_xref_in_taxonomy				:= facility_name_xref_in(taxonomy <> '');
	export addr_name_xref_in				        		:= MPRD.Files(pversion,pUseProd).addr_name_xref_file;
	export addr_name_xref_in_gk	          			:= addr_name_xref_in(group_key <> '');
	export basc_facility_mme_in				 		   		:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_basc_facility_mme;
	export basc_facility_mme_in_gk	      	  	:= basc_facility_mme_in(group_key <> '');
	export nanpa_in				                			:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_nanpa;
	export nanpa_in_npanum	              			:= nanpa_in(npa_num <> '');
	export best_hospital_in				        			:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_best_hospital;
	export best_hospital_in_addr	        			:= best_hospital_in(addr_key <>'0' and addr_key <>'' );
	export last_name_stats_in				    	  		:= MPRD.Files(pversion,pUseProd).last_name_stats_file;
	export last_name_stats_in_lname		    			:= last_name_stats_in(last_name<> '');
	export office_attributes_facility_in			  := MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_office_attributes_facility;
	export office_attributes_facility_in_sgk  	:= office_attributes_facility_in(surrogate_key <> '');
	export office_attributes_in									:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_office_attributes;
	export office_attributes_in_sgk	          	:= office_attributes_in(surrogate_key <> '');
	export call_queue_bad_in				  					:= MPRD.Files(pversion,pUseProd).call_queue_bad_file;
	export call_queue_bad_in_phone	          	:= call_queue_bad_in(prac_phone1 <> '');
  export lic_file_date_in				        	    := MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_lic_filedate;
  export lic_file_date_in_filecode	      	  := lic_file_date_in(filecode<> '');
	export group_practice_in										:= MPRD.Files(pversion,pUseProd).group_practice_file;
	export group_practice_base									:= MPRD.Files(pversion,pUseProd).group_practice_base.built;
	export group_practice_in_prac1_key					:= group_practice_in(prac1_key<>'');
	export group_practice_in_prac_phone1				:= group_practice_in(prac_phone1<>'');
	export group_practice_base_lnpid						:= group_practice_base(lnpid > 0);
	export business_activities_lu_in						:= MPRD.Files(pversion,pUseProd).business_activities_lu_file;
	export business_activities_lu_in_ind				:= business_activities_lu_in(dea_bus_act_ind<>'');
	export cms_ecp_in														:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_cms_ecp;
	export cms_ecp_base													:= MPRD.Files(pversion,pUseProd).cms_ecp_base.built;
	export cms_ecp_in_seq												:= cms_ecp_in(seq_num >0);
	export cms_ecp_base_lnpid										:= cms_ecp_base(lnpid > 0);
	export opi_in																:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_opi;
	export opi_in_npi														:= opi_in(npi<>'');
	export opi_facility_in											:= MPRD.InFile_Preprocessor(pversion,pUseProd).Prepped_opi_facility;
	export opi_facility_in_npi									:= opi_facility_in(npi<>'');
	
	tools.mac_FilesIndex('fac_joined_grp_key,							{group_key},		{fac_in_joinedgk}',										MPRD.Keynames(pversion,pUseProd).facility_join_group_key,										facility_join_group_key);
	tools.mac_FilesIndex('fac_joined_filecode_key,{filecode},{group_affiliation,hosp_affiliation,prac1_key,prac_phone1,group_key}',MPRD.Keynames(pversion,pUseProd).facility_join_filecode_key,facility_join_filecode_key);
	tools.mac_FilesIndex('fac_base_lnpid,									{lnpid},				{fac_base_lnpid}',										MPRD.Keynames(pversion,pUseProd).facility_lnpid,														facility_lnpid);			
	tools.mac_FilesIndex('ind_joined_grp_key,							{group_key},		{ind_in_joinedgk}',										MPRD.Keynames(pversion,pUseProd).individual_join_group_key,									individual_join_group_key);	
	tools.mac_FilesIndex('ind_base_lnpid,									{lnpid},				{ind_base_lnpid}',										MPRD.Keynames(pversion,pUseProd).individual_lnpid,													individual_lnpid);
	tools.mac_FilesIndex('basc_cp_in,											{group_key},		{basc_cp_in_gk}',											MPRD.Keynames(pversion,pUseProd).basc_cp_group_key,													basc_cp_group_key);
	tools.mac_FilesIndex('basc_cp_base_lnpid,							{lnpid},				{basc_cp_base_lnpid}',								MPRD.Keynames(pversion,pUseProd).basc_cp_lnpid,															basc_cp_lnpid);
  tools.mac_FilesIndex('basc_claims_in,									{group_key},		{basc_claims_in_gk}',									MPRD.Keynames(pversion,pUseProd).basc_claims_group_key,											basc_claims_group_key);
	tools.mac_FilesIndex('basc_claims_base_lnpid,					{lnpid},				{basc_claims_base_lnpid}',						MPRD.Keynames(pversion,pUseProd).basc_claims_lnpid,													basc_claims_lnpid);
	tools.mac_FilesIndex('npi_extension_in,								{npi_num},			{npi_extension_in_npinum}',						MPRD.Keynames(pversion,pUseProd).npi_extension_npi_num_key,									npi_extension_npi_num_key);
	tools.mac_FilesIndex('npi_extension_base_lnpid,				{lnpid},				{npi_extension_base_lnpid}',					MPRD.Keynames(pversion,pUseProd).npi_extension_lnpid,												npi_extension_lnpid);
	tools.mac_FilesIndex('npi_extension_facility_in,			{npi_num},			{npi_extension_facility_in_npinum}',	MPRD.Keynames(pversion,pUseProd).npi_extension_facility_npi_num_key,				npi_extension_facility_npi_num_key);
	tools.mac_FilesIndex('npi_extension_facility_base_lnpid,{lnpid},			{npi_extension_facility_base_lnpid}',	MPRD.Keynames(pversion,pUseProd).npi_extension_facility_lnpid,							npi_extension_facility_lnpid);
	tools.mac_FilesIndex('claims_addr_master_in,					{bill_tin},			{claims_addr_master_in_billtin}',			MPRD.Keynames(pversion,pUseProd).claims_addr_master_bill_tin_key,						claims_addr_master_bill_tin_key);
	tools.mac_FilesIndex('claims_addr_master_in,					{bill_npi},			{claims_addr_master_in_billnpi}',			MPRD.Keynames(pversion,pUseProd).claims_addr_master_bill_npi_key,						claims_addr_master_bill_npi_key);
	tools.mac_FilesIndex('claims_addr_master_in,					{rendering_npi},{claims_addr_master_in_renderingnpi}',MPRD.Keynames(pversion,pUseProd).claims_addr_master_rendering_npi_key,			claims_addr_master_rendering_npi_key);	
	tools.mac_FilesIndex('claims_addr_master_in,					{addr_key},			{claims_addr_master_in_addr_key}',		MPRD.Keynames(pversion,pUseProd).claims_addr_master_addr_key_key,						claims_addr_master_addr_key_key);
	tools.mac_FilesIndex('claims_addr_master_base_lnpid,	{lnpid},				{claims_addr_master_base_lnpid}',			MPRD.Keynames(pversion,pUseProd).claims_addr_master_lnpid,									claims_addr_master_lnpid);
	tools.mac_FilesIndex('claims_by_month_in,							{bill_tin},			{claims_by_month_in_billtin}',				MPRD.Keynames(pversion,pUseProd).claims_by_month_bill_tin_key,							claims_by_month_bill_tin_key);
	tools.mac_FilesIndex('claims_by_month_in,							{bill_npi},			{claims_by_month_in_billnpi}',				MPRD.Keynames(pversion,pUseProd).claims_by_month_bill_npi_key,							claims_by_month_bill_npi_key);
	tools.mac_FilesIndex('claims_by_month_in,							{rendering_npi},{claims_by_month_in_renderingnpi}',		MPRD.Keynames(pversion,pUseProd).claims_by_month_rendering_npi_key,					claims_by_month_rendering_npi_key);	
	tools.mac_FilesIndex('claims_by_month_in,							{addr_key},			{claims_by_month_in_addr_key}',				MPRD.Keynames(pversion,pUseProd).claims_by_month_addr_key_key,							claims_by_month_addr_key_key);
	tools.mac_FilesIndex('npi_tin_xref_in,								{bill_npi},			{npi_tin_xref_in_billnpi}',						MPRD.Keynames(pversion,pUseProd).npi_tin_xref_bill_npi_key,									npi_tin_xref_bill_npi_key);
	tools.mac_FilesIndex('taxonomy_equiv_in,							{taxonomy},			{taxonomy_equiv_in_taxonomy}',				MPRD.keynames(pversion,pUseProd).taxonomy_equiv_taxonomy_key,								taxonomy_equiv_taxonomy_key);
	tools.mac_FilesIndex('basc_deceased_in,								{group_key},		{basc_deceased_in_gk}',								MPRD.Keynames(pversion,pUseProd).basc_deceased_group_key,										basc_deceased_group_key);
	tools.mac_FilesIndex('basc_deceased_base_lnpid,				{lnpid},				{basc_deceased_base_lnpid}',					MPRD.Keynames(pversion,pUseProd).basc_deceased_lnpid,												basc_deceased_lnpid);
	tools.mac_FilesIndex('taxonomy_full_lu_in,						{taxonomy},			{taxonomy_full_lu_in_taxonomy}',			MPRD.Keynames(pversion,pUseProd).taxonomy_full_lu_taxonomy_key,							taxonomy_full_lu_taxonomy_key);
	tools.mac_FilesIndex('specialty_lu_in,								{specialty},		{specialty_lu_in_specialty}',					MPRD.Keynames(pversion,pUseProd).specialty_lu_specialty_key,								specialty_lu_specialty_key);
	tools.mac_FilesIndex('group_lu_in,										{code },				{group_lu_in_code}',									MPRD.Keynames(pversion,pUseProd).group_lu_code_key,													group_lu_code_key);
	tools.mac_FilesIndex('hospital_lu_in,									{code },				{hospital_lu_in_code}',								MPRD.Keynames(pversion,pUseProd).hospital_lu_code_key,											hospital_lu_code_key);
	tools.mac_FilesIndex('best_hospital_in,								{addr_key},			{best_hospital_in_addr}',							MPRD.Keynames(pversion,pUseProd).best_hospital_addr_key,										best_hospital_addr_key);
	tools.mac_FilesIndex('source_confidence_lu_in,				{filecode},			{source_confidence_lu_in_fcode}',			MPRD.Keynames(pversion,pUseProd).source_confidence_lu_file_code_key,				source_confidence_lu_file_code_key);	
	tools.mac_FilesIndex('office_attributes_facility_in,	{surrogate_key},{office_attributes_facility_in_sgk}',	MPRD.Keynames(pversion,pUseProd).office_attributes_facility_surrogate_key,	office_attributes_facility_surrogate_key);
	tools.mac_FilesIndex('office_attributes_in,						{surrogate_key},{office_attributes_in_sgk}',					MPRD.Keynames(pversion,pUseProd).office_attributes_surrogate_key,						office_attributes_surrogate_key);
	tools.mac_FilesIndex('lic_file_date_in,								{filecode},			{lic_file_date_in_filecode}',					MPRD.Keynames(pversion,pUseProd).lic_filedate_filecode_key,									lic_filedate_filecode_key);
	tools.mac_FilesIndex('group_practice_in,							{prac1_key},		{group_practice_in_prac1_key}',				MPRD.Keynames(pversion,pUseProd).group_practice_prac1_key_key,							group_practice_prac1_key_key);
	tools.mac_FilesIndex('group_practice_in,							{prac_phone1},	{group_practice_in_prac_phone1}',			MPRD.Keynames(pversion,pUseProd).group_practice_prac_phone1_key,						group_practice_prac_phone1_key);
	tools.mac_FilesIndex('group_practice_base_lnpid,			{lnpid},				{group_practice_base_lnpid}',					MPRD.Keynames(pversion,pUseProd).group_practice_lnpid,											group_practice_lnpid);
	tools.mac_FilesIndex('business_activities_lu_in,{dea_bus_act_ind,dea_bus_subcode},{business_activities_lu_in_ind}',MPRD.Keynames(pversion,pUseProd).business_activities_lu_ind_key,			business_activities_lu_ind_key);	
	tools.mac_FilesIndex('cms_ecp_in,											{seq_num,filecode},	{cms_ecp_in_seq}',								MPRD.Keynames(pversion,pUseProd).cms_ecp_seq_key,														cms_ecp_seq_key);
	tools.mac_FilesIndex('cms_ecp_base_lnpid,							{lnpid},				{cms_ecp_base_lnpid}',								MPRD.Keynames(pversion,pUseProd).cms_ecp_lnpid,															cms_ecp_lnpid);
	tools.mac_FilesIndex('opi_in,													{npi},					{opi_in_npi}',												MPRD.Keynames(pversion,pUseProd).opi_npi_key,																opi_npi_key);
	tools.mac_FilesIndex('opi_facility_in,								{npi},					{opi_facility_in_npi}',								MPRD.Keynames(pversion,pUseProd).opi_facility_npi_key,											opi_facility_npi_key);
	tools.mac_FilesIndex('nanpa_in,												{npa_num},			{nanpa_in_npanum}',										MPRD.Keynames(pversion,pUseProd).nanpa_npa_num_key,													nanpa_npa_num_key);
	tools.mac_FilesIndex('basc_facility_mme_in,						{group_key},		{basc_facility_mme_in_gk}',						MPRD.Keynames(pversion,pUseProd).basc_facility_mme_group_key,								basc_facility_mme_group_key);
	tools.mac_FilesIndex('basc_addr_base_lnpid,						{lnpid},				{basc_addr_base_lnpid}',							MPRD.Keynames(pversion,pUseProd).basc_addr_lnpid,														basc_addr_lnpid);
	tools.mac_FilesIndex('client_data_base_lnpid,					{lnpid},				{client_data_base_lnpid}',						MPRD.Keynames(pversion,pUseProd).client_data_lnpid,													client_data_lnpid);
end;


