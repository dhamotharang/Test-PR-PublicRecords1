import versioncontrol, _control, ut, tools, MPRD, Healthcare_ProviderPoint_QA;
export Build_all(string pversion, boolean pUseProd = false) := function

	spray_  		 := VersionControl.fSprayInputFiles(MPRD.fSpray(pversion,pUseProd));

	built := sequential(
   					spray_,
						Healthcare_ProviderPoint_QA.Make_QA_MPRD_Files(pversion),
						parallel(
							MPRD.Build_Keys.Build_Keys_npi_tin_xref(pversion,pUseProd).npi_tin_xref_All,
							MPRD.Build_Keys.Build_Keys_taxonomy_full_lu(pversion,pUseProd).taxonomy_full_lu_All,
							MPRD.Build_Keys.Build_Keys_specialty_lu(pversion,pUseProd).specialty_lu_All,
							MPRD.Build_Keys.Build_Keys_group_lu(pversion,pUseProd).group_lu_All,
							MPRD.Build_keys.Build_Keys_hospital_lu(pversion,pUseProd).hospital_lu_All,
							MPRD.Build_Keys.Build_Keys_best_hospital(pversion,pUseProd).best_hospital_All,
							MPRD.Build_Keys.Build_Keys_office_attributes_facility(pversion,pUseProd).office_attributes_facility_All,
							MPRD.Build_Keys.Build_Keys_office_attributes(pversion,pUseProd).office_attributes_All,
							MPRD.Build_Keys.Build_Keys_claims_by_month(pversion,pUseProd).claims_by_month_All,
							MPRD.Build_Keys.Build_Keys_taxonomy_equiv(pversion,pUseProd).taxonomy_equiv_All,
							MPRD.Build_Keys.Build_Keys_source_confidence_lu(pversion,pUseProd).source_confidence_lu_All,
							MPRD.Build_Keys.Build_Keys_opi(pversion,pUseProd).opi_all,
							MPRD.Build_Keys.Build_Keys_opi_facility(pversion,pUseProd).opi_facility_all,
							MPRD.Build_Keys.Build_Keys_business_activities_lu(pversion,pUseProd).business_activities_lu_all,
							MPRD.Build_Keys.Build_Keys_lic_filedate(pversion,pUseProd).lic_filedate_all,
							MPRD.Build_Keys.Build_keys_basc_facility_mme(pversion,pUseProd).basc_facility_mme_all,
							MPRD.Build_keys.Build_keys_nanpa(pversion,pUseProd).nanpa_npa_all),
						parallel(
							MPRD.Build_Base.build_base_individual(pversion,pUseProd).individual_all,
							MPRD.Build_Base.build_base_facility(pversion,pUseProd).facility_all,
							MPRD.Build_Base.build_base_basc_claims(pversion,pUseProd).basc_claims_all,
							MPRD.Build_Base.build_base_basc_cp(pversion,pUseProd).basc_cp_all,
							MPRD.Build_Base.build_base_claims_by_month(pversion,pUseProd).claims_by_month_all,
							MPRD.Build_Base.build_base_claims_addr_master(pversion,pUseProd).claims_addr_master_all,
							MPRD.Build_Base.build_base_npi_tin_xref(pversion,pUseProd).npi_tin_xref_all,
							MPRD.Build_Base.build_base_npi_extension(pversion,pUseProd).npi_extension_all,
							MPRD.Build_Base.build_base_npi_extension_facility(pversion,pUseProd).npi_extension_facility_all,
							MPRD.Build_Base.build_base_taxonomy_equiv(pversion,pUseProd).taxonomy_equiv_all,
							MPRD.Build_Base.build_base_basc_deceased(pversion,pUseProd).basc_deceased_all,
							MPRD.Build_Base.build_base_basc_addr(pversion,pUseProd).basc_addr_all,
							MPRD.Build_Base.build_base_client_data(pversion,pUseProd).client_data_all,
							MPRD.Build_Base.build_base_office_attributes(pversion,pUseProd).office_attributes_all,
							MPRD.Build_Base.build_base_office_attributes_facility(pversion,pUseProd).office_attributes_facility_all,
							MPRD.Build_Base.build_base_std_terms_lu(pversion,pUseProd).std_terms_lu_all,						
							MPRD.Build_Base.build_base_taxonomy_full_lu(pversion,pUseProd).taxonomy_full_lu_all,						
							MPRD.Build_Base.build_base_dir_confidence_2010_lu(pversion,pUseProd).dir_confidence_2010_lu_all,	
							MPRD.Build_Base.build_base_specialty_lu(pversion,pUseProd).specialty_lu_all,	
							MPRD.Build_Base.build_base_group_lu(pversion,pUseProd).group_lu_all,	
							MPRD.Build_Base.build_base_hospital_lu(pversion,pUseProd).hospital_lu_all,	
							MPRD.Build_Base.build_base_dea_xref(pversion,pUseProd).dea_xref_all,
							MPRD.Build_Base.build_base_lic_xref(pversion,pUseProd).lic_xref_all,
							MPRD.Build_Base.build_base_addr_name_xref(pversion,pUseProd).addr_name_xref_all,
							MPRD.Build_Base.build_base_facility_name_xref(pversion,pUseProd).facility_name_xref_all,
							MPRD.Build_Base.build_base_basc_facility_mme(pversion,pUseProd).basc_facility_mme_all,
							MPRD.Build_Base.build_base_lic_filedate(pversion,pUseProd).lic_filedate_all,
							MPRD.Build_Base.build_base_nanpa(pversion,pUseProd).nanpa_all,
							MPRD.Build_Base.build_base_best_hospital(pversion,pUseProd).best_hospital_all,
							MPRD.Build_Base.build_base_last_name_stats(pversion,pUseProd).last_name_stats_all,
							MPRD.Build_Base.build_base_source_confidence_lu(pversion,pUseProd).source_confidence_lu_all,
							MPRD.Build_Base.build_base_ignore_terms_lu(pversion,pUseProd).ignore_terms_lu_all,
							MPRD.Build_Base.build_base_taxon_lu(pversion,pUseProd).taxon_lu_all,
							MPRD.Build_Base.build_base_abbr_lu(pversion,pUseProd).abbr_lu_all,
							MPRD.Build_Base.build_base_call_queue_bad(pversion,pUseProd).call_queue_bad_all,
							MPRD.Build_Base.build_base_group_practice(pversion,pUseProd).group_practice_all,
							MPRD.Build_Base.build_base_aci_schedule(pversion,pUseProd).aci_schedule_all,
							MPRD.Build_Base.build_base_business_activities_lu(pversion,pUseProd).business_activities_lu_all,
							MPRD.Build_Base.build_base_cms_ecp(pversion,pUseProd).cms_ecp_all,
							MPRD.Build_Base.build_base_opi(pversion,pUseProd).opi_all,
							MPRD.Build_Base.build_base_opi_facility(pversion,pUseProd).opi_facility_all,
							MPRD.Build_Base.build_base_abms_cert_lu(pversion,pUseProd).abms_cert_lu_all,
							MPRD.Build_Base.build_base_abms_cooked(pversion,pUseProd).abms_cooked_all),
						parallel(
							MPRD.Build_Keys.Build_Keys_individual_joined(pversion,pUseProd).individual_joined_All,
							MPRD.Build_Keys.Build_Keys_individual(pversion,pUseProd).individual_all,
							MPRD.Build_Keys.Build_Keys_facility_joined(pversion,pUseProd).facility_joined_All,
							MPRD.Build_Keys.Build_Keys_facility_joined_filecode(pversion,pUseProd).facility_joined_filecode_All,
							MPRD.Build_Keys.Build_keys_facility(pversion,pUseProd).facility_all,
							MPRD.Build_Keys.Build_keys_basc_cp(pversion,pUseProd).basc_cp_all,
							MPRD.Build_Keys.Build_keys_basc_claims(pversion,pUseProd).basc_claims_all,
							MPRD.Build_Keys.Build_keys_basc_addr(pversion,pUseProd).basc_addr_all,
							MPRD.Build_Keys.build_keys_client_data(pversion,pUseProd).client_data_all,
							MPRD.Build_keys.Build_keys_cms_ecp(pversion,pUseProd).cms_ecp_all,
							MPRD.Build_Keys.Build_keys_claims_addr_master(pversion,pUseProd).claims_addr_master_all,
							MPRD.Build_Keys.Build_keys_npi_extension(pversion,pUseProd).npi_extension_all,
							MPRD.Build_Keys.Build_keys_npi_extension_facility(pversion,pUseProd).npi_extension_facility_all,
							MPRD.Build_Keys.Build_keys_basc_deceased(pversion,pUseProd).basc_deceased_all,
							MPRD.Build_Keys.Build_Keys_group_practice(pversion,pUseProd).group_practice_all),
						parallel(
							MPRD.Promote.promote_facility(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_facility_joined_grpkey(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_facility_joined_filecodekey(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_individual(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_individual_joined_grpkey(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_basc_claims(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_basc_cp(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_claims_by_month(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_claims_addr_master(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_npi_tin_xref(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_npi_extension(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_npi_extension_facility(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_taxonomy_equiv(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_basc_deceased(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_basc_addr(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_client_data(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_office_attributes(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_office_attributes_facility(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_std_terms_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.promote_taxonomy_full_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_dir_confidence_2010_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_specialty_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_group_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_hospital_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_dea_xref(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_lic_xref(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_facility_name_xref(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_addr_name_xref(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_basc_facility_mme(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_lic_filedate(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_nanpa(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_best_hospital(pversion,pUseProd).buildfiles.Built2QA,
              MPRD.Promote.promote_last_name_stats(pversion,pUseProd).buildfiles.Built2QA,						
   						MPRD.Promote.Promote_source_confidence_lu(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_ignore_terms_lu(pversion,pUseProd).buildfiles.Built2QA,
   						MPRD.Promote.Promote_taxon_lu(pversion,pUseProd).buildfiles.Built2QA,
						  MPRD.Promote.Promote_abbr_lu(pversion,pUseProd).buildfiles.Built2QA,
						  MPRD.Promote.Promote_call_queue_bad(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_group_practice(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_aci_schedule(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_business_activities_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_cms_ecp(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_opi(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_opi_facility(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_abms_cert_lu(pversion,pUseProd).buildfiles.Built2QA,
							MPRD.Promote.Promote_abms_cooked(pversion,pUseProd).buildfiles.Built2QA),
							//Run Strata
							MPRD.Build_Strata(pversion,pUseProd).All,
						sequential(
							FileServices.StartSuperFileTransaction(),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).individual_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).facility_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).dea_xref_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).npi_tin_xref_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).addr_name_xref_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).facility_name_xref_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_cp_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_claims_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).npi_extension_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).npi_extension_facility_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).claims_addr_master_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).claims_by_month_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).taxonomy_equiv_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_deceased_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_addr_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).client_data_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).office_attributes_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).office_attributes_facility_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).std_terms_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).taxonomy_full_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).dir_confidence_2010_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).specialty_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).group_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).hospital_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).lic_xref_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_facility_mme_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).lic_filedate_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).nanpa_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).best_hospital_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).last_name_stats_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).source_confidence_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).ignore_terms_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).taxon_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).abbr_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).call_queue_bad_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).group_practice_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).business_activities_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).cms_ecp_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).opi_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).opi_facility_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).abms_cert_lu_lInputHistTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).abms_cooked_lInputHistTemplate,true),

							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).facility_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).individual_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).dea_xref_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).npi_tin_xref_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).addr_name_xref_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).facility_name_xref_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_cp_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_claims_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).npi_extension_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).npi_extension_facility_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).claims_addr_master_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).claims_by_month_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).taxonomy_equiv_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_deceased_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_addr_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).client_data_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).office_attributes_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).office_attributes_facility_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).std_terms_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).taxonomy_full_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).dir_confidence_2010_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).specialty_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).group_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).hospital_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).lic_xref_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_facility_mme_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).lic_filedate_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).nanpa_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).best_hospital_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).last_name_stats_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).source_confidence_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).ignore_terms_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).taxon_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).abbr_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).call_queue_bad_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).group_practice_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).aci_schedule_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).business_activities_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).cms_ecp_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).opi_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).opi_facility_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).abms_cert_lu_lInputHistTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).abms_cooked_lInputHistTemplate),
							
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).facility_lInputHistTemplate,  								MPRD.Filenames(pversion,pUseProd).facility_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).individual_lInputHistTemplate,  							MPRD.Filenames(pversion,pUseProd).individual_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).dea_xref_lInputHistTemplate,  								MPRD.Filenames(pversion,pUseProd).dea_xref_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).npi_tin_xref_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).npi_tin_xref_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).addr_name_xref_lInputHistTemplate, 						MPRD.Filenames(pversion,pUseProd).addr_name_xref_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).facility_name_xref_lInputHistTemplate,  			MPRD.Filenames(pversion,pUseProd).facility_name_xref_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).basc_cp_lInputHistTemplate,  									MPRD.Filenames(pversion,pUseProd).basc_cp_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).basc_claims_lInputHistTemplate,  							MPRD.Filenames(pversion,pUseProd).basc_claims_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).npi_extension_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).npi_extension_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).npi_extension_facility_lInputHistTemplate,  	MPRD.Filenames(pversion,pUseProd).npi_extension_facility_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).claims_addr_master_lInputHistTemplate,  			MPRD.Filenames(pversion,pUseProd).claims_addr_master_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).claims_by_month_lInputHistTemplate,  					MPRD.Filenames(pversion,pUseProd).claims_by_month_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).taxonomy_equiv_lInputHistTemplate,						MPRD.Filenames(pversion,pUseProd).taxonomy_equiv_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).basc_deceased_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).basc_deceased_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).basc_addr_lInputHistTemplate,  								MPRD.Filenames(pversion,pUseProd).basc_addr_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).client_data_lInputHistTemplate,  							MPRD.Filenames(pversion,pUseProd).client_data_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).office_attributes_lInputHistTemplate,  				MPRD.Filenames(pversion,pUseProd).office_attributes_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).office_attributes_facility_lInputHistTemplate,MPRD.Filenames(pversion,pUseProd).office_attributes_facility_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).std_terms_lu_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).std_terms_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).taxonomy_full_lu_lInputHistTemplate,  				MPRD.Filenames(pversion,pUseProd).taxonomy_full_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).dir_confidence_2010_lu_lInputHistTemplate,  	MPRD.Filenames(pversion,pUseProd).dir_confidence_2010_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).specialty_lu_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).specialty_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).group_lu_lInputHistTemplate,  								MPRD.Filenames(pversion,pUseProd).group_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).hospital_lu_lInputHistTemplate,  							MPRD.Filenames(pversion,pUseProd).hospital_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).lic_xref_lInputHistTemplate,  								MPRD.Filenames(pversion,pUseProd).lic_xref_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).basc_facility_mme_lInputHistTemplate,  				MPRD.Filenames(pversion,pUseProd).basc_facility_mme_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).lic_filedate_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).lic_filedate_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).nanpa_lInputHistTemplate,  										MPRD.Filenames(pversion,pUseProd).nanpa_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).best_hospital_lInputHistTemplate,  						MPRD.Filenames(pversion,pUseProd).best_hospital_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).last_name_stats_lInputHistTemplate,  					MPRD.Filenames(pversion,pUseProd).last_name_stats_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).source_confidence_lu_lInputHistTemplate,  		MPRD.Filenames(pversion,pUseProd).source_confidence_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).ignore_terms_lu_lInputHistTemplate,  					MPRD.Filenames(pversion,pUseProd).ignore_terms_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).taxon_lu_lInputHistTemplate,  								MPRD.Filenames(pversion,pUseProd).taxon_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).abbr_lu_lInputHistTemplate,  									MPRD.Filenames(pversion,pUseProd).abbr_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).call_queue_bad_lInputHistTemplate,  					MPRD.Filenames(pversion,pUseProd).call_queue_bad_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).group_practice_lInputHistTemplate,  					MPRD.Filenames(pversion,pUseProd).group_practice_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).aci_schedule_lInputHistTemplate,							MPRD.Filenames(pversion,pUseProd).aci_schedule_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).business_activities_lu_lInputHistTemplate,		MPRD.Filenames(pversion,pUseProd).business_activities_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).cms_ecp_lInputHistTemplate,										MPRD.Filenames(pversion,pUseProd).cms_ecp_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).opi_lInputHistTemplate,												MPRD.Filenames(pversion,pUseProd).opi_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).opi_facility_lInputHistTemplate,							MPRD.Filenames(pversion,pUseProd).opi_facility_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,pUseProd).abms_cert_lu_lInputHistTemplate,							MPRD.Filenames(pversion,pUseProd).abms_cert_lu_lInputTemplate,,true),
							FileServices.AddSuperFile(MPRD.Filenames(pversion,puseProd).abms_cooked_lInputHistTemplate,								MPRD.Filenames(pversion,puseProd).abms_cooked_lInputTemplate,,true),
							
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).individual_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).facility_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).dea_xref_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).npi_tin_xref_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).addr_name_xref_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).facility_name_xref_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_cp_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_claims_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).npi_extension_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).npi_extension_facility_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).claims_addr_master_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).claims_by_month_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).taxonomy_equiv_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_deceased_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_addr_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).client_data_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).office_attributes_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).office_attributes_facility_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).std_terms_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).taxonomy_full_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).dir_confidence_2010_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).specialty_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).group_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).hospital_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).lic_xref_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).basc_facility_mme_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).lic_filedate_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).nanpa_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).best_hospital_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).last_name_stats_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).source_confidence_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).ignore_terms_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).taxon_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).abbr_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).call_queue_bad_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).group_practice_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).aci_schedule_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).business_activities_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).cms_ecp_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).opi_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).opi_facility_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).abms_cert_lu_lInputTemplate,true),
							FileServices.RemoveOwnedSubFiles(MPRD.Filenames(pversion,pUseProd).abms_cooked_lInputTemplate,true),
							
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).facility_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).individual_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).dea_xref_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).npi_tin_xref_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).addr_name_xref_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).facility_name_xref_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_cp_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_claims_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).npi_extension_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).npi_extension_facility_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).claims_addr_master_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).claims_by_month_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).taxonomy_equiv_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_deceased_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_addr_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).client_data_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).office_attributes_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).office_attributes_facility_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).std_terms_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).taxonomy_full_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).dir_confidence_2010_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).specialty_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).group_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).hospital_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).lic_xref_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).basc_facility_mme_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).lic_filedate_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).nanpa_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).best_hospital_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).last_name_stats_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).source_confidence_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).ignore_terms_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).taxon_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).abbr_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).call_queue_bad_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).group_practice_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).aci_schedule_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).business_activities_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).cms_ecp_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).opi_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).opi_facility_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,pUseProd).abms_cert_lu_lInputTemplate),
							FileServices.ClearSuperFile(MPRD.Filenames(pversion,puseProd).abms_cooked_lInputTemplate),
							FileServices.FinishSuperFileTransaction())					
					): success(Send_Email(pversion,pUseProd).BuildSuccess), failure(send_email(pversion,pUseProd).BuildFailure);
   
   return built;
end;