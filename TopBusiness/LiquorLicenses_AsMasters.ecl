import Liquor_Licenses,MDR;

export LiquorLicenses_AsMasters := module(Interface_AsMasters.Unlinked.Default)

	export dataset(Layout_Linking.Unlinked) As_Linking_Master := function
		
		extract_in_1 := normalize(Liquor_Licenses.Files().Base.IN.QA,if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_IN_Liquor_Licenses,
				self.source_docid := left.rawfields.permit_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.name,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_in_2 := normalize(Liquor_Licenses.Files().Base.IN.QA,if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_IN_Liquor_Licenses,
				self.source_docid := left.rawfields.permit_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.corporation,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_in_3 := normalize(Liquor_Licenses.Files().Base.IN.QA,if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_IN_Liquor_Licenses,
				self.source_docid := left.rawfields.permit_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.doing_business_as,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_la_1 := normalize(Liquor_Licenses.Files().Base.LA.QA(clean_owner_name.lname = ''),if(left.clean_owner_address.v_city_name != left.clean_owner_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_LA_Liquor_Licenses,
				self.source_docid := left.rawfields.formattedcredential,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.ownername,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_owner_address.prim_range,
				self.predir := left.clean_owner_address.predir,
				self.prim_name := left.clean_owner_address.prim_name,
				self.addr_suffix := left.clean_owner_address.addr_suffix,
				self.postdir := left.clean_owner_address.postdir,
				self.unit_desig := left.clean_owner_address.unit_desig,
				self.sec_range := left.clean_owner_address.sec_range,
				self.city_name := choose(counter,
					left.clean_owner_address.p_city_name,
					left.clean_owner_address.v_city_name),
				self.state := left.clean_owner_address.st,
				self.zip := left.clean_owner_address.zip,
				self.county_fips := left.clean_owner_address.fips_county,
				self.msa := left.clean_owner_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_la_2 := normalize(Liquor_Licenses.Files().Base.LA.QA(rawfields.tradename != ''),if(left.clean_trade_address.v_city_name != left.clean_trade_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_LA_Liquor_Licenses,
				self.source_docid := left.rawfields.formattedcredential,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.tradename,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_trade_address.prim_range,
				self.predir := left.clean_trade_address.predir,
				self.prim_name := left.clean_trade_address.prim_name,
				self.addr_suffix := left.clean_trade_address.addr_suffix,
				self.postdir := left.clean_trade_address.postdir,
				self.unit_desig := left.clean_trade_address.unit_desig,
				self.sec_range := left.clean_trade_address.sec_range,
				self.city_name := choose(counter,
					left.clean_trade_address.p_city_name,
					left.clean_trade_address.v_city_name),
				self.state := left.clean_trade_address.st,
				self.zip := left.clean_trade_address.zip,
				self.county_fips := left.clean_trade_address.fips_county,
				self.msa := left.clean_trade_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_oh_1 := normalize(Liquor_Licenses.Files().Base.OH.QA(clean_person_name.lname = ''),if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_OH_Liquor_Licenses,
				self.source_docid := left.rawfields.permit_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.name,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_oh_2 := normalize(Liquor_Licenses.Files().Base.OH.QA(rawfields.dba != ''),if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_OH_Liquor_Licenses,
				self.source_docid := left.rawfields.permit_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.dba,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_pa_1 := normalize(Liquor_Licenses.Files().Base.PA.QA(clean_person_name1.lname = ''),if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_PA_Liquor_Licenses,
				self.source_docid := left.rawfields.license_identification_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.licensee_name_1,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_pa_2 := normalize(Liquor_Licenses.Files().Base.PA.QA(clean_person_name2.lname = ''),if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_PA_Liquor_Licenses,
				self.source_docid := left.rawfields.license_identification_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.licensee_name_2,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_pa_3 := normalize(Liquor_Licenses.Files().Base.PA.QA(clean_person_name3.lname = ''),if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_PA_Liquor_Licenses,
				self.source_docid := left.rawfields.license_identification_number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.licensee_name_3,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_tx_1 := normalize(Liquor_Licenses.Files().Base.TX.QA(clean_tradename_name.lname = ''),if(left.clean_location_address.v_city_name != left.clean_location_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.tradename,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_location_address.prim_range,
				self.predir := left.clean_location_address.predir,
				self.prim_name := left.clean_location_address.prim_name,
				self.addr_suffix := left.clean_location_address.addr_suffix,
				self.postdir := left.clean_location_address.postdir,
				self.unit_desig := left.clean_location_address.unit_desig,
				self.sec_range := left.clean_location_address.sec_range,
				self.city_name := choose(counter,
					left.clean_location_address.p_city_name,
					left.clean_location_address.v_city_name),
				self.state := left.clean_location_address.st,
				self.zip := left.clean_location_address.zip,
				self.county_fips := left.clean_location_address.fips_county,
				self.msa := left.clean_location_address.msa,
				self.phone := left.clean_phone,
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_tx_2 := normalize(Liquor_Licenses.Files().Base.TX.QA(clean_owner_name.lname = ''),if(left.clean_location_address.v_city_name != left.clean_location_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.owner,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_location_address.prim_range,
				self.predir := left.clean_location_address.predir,
				self.prim_name := left.clean_location_address.prim_name,
				self.addr_suffix := left.clean_location_address.addr_suffix,
				self.postdir := left.clean_location_address.postdir,
				self.unit_desig := left.clean_location_address.unit_desig,
				self.sec_range := left.clean_location_address.sec_range,
				self.city_name := choose(counter,
					left.clean_location_address.p_city_name,
					left.clean_location_address.v_city_name),
				self.state := left.clean_location_address.st,
				self.zip := left.clean_location_address.zip,
				self.county_fips := left.clean_location_address.fips_county,
				self.msa := left.clean_location_address.msa,
				self.phone := left.clean_phone,
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_tx_3 := normalize(Liquor_Licenses.Files().Base.TX.QA(clean_tradename_name.lname = ''),if(left.clean_mailing_address.v_city_name != left.clean_mailing_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.tradename,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_mailing_address.prim_range,
				self.predir := left.clean_mailing_address.predir,
				self.prim_name := left.clean_mailing_address.prim_name,
				self.addr_suffix := left.clean_mailing_address.addr_suffix,
				self.postdir := left.clean_mailing_address.postdir,
				self.unit_desig := left.clean_mailing_address.unit_desig,
				self.sec_range := left.clean_mailing_address.sec_range,
				self.city_name := choose(counter,
					left.clean_mailing_address.p_city_name,
					left.clean_mailing_address.v_city_name),
				self.state := left.clean_mailing_address.st,
				self.county_fips := left.clean_mailing_address.fips_county,
				self.zip := left.clean_mailing_address.zip,
				self.msa := left.clean_mailing_address.msa,
				self.phone := left.clean_phone,
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_tx_4 := normalize(Liquor_Licenses.Files().Base.TX.QA(clean_owner_name.lname = ''),if(left.clean_mailing_address.v_city_name != left.clean_mailing_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.owner,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_mailing_address.prim_range,
				self.predir := left.clean_mailing_address.predir,
				self.prim_name := left.clean_mailing_address.prim_name,
				self.addr_suffix := left.clean_mailing_address.addr_suffix,
				self.postdir := left.clean_mailing_address.postdir,
				self.unit_desig := left.clean_mailing_address.unit_desig,
				self.sec_range := left.clean_mailing_address.sec_range,
				self.city_name := choose(counter,
					left.clean_mailing_address.p_city_name,
					left.clean_mailing_address.v_city_name),
				self.state := left.clean_mailing_address.st,
				self.zip := left.clean_mailing_address.zip,
				self.county_fips := left.clean_mailing_address.fips_county,
				self.msa := left.clean_mailing_address.msa,
				self.phone := left.clean_phone,
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
		
		extract_ct_1 := normalize(Liquor_Licenses.Files().Base.CT.QA,if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_CT_Liquor_Licenses,
				self.source_docid := left.rawfields.number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.business_name,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
				
		extract_ct_2 := normalize(Liquor_Licenses.Files().Base.CT.QA,if(left.clean_address.v_city_name != left.clean_address.p_city_name,2,1),
			transform(Layout_Linking.Unlinked,
				self.source := MDR.sourceTools.src_CT_Liquor_Licenses,
				self.source_docid := left.rawfields.number,
				self.source_party := '',
				self.date_first_seen := (unsigned4)left.dt_first_seen,
				self.date_last_seen := (unsigned4)left.dt_last_seen,
				self.company_name := left.rawfields.dba_name,
				self.company_name_type := Constants.Company_Name_Types.UNKNOWN,
				self.address_type := Constants.Address_Types.UNKNOWN,
				self.phone_type := Constants.Phone_Types.UNKNOWN,
				self.aid := 0,
				self.prim_range := left.clean_address.prim_range,
				self.predir := left.clean_address.predir,
				self.prim_name := left.clean_address.prim_name,
				self.addr_suffix := left.clean_address.addr_suffix,
				self.postdir := left.clean_address.postdir,
				self.unit_desig := left.clean_address.unit_desig,
				self.sec_range := left.clean_address.sec_range,
				self.city_name := choose(counter,
					left.clean_address.p_city_name,
					left.clean_address.v_city_name),
				self.state := left.clean_address.st,
				self.zip := left.clean_address.zip,
				self.county_fips := left.clean_address.fips_county,
				self.msa := left.clean_address.msa,
				self.phone := '',
				self.fein := '',
				self.url := '',
				self.duns := '',
				self.experian := '',
				self.zoom := '',
				self.incorp_state := '',
				self.incorp_number := ''));	
				
		combined_extracts :=
			extract_ct_1 + extract_ct_2 + 
			extract_tx_1 + extract_tx_2 + extract_tx_3 + extract_tx_4 +
			extract_pa_1 + extract_pa_2 + extract_pa_3 +
			extract_oh_1 + extract_oh_2 +
			extract_la_1 + extract_la_2 +
			extract_in_1 + extract_in_2 + extract_in_3;
		
		return combined_extracts(company_name != '');
		
	end;
	
	export dataset(Layout_License.Unlinked) As_License_Master := function
		
		extract_in := project(Liquor_Licenses.Files().Base.IN.QA,
			transform(Layout_License.Unlinked,
				self.source            := MDR.sourceTools.src_IN_Liquor_Licenses,
				self.source_docid      := left.rawfields.permit_number,
				self.source_party      := '',
				self.license_state     := 'IN',
				self.license_board     := '',
				self.license_number    := left.rawfields.permit_number,
				self.license_type      := 'Liquor License',
				self.license_status    := '';
				self.issue_date        := '',
				self.last_renewal_date := if(left.clean_dates.extension_expiration_date = 0,'',(string)left.clean_dates.extension_expiration_date),
				self.expiration_date   := if(left.clean_dates.expiration_date = 0,'',(string)left.clean_dates.expiration_date),
				self.company_name      := left.rawfields.name;
				));
				
		extract_la := project(Liquor_Licenses.Files().Base.LA.QA,
			transform(Layout_License.Unlinked,
				self.source            := MDR.sourceTools.src_LA_Liquor_Licenses,
				self.source_docid      := left.rawfields.formattedcredential,
				self.source_party      := '',
				self.license_state     := 'LA',
				self.license_board     := '',
				self.license_number    := left.rawfields.formattedcredential,
				self.license_type      := 'Liquor License',
				self.license_status    := '';
				self.issue_date        := '',
				self.last_renewal_date := '',
				self.expiration_date   := '',
				self.company_name      := left.rawfields.ownername;
				));
				
		extract_oh := project(Liquor_Licenses.Files().Base.OH.QA,
			transform(Layout_License.Unlinked,
				self.source            := MDR.sourceTools.src_OH_Liquor_Licenses,
				self.source_docid      := left.rawfields.permit_number,
				self.source_party      := '',
				self.license_state     := 'OH',
				self.license_board     := '',
				self.license_number    := left.rawfields.permit_number,
				self.license_type      := 'Liquor License',
				self.license_status    := '';
				self.issue_date        := '',
				self.last_renewal_date := '',
				self.expiration_date   := '',
				self.company_name      := left.rawfields.name;
				));
				
		extract_pa := project(Liquor_Licenses.Files().Base.PA.QA,
			transform(Layout_License.Unlinked,
				self.source            := MDR.sourceTools.src_PA_Liquor_Licenses,
				self.source_docid      := left.rawfields.license_identification_number,
				self.source_party      := '',
				self.license_state     := 'PA',
				self.license_board     := '',
				self.license_number    := left.rawfields.license_identification_number,
				self.license_type      := 'Liquor License',
				self.license_status    := '';
				self.issue_date        := '',
				self.last_renewal_date := '',
				self.expiration_date   := '',
				self.company_name      := left.rawfields.licensee_name_1;
				));
				
		extract_tx := project(Liquor_Licenses.Files().Base.TX.QA,
			transform(Layout_License.Unlinked,
				self.source            := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party      := '',
				self.license_state     := 'TX',
				self.license_board     := '',
				self.license_number    := left.rawfields.clp,
				self.license_type      := 'Liquor License',
				self.license_status    := left.rawfields.licstatusdesc;
				self.issue_date        := if(left.clean_dates.originallicensedate = 0,'',(string)left.clean_dates.originallicensedate),
				self.last_renewal_date := '',
				self.expiration_date   := if(left.clean_dates.expirydate = 0,'',(string)left.clean_dates.expirydate),
				self.company_name      := left.rawfields.owner;
				));
				
		extract_ct := project(Liquor_Licenses.Files().Base.CT.QA,
			transform(Layout_License.Unlinked,
				self.source            := MDR.sourceTools.src_CT_Liquor_Licenses,
				self.source_docid      := left.rawfields.number,
				self.source_party      := '',
				self.license_state     := 'CT',
				self.license_board     := '',
				self.license_number    := left.rawfields.number,
				self.license_type      := 'Liquor License',
				self.license_status    := left.rawfields.status;
				self.issue_date        := '',
				self.last_renewal_date := if(left.clean_dates.effective_date = 0,'',(string)left.clean_dates.effective_date),
				self.expiration_date   := if(left.clean_dates.expiration = 0,'',(string)left.clean_dates.expiration),
				self.company_name      := left.rawfields.business_name;
				));
				
		combined_extracts :=
			extract_ct +
			extract_tx +
			extract_pa +
			extract_oh +
			extract_la +
			extract_in;
				
		return combined_extracts;
		
	end;	
	
	export dataset(Layout_Contacts.Unlinked) As_Contact_Master := function
		
		extract_in := normalize(Liquor_Licenses.Files().Base.IN.QA,
			2,
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_IN_Liquor_Licenses,
				self.source_docid      := left.rawfields.permit_number,
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := choose(counter,
					left.clean_president_name.title,
					left.clean_secretary_name.title),
				self.name_first        := choose(counter,
					left.clean_president_name.fname,
					left.clean_secretary_name.fname),
				self.name_middle       := choose(counter,
					left.clean_president_name.mname,
					left.clean_secretary_name.mname),
				self.name_last         := choose(counter,
					left.clean_president_name.lname,
					left.clean_secretary_name.lname),
				self.name_suffix       := choose(counter,
					left.clean_president_name.name_suffix,
					left.clean_secretary_name.name_suffix),
				self.position_title    := choose(counter,
					'President',
					'Secretary'),
				self := []));		
				
		extract_la := normalize(Liquor_Licenses.Files().Base.LA.QA,
			if(left.clean_owner_address.v_city_name != left.clean_owner_address.p_city_name,2,1),
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_LA_Liquor_Licenses,
				self.source_docid      := left.rawfields.formattedcredential,
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := left.clean_owner_name.title,
				self.name_first        := left.clean_owner_name.fname,
				self.name_middle       := left.clean_owner_name.mname,
				self.name_last         := left.clean_owner_name.lname,
				self.name_suffix       := left.clean_owner_name.name_suffix,
				self.prim_range        := left.clean_owner_address.prim_range,
				self.predir            := left.clean_owner_address.predir,
				self.prim_name         := left.clean_owner_address.prim_name,
				self.addr_suffix       := left.clean_owner_address.addr_suffix,
				self.postdir           := left.clean_owner_address.postdir,
				self.unit_desig        := left.clean_owner_address.unit_desig,
				self.sec_range         := left.clean_owner_address.sec_range,
				self.city_name         := choose(counter,
					left.clean_owner_address.p_city_name,
					left.clean_owner_address.v_city_name),
				self.state             := left.clean_owner_address.st,
				self.zip               := left.clean_owner_address.zip,
				self.position_title    := 'Liquor License Contact',
				self := []));		
				
		extract_oh := project(Liquor_Licenses.Files().Base.OH.QA,
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_OH_Liquor_Licenses,
				self.source_docid      := left.rawfields.permit_number,
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := left.clean_person_name.title,
				self.name_first        := left.clean_person_name.fname,
				self.name_middle       := left.clean_person_name.mname,
				self.name_last         := left.clean_person_name.lname,
				self.name_suffix       := left.clean_person_name.name_suffix,
				self.position_title    := 'Liquor License Contact',
				self := []));		
				
		extract_pa := normalize(Liquor_Licenses.Files().Base.PA.QA,
			3,
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_PA_Liquor_Licenses,
				self.source_docid      := left.rawfields.license_identification_number,
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := choose(counter,
					left.clean_person_name1.title,
					left.clean_person_name2.title,
					left.clean_person_name3.title),
				self.name_first       := choose(counter,
					left.clean_person_name1.fname,
					left.clean_person_name2.fname,
					left.clean_person_name3.fname),
				self.name_middle       := choose(counter,
					left.clean_person_name1.mname,
					left.clean_person_name2.mname,
					left.clean_person_name3.mname),
				self.name_last         := choose(counter,
					left.clean_person_name1.lname,
					left.clean_person_name2.lname,
					left.clean_person_name3.lname),
				self.name_suffix       := choose(counter,
					left.clean_person_name1.name_suffix,
					left.clean_person_name2.name_suffix,
					left.clean_person_name3.name_suffix),
				self.position_title    := 'Liquor License Contact',
				self := []));		
				
		extract_tx_1 := project(Liquor_Licenses.Files().Base.TX.QA,
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := left.clean_tradename_name.title,
				self.name_first        := left.clean_tradename_name.fname,
				self.name_middle       := left.clean_tradename_name.mname,
				self.name_last         := left.clean_tradename_name.lname,
				self.name_suffix       := left.clean_tradename_name.name_suffix,
				self.position_title    := 'Liquor License Contact',
				self := []));		
				
		extract_tx_2 := project(Liquor_Licenses.Files().Base.TX.QA,
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_TX_Liquor_Licenses,
				self.source_docid := if(left.rawfields.licstatusdesc = 'Applicant','APP' + hash32(left.rawfields.owner,left.rawfields.tradename),left.rawfields.clp),
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := left.clean_owner_name.title,
				self.name_first        := left.clean_owner_name.fname,
				self.name_middle       := left.clean_owner_name.mname,
				self.name_last         := left.clean_owner_name.lname,
				self.name_suffix       := left.clean_owner_name.name_suffix,
				self.position_title    := 'Liquor License Contact',
				self := []));		
				
		extract_ct := project(Liquor_Licenses.Files().Base.CT.QA,
			transform(Layout_Contacts.Unlinked,
				self.source            := MDR.sourceTools.src_CT_Liquor_Licenses,
				self.source_docid      := left.rawfields.number,
				self.source_party      := '',
				self.date_first_seen   := (unsigned4)left.dt_first_seen,
				self.date_last_seen    := (unsigned4)left.dt_last_seen,
				self.name_prefix       := left.clean_contact_name.title,
				self.name_first        := left.clean_contact_name.fname,
				self.name_middle       := left.clean_contact_name.mname,
				self.name_last         := left.clean_contact_name.lname,
				self.name_suffix       := left.clean_contact_name.name_suffix,
				self.position_title    := 'Liquor License Contact',
				self := []));		
				
		combined_extracts :=
			extract_ct +
			extract_tx_1 + extract_tx_2 +
			extract_pa +
			extract_oh +
			extract_la +
			extract_in;
		
		return combined_extracts(name_last != '');
		
	end;	
	
end;
