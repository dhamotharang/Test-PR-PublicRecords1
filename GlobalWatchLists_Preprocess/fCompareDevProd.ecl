Import GlobalWatchLists, GlobalWatchLists_Preprocess, ut, STD;

EXPORT fCompareDevProd (string DevDate) := function
															
	//Current Production File
	ProdBase := dataset(ut.foreign_prod+'thor_data400::base::globalwatchlists',Globalwatchlists.Layout_GlobalWatchLists,flat);												
	
//New Common Base File
	DevBase := dataset('~ thor_data400::in::globalwatchlists_'+DevDate,Globalwatchlists.Layout_GlobalWatchLists,flat);
	DevBaseOFAC := dataset('~ thor_data400::in::globalwatchlists_'+DevDate+'o',Globalwatchlists.Layout_GlobalWatchLists,flat);
	
	//Compare Dev/Prod  files
	srtProdBase := sort(distribute(ProdBase,hash(pty_key,source,orig_pty_name)),pty_key,source,orig_pty_name,local);
	srtDevBase	:= sort(distribute(DevBase,hash(pty_key,source,orig_pty_name)),pty_key,source,orig_pty_name,local);
	srtDevBaseOFAC	:= sort(distribute(DevBaseOFAC,hash(pty_key,source,orig_pty_name)),pty_key,source,orig_pty_name,local);
	
	PSourceCount	:= output(table(srtProdBase(orig_pty_name <> ''), {source, count(group)}, source, few), named('ProdSourceCount'),all);
	DSourceCount	:= output(table(srtDevBase(orig_pty_name <> ''), {source, count(group)}, source, few), named('DevSourceCount'),all);
	DOFACSourceCount	:= output(table(srtDevBaseOFAC(orig_pty_name <> ''), {source, count(group)}, source, few), named('DevOFACSourceCount'),all);
	
	slim_layout	:=	RECORDOF(ProdBase)	AND NOT	[date_first_seen,date_last_seen,date_vendor_first_reported,date_vendor_last_reported,date_added_to_list,date_last_updated,effective_date,expiration_date];
	
	// Put records in the new slimmed layout and trim/upper.
	slim_layout tslim_layout(Globalwatchlists.Layout_GlobalWatchLists L) := TRANSFORM
	self.pty_key						:= ut.fnTrim2Upper(L.pty_key);
	self.source							:= ut.fnTrim2Upper(L.source);
	self.orig_pty_name			:= ut.fnTrim2Upper(L.orig_pty_name);
	self.orig_vessel_name		:= ut.fnTrim2Upper(L.orig_vessel_name);
	self.country						:= ut.fnTrim2Upper(L.country);
	self.name_type					:= ut.fnTrim2Upper(L.name_type);
	self.addr_1							:= ut.fnTrim2Upper(L.addr_1);
	self.addr_2							:= ut.fnTrim2Upper(L.addr_2);
	self.addr_3							:= ut.fnTrim2Upper(L.addr_3);
	self.addr_4							:= ut.fnTrim2Upper(L.addr_4);
	self.addr_5							:= ut.fnTrim2Upper(L.addr_5);
	self.addr_6							:= ut.fnTrim2Upper(L.addr_6);
	self.addr_7							:= ut.fnTrim2Upper(L.addr_7);
	self.addr_8							:= ut.fnTrim2Upper(L.addr_8);
	self.addr_9							:= ut.fnTrim2Upper(L.addr_9);
	self.addr_10						:= ut.fnTrim2Upper(L.addr_10);
	self.remarks_1					:= ut.fnTrim2Upper(L.remarks_1);
	self.remarks_2					:= ut.fnTrim2Upper(L.remarks_2);
	self.remarks_3					:= ut.fnTrim2Upper(L.remarks_3);
	self.remarks_4					:= ut.fnTrim2Upper(L.remarks_4);
	self.remarks_5					:= ut.fnTrim2Upper(L.remarks_5);
	self.remarks_6					:= ut.fnTrim2Upper(L.remarks_6);
	self.remarks_7					:= ut.fnTrim2Upper(L.remarks_7);
	self.remarks_8					:= ut.fnTrim2Upper(L.remarks_8);
	self.remarks_9					:= ut.fnTrim2Upper(L.remarks_9);
	self.remarks_10					:= ut.fnTrim2Upper(L.remarks_10);
	self.remarks_11					:= ut.fnTrim2Upper(L.remarks_11);
	self.remarks_12					:= ut.fnTrim2Upper(L.remarks_12);
	self.remarks_13					:= ut.fnTrim2Upper(L.remarks_13);
	self.remarks_14					:= ut.fnTrim2Upper(L.remarks_14);
	self.remarks_15					:= ut.fnTrim2Upper(L.remarks_15);
	self.remarks_16					:= ut.fnTrim2Upper(L.remarks_16);
	self.remarks_17					:= ut.fnTrim2Upper(L.remarks_17);
	self.remarks_18					:= ut.fnTrim2Upper(L.remarks_18);
	self.remarks_19					:= ut.fnTrim2Upper(L.remarks_19);
	self.remarks_20					:= ut.fnTrim2Upper(L.remarks_20);
	self.remarks_21					:= ut.fnTrim2Upper(L.remarks_21);
	self.remarks_22					:= ut.fnTrim2Upper(L.remarks_22);
	self.remarks_23					:= ut.fnTrim2Upper(L.remarks_23);
	self.remarks_24					:= ut.fnTrim2Upper(L.remarks_24);
	self.remarks_25					:= ut.fnTrim2Upper(L.remarks_25);
	self.remarks_26					:= ut.fnTrim2Upper(L.remarks_26);
	self.remarks_27					:= ut.fnTrim2Upper(L.remarks_27);
	self.remarks_28					:= ut.fnTrim2Upper(L.remarks_28);
	self.remarks_29					:= ut.fnTrim2Upper(L.remarks_29);
	self.remarks_30					:= ut.fnTrim2Upper(L.remarks_30);
	self.cname							:= ut.fnTrim2Upper(L.cname);
	self.entity_id					:= ut.fnTrim2Upper(L.entity_id);
	self.first_name					:= ut.fnTrim2Upper(L.first_name);
	self.last_name					:= ut.fnTrim2Upper(L.last_name);
	self.title_1						:= ut.fnTrim2Upper(L.title_1);
	self.title_2						:= ut.fnTrim2Upper(L.title_2);
	self.title_3						:= ut.fnTrim2Upper(L.title_3);
	self.title_4						:= ut.fnTrim2Upper(L.title_4);
	self.title_5						:= ut.fnTrim2Upper(L.title_5);
	self.title_6						:= ut.fnTrim2Upper(L.title_6);
	self.title_7						:= ut.fnTrim2Upper(L.title_7);
	self.title_8						:= ut.fnTrim2Upper(L.title_8);
	self.title_9						:= ut.fnTrim2Upper(L.title_9);
	self.title_10						:= ut.fnTrim2Upper(L.title_10);
	self.aka_id							:= ut.fnTrim2Upper(L.aka_id);
 	self.aka_type						:= ut.fnTrim2Upper(L.aka_type);
 	self.aka_category				:= ut.fnTrim2Upper(L.aka_category);
	self.giv_designator			:= ut.fnTrim2Upper(L.giv_designator);
	self.entity_type				:= ut.fnTrim2Upper(L.entity_type);
	self.address_id					:= ut.fnTrim2Upper(L.address_id);
	self.address_line_1			:= ut.fnTrim2Upper(L.address_line_1);
	self.address_line_2			:= ut.fnTrim2Upper(L.address_line_2);
	self.address_line_3			:= ut.fnTrim2Upper(L.address_line_3);
 	self.address_city				:= ut.fnTrim2Upper(L.address_city);
	self.address_state_province	:= ut.fnTrim2Upper(L.address_state_province);
	self.address_postal_code		:= ut.fnTrim2Upper(L.address_postal_code);
 	self.address_country		:= ut.fnTrim2Upper(L.address_country);
 	self.remarks						:= ut.fnTrim2Upper(L.remarks);
	self.call_sign					:= ut.fnTrim2Upper(L.call_sign);
 	self.vessel_type				:= ut.fnTrim2Upper(L.vessel_type);
	self.tonnage						:= ut.fnTrim2Upper(L.tonnage);
	self.gross_registered_tonnage	:= ut.fnTrim2Upper(L.gross_registered_tonnage);
 	self.vessel_flag				:= ut.fnTrim2Upper(L.vessel_flag);
	self.vessel_owner				:= ut.fnTrim2Upper(L.vessel_owner);
	self.sanctions_program_1	:= ut.fnTrim2Upper(L.sanctions_program_1);
	self.sanctions_program_2	:= ut.fnTrim2Upper(L.sanctions_program_2);
	self.sanctions_program_3	:= ut.fnTrim2Upper(L.sanctions_program_3);
	self.sanctions_program_4	:= ut.fnTrim2Upper(L.sanctions_program_4);
	self.sanctions_program_5	:= ut.fnTrim2Upper(L.sanctions_program_5);
	self.sanctions_program_6	:= ut.fnTrim2Upper(L.sanctions_program_6);
	self.sanctions_program_7	:= ut.fnTrim2Upper(L.sanctions_program_7);
	self.sanctions_program_8	:= ut.fnTrim2Upper(L.sanctions_program_8);
	self.sanctions_program_9	:= ut.fnTrim2Upper(L.sanctions_program_9);
	self.sanctions_program_10	:= ut.fnTrim2Upper(L.sanctions_program_10);
	self.passport_details			:= ut.fnTrim2Upper(L.passport_details);
	self.ni_number_details		:= ut.fnTrim2Upper(L.ni_number_details);
	self.id_id_1							:= ut.fnTrim2Upper(L.id_id_1);
	self.id_id_2							:= ut.fnTrim2Upper(L.id_id_2);
	self.id_id_3							:= ut.fnTrim2Upper(L.id_id_3);
	self.id_id_4							:= ut.fnTrim2Upper(L.id_id_4);
	self.id_id_5							:= ut.fnTrim2Upper(L.id_id_5);
	self.id_id_6							:= ut.fnTrim2Upper(L.id_id_6);
	self.id_id_7							:= ut.fnTrim2Upper(L.id_id_7);
	self.id_id_8							:= ut.fnTrim2Upper(L.id_id_8);
	self.id_id_9							:= ut.fnTrim2Upper(L.id_id_9);
	self.id_id_10							:= ut.fnTrim2Upper(L.id_id_10);
	self.id_type_1						:= ut.fnTrim2Upper(L.id_type_1);
	self.id_type_2						:= ut.fnTrim2Upper(L.id_type_2);
	self.id_type_3						:= ut.fnTrim2Upper(L.id_type_3);
	self.id_type_4						:= ut.fnTrim2Upper(L.id_type_4);
	self.id_type_5						:= ut.fnTrim2Upper(L.id_type_5);
	self.id_type_6						:= ut.fnTrim2Upper(L.id_type_6);
	self.id_type_7						:= ut.fnTrim2Upper(L.id_type_7);
	self.id_type_8						:= ut.fnTrim2Upper(L.id_type_8);
	self.id_type_9						:= ut.fnTrim2Upper(L.id_type_9);
	self.id_type_10						:= ut.fnTrim2Upper(L.id_type_10);
 	self.id_number_1					:= ut.fnTrim2Upper(L.id_number_1);
 	self.id_number_2					:= ut.fnTrim2Upper(L.id_number_2);
 	self.id_number_3					:= ut.fnTrim2Upper(L.id_number_3);
 	self.id_number_4					:= ut.fnTrim2Upper(L.id_number_4);
 	self.id_number_5					:= ut.fnTrim2Upper(L.id_number_5);
 	self.id_number_6					:= ut.fnTrim2Upper(L.id_number_6);
 	self.id_number_7					:= ut.fnTrim2Upper(L.id_number_7);
 	self.id_number_8					:= ut.fnTrim2Upper(L.id_number_8);
 	self.id_number_9					:= ut.fnTrim2Upper(L.id_number_9);
 	self.id_number_10					:= ut.fnTrim2Upper(L.id_number_10);
 	self.id_country_1					:= ut.fnTrim2Upper(L.id_country_1);
 	self.id_country_2					:= ut.fnTrim2Upper(L.id_country_2);
 	self.id_country_3					:= ut.fnTrim2Upper(L.id_country_3);
 	self.id_country_4					:= ut.fnTrim2Upper(L.id_country_4);
 	self.id_country_5					:= ut.fnTrim2Upper(L.id_country_5);
 	self.id_country_6					:= ut.fnTrim2Upper(L.id_country_6);
 	self.id_country_7					:= ut.fnTrim2Upper(L.id_country_7);
 	self.id_country_8					:= ut.fnTrim2Upper(L.id_country_8);
 	self.id_country_9					:= ut.fnTrim2Upper(L.id_country_9);
 	self.id_country_10				:= ut.fnTrim2Upper(L.id_country_10);
	self.id_issue_date_1			:= ut.fnTrim2Upper(L.id_issue_date_1);
	self.id_issue_date_2			:= ut.fnTrim2Upper(L.id_issue_date_2);
	self.id_issue_date_3			:= ut.fnTrim2Upper(L.id_issue_date_3);
	self.id_issue_date_4			:= ut.fnTrim2Upper(L.id_issue_date_4);
	self.id_issue_date_5			:= ut.fnTrim2Upper(L.id_issue_date_5);
	self.id_issue_date_6			:= ut.fnTrim2Upper(L.id_issue_date_6);
	self.id_issue_date_7			:= ut.fnTrim2Upper(L.id_issue_date_7);
	self.id_issue_date_8			:= ut.fnTrim2Upper(L.id_issue_date_8);
	self.id_issue_date_9			:= ut.fnTrim2Upper(L.id_issue_date_9);
	self.id_issue_date_10			:= ut.fnTrim2Upper(L.id_issue_date_10);
	self.id_expiration_date_1	:= ut.fnTrim2Upper(L.id_expiration_date_1);
	self.id_expiration_date_2	:= ut.fnTrim2Upper(L.id_expiration_date_2);
	self.id_expiration_date_3	:= ut.fnTrim2Upper(L.id_expiration_date_3);
	self.id_expiration_date_4	:= ut.fnTrim2Upper(L.id_expiration_date_4);
	self.id_expiration_date_5	:= ut.fnTrim2Upper(L.id_expiration_date_5);
	self.id_expiration_date_6	:= ut.fnTrim2Upper(L.id_expiration_date_6);
	self.id_expiration_date_7	:= ut.fnTrim2Upper(L.id_expiration_date_7);
	self.id_expiration_date_8	:= ut.fnTrim2Upper(L.id_expiration_date_8);
	self.id_expiration_date_9	:= ut.fnTrim2Upper(L.id_expiration_date_9);
	self.id_expiration_date_10	:= ut.fnTrim2Upper(L.id_expiration_date_10);
	self.nationality_id_1			:= ut.fnTrim2Upper(L.nationality_id_1);
	self.nationality_id_2			:= ut.fnTrim2Upper(L.nationality_id_2);
	self.nationality_id_3			:= ut.fnTrim2Upper(L.nationality_id_3);
	self.nationality_id_4			:= ut.fnTrim2Upper(L.nationality_id_4);
	self.nationality_id_5			:= ut.fnTrim2Upper(L.nationality_id_5);
	self.nationality_id_6			:= ut.fnTrim2Upper(L.nationality_id_6);
	self.nationality_id_7			:= ut.fnTrim2Upper(L.nationality_id_7);
	self.nationality_id_8			:= ut.fnTrim2Upper(L.nationality_id_8);
	self.nationality_id_9			:= ut.fnTrim2Upper(L.nationality_id_9);
	self.nationality_id_10		:= ut.fnTrim2Upper(L.nationality_id_10);
 	self.nationality_1				:= ut.fnTrim2Upper(L.nationality_1);
 	self.nationality_2				:= ut.fnTrim2Upper(L.nationality_2);
 	self.nationality_3				:= ut.fnTrim2Upper(L.nationality_3);
 	self.nationality_4				:= ut.fnTrim2Upper(L.nationality_4);
 	self.nationality_5				:= ut.fnTrim2Upper(L.nationality_5);
 	self.nationality_6				:= ut.fnTrim2Upper(L.nationality_6);
 	self.nationality_7				:= ut.fnTrim2Upper(L.nationality_7);
 	self.nationality_8				:= ut.fnTrim2Upper(L.nationality_8);
 	self.nationality_9				:= ut.fnTrim2Upper(L.nationality_9);
 	self.nationality_10				:= ut.fnTrim2Upper(L.nationality_10);
	self.citizenship_id_1			:= ut.fnTrim2Upper(L.citizenship_id_1);
	self.citizenship_id_2			:= ut.fnTrim2Upper(L.citizenship_id_2);
	self.citizenship_id_3			:= ut.fnTrim2Upper(L.citizenship_id_3);
	self.citizenship_id_4			:= ut.fnTrim2Upper(L.citizenship_id_4);
	self.citizenship_id_5			:= ut.fnTrim2Upper(L.citizenship_id_5);
	self.citizenship_id_6			:= ut.fnTrim2Upper(L.citizenship_id_6);
	self.citizenship_id_7			:= ut.fnTrim2Upper(L.citizenship_id_7);
	self.citizenship_id_8			:= ut.fnTrim2Upper(L.citizenship_id_8);
	self.citizenship_id_9			:= ut.fnTrim2Upper(L.citizenship_id_9);
	self.citizenship_id_10		:= ut.fnTrim2Upper(L.citizenship_id_10);
 	self.citizenship_1				:= ut.fnTrim2Upper(L.citizenship_1);
 	self.citizenship_2				:= ut.fnTrim2Upper(L.citizenship_2);
 	self.citizenship_3				:= ut.fnTrim2Upper(L.citizenship_3);
 	self.citizenship_4				:= ut.fnTrim2Upper(L.citizenship_4);
 	self.citizenship_5				:= ut.fnTrim2Upper(L.citizenship_5);
 	self.citizenship_6				:= ut.fnTrim2Upper(L.citizenship_6);
 	self.citizenship_7				:= ut.fnTrim2Upper(L.citizenship_7);
 	self.citizenship_8				:= ut.fnTrim2Upper(L.citizenship_8);
 	self.citizenship_9				:= ut.fnTrim2Upper(L.citizenship_9);
 	self.citizenship_10				:= ut.fnTrim2Upper(L.citizenship_10);
	self.pob_1								:= ut.fnTrim2Upper(L.pob_1);
	self.pob_2								:= ut.fnTrim2Upper(L.pob_2);
	self.pob_3								:= ut.fnTrim2Upper(L.pob_3);
	self.pob_4								:= ut.fnTrim2Upper(L.pob_4);
	self.pob_5								:= ut.fnTrim2Upper(L.pob_5);
	self.pob_6								:= ut.fnTrim2Upper(L.pob_6);
	self.pob_7								:= ut.fnTrim2Upper(L.pob_7);
	self.pob_8								:= ut.fnTrim2Upper(L.pob_8);
	self.pob_9								:= ut.fnTrim2Upper(L.pob_9);
	self.pob_10								:= ut.fnTrim2Upper(L.pob_10);
 	self.country_of_birth_1		:= ut.fnTrim2Upper(L.country_of_birth_1);
 	self.country_of_birth_2		:= ut.fnTrim2Upper(L.country_of_birth_2);
 	self.country_of_birth_3		:= ut.fnTrim2Upper(L.country_of_birth_3);
 	self.country_of_birth_4		:= ut.fnTrim2Upper(L.country_of_birth_4);
 	self.country_of_birth_5		:= ut.fnTrim2Upper(L.country_of_birth_5);
 	self.country_of_birth_6		:= ut.fnTrim2Upper(L.country_of_birth_6);
 	self.country_of_birth_7		:= ut.fnTrim2Upper(L.country_of_birth_7);
 	self.country_of_birth_8		:= ut.fnTrim2Upper(L.country_of_birth_8);
 	self.country_of_birth_9		:= ut.fnTrim2Upper(L.country_of_birth_9);
 	self.country_of_birth_10	:= ut.fnTrim2Upper(L.country_of_birth_10);
	self.language_1						:= ut.fnTrim2Upper(L.language_1);
	self.language_2						:= ut.fnTrim2Upper(L.language_2);
	self.language_3						:= ut.fnTrim2Upper(L.language_3);
	self.language_4						:= ut.fnTrim2Upper(L.language_4);
	self.language_5						:= ut.fnTrim2Upper(L.language_5);
	self.language_6						:= ut.fnTrim2Upper(L.language_6);
	self.language_7						:= ut.fnTrim2Upper(L.language_7);
	self.language_8						:= ut.fnTrim2Upper(L.language_8);
	self.language_9						:= ut.fnTrim2Upper(L.language_9);
	self.language_10					:= ut.fnTrim2Upper(L.language_10);
	self.membership_1					:= ut.fnTrim2Upper(L.membership_1);
	self.membership_2					:= ut.fnTrim2Upper(L.membership_2);
	self.membership_3					:= ut.fnTrim2Upper(L.membership_3);
	self.membership_4					:= ut.fnTrim2Upper(L.membership_4);
	self.membership_5					:= ut.fnTrim2Upper(L.membership_5);
	self.membership_6					:= ut.fnTrim2Upper(L.membership_6);
	self.membership_7					:= ut.fnTrim2Upper(L.membership_7);
	self.membership_8					:= ut.fnTrim2Upper(L.membership_8);
	self.membership_9					:= ut.fnTrim2Upper(L.membership_9);
	self.membership_10				:= ut.fnTrim2Upper(L.membership_10);
	self.position_1						:= ut.fnTrim2Upper(L.position_1);
	self.position_2						:= ut.fnTrim2Upper(L.position_2);
	self.position_3						:= ut.fnTrim2Upper(L.position_3);
	self.position_4						:= ut.fnTrim2Upper(L.position_4);
	self.position_5						:= ut.fnTrim2Upper(L.position_5);
	self.position_6						:= ut.fnTrim2Upper(L.position_6);
	self.position_7						:= ut.fnTrim2Upper(L.position_7);
	self.position_8						:= ut.fnTrim2Upper(L.position_8);
	self.position_9						:= ut.fnTrim2Upper(L.position_9);
	self.position_10					:= ut.fnTrim2Upper(L.position_10);
	self.occupation_1					:= ut.fnTrim2Upper(L.occupation_1);
	self.occupation_2					:= ut.fnTrim2Upper(L.occupation_2);
	self.occupation_3					:= ut.fnTrim2Upper(L.occupation_3);
	self.occupation_4					:= ut.fnTrim2Upper(L.occupation_4);
	self.occupation_5					:= ut.fnTrim2Upper(L.occupation_5);
	self.occupation_6					:= ut.fnTrim2Upper(L.occupation_6);
	self.occupation_7					:= ut.fnTrim2Upper(L.occupation_7);
	self.occupation_8					:= ut.fnTrim2Upper(L.occupation_8);
	self.occupation_9					:= ut.fnTrim2Upper(L.occupation_9);
	self.occupation_10				:= ut.fnTrim2Upper(L.occupation_10);
 	self.gender								:= ut.fnTrim2Upper(L.gender);
 	self.grounds							:= ut.fnTrim2Upper(L.grounds);
 	self.federal_register_citation_1	:= ut.fnTrim2Upper(L.federal_register_citation_1);
 	self.federal_register_citation_2	:= ut.fnTrim2Upper(L.federal_register_citation_2);
 	self.federal_register_citation_3	:= ut.fnTrim2Upper(L.federal_register_citation_3);
 	self.federal_register_citation_4	:= ut.fnTrim2Upper(L.federal_register_citation_4);
 	self.federal_register_citation_5	:= ut.fnTrim2Upper(L.federal_register_citation_5);
 	self.federal_register_citation_6	:= ut.fnTrim2Upper(L.federal_register_citation_6);
 	self.federal_register_citation_7	:= ut.fnTrim2Upper(L.federal_register_citation_7);
 	self.federal_register_citation_8	:= ut.fnTrim2Upper(L.federal_register_citation_8);
 	self.federal_register_citation_9	:= ut.fnTrim2Upper(L.federal_register_citation_9);
 	self.federal_register_citation_10	:= ut.fnTrim2Upper(L.federal_register_citation_10);
	self.federal_register_citation_date_1	:= ut.fnTrim2Upper(L.federal_register_citation_date_1);
	self.federal_register_citation_date_2	:= ut.fnTrim2Upper(L.federal_register_citation_date_2);
	self.federal_register_citation_date_3	:= ut.fnTrim2Upper(L.federal_register_citation_date_3);
	self.federal_register_citation_date_4	:= ut.fnTrim2Upper(L.federal_register_citation_date_4);
	self.federal_register_citation_date_5	:= ut.fnTrim2Upper(L.federal_register_citation_date_5);
	self.federal_register_citation_date_6	:= ut.fnTrim2Upper(L.federal_register_citation_date_6);
	self.federal_register_citation_date_7	:= ut.fnTrim2Upper(L.federal_register_citation_date_7);
	self.federal_register_citation_date_8	:= ut.fnTrim2Upper(L.federal_register_citation_date_8);
	self.federal_register_citation_date_9	:= ut.fnTrim2Upper(L.federal_register_citation_date_9);
	self.federal_register_citation_date_10	:= ut.fnTrim2Upper(L.federal_register_citation_date_10);
 	self.license_requirement					:= ut.fnTrim2Upper(L.license_requirement);
	self.license_review_policy				:= ut.fnTrim2Upper(L.license_review_policy);
	self.subordinate_status						:= ut.fnTrim2Upper(L.subordinate_status);
	self.physique											:= ut.fnTrim2Upper(L.physique);
 	self.hair_color										:= ut.fnTrim2Upper(L.hair_color);
 	self.eyes													:= ut.fnTrim2Upper(L.eyes);
	self.complexion										:= ut.fnTrim2Upper(L.complexion);
 	self.race													:= ut.fnTrim2Upper(L.race);
 	self.scars_marks									:= ut.fnTrim2Upper(L.scars_marks);
	self.photo_file										:= ut.fnTrim2Upper(L.photo_file);
 	self.offenses											:= ut.fnTrim2Upper(L.offenses);
	self.ncic													:= ut.fnTrim2Upper(L.ncic);
	self.warrant_by										:= ut.fnTrim2Upper(L.warrant_by);
	self.caution											:= ut.fnTrim2Upper(L.caution);
	self.reward												:= ut.fnTrim2Upper(L.reward);
	self.type_of_denial								:= ut.fnTrim2Upper(L.type_of_denial);
	self.linked_with_1								:= ut.fnTrim2Upper(L.linked_with_1);
	self.linked_with_2								:= ut.fnTrim2Upper(L.linked_with_2);
	self.linked_with_3								:= ut.fnTrim2Upper(L.linked_with_3);
	self.linked_with_4								:= ut.fnTrim2Upper(L.linked_with_4);
	self.linked_with_5								:= ut.fnTrim2Upper(L.linked_with_5);
	self.linked_with_6								:= ut.fnTrim2Upper(L.linked_with_6);
	self.linked_with_7								:= ut.fnTrim2Upper(L.linked_with_7);
	self.linked_with_8								:= ut.fnTrim2Upper(L.linked_with_8);
	self.linked_with_9								:= ut.fnTrim2Upper(L.linked_with_9);
	self.linked_with_10								:= ut.fnTrim2Upper(L.linked_with_10);
 	self.linked_with_id_1							:= ut.fnTrim2Upper(L.linked_with_id_1);
 	self.linked_with_id_2							:= ut.fnTrim2Upper(L.linked_with_id_2);
 	self.linked_with_id_3							:= ut.fnTrim2Upper(L.linked_with_id_3);
 	self.linked_with_id_4							:= ut.fnTrim2Upper(L.linked_with_id_4);
 	self.linked_with_id_5							:= ut.fnTrim2Upper(L.linked_with_id_5);
 	self.linked_with_id_6							:= ut.fnTrim2Upper(L.linked_with_id_6);
 	self.linked_with_id_7							:= ut.fnTrim2Upper(L.linked_with_id_7);
 	self.linked_with_id_8							:= ut.fnTrim2Upper(L.linked_with_id_8);
 	self.linked_with_id_9							:= ut.fnTrim2Upper(L.linked_with_id_9);
 	self.linked_with_id_10						:= ut.fnTrim2Upper(L.linked_with_id_10);
	self.listing_information					:= ut.fnTrim2Upper(L.listing_information);
	self.foreign_principal						:= ut.fnTrim2Upper(L.foreign_principal);
 	self.nature_of_service						:= ut.fnTrim2Upper(L.nature_of_service);
	self.activities										:= ut.fnTrim2Upper(L.activities);
	self.finances											:= ut.fnTrim2Upper(L.finances);
	self															:=	L;
	END;

	out_GWLDiff := RECORD
		slim_layout;
		STRING100 diff1;
		STRING100 diff2;
	END;

	out_GWLDiff tGWLDiff(slim_layout L, slim_layout R) := TRANSFORM
		SELF.diff1	:=	ROWDIFF(L,R);
		SELF.diff2	:=	ROWDIFF(L, R, COUNT);
		SELF				:=	L;
	END;

	DiffResult	:=	JOIN(PROJECT(srtDevBase, tslim_layout(LEFT),LOCAL), 
												PROJECT(srtProdBase, tslim_layout(LEFT),LOCAL),
												left.source = right.source AND
												left.orig_pty_name[1..15]	= right.orig_pty_name[1..15] AND
												left.address_line_1 = right.address_line_1 AND
												left.address_line_2 = right.address_line_2,
												tGWLDiff(LEFT,RIGHT),LOCAL);	
	
	t_GWLDiff		:=	OUTPUT(CHOOSEN(SORT(TABLE(DiffResult(diff1<>''),{source, diff1, cnt := COUNT(GROUP)}, source, diff1, FEW), -cnt),1000),NAMED('Table_GWLDIFF_results'));
	s_GWLDiff		:=	OUTPUT(DEDUP(SORT(DISTRIBUTE(DiffResult(diff1<>''),HASH(diff1)),source,orig_pty_name,LOCAL),record,LOCAL),NAMED('Sample_GWLDIFF_results'));
	
	PRecCount := output(count(srtProdBase(orig_pty_name <> '')),named('ProdRecordCount'));
	DRecCount := output(count(srtDevBaseOFAC(orig_pty_name <> '')),named('DevRecordCount'));
	
	result	:=	SEQUENTIAL(PSourceCount,DSourceCount,DOFACSourceCount, t_GWLDiff,s_GWLDiff,PRecCount,DRecCount);
												
	return result;
end;