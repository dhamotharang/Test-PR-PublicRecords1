/* --------------------------------------------------------------------------------
First run PRTE2_Email_Data_Ins.U_CheckKeys1_Save_w_DID_First, copy a bunch of sample DIDs
 Need to do that paste those sample DIDs into the set below
 -------------------------------------------------------------------------------- */
 
 // Just to get started I'm just checking the main did key that is created
 
IMPORT ut;

DSNAME := 'prte::key::email_data::20150820::did';

layout_clean_name := RECORD
   string5 title;
   string20 fname;
   string20 mname;
   string20 lname;
   string5 name_suffix;
   string3 name_score;
  END;

layout_clean182 := RECORD
   string10 prim_range;
   string2 predir;
   string28 prim_name;
   string4 addr_suffix;
   string2 postdir;
   string10 unit_desig;
   string8 sec_range;
   string25 p_city_name;
   string25 v_city_name;
   string2 st;
   string5 zip;
   string4 zip4;
   string4 cart;
   string1 cr_sort_sz;
   string4 lot;
   string1 lot_order;
   string2 dbpc;
   string1 chk_digit;
   string2 rec_type;
   string5 county;
   string10 geo_lat;
   string11 geo_long;
   string4 msa;
   string7 geo_blk;
   string1 geo_match;
   string4 err_stat;
  END;

DidSetLayout := RECORD
  unsigned6 did;
END;
Layout_In_EclWatch := RECORD
  // unsigned6 did;
  string200 clean_email;
  string100 append_email_username;
  string120 append_domain;
  string12 append_domain_type;
  string100 append_domain_root;
  string20 append_domain_ext;
  boolean append_is_tld_state;
  boolean append_is_tld_generic;
  boolean append_is_tld_country;
  boolean append_is_valid_domain_ext;
  unsigned8 email_rec_key;
  string2 email_src;
  unsigned8 rec_src_all;
  unsigned8 email_src_all;
  unsigned8 email_src_num;
  unsigned8 num_email_per_did;
  unsigned8 num_did_per_email;
  string orig_pmghousehold_id;
  string orig_pmgindividual_id;
  string orig_first_name;
  string orig_last_name;
  string orig_address;
  string orig_city;
  string orig_state;
  string orig_zip;
  string orig_zip4;
  string orig_email;
  string orig_ip;
  string orig_login_date;
  string orig_site;
  string orig_e360_id;
  string orig_teramedia_id;
  unsigned8 did_score;
  string10 did_type;
  boolean is_did_prop;
  unsigned8 hhid;
  layout_clean_name clean_name;
  layout_clean182 clean_address;
  unsigned8 append_rawaid;
  string9 best_ssn;
  unsigned4 best_dob;
  string8 process_date;
  string1 activecode;
  string8 date_first_seen;
  string8 date_last_seen;
  string8 date_vendor_first_reported;
  string8 date_vendor_last_reported;
  boolean current_rec;
  unsigned8 __internal_fpos__;
 END;

IndexFields := RECORD
	unsigned6 did;
END;
prct_data_key := INDEX({IndexFields}, Layout_In_EclWatch, ut.foreign_prod+DSNAME);

did_lst_0 := [
103070,     //103070
109011,     //109011
173116,     //173116
183389,     //183389
215894,     //215894
250005,     //250005
888809036541,
888809039568,
888809053392,
888809045641,
888809031081,
888809046171,
888809046028,
888809049708,
888809000095,
888809000000,
888809000001,
888809000002,
888809000096,
888809053361,
888809000097,
888809000003,
888809000098,
888809000099,
888809000100,
888809000101,
888809000102,
888809000103,
888809000104,
888809000105,
888809000106,
888809000107,
888809000108,
888809000109,
888809000110,
888809000112,
888809000113,
888809000114,
888809000115,
888809000116,
888809000117,
888809000118,
888809000119,
888809000120,
888809000004,
888809000005,
888809000006,
888809000007,
888809000121,
888809000122,
888809000123,
888809000124,
888809000126,
888809000127,
888809000128,
888809000129,
888809000130,
888809000134,
888809000131,
888809000008,
888809000135,
888809000136,
888809000137,
888809000009,
888809000132,
888809000138,
888809000133,
888809000010,
888809000011,
888809000012,
888809000013,
888809000014,
888809000015,
888809000016,
888809000017,
888809000140,
888809000018,
888809000019,
888809000141,
888809000020,
888809000021,
888809000142,
888809000143,
888809000144,
888809000022,
888809000023,
888809000024,
888809000025,
888809051288,
888809000027,
888809000028,
888809000029,
888809051322,
888809051869,
888809000145,
888809000146,
888809000148,
888809000147,
888809000032,
888809000033,
888809000151,
888809000034,
888809000035,
888809000036,
888809000149,
888809000152,
888809000037,
888809000153,
888809000154,
888809000038,
888809000156,
888809000157,
888809000158,
888809000159,
888809000160,
888809000161,
888809000162,
888809000163,
888809000164,
888809000165,
888809051438,
888809000167,
888809000168,
888809000169,
888809000170,
888809000171,
888809000172,
888809000173,
888809000174,
888809000175,
888809000183,
888809000176,
888809000185,
888809000177,
888809000179,
888809000180,
888809000181,
888809000186,
888809000187,
888809000039,
888809000188,
888809000189,
888809000190,
888809000191,
888809000192,
888809000195,
888809000198,
888809000199,
888809000197,
888809000193,
888809000200,
888809000201,
888809000202,
888809000203,
888809000204,
888809000205,
888809000194,
888809000206,
888809000207,
888809000208,
888809000209,
888809000210,
888809000211,
888809000212,
888809000213,
888809000214,
888809000215,
888809000216,
888809000217,
888809000218,
888809000040,
888809000219,
888809000220,
888809000221,
888809000222,
888809000223,
888809000224,
888809000226,
888809000225,
888809000227,
888809000228,
888809000041,
888809000042,
888809000230,
888809000231,
888809000232,
888809000244,
888809000245,
888809000234,
888809000235,
888809000236,
888809049120,
888809049121,
888809049123,
888809049124,
888809049125,
888809051974,
888809049126,
888809049128,
888809049129,
888809049130,
888809049131,
888809051180,
888809049132,
888809049134,
888809049136,
888809049137,
888809049138,
888809049139,
888809049140,
888809049141,
888809049142,
888809049143,
888809049145,
888809049146,
888809049147,
888809049148,
888809049149,
888809049150,
888809049151,
888809049152,
888809049153,
888809049154,
888809049155,
888809049156,
888809049157,
888809051126,
888809051424,
888809049160,
888809049161,
888809049162,
888809049163,
888809049165,
888809049166,
888809049167,
888809049169,
888809049170,
888809053911,
888809049174,
888809049175,
888809049176,
888809049177,
888809050670,
888809049180,
888809049181,
888809049182,
888809049183,
888809049184,
888809049185,
888809049186,
888809049187,
888809049188,
888809049189,
888809049190,
888809049192,
888809049193,
888809049194,
888809049196,
888809053688,
888809049197,
888809049199,
888809049200,
888809049201,
888809049202,
888809049203,
888809049204,
888809049205,
888809049206,
888809049207,
888809049208,
888809049209,
888809049210,
888809049211,
888809049212,
888809049213,
888809049214,
888809049215,
888809049217,
888809049218,
888809049219,
888809049220,
888809049221,
888809049222,
888809049223,
888809049224,
888809049225,
888809049226,
888809049227,
888809050582,
888809049228,
888809049230,
888809049231,
888809049233,
888809051307,
888809049235,
888809051870,
888809049236,
888809049238,
888809049239,
888809049240,
888809049241,
888809049242,
888809049243,
888809049244,
888809049245,
888809049246,
888809049247,
888809049248,
888809049249,
888809049250,
888809049251,
888809049252,
888809049253,
888809049254,
888809049255,
888809049256,
888809049257,
888809049258,
888809049259,
888809049260,
888809049261,
888809049262,
888809051557,
888809050928,
888809051606,
888809050387,
888809053238,
888809049264,
888809049270,
888809049271,
888809049272,
888809049274,
888809051260,
888809049276,
888809049277,
888809049278,
888809049279,
888809049280,
888809049281,
888809049282,
888809049283,
888809049284,
888809049285,
888809050996,
888809049287,
888809049288,
888809049289,
888809049290,
888809049291,
888809049292,
888809049294,
888809049295,
888809049296,
888809050945,
888809049297,
888809050820,
888809049300,
888809049301,
888809050169,
888809049302,
888809049304,
888809049305,
888809049307,
888809049308,
888809049309,
888809049310,
888809049311,
888809051562,
888809049313,
888809049315,
888809049316,
888809049317,
888809049318,
888809049319,
888809049320,
888809049322,
888809051571,
888809049324,
888809049325,
888809049326,
888809049327,
888809049328,
888809049329,
888809049330,
888809049331,
888809049332,
888809049333,
888809049334,
888809049336,
888809050641,
888809049339,
888809049683,
888809049340,
888809049341,
888809049342,
888809049343,
888809049344,
888809049346,
888809049347,
888809049348,
888809050773,
888809049349,
888809049350,
888809049351,
888809049352,
888809049353,
888809049355,
888809049356,
888809049357,
888809049358,
888809049359,
888809049360,
888809049362,
888809049363,
888809049364,
888809049365,
888809049366,
888809049367,
888809049368,
888809049369,
888809049370,
888809049371,
888809049372,
888809049373,
888809049374,
888809049375,
888809049376,
888809049377,
888809049378,
888809049379,
888809049380,
888809049381,
888809049382,
888809049383,
888809049384,
888809049385,
888809049386,
888809049387,
888809049388,
888809049389,
888809049390,
888809049391,
888809049392,
888809049393,
888809049395,
888809049396,
888809049397,
888809049398,
888809049399,
888809049400,
888809049401,
888809050140,
888809049402,
888809049403,
888809049404,
888809049405,
888809049406,
888809049407,
888809049408,
888809049409,
888809049410,
888809050692,
888809049411,
888809049412,
888809049413,
888809049414,
888809049415,
888809049416,
888809051308,
888809052440,
888809030557,
888809030557,
888809032152,
888809032152,
888809030557,
888809036587,
888809037442,
888809037442,
888809037442,
888809036587,
888809047954,
888809047954,
888809047954,
888809047954,
888809047954,
888809048592,
888809048592,
888809049361,
888809048592,
888809048592,
888809048592,
888809049361
];

DidSet_DS := DEDUP(SORT(DATASET(did_lst_0,DidSetLayout),did),did);
did_lst := SET(DidSet_DS,did);

FoundDS := DEDUP(SORT(prct_data_key(did in did_lst),did),did);
foundSet := SET(FoundDS,did);
notFound := DidSet_DS(did not in foundSet);
Count1 := COUNT(did_lst);
Count2 := COUNT(FoundDS);
Count3 := COUNT(prct_data_key);
Count4 := COUNT(notFound);

// ----------------------------------------------------------------
OUTPUT('Counts '+count1+' / '+count2+' / '+count3+' / '+count4);
// The above line count1 should = count2 and count4 should be zero
// ----------------------------------------------------------------

OUTPUT(FoundDS);
OUTPUT(notFound);
