//This is the code to execute in a builder window
#OPTION('multiplePersistInstances', FALSE);
#workunit('name','Scrubs_bk_search.BWR_Hygiene - Hygiene & Stats - SALT V3.3.2');
IMPORT Scrubs_bk_search,SALT33;
// First create an instantiated hygiene module
  infile := Scrubs_bk_search.In_bk_search;
  ip := DISTRIBUTE(infile, SKEW(0.1));
  h := Scrubs_bk_search.Hygiene(ip);
  p := h.AllProfiles; // Detailed profile of every field
  OUTPUT(h.Summary('SummaryReport'),ALL);
  OUTPUT(h.SourceCounts,ALL,NAMED('SourceCounts'));
  OUTPUT(h.CrossLinkingPotential,ALL,NAMED('CrossLinkingPotential'));
  OUTPUT(h.invSummary,NAMED('InvertedSummary'),ALL);
  OUTPUT(p,NAMED('AllProfiles'),ALL); // Detailed profile of every field
  OUTPUT(h.Correlations,NAMED('Correlations'),ALL); // Which fields are related to which other fields
  OUTPUT(h.ValidityErrors,NAMED('ValidityErrors'),ALL); // Violations of FieldType statements
  OUTPUT(SALT33.MAC_Character_Counts.EclRecord(p,'Layout_bk_search'),NAMED('OptimizedLayout'));// File layout suggested by data
  // Produces field types that match the most common 99.9% of your data. Change to 100 to match all your data
  OUTPUT(SALT33.MAC_Character_Counts.FieldTypes(p,99.9),NAMED('Types'));
  // ****** Cross Tabs *******
  // It is possible to create a cross table between any two fields, see documentation on SALT33.MAC_CrossTab
  // These commented out lines will create crosstabs from the sourcefield to each individual field
  // IF you find yourself using ALL of these a LOT - let me know, I can make the 'all' case faster
   Examples := 10;
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,process_date,Examples),NAMED('process_dateBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,caseid,Examples),NAMED('caseidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,defendantid,Examples),NAMED('defendantidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,recid,Examples),NAMED('recidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,tmsid,Examples),NAMED('tmsidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,seq_number,Examples),NAMED('seq_numberBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,court_code,Examples),NAMED('court_codeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,case_number,Examples),NAMED('case_numberBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_case_number,Examples),NAMED('orig_case_numberBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,chapter,Examples),NAMED('chapterBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,filing_type,Examples),NAMED('filing_typeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,business_flag,Examples),NAMED('business_flagBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,corp_flag,Examples),NAMED('corp_flagBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,discharged,Examples),NAMED('dischargedBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,disposition,Examples),NAMED('dispositionBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,pro_se_ind,Examples),NAMED('pro_se_indBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,converted_date,Examples),NAMED('converted_dateBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_county,Examples),NAMED('orig_countyBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,debtor_type,Examples),NAMED('debtor_typeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,debtor_seq,Examples),NAMED('debtor_seqBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ssn,Examples),NAMED('ssnBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ssnsrc,Examples),NAMED('ssnsrcBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ssnmatch,Examples),NAMED('ssnmatchBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ssnmsrc,Examples),NAMED('ssnmsrcBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,screen,Examples),NAMED('screenBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dcode,Examples),NAMED('dcodeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,disptype,Examples),NAMED('disptypeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dispreason,Examples),NAMED('dispreasonBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,statusdate,Examples),NAMED('statusdateBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,holdcase,Examples),NAMED('holdcaseBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,datevacated,Examples),NAMED('datevacatedBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,datetransferred,Examples),NAMED('datetransferredBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,activityreceipt,Examples),NAMED('activityreceiptBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,tax_id,Examples),NAMED('tax_idBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,name_type,Examples),NAMED('name_typeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_name,Examples),NAMED('orig_nameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_fname,Examples),NAMED('orig_fnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_mname,Examples),NAMED('orig_mnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_lname,Examples),NAMED('orig_lnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_name_suffix,Examples),NAMED('orig_name_suffixBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,title,Examples),NAMED('titleBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,fname,Examples),NAMED('fnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,mname,Examples),NAMED('mnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,lname,Examples),NAMED('lnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,name_suffix,Examples),NAMED('name_suffixBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,name_score,Examples),NAMED('name_scoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,cname,Examples),NAMED('cnameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_company,Examples),NAMED('orig_companyBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_addr1,Examples),NAMED('orig_addr1Bysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_addr2,Examples),NAMED('orig_addr2Bysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_city,Examples),NAMED('orig_cityBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_st,Examples),NAMED('orig_stBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_zip5,Examples),NAMED('orig_zip5Bysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_zip4,Examples),NAMED('orig_zip4Bysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_email,Examples),NAMED('orig_emailBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orig_fax,Examples),NAMED('orig_faxBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,prim_range,Examples),NAMED('prim_rangeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,predir,Examples),NAMED('predirBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,prim_name,Examples),NAMED('prim_nameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,addr_suffix,Examples),NAMED('addr_suffixBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,postdir,Examples),NAMED('postdirBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,unit_desig,Examples),NAMED('unit_desigBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,sec_range,Examples),NAMED('sec_rangeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,p_city_name,Examples),NAMED('p_city_nameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,v_city_name,Examples),NAMED('v_city_nameBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,st,Examples),NAMED('stBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,zip,Examples),NAMED('zipBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,zip4,Examples),NAMED('zip4Bysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,cart,Examples),NAMED('cartBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,cr_sort_sz,Examples),NAMED('cr_sort_szBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,lot,Examples),NAMED('lotBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,lot_order,Examples),NAMED('lot_orderBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dbpc,Examples),NAMED('dbpcBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,chk_digit,Examples),NAMED('chk_digitBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,rec_type,Examples),NAMED('rec_typeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,county,Examples),NAMED('countyBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,geo_lat,Examples),NAMED('geo_latBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,geo_long,Examples),NAMED('geo_longBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,msa,Examples),NAMED('msaBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,geo_blk,Examples),NAMED('geo_blkBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,geo_match,Examples),NAMED('geo_matchBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,err_stat,Examples),NAMED('err_statBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,phone,Examples),NAMED('phoneBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,did,Examples),NAMED('didBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,bdid,Examples),NAMED('bdidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,app_ssn,Examples),NAMED('app_ssnBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,app_tax_id,Examples),NAMED('app_tax_idBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,date_first_seen,Examples),NAMED('date_first_seenBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,date_last_seen,Examples),NAMED('date_last_seenBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,date_vendor_first_reported,Examples),NAMED('date_vendor_first_reportedBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,date_vendor_last_reported,Examples),NAMED('date_vendor_last_reportedBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,disptypedesc,Examples),NAMED('disptypedescBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,srcdesc,Examples),NAMED('srcdescBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,srcmtchdesc,Examples),NAMED('srcmtchdescBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,screendesc,Examples),NAMED('screendescBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dcodedesc,Examples),NAMED('dcodedescBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,date_filed,Examples),NAMED('date_filedBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,record_type,Examples),NAMED('record_typeBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,delete_flag,Examples),NAMED('delete_flagBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dotid,Examples),NAMED('dotidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dotscore,Examples),NAMED('dotscoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,dotweight,Examples),NAMED('dotweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,empid,Examples),NAMED('empidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,empscore,Examples),NAMED('empscoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,empweight,Examples),NAMED('empweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,powid,Examples),NAMED('powidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,powscore,Examples),NAMED('powscoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,powweight,Examples),NAMED('powweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,proxid,Examples),NAMED('proxidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,proxscore,Examples),NAMED('proxscoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,proxweight,Examples),NAMED('proxweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,seleid,Examples),NAMED('seleidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,selescore,Examples),NAMED('selescoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,seleweight,Examples),NAMED('seleweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orgid,Examples),NAMED('orgidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orgscore,Examples),NAMED('orgscoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,orgweight,Examples),NAMED('orgweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ultid,Examples),NAMED('ultidBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ultscore,Examples),NAMED('ultscoreBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,ultweight,Examples),NAMED('ultweightBysourcecode'));
  //  OUTPUT(SALT33.MAC_CrossTab(infile,sourcecode,source_rec_id,Examples),NAMED('source_rec_idBysourcecode'));
