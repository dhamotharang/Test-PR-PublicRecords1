

IMPORT VotersV2_Services,doxie;

EXPORT Transforms := MODULE

  EXPORT acct_rec := RECORD
    UNSIGNED6 vtid;
    STRING30 acctno := ''; //for batch purposes
    // String12 did;
  END;

  EXPORT Layouts.BatchOutput xfm_final(acct_rec L,layouts.SourceOutput R) := TRANSFORM
    // SELF.did := L.did;
    SELF.vtid := (STRING) L.vtid;
    SELF := R.Name;
    
    res1 := R.res;
    mail1 := R.mail;
    SELF.res_prim_range := res1.prim_range ;
    SELF.res_predir := res1.predir;
    SELF.res_prim_name := res1.prim_name;
    SELF.res_addr_suffix := res1.addr_suffix;
    SELF.res_postdir := res1.postdir;
    SELF.res_unit_desig := res1.unit_desig;
    SELF.res_sec_range := res1.sec_range;
    SELF.res_p_city_name := res1.p_city_name;
    SELF.res_v_city_name := res1.v_city_name;
    SELF.res_st := res1.st;
    SELF.res_zip5 := res1.zip5;
    SELF.res_zip4 := res1.zip4;
    SELF.res_fips_state := res1.fips_state;
    SELF.res_fips_county := res1.fips_county;
    SELF.res_county := res1.county;
    SELF.mail_prim_range := mail1.prim_range ;
    SELF.mail_predir := mail1.predir;
    SELF.mail_prim_name := mail1.prim_name;
    SELF.mail_addr_suffix := mail1.addr_suffix;
    SELF.mail_postdir := mail1.postdir;
    SELF.mail_unit_desig := mail1.unit_desig;
    SELF.mail_sec_range := mail1.sec_range;
    SELF.mail_p_city_name := mail1.p_city_name;
    SELF.mail_v_city_name := mail1.v_city_name;
    SELF.mail_st := mail1.st;
    SELF.mail_zip5 := mail1.zip5;
    SELF.mail_zip4 := mail1.zip4;
    SELF.mail_fips_state := mail1.fips_state;
    SELF.mail_fips_county := mail1.fips_county;
    SELF.mail_county := mail1.county;
    
    hist := R.history;
    SELF.voted_year_1 := hist[1].voted_year;
    SELF.primary_1 := hist[1].primary;
    SELF.special_1_1 := hist[1].special_1;
    SELF.other_1 := hist[1].other;
    SELF.special_2_1 := hist[1].special_2;
    SELF.general_1 := hist[1].general;
    SELF.pres_1 := hist[1].pres;
    SELF.vote_date_1 := hist[1].vote_date;
    SELF.voted_year_2 := hist[2].voted_year;
    SELF.primary_2 := hist[2].primary;
    SELF.special_1_2 := hist[2].special_1;
    SELF.other_2 := hist[2].other;
    SELF.special_2_2 := hist[2].special_2;
    SELF.general_2 := hist[2].general;
    SELF.pres_2 := hist[2].pres;
    SELF.vote_date_2 := hist[2].vote_date;
    SELF.voted_year_3 := hist[3].voted_year;
    SELF.primary_3 := hist[3].primary;
    SELF.special_1_3 := hist[3].special_1;
    SELF.other_3 := hist[3].other;
    SELF.special_2_3 := hist[3].special_2;
    SELF.general_3 := hist[3].general;
    SELF.pres_3 := hist[3].pres;
    SELF.vote_date_3 := hist[3].vote_date;
    SELF.voted_year_4 := hist[4].voted_year;
    SELF.primary_4 := hist[4].primary;
    SELF.special_1_4 := hist[4].special_1;
    SELF.other_4 := hist[4].other;
    SELF.special_2_4 := hist[4].special_2;
    SELF.general_4 := hist[4].general;
    SELF.pres_4 := hist[4].pres;
    SELF.vote_date_4 := hist[4].vote_date;
    SELF.voted_year_5 := hist[5].voted_year;
    SELF.primary_5 := hist[5].primary;
    SELF.special_1_5 := hist[5].special_1;
    SELF.other_5 := hist[5].other;
    SELF.special_2_5 := hist[5].special_2;
    SELF.general_5 := hist[5].general;
    SELF.pres_5 := hist[5].pres;
    SELF.vote_date_5 := hist[5].vote_date;
    SELF.voted_year_6 := hist[6].voted_year;
    SELF.primary_6 := hist[6].primary;
    SELF.special_1_6 := hist[6].special_1;
    SELF.other_6 := hist[6].other;
    SELF.special_2_6 := hist[6].special_2;
    SELF.general_6 := hist[6].general;
    SELF.pres_6 := hist[6].pres;
    SELF.vote_date_6 := hist[6].vote_date;
    SELF.voted_year_7 := hist[7].voted_year;
    SELF.primary_7 := hist[7].primary;
    SELF.special_1_7 := hist[7].special_1;
    SELF.other_7 := hist[7].other;
    SELF.special_2_7 := hist[7].special_2;
    SELF.general_7 := hist[7].general;
    SELF.pres_7 := hist[7].pres;
    SELF.vote_date_7 := hist[7].vote_date;
    SELF.voted_year_8 := hist[8].voted_year;
    SELF.primary_8 := hist[8].primary;
    SELF.special_1_8 := hist[8].special_1;
    SELF.other_8 := hist[8].other;
    SELF.special_2_8 := hist[8].special_2;
    SELF.general_8 := hist[8].general;
    SELF.pres_8 := hist[8].pres;
    SELF.vote_date_8 := hist[8].vote_date;
    SELF.voted_year_9 := hist[9].voted_year;
    SELF.primary_9 := hist[9].primary;
    SELF.special_1_9 := hist[9].special_1;
    SELF.other_9 := hist[9].other;
    SELF.special_2_9 := hist[9].special_2;
    SELF.general_9 := hist[9].general;
    SELF.pres_9 := hist[9].pres;
    SELF.vote_date_9 := hist[9].vote_date;
    SELF.voted_year_10 := hist[10].voted_year;
    SELF.primary_10 := hist[10].primary;
    SELF.special_1_10 := hist[10].special_1;
    SELF.other_10 := hist[10].other;
    SELF.special_2_10 := hist[10].special_2;
    SELF.general_10 := hist[10].general;
    SELF.pres_10 := hist[10].pres;
    SELF.vote_date_10 := hist[10].vote_date;
    SELF.voted_year_11 := hist[11].voted_year;
    SELF.primary_11 := hist[11].primary;
    SELF.special_1_11 := hist[11].special_1;
    SELF.other_11 := hist[11].other;
    SELF.special_2_11 := hist[11].special_2;
    SELF.general_11 := hist[11].general;
    SELF.pres_11 := hist[11].pres;
    SELF.vote_date_11 := hist[11].vote_date;
    SELF.voted_year_12 := hist[12].voted_year;
    SELF.primary_12 := hist[12].primary;
    SELF.special_1_12 := hist[12].special_1;
    SELF.other_12 := hist[12].other;
    SELF.special_2_12 := hist[12].special_2;
    SELF.general_12 := hist[12].general;
    SELF.pres_12 := hist[12].pres;
    SELF.vote_date_12 := hist[12].vote_date;
    SELF.voted_year_13 := hist[13].voted_year;
    SELF.primary_13 := hist[13].primary;
    SELF.special_1_13 := hist[13].special_1;
    SELF.other_13 := hist[13].other;
    SELF.special_2_13 := hist[13].special_2;
    SELF.general_13 := hist[13].general;
    SELF.pres_13 := hist[13].pres;
    SELF.vote_date_13 := hist[13].vote_date;
    SELF.voted_year_14 := hist[14].voted_year;
    SELF.primary_14 := hist[14].primary;
    SELF.special_1_14 := hist[14].special_1;
    SELF.other_14 := hist[14].other;
    SELF.special_2_14 := hist[14].special_2;
    SELF.general_14 := hist[14].general;
    SELF.pres_14 := hist[14].pres;
    SELF.vote_date_14 := hist[14].vote_date;
    SELF.voted_year_15 := hist[15].voted_year;
    SELF.primary_15 := hist[15].primary;
    SELF.special_1_15 := hist[15].special_1;
    SELF.other_15 := hist[15].other;
    SELF.special_2_15 := hist[15].special_2;
    SELF.general_15 := hist[15].general;
    SELF.pres_15 := hist[15].pres;
    SELF.vote_date_15 := hist[15].vote_date;
    SELF.voted_year_16 := hist[16].voted_year;
    SELF.primary_16 := hist[16].primary;
    SELF.special_1_16 := hist[16].special_1;
    SELF.other_16 := hist[16].other;
    SELF.special_2_16 := hist[16].special_2;
    SELF.general_16 := hist[16].general;
    SELF.pres_16 := hist[16].pres;
    SELF.vote_date_16 := hist[16].vote_date;
    SELF.voted_year_17 := hist[17].voted_year;
    SELF.primary_17 := hist[17].primary;
    SELF.special_1_17 := hist[17].special_1;
    SELF.other_17 := hist[17].other;
    SELF.special_2_17 := hist[17].special_2;
    SELF.general_17 := hist[17].general;
    SELF.pres_17 := hist[17].pres;
    SELF.vote_date_17 := hist[17].vote_date;
    SELF.voted_year_18 := hist[18].voted_year;
    SELF.primary_18 := hist[18].primary;
    SELF.special_1_18 := hist[18].special_1;
    SELF.other_18 := hist[18].other;
    SELF.special_2_18 := hist[18].special_2;
    SELF.general_18 := hist[18].general;
    SELF.pres_18 := hist[18].pres;
    SELF.vote_date_18 := hist[18].vote_date;
    SELF.voted_year_19 := hist[19].voted_year;
    SELF.primary_19 := hist[19].primary;
    SELF.special_1_19 := hist[19].special_1;
    SELF.other_19 := hist[19].other;
    SELF.special_2_19 := hist[19].special_2;
    SELF.general_19 := hist[19].general;
    SELF.pres_19 := hist[19].pres;
    SELF.vote_date_19 := hist[19].vote_date;
    SELF.voted_year_20 := hist[20].voted_year;
    SELF.primary_20 := hist[20].primary;
    SELF.special_1_20 := hist[20].special_1;
    SELF.other_20 := hist[20].other;
    SELF.special_2_20 := hist[20].special_2;
    SELF.general_20 := hist[20].general;
    SELF.pres_20 := hist[20].pres;
    SELF.vote_date_20 := hist[20].vote_date;
    SELF := L;
    SELF := R;
    SELF := [];
  END;

END;
