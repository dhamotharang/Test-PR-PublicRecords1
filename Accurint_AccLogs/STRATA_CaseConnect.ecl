import strata;

export STRATA_CaseConnect(string filedate,boolean omit_output_to_screen = true) := function 

ds := Accurint_AccLogs.File_AccLogs_Base;

rSTRATA_CaseConnect := record	 
 CountGroup              	:= count(group); 
 orig_searchdescription		:= ds.orig_searchdescription;
 orig_company_id					:= sum(group,if(ds.orig_company_id<>'',1,0));
 orig_loginid							:= sum(group,if(ds.orig_loginid<>'',1,0));
 orig_billing_code				:= sum(group,if(ds.orig_billing_code<>'',1,0));
 orig_user_companyname		:= sum(group,if(ds.orig_user_companyname<>'',1,0));
 orig_user_firstname			:= sum(group,if(ds.orig_user_firstname<>'',1,0));
 orig_user_lastname				:= sum(group,if(ds.orig_user_lastname<>'',1,0));
 orig_user_status					:= sum(group,if(ds.orig_user_status<>'',1,0));
 orig_login_history_id		:= sum(group,if(ds.orig_login_history_id<>'',1,0));
 orig_fname								:= sum(group,if(ds.orig_fname<>'',1,0));
 orig_mname								:= sum(group,if(ds.orig_mname<>'',1,0));
 orig_lname								:= sum(group,if(ds.orig_lname<>'',1,0));
 orig_full_name						:= sum(group,if(ds.orig_full_name<>'',1,0));		
 orig_business_name				:= sum(group,if(ds.orig_business_name<>'',1,0));
 orig_address							:= sum(group,if(ds.orig_address<>'',1,0));	
 orig_city								:= sum(group,if(ds.orig_city<>'',1,0));
 orig_state								:= sum(group,if(ds.orig_state<>'',1,0));	
 orig_zip									:= sum(group,if(ds.orig_zip<>'',1,0));
 orig_zip4								:= sum(group,if(ds.orig_zip4<>'',1,0));
 orig_phone								:= sum(group,if(ds.orig_phone<>'',1,0));
 orig_ssn									:= sum(group,if(ds.orig_ssn<>'',1,0));
 orig_dob									:= sum(group,if(ds.orig_dob<>'',1,0));
 orig_transaction_type		:= sum(group,if(ds.orig_transaction_type<>'',1,0));
 orig_function_name				:= sum(group,if(ds.orig_function_name<>'',1,0));
 orig_transaction_code		:= sum(group,if(ds.orig_transaction_code<>'',1,0));
 orig_unique_id						:= sum(group,if(ds.orig_unique_id<>'',1,0));
 orig_ein									:= sum(group,if(ds.orig_ein<>'',1,0));
 orig_charter_nbr					:= sum(group,if(ds.orig_charter_nbr<>'',1,0));
 orig_ucc_nbr							:= sum(group,if(ds.orig_ucc_nbr<>'',1,0));
 orig_filing_nbr					:= sum(group,if(ds.orig_filing_nbr<>'',1,0));
 orig_did									:= sum(group,if(ds.orig_did<>'',1,0));
 orig_domain							:= sum(group,if(ds.orig_domain<>'',1,0));
 orig_dl									:= sum(group,if(ds.orig_dl<>'',1,0));
 user_id									:= sum(group,if(ds.user_id<>'',1,0));
 user_title								:= sum(group,if(ds.user_title<>'',1,0));
 user_fname								:= sum(group,if(ds.user_fname<>'',1,0));
 user_mname								:= sum(group,if(ds.user_mname<>'',1,0));
 user_lname								:= sum(group,if(ds.user_lname<>'',1,0));
 user_name_suffix					:= sum(group,if(ds.user_name_suffix<>'',1,0));
 user_name_append					:= sum(group,if(ds.user_name_append<>'',1,0));
 user_cname								:= sum(group,if(ds.user_cname<>'',1,0));
 title										:= sum(group,if(ds.title<>'',1,0));
 fname										:= sum(group,if(ds.fname<>'',1,0));
 mname										:= sum(group,if(ds.mname<>'',1,0));
 lname										:= sum(group,if(ds.lname<>'',1,0));
 name_suffix							:= sum(group,if(ds.name_suffix<>'',1,0));
 cname										:= sum(group,if(ds.cname<>'',1,0));
 prim_range								:= sum(group,if(ds.prim_range<>'',1,0));
 predir										:= sum(group,if(ds.predir<>'',1,0));
 prim_name								:= sum(group,if(ds.prim_name<>'',1,0));
 addr_suffix							:= sum(group,if(ds.addr_suffix<>'',1,0));
 postdir									:= sum(group,if(ds.postdir<>'',1,0));
 unit_desig								:= sum(group,if(ds.unit_desig<>'',1,0));
 sec_range								:= sum(group,if(ds.sec_range<>'',1,0));
 p_city_name							:= sum(group,if(ds.p_city_name<>'',1,0));
 v_city_name							:= sum(group,if(ds.v_city_name<>'',1,0));
 st												:= sum(group,if(ds.st<>'',1,0));
 zip											:= sum(group,if(ds.zip<>'',1,0));
 zip4											:= sum(group,if(ds.zip4<>'',1,0));
 cart											:= sum(group,if(ds.cart<>'',1,0));
 cr_sort_sz								:= sum(group,if(ds.cr_sort_sz<>'',1,0));
 lot											:= sum(group,if(ds.lot<>'',1,0));
 lot_order								:= sum(group,if(ds.lot_order<>'',1,0));
 dbpc											:= sum(group,if(ds.dbpc<>'',1,0));
 chk_digit								:= sum(group,if(ds.chk_digit<>'',1,0));
 rec_type									:= sum(group,if(ds.rec_type<>'',1,0));
 county										:= sum(group,if(ds.county<>'',1,0));
 geo_lat									:= sum(group,if(ds.geo_lat<>'',1,0));
 geo_long									:= sum(group,if(ds.geo_long<>'',1,0));
 msa											:= sum(group,if(ds.msa<>'',1,0));
 geo_blk									:= sum(group,if(ds.geo_blk<>'',1,0));
 geo_match								:= sum(group,if(ds.geo_match<>'',1,0));
 err_stat									:= sum(group,if(ds.err_stat<>'',1,0));
 phone										:= sum(group,if(ds.phone<>'',1,0));
 ssn											:= sum(group,if(ds.ssn<>'',1,0));
 dob											:= sum(group,if(ds.dob<>'',1,0));
 dt_vendor_first_reported	:= sum(group,if(ds.dt_vendor_first_reported<>'',1,0));
 dt_vendor_last_reported	:= sum(group,if(ds.dt_vendor_last_reported<>'',1,0));
 dt_first_seen 						:= sum(group,if(ds.dt_first_seen<>'',1,0));
 dt_last_seen 						:= sum(group,if(ds.dt_last_seen<>'',1,0));	
 // did												:= sum(group,if(ds.did<>'',1,0));
 // bdid											:= sum(group,if(ds.bdid<>'',1,0));
 // transaction_count 				:= sum(group,if(ds.transaction_count<>'',1,0));
 search_description				:= sum(group,if(ds.search_description<>'',1,0));
 hash_key									:= sum(group,if(ds.hash_key<>'',1,0));
end;

 
 tStats := table(ds,rSTRATA_CaseConnect,orig_searchdescription,few);

strata.createXMLStats(tStats,'caseconnect_v2','data',filedate,'',resultsOut,,,,,omit_output_to_screen);
return resultsOut;
end;