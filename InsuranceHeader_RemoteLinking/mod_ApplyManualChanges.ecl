//---------------------------------------------------------------------------
// Hacks used to modify the standard behaviour of the person header internal linking SALT attributes
//---------------------------------------------------------------------------
// Currently supports adding hacks to code generated using SALT V3.7.0-RC1
IMPORT SALTTOOLS22;
IMPORT lib_stringlib;
IMPORT STD;

EXPORT mod_ApplyManualChanges(STRING sModule, STRING sESP='10.194.198.202:8145', BOOLEAN isDev = TRUE):=MODULE

EXPORT fGetAttribute(STRING att):=SALTTOOLS22.mod_Soapcalls.fGetAttributes(sModule,att,sESP)(COUNT(results)>0)[1].results[1].Text;
EXPORT fPutAttribute(STRING att,STRING new_att):=OUTPUT(SALTTOOLS22.mod_Soapcalls.fSaveAttribute(sModule,att,new_att,sESP));

EXPORT hack_ind := '/*HACK-O-MATIC*/ ';

EXPORT fSaveChange(STRING attribName, STRING currentCode, STRING newCode)	:= FUNCTION
	outAction	:= SEQUENTIAL(IF(STD.Str.Find(currentCode, hack_ind, 1) > 0,
														 OUTPUT(attribName + ' already modified'),
														 fPutAttribute(attribName, newCode)));
									
	RETURN outAction;
END;


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Config changes
attrName := 'Config';
s:=fGetAttribute(attrName);
salt_version0	:= REGEXFIND('SALT[0-9]+\\.AttrValueType', s, 0);
salt_version	:= REGEXFIND('SALT[0-9]+', salt_version0, 0);
s01:=REGEXREPLACE('^[ \t]*(END;)[ \t]*$', s, hack_ind + 'EXPORT SSN_Score_Min_MAINNAME 	:= 1500;\r\n'
                                           + hack_ind + 'EXPORT DOB_Score_Min_MAINNAME 	:= 500;\r\n'
																					 + hack_ind + 'EXPORT DL_NBR_Score_Min_MAINNAME:= 1000;\r\n'
																					 + hack_ind + 'EXPORT SSN_Score_Min_SNAME 			:= 1500;\r\n'
																					 + hack_ind + 'EXPORT DOB_Score_Min_SNAME 			:= 500;\r\n'
																					 + hack_ind + 'EXPORT SSN_Score_Min_FULLNAME 	:= 1500;\r\n'
																					 + hack_ind + 'EXPORT DOB_Score_Min_FULLNAME 	:= 500;\r\n'
																					 + hack_ind + 'EXPORT Addr_Score_Min_FULLNAME 	:= 1500;\r\n'
																					 + hack_ind + 'EXPORT Mismatch_Score_DERIVED_GENDER	:= -5000;\r\n'
																					 + hack_ind + 'EXPORT Threshold_Score_SNAME					:= -2000;\r\n'
                      + hack_ind + 'EXPORT Superfile_Name					:= \'\' : STORED(\'Superfile_Name\');\r\n'
																					 + '$1');
s02 := REGEXREPLACE('^([^\r\n]*)EXPORT Config := MODULE,VIRTUAL([^\r\n]*)$',s01,'EXPORT Config := MODULE,VIRTUAL\r\n/*---------------------------------------------------------------------------------------------------------------------------------------------*/\r\n///////////////////////////////MODIFY FOLLOWING TWO PARAMETERS BEFORE RUNNING TESTS\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\r\n/*---------------------------------------------------------------------------------------------------------------------------------------------*/\r\nEXPORT STRING PrefixMod := \'Reg_370\'; //Modify this to change the output name of all files in the module\r\nEXPORT UpdateSF := FALSE; //Change to FALSE if running a test to avoid updating the superfile and generating strata files\r\n/*---------------------------------------------------------------------------------------------------------------------------------------------*/\r\n////////////////////////////////////////////////////////////\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\r\n/*---------------------------------------------------------------------------------------------------------------------------------------------*/\r\nEXPORT Infix := PrefixMod + IF(PrefixMod > \'\', \'::\',\'\') + \''+sModule+'\';\r\n');
s03 := REGEXREPLACE('EXPORT WithinEditN\\('+salt_version+'.StrType l,UNSIGNED1 ll, '+salt_version+'.StrType r,UNSIGNED1 rl,UNSIGNED1 d, UNSIGNED1 edit_threshold=0,UNSIGNED1 mode=alg.Standard',s02,hack_ind + 'EXPORT WithinEditN('+salt_version+'.StrType l,UNSIGNED1 ll, '+salt_version+'.StrType r,UNSIGNED1 rl,UNSIGNED1 d, UNSIGNED1 edit_threshold=0,UNSIGNED1 mode=alg.NoTrailingHalfEdit');

sNew := s03;
EXPORT aConfigChanges := fSaveChange(attrName, s, sNew);

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Debug changes
attrName := 'Debug';
s:=fGetAttribute(attrName);
salt_version0	:= REGEXFIND('SALT[0-9]+\\.Fn_Fail_Scale', s, 0);
salt_version	:= REGEXFIND('SALT[0-9]+', salt_version0, 0);
s00:=REGEXREPLACE('[ \t]*// Get propagation scores for individual propagated fields[ \r\n\t]*SELF.SSN_score_prop := MAX\\(le.SSN_prop,ri.SSN_prop\\)\\*SELF.SSN_score; // Score if either field propogated[ \r\n\t]*SELF.FULLNAME_score_prop := IF\\(le.FULLNAME_prop\\+ri.FULLNAME_prop>0,SELF.FULLNAME_score\\*\\(0\\+IF\\(le.MAINNAME_prop\\+ri.MAINNAME_prop>0,s.MAINNAME_specificity,0\\)\\+IF\\(le.SNAME_prop\\+ri.SNAME_prop>0,s.SNAME_specificity,0\\)\\)/\\( s.MAINNAME_specificity\\+ s.SNAME_specificity\\),0\\);[ \r\n\t]*SELF.MAINNAME_score_prop := IF\\(le.MAINNAME_prop\\+ri.MAINNAME_prop>0,SELF.MAINNAME_score\\*\\(0\\+IF\\(le.FNAME_prop\\+ri.FNAME_prop>0,s.FNAME_specificity,0\\)\\+IF\\(le.MNAME_prop\\+ri.MNAME_prop>0,s.MNAME_specificity,0\\)\\+IF\\(le.LNAME_prop\\+ri.LNAME_prop>0,s.LNAME_specificity,0\\)\\)/\\( s.FNAME_specificity\\+ s.MNAME_specificity\\+ s.LNAME_specificity\\),0\\);[ \r\n\t]*SELF.DOB_score_prop:= SELF.DOB_score\\*\\(IF\\( \\(le.DOB_prop\\|ri.DOB_prop\\)&4>0,6,0 \\)\\+IF\\( \\(le.DOB_prop\\|ri.DOB_prop\\)&2>0,4,0 \\)\\+IF\\( \\(le.DOB_prop\\|ri.DOB_prop\\)&1>0,5,0 \\)\\)/15; // Compute weight of year/month/day propagation independently[ \r\n\t]*SELF.LNAME_score_prop := \\(MAX\\(le.LNAME_prop,ri.LNAME_prop\\)/MAX\\(LENGTH\\(TRIM\\(le.LNAME\\)\\),LENGTH\\(TRIM\\(ri.LNAME\\)\\)\\)\\)\\*SELF.LNAME_score; // Proportion of longest string propogated[ \r\n\t]*SELF.FNAME_score_prop := \\(MAX\\(le.FNAME_prop,ri.FNAME_prop\\)/MAX\\(LENGTH\\(TRIM\\(le.FNAME\\)\\),LENGTH\\(TRIM\\(ri.FNAME\\)\\)\\)\\)\\*SELF.FNAME_score; // Proportion of longest string propogated[ \r\n\t]*SELF.MNAME_score_prop := \\(MAX\\(le.MNAME_prop,ri.MNAME_prop\\)/MAX\\(LENGTH\\(TRIM\\(le.MNAME\\)\\),LENGTH\\(TRIM\\(ri.MNAME\\)\\)\\)\\)\\*SELF.MNAME_score; // Proportion of longest string propogated[ \r\n\t]*SELF.SNAME_score_prop := MAX\\(le.SNAME_prop,ri.SNAME_prop\\)\\*SELF.SNAME_score; // Score if either field propogated[ \r\n\t]*SELF.DERIVED_GENDER_score_prop := MAX\\(le.DERIVED_GENDER_prop,ri.DERIVED_GENDER_prop\\)\\*SELF.DERIVED_GENDER_score; // Score if either field propogated[ \r\n\t]*SELF.Conf_Prop := \\(0 \\+ SELF.SSN_score_prop \\+ SELF.FULLNAME_score_prop \\+ SELF.MAINNAME_score_prop \\+ SELF.DOB_score_prop \\+ SELF.LNAME_score_prop \\+ SELF.FNAME_score_prop \\+ SELF.MNAME_score_prop \\+ SELF.SNAME_score_prop \\+ SELF.DERIVED_GENDER_score_prop\\) / 100; // Score based on propogated fields',s,'// Get propagation scores for individual propagated fields\r\n/*------------------added cfouts----------------------*/\r\n\tfname_prop_score_abs := ABS(FNAME_score_temp_noancestor);\r\n\tmname_prop_score_abs := ABS(MNAME_score_noancestor);\r\n\tlname_prop_score_abs := ABS(LNAME_score_noancestor);\r\n\tsname_prop_score_abs := ABS(SNAME_score_noancestor);\r\n\tsum_mainname_scale := fname_prop_score_abs + mname_prop_score_abs + lname_prop_score_abs;\r\n\tsum_fullname_scale := sum_mainname_scale + sname_prop_score_abs;\r\n\tfname_prop_scale := MAX(le.FNAME_prop,ri.FNAME_prop)/MAX(LENGTH(TRIM(le.FNAME)),LENGTH(TRIM(ri.FNAME)));\r\n\tmname_prop_scale := MAX(le.MNAME_prop,ri.MNAME_prop)/MAX(LENGTH(TRIM(le.MNAME)),LENGTH(TRIM(ri.MNAME)));\r\n\tlname_prop_scale := MAX(le.LNAME_prop,ri.LNAME_prop)/MAX(LENGTH(TRIM(le.LNAME)),LENGTH(TRIM(ri.LNAME)));\r\n\tsname_prop_scale := MAX(le.SNAME_prop,ri.SNAME_prop);\r\n\tfname_concept_prop_weight	:= if(le.FNAME_prop+ri.FNAME_prop>0,fname_prop_scale*fname_prop_score_abs,0);\r\n\tmname_concept_prop_weight := if(le.MNAME_prop+ri.MNAME_prop>0,mname_prop_scale*mname_prop_score_abs,0);\r\n\tlname_concept_prop_weight	:= if(le.LNAME_prop+ri.LNAME_prop>0,lname_prop_scale*lname_prop_score_abs,0);\r\n\tsname_concept_prop_weight := if(le.SNAME_prop+ri.SNAME_prop>0,sname_prop_scale*sname_prop_score_abs,0);\r\n\tsum_mainname_prop_weight	:= fname_concept_prop_weight+mname_concept_prop_weight+lname_concept_prop_weight;\r\n\tsum_fullname_prop_weight	:= sum_mainname_prop_weight+sname_concept_prop_weight;\r\n\r\n\tSELF.SSN_prop_score	:= MAX(le.SSN_prop,ri.SSN_prop)*SELF.SSN_score;\r\n\tSELF.DOB_prop_score	:= self.DOB_score*(IF( (le.DOB_prop|ri.DOB_prop)&4>0,6,0 )+IF( (le.DOB_prop|ri.DOB_prop)&2>0,4,0 )+IF( (le.DOB_prop|ri.DOB_prop)&1>0,5,0 ))/15;\r\n\tSELF.FULLNAME_prop_score	:= if(le.FULLNAME_prop+ri.FULLNAME_prop>0,self.FULLNAME_score*(0+sum_fullname_prop_weight)/sum_fullname_scale,0);\r\n\tSELF.MAINNAME_prop_score	:= if(le.MAINNAME_prop+ri.MAINNAME_prop>0,self.MAINNAME_score*(0+sum_mainname_prop_weight)/sum_mainname_scale,0);\r\n\tSELF.FNAME_prop_score	:= fname_prop_scale*SELF.FNAME_score;\r\n\tSELF.MNAME_prop_score := mname_prop_scale*SELF.MNAME_score;\r\n\tSELF.LNAME_prop_score	:= lname_prop_scale*SELF.LNAME_score;\r\n\tSELF.SNAME_prop_score := sname_prop_scale*SELF.SNAME_score;\r\n\tSELF.DERIVED_GENDER_prop_score := MAX(le.DERIVED_GENDER_prop,ri.DERIVED_GENDER_prop)*SELF.DERIVED_GENDER_score;\r\n\r\n\tSELF.Conf_Prop := (0\r\n\t\t + SELF.SSN_prop_score // Score if either field propogated\r\n\t\t+ SELF.FULLNAME_prop_score\r\n\t\t+ SELF.MAINNAME_prop_score\r\n\t\t+ SELF.DOB_prop_score // Compute weight of year/month/day propogation independently\r\n\t\t+ SELF.LNAME_prop_score // Proportion of longest string propogated\r\n\t\t+ SELF.FNAME_prop_score // Proportion of longest string propogated\r\n\t\t + SELF.MNAME_prop_score // Proportion of longest string propogated\r\n\t\t+ SELF.SNAME_prop_score // Score if either field propogated\r\n\t\t+ SELF.DERIVED_GENDER_prop_score // Score if either field propogated\r\n\t) / 100; // Score based on propogated fields\r\n\tcleaveContribution := IF(le.DID <> ri.DID, le.CleavePenalty + ri.CleavePenalty, 0);\r\n\t/*------------------added cfouts----------------------*/');
s01:=REGEXREPLACE('^[ \t]*SELF.SSN_score', s00, hack_ind + 'SSN_score_v1');
s02:=REGEXREPLACE('^([^\r\n]*Fn_Fail_Scale\\(le\\.SSN_weight100\\,s\\.SSN_switch\\)[^\r\n]*)$', s01, '$1' + '\r\n' + hack_ind + 'SELF.SSN_score := SSN_score_v1;');
s03:=REGEXREPLACE('^[ \t]*SELF.DL_NBR_score', s02, hack_ind + 'DL_NBR_score_v1');
s04:=REGEXREPLACE('^([^\r\n]*Fn_Fail_Scale\\(le\\.DL_NBR_weight100,s\\.DL_NBR_switch\\)[^\r\n]*)$', s03, '$1' + '\r\n' + hack_ind + 'SELF.DL_NBR_score := DL_NBR_score_v1;');
s05:=REGEXREPLACE('^[ \t]*INTEGER2 MAINNAME_score_pre', s04, hack_ind + 'INTEGER2 MAINNAME_score_pre_v1');
s06:=REGEXREPLACE('^[ \t]*(SELF.left_MAINNAME := le.MAINNAME;)', s05, hack_ind + 'INTEGER2 MAINNAME_score_strict := MAP( (le.MAINNAME_isnull OR le.FNAME_isnull AND le.MNAME_isnull AND le.LNAME_isnull) OR (ri.MAINNAME_isnull OR ri.FNAME_isnull AND ri.MNAME_isnull AND ri.LNAME_isnull) => 0,\r\n'
                                                                  + hack_ind + 'FULLNAME_score_pre > 0 => 0, // Ancestor has found solution so child keeps quiet\r\n'
																																	+ hack_ind + 'le.MAINNAME = ri.MAINNAME  => le.MAINNAME_weight100,\r\n'
																																	+ hack_ind /*+ salt_version - using 2.9 wordbag still*/ + salt_version + '.fn_concept_wordbag_EditN.Match3(('+salt_version+'.StrType)ri.FNAME,ri.FNAME_MAINNAME_weight100,false,Config.FNAME_Force,false,0,0,ri.FNAME_len,ri.FNAME_MAINNAME_fuzzy_weight100,('+salt_version+'.StrType)ri.MNAME,ri.MNAME_MAINNAME_weight100,false,0,false,0,0,ri.MNAME_len,ri.MNAME_MAINNAME_fuzzy_weight100,('+salt_version+'.StrType)ri.LNAME,ri.LNAME_MAINNAME_weight100,false,0,false,0,0,ri.LNAME_len,ri.LNAME_MAINNAME_fuzzy_weight100,('+salt_version+'.StrType)le.FNAME,le.FNAME_MAINNAME_weight100,le.FNAME_len,le.FNAME_MAINNAME_fuzzy_weight100,('+salt_version+'.StrType)le.MNAME,le.MNAME_MAINNAME_weight100,le.MNAME_len,le.MNAME_MAINNAME_fuzzy_weight100,('+salt_version+'.StrType)le.LNAME,le.LNAME_MAINNAME_weight100,le.LNAME_len,le.LNAME_MAINNAME_fuzzy_weight100,'+sModule+'.Config.WithinEditN)*IF(MAINNAME_score_scale=0,1,MAINNAME_score_scale))*IF(FULLNAME_score_scale=0,1,FULLNAME_score_scale);\r\n' + '$1');
s07:=REGEXREPLACE('^[ \t]*SELF.DOB_score', s06, hack_ind + 'DOB_score_v1');
s08:=REGEXREPLACE('^([^\r\n]*DOB_score_temp\\)\\;)$', s07, '$1' + '\r\n' + hack_ind + 'SELF.DOB_score := DOB_score_v1;');
s09:=REGEXREPLACE('^([^\r\n]*SELF\\.right_DOB[ \t]*\\:\\=[^\r\n]*)$', s08, '$1' + '\r\n' + hack_ind + 'integer2 MAINNAME_score_pre := if ((ssn_score_v1 > Config.SSN_Score_Min_MAINNAME AND dob_score_v1 > Config.DOB_Score_Min_MAINNAME)\r\n OR MAINNAME_score_strict > 0,\r\n MAINNAME_score_pre_v1, 0);\r\n');
s11:=REGEXREPLACE('^[^\r\n]*Fn_Fail_Scale\\(le\\.DERIVED_GENDER_weight100,s\\.DERIVED_GENDER_switch\\)', s09, hack_ind + 'Config.Mismatch_Score_DERIVED_GENDER');
s12:=REGEXREPLACE('^[^\r\n]*SELF.FULLNAME_score[ \t]*\\:\\=[^\r\n]*$', s11, hack_ind + 'SELF.FULLNAME_score := IF ( FULLNAME_score_ext > -300\r\n'
																																					+ hack_ind + 'OR (SELF.SSN_score > Config.SSN_Score_Min_FULLNAME AND SELF.DOB_score > Config.DOB_Score_Min_FULLNAME AND SELF.FNAME_score > 0)\r\n'
																																					+ hack_ind + 'OR (SELF.ADDRESS_score > Config.Addr_Score_Min_FULLNAME AND SELF.DOB_score > Config.DOB_Score_Min_FULLNAME AND SELF.FNAME_score > 0),\r\n'
																																					+ hack_ind + 'FULLNAME_score_res,-9999);');

s13:=REGEXREPLACE('^[^\r\n]*(SELF.Conf[ \t]*\\:\\=)[^\r\n]*MAX\\(SELF\\.ADDRESS_score[^\r\n]*$', s12, hack_ind + '$1' + '(SELF.ADDRESS_score + SELF.SSN_score + SELF.POLICY_NUMBER_score + SELF.CLAIM_NUMBER_score + SELF.DL_NBR_score + SELF.FULLNAME_score + SELF.MAINNAME_score + SELF.ADDR1_score + SELF.DOB_score + SELF.ZIP_score + SELF.LOCALE_score + SELF.PRIM_NAME_score + SELF.LNAME_score + SELF.PRIM_RANGE_score + SELF.CITY_score + SELF.FNAME_score + SELF.SEC_RANGE_score + SELF.MNAME_score + SELF.ST_score + SELF.SNAME_score + SELF.GENDER_score + SELF.DERIVED_GENDER_score) / 100 + outside;\r\n\tSELF:=[]');

//s14:=REGEXREPLACE('Config.MatchThreshold\\) := MODULE[^\r\n]*$',s13,'Config.MatchThreshold,BOOLEAN MicroMode = FALSE) := MODULE');
//s15:=REGEXREPLACE('match_candidates\\(ih\\)',s14,'match_candidates(ih,MicroMode)');
s16:=REGEXREPLACE('^[^\r\n]*EXPORT[ \t]*Layout_Sample_Matches := RECORD[^\r\n]*$',s13,hack_ind + 'EXPORT Layout_Sample_Matches := RECORD,MAXLENGTH(32000)\r\n\tUNSIGNED2 Rule;\r\n\tINTEGER2 Conf;\r\n\tINTEGER2 Conf_Prop;\r\n\tINTEGER2 DateOverlap := 0;\r\n\t' + salt_version + '.UIDType DID1;\r\n\t' + salt_version + '.UIDType DID2;\r\n\t' + salt_version + '.UIDType RID1;\r\n\t' + salt_version + '.UIDType RID2;');
s17:=REGEXREPLACE('^[^\r\n]*TYPEOF\\(h.AMBEST\\) right_AMBEST;[^\r\n]*$',s16,hack_ind + 'TYPEOF(h.AMBEST) right_AMBEST;\r\n\tINTEGER2 SSN_prop_score;\r\n\tINTEGER2 DOB_prop_score;\r\n\tINTEGER2 FULLNAME_prop_score;\r\n\tINTEGER2 MAINNAME_prop_score;\r\n\tINTEGER2 FNAME_prop_score;\r\n\tINTEGER2 MNAME_prop_score;\r\n\tINTEGER2 LNAME_prop_score;\r\n\tINTEGER2 SNAME_prop_score;\r\n\tINTEGER2 DERIVED_GENDER_prop_score;');
s18:=REGEXREPLACE('^[^\r\n]*d \\:\\= DEDUP\\( SORT\\( r, DID1, DID2, -Conf, LOCAL \\), DID1, DID2, LOCAL \\);[^\r\n]*$',s17,hack_ind + 'd := DEDUP(r(rid1 <> rid2), ALL, WHOLE RECORD);');
s19:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*SSN_score_prop;[^\r\n]*$',s18,'// INTEGER2 SSN_score_prop;');
s20:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*FULLNAME_score_prop;[^\r\n]*$',s19,'// INTEGER2 FULLNAME_score_prop;');
s21:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*MAINNAME_score_prop;[^\r\n]*$',s20,'// INTEGER2 MAINNAME_score_prop;');
s22:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*DOB_score_prop;[^\r\n]*$',s21,'// INTEGER2 DOB_score_prop;');
s23:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*LNAME_score_prop;[^\r\n]*$',s22,'// INTEGER2 LNAME_score_prop;');
s24:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*FNAME_score_prop;[^\r\n]*$',s23,'// INTEGER2 FNAME_score_prop;');
s25:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*MNAME_score_prop;[^\r\n]*$',s24,'// INTEGER2 MNAME_score_prop;');
s26:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*SNAME_score_prop;[^\r\n]*$',s25,'// INTEGER2 SNAME_score_prop;');
s27:=REGEXREPLACE('^[^\r\n]*INTEGER2[ \t]*DERIVED_GENDER_score_prop;[^\r\n]*$',s26,'// INTEGER2 DERIVED_GENDER_score_prop;');
// s28:=REGEXREPLACE('^[^\r\n]*match_methods\\(ih\\)\\.match_MAINNAME\\([^\r\n]*$',s27,hack_ind + 'match_methods(ih).match_MAINNAME(le.MAINNAME,ri.MAINNAME,('+salt_version+'.StrType)le.FNAME,le.FNAME_MAINNAME_weight100,true,Config.FNAME_Force,true,,1,('+salt_version+'.StrType)le.MNAME,le.MNAME_MAINNAME_weight100,true,0,true,,2,('+salt_version+'.StrType)le.LNAME,le.LNAME_MAINNAME_weight100,true,0,true,,2,('+salt_version+'.StrType)ri.FNAME,ri.FNAME_MAINNAME_weight100,('+salt_version+'.StrType)ri.MNAME,ri.MNAME_MAINNAME_weight100,('+salt_version+'.StrType)ri.LNAME,ri.LNAME_MAINNAME_weight100,false));');
//s29:=REGEXREPLACE('^([^\r\n]*)'+salt_version+'.fn_concept_wordbag_EditN.Match3\\(\\('+salt_version+'.StrType\\)ri.FNAME,ri.FNAME_MAINNAME_weight100,true,Config.FNAME_Force,true,1,0,ri.FNAME_len,ri.FNAME_MAINNAME_fuzzy_weight100,\\('+salt_version+'.StrType\\)ri.MNAME,ri.MNAME_MAINNAME_weight100,true,0,true,2,0,ri.MNAME_len,ri.MNAME_MAINNAME_fuzzy_weight100,\\('+salt_version+'.StrType\\)ri.LNAME,ri.LNAME_MAINNAME_weight100,true,0,true,2,0,ri.LNAME_len,ri.LNAME_MAINNAME_fuzzy_weight100,\\('+salt_version+'.StrType\\)le.FNAME,le.FNAME_MAINNAME_weight100,le.FNAME_len,le.FNAME_MAINNAME_fuzzy_weight100,\\('+salt_version+'.StrType\\)le.MNAME,le.MNAME_MAINNAME_weight100,le.MNAME_len,le.MNAME_MAINNAME_fuzzy_weight100,\\('+salt_version+'.StrType\\)le.LNAME,le.LNAME_MAINNAME_weight100,le.LNAME_len,le.LNAME_MAINNAME_fuzzy_weight100,'+smodule+'.Config.WithinEditN\\)\\*IF\\(MAINNAME_score_scale=0,1,MAINNAME_score_scale\\)\\)\\*IF\\(FULLNAME_score_scale=0,1,FULLNAME_score_scale\\);([^\r\n]*)$', s28, hack_ind + '$1'+'SALT29.fn_concept_wordbag_EditN.Match3(('+salt_version+'.StrType)ri.FNAME,ri.FNAME_MAINNAME_weight100,true,Config.FNAME_Force,true,1,('+salt_version+'.StrType)ri.MNAME,ri.MNAME_MAINNAME_weight100,true,0,true,2,('+salt_version+'.StrType)ri.LNAME,ri.LNAME_MAINNAME_weight100,true,0,true,2,('+salt_version+'.StrType)le.FNAME,le.FNAME_MAINNAME_weight100,('+salt_version+'.StrType)le.MNAME,le.MNAME_MAINNAME_weight100,('+salt_version+'.StrType)le.LNAME,le.LNAME_MAINNAME_weight100)*IF(MAINNAME_score_scale=0,1,MAINNAME_score_scale))*IF(FULLNAME_score_scale=0,1,FULLNAME_score_scale);' + '$2');
s30:=REGEXREPLACE('^([^\r\n]*)SELF.LNAME_score := MAP\\([ \r\n\t]*le.LNAME_isnull OR ri.LNAME_isnull => 0,[ \r\n\t]*MAINNAME_score_pre > 0 OR FULLNAME_score_pre > 0 => 0, // Ancestor has found solution so child keeps quiet[ \r\n\t]*le.LNAME = ri.LNAME OR '+salt_version+'.HyphenMatch\\(le.LNAME,ri.LNAME,1\\)<=2  => MIN\\(le.LNAME_weight100,ri.LNAME_weight100\\),[ \r\n\t]*LENGTH\\(TRIM\\(le.LNAME\\)\\)>0 and le.LNAME = ri.LNAME\\[1..LENGTH\\(TRIM\\(le.LNAME\\)\\)\\] => le.LNAME_weight100, // An initial match - take initial specificity[ \r\n\t]*LENGTH\\(TRIM\\(ri.LNAME\\)\\)>0 and ri.LNAME = le.LNAME\\[1..LENGTH\\(TRIM\\(ri.LNAME\\)\\)\\] => ri.LNAME_weight100, // An initial match - take initial specificity[ \r\n\t]*Config.WithinEditN\\(le.LNAME,le.LNAME_len,ri.LNAME,ri.LNAME_len,2,6\\) => MAP\\(\\(6 > le.LNAME_len\\) AND \\(6 > ri.LNAME_len\\) => '+salt_version+'.fn_fuzzy_specificity\\(le.LNAME_weight100,le.LNAME_cnt, le.LNAME_e1_cnt,ri.LNAME_weight100,ri.LNAME_cnt,ri.LNAME_e1_cnt\\),'+salt_version+'.fn_fuzzy_specificity\\(le.LNAME_weight100,le.LNAME_cnt, le.LNAME_e2_cnt,ri.LNAME_weight100,ri.LNAME_cnt,ri.LNAME_e2_cnt\\)\\),[ \r\n\t]*'+salt_version+'.Fn_Fail_Scale\\(le.LNAME_weight100,s.LNAME_switch\\)\\)\\*IF\\(MAINNAME_score_scale=0,1,MAINNAME_score_scale\\)\\*IF\\(FULLNAME_score_scale=0,1,FULLNAME_score_scale\\);',s27,hack_ind +' 		/*------------------added cfouts----------------------*/\r\n\t\tINTEGER2 lname_score_noancestor := MAP( le.LNAME_isnull OR ri.LNAME_isnull => 0,\r\n\t\t\t\t\tle.LNAME = ri.LNAME OR '+salt_version+'.HyphenMatch(le.LNAME,ri.LNAME,1)<=2  => MIN(le.LNAME_weight100,ri.LNAME_weight100),\r\n\t\t\t\t\tLENGTH(TRIM(le.LNAME))>0 and le.LNAME = ri.LNAME[1..LENGTH(TRIM(le.LNAME))] => le.LNAME_weight100, // An initial match - take initial specificity\r\n\t\t\t\t\tLENGTH(TRIM(ri.LNAME))>0 and ri.LNAME = le.LNAME[1..LENGTH(TRIM(ri.LNAME))] => ri.LNAME_weight100, // An initial match - take initial specificity\r\n\t\t\t\t\t'+sModule+'.Config.WithinEditN(le.LNAME,le.LNAME_len,ri.LNAME,ri.LNAME_len,1,0) => '+salt_version+'.fn_fuzzy_specificity(le.LNAME_weight100,le.LNAME_cnt, le.LNAME_e1_cnt,ri.LNAME_weight100,ri.LNAME_cnt,ri.LNAME_e1_cnt),\r\n\t\t\t\t\t'+sModule+'.Config.WithinEditN(le.LNAME,le.LNAME_len,ri.LNAME,ri.LNAME_len,2,6) => SALT37.fn_fuzzy_specificity(le.LNAME_weight100,le.LNAME_cnt, le.LNAME_e2_cnt,ri.LNAME_weight100,ri.LNAME_cnt,ri.LNAME_e2_cnt),\r\n\t\t\t\t\t'+salt_version+'.Fn_Fail_Scale(le.LNAME_weight100,s.LNAME_switch))*IF(MAINNAME_score_scale=0,1,MAINNAME_score_scale)*IF(FULLNAME_score_scale=0,1,FULLNAME_score_scale);\r\n\r\n\tSELF.LNAME_score := MAP(le.LNAME_isnull OR ri.LNAME_isnull => 0,\r\n\t\t\t\t\tMAINNAME_score_pre > 0 OR FULLNAME_score_pre > 0 => 0,\r\n\t\t\t\t\tlname_score_noancestor);\r\n/*------------------added cfouts----------------------*/');
s31:=REGEXREPLACE('^([^\r\n]*)INTEGER2[ \t]*FNAME_score_temp \\:\\= MAP\\([ \r\n\t]*le.FNAME_isnull OR ri.FNAME_isnull => 0,[ \r\n\t]*MAINNAME_score_pre',s30,hack_ind + 'INTEGER2 FNAME_score_temp_noancestor := MAP(\r\n\t\t\t\t\t\tle.FNAME_isnull OR ri.FNAME_isnull => 0,\r\n\t\t\t\t\t\t//MAINNAME_score_pre');
s32:=REGEXREPLACE('^([^\r\n]*)SELF.left_SEC_RANGE := le.SEC_RANGE;',s31,'	/*------------------added cfouts----------------------*/\r\n\tINTEGER2 FNAME_score_temp := MAP(le.FNAME_isnull OR ri.FNAME_isnull => 0,\r\n\t\t\t\t\t\tMAINNAME_score_pre > 0 OR FULLNAME_score_pre > 0 => 0,\r\n\t\t\t\t\t\tFNAME_score_temp_noancestor);\r\n\t/*------------------added cfouts----------------------*/\r\n\r\n\tSELF.left_SEC_RANGE := le.SEC_RANGE;');
s33:=REGEXREPLACE('^([^\r\n]*)SELF.MNAME_score \\:\\= MAP\\([ \r\n\t]*le.MNAME_isnull OR ri.MNAME_isnull => 0,[ \r\n\t]*MAINNAME_score_pre > 0 OR FULLNAME_score_pre > 0 => 0, // Ancestor has found solution so child keeps quiet',s32,hack_ind + 'INTEGER2 MNAME_score_noancestor := MAP(\r\n                        le.MNAME_isnull OR ri.MNAME_isnull => 0,');
s34:=REGEXREPLACE('^([^\r\n]*)SELF.left_ST \\:\\= le.ST;[^\r\n]*$',s33,'/*------------------added cfouts----------------------*/\r\n\tSELF.MNAME_score := MAP(le.MNAME_isnull OR ri.MNAME_isnull => 0,\r\n\t\t\t\t\tMAINNAME_score_pre > 0 OR FULLNAME_score_pre > 0 => 0,\r\n\t\t\t\t\tMNAME_score_noancestor);\r\n\t/*------------------added cfouts----------------------*/\r\n\tSELF.left_ST := le.ST;');

// s36 := REGEXREPLACE('IMPORT '+salt_version+',std;',s34,'IMPORT SALT29,'+salt_version+',std;');
s37 := REGEXREPLACE('^([^\r\n]*)SELF.SNAME_score := MAP\\([ \r\n\t]*le.SNAME_isnull OR ri.SNAME_isnull => 0,[ \r\n\t]*FULLNAME_score_pre > 0 => 0, // Ancestor has found solution so child keeps quiet[ \r\n\t]*le.SNAME = ri.SNAME  => le.SNAME_weight100,[ \r\n\t]*'+salt_version+'.Fn_Fail_Scale\\(le.SNAME_weight100,s.SNAME_switch\\)\\)\\*IF\\(FULLNAME_score_scale=0,1,FULLNAME_score_scale\\);[^\r\n]*$',s34,'	/*------------------added cfouts----------------------*/\r\nINTEGER2 sname_score_noancestor := MAP( le.SNAME_isnull OR ri.SNAME_isnull => 0,\r\n\t\tle.SNAME = ri.SNAME  => le.SNAME_weight100,\r\n\t\tssn_score_v1 > Config.SSN_Score_Min_SNAME and dob_score_v1 > Config.DOB_Score_Min_SNAME => Config.Threshold_Score_SNAME,\r\n\t\t-9999)*IF(FULLNAME_score_scale=0,1,FULLNAME_score_scale);\r\nSELF.SNAME_score := MAP(le.SNAME_isnull OR ri.SNAME_isnull => 0,\r\n\t\tFULLNAME_score_pre > 0 => 0,\r\n\t\tsname_score_noancestor);\r\n/*------------------added cfouts----------------------*/');
// s38:=REGEXREPLACE('Match_Candidates\\(ih\\)',s37,'match_candidates(ih,MicroMode)');
s39:=REGEXREPLACE('Config.WithinEditN\\(le.FNAME,le.FNAME_len,ri.FNAME,ri.FNAME_len,2,6\\) => MAP\\(\\(6 > le.FNAME_len\\) AND \\(6 > ri.FNAME_len\\) => SALT37.fn_fuzzy_specificity\\(le.FNAME_weight100,le.FNAME_cnt, le.FNAME_e1_cnt,ri.FNAME_weight100,ri.FNAME_cnt,ri.FNAME_e1_cnt\\),'+salt_version+'.fn_fuzzy_specificity\\(le.FNAME_weight100,le.FNAME_cnt, le.FNAME_e2_cnt,ri.FNAME_weight100,ri.FNAME_cnt,ri.FNAME_e2_cnt\\)\\),',s37,'Config.WithinEditN(le.FNAME,le.FNAME_len,ri.FNAME,ri.FNAME_len,1,0) => '+salt_version+'.fn_fuzzy_specificity(le.FNAME_weight100,le.FNAME_cnt, le.FNAME_e1_cnt,ri.FNAME_weight100,ri.FNAME_cnt,ri.FNAME_e1_cnt),\r\n												Config.WithinEditN(le.FNAME,le.FNAME_len,ri.FNAME,ri.FNAME_len,2,6) => '+salt_version+'.fn_fuzzy_specificity(le.FNAME_weight100,le.FNAME_cnt, le.FNAME_e2_cnt,ri.FNAME_weight100,ri.FNAME_cnt,ri.FNAME_e2_cnt),');
s40:=REGEXREPLACE('Config.WithinEditN\\(le.MNAME,le.MNAME_len,ri.MNAME,ri.MNAME_len,2,6\\) => MAP\\(\\(6 > le.MNAME_len\\) AND \\(6 > ri.MNAME_len\\) => SALT37.fn_fuzzy_specificity\\(le.MNAME_weight100,le.MNAME_cnt, le.MNAME_e1_cnt,ri.MNAME_weight100,ri.MNAME_cnt,ri.MNAME_e1_cnt\\),'+salt_version+'.fn_fuzzy_specificity\\(le.MNAME_weight100,le.MNAME_cnt, le.MNAME_e2_cnt,ri.MNAME_weight100,ri.MNAME_cnt,ri.MNAME_e2_cnt\\)\\),',s39,'Config.WithinEditN(le.MNAME,le.MNAME_len,ri.MNAME,ri.MNAME_len,1,0) => '+salt_version+'.fn_fuzzy_specificity(le.MNAME_weight100,le.MNAME_cnt, le.MNAME_e1_cnt,ri.MNAME_weight100,ri.MNAME_cnt,ri.MNAME_e1_cnt),\r\n												Config.WithinEditN(le.MNAME,le.MNAME_len,ri.MNAME,ri.MNAME_len,2,6) => '+salt_version+'.fn_fuzzy_specificity(le.MNAME_weight100,le.MNAME_cnt, le.MNAME_e2_cnt,ri.MNAME_weight100,ri.MNAME_cnt,ri.MNAME_e2_cnt),');
sNew := s40;
EXPORT aDebugChanges := fSaveChange(attrName, s, sNew);

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// match_candidates changes
attrName := 'match_candidates';
s:=fGetAttribute(attrName);
salt_version0	:= REGEXFIND('SALT[0-9]+\\.StrType', s, 0);
salt_version	:= REGEXFIND('SALT[0-9]+', salt_version0, 0);
// s06:=REGEXREPLACE('^([^\r\n]*)EXPORT match_candidates\\(DATASET\\(layout_HEADER\\) ih\\) := MODULE([^\r\n]*)$',s,hack_ind + 'EXPORT match_candidates(DATASET(layout_HEADER) ih,boolean MicroMode = FALSE) := MODULE');
// s07:=REGEXREPLACE('^([^\r\n]*)  h00 := '+sModule+'.Cleave\\(ih\\).input_file;([^\r\n]*)$',s06,hack_ind + '  h00 := Cleave(ih,,,MicroMode).input_file;');
// s08:=REGEXREPLACE('SHARED pj6 := JOIN\\(pj5,SNAME_props,left.DID=right.DID,take_SNAME\\(left,right\\),LEFT OUTER,HASH,HINT\\(parallel_match\\)\\);',s07,'SHARED pj6 := JOIN(pj5002,SNAME_props,left.DID=right.DID,take_SNAME(left,right),LEFT OUTER,HASH,HINT(parallel_match));\r\n/*------------------added cfouts----------------------*/\r\nSHARED VENDORID_prop5 := JOIN(VENDORID_prop4,SNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop5 := JOIN(VEH_PROP_VENDORID_prop4,SNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop5 := JOIN(UnderLinks_prop4,SNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop5 := JOIN(RelativeLinks_prop4,SNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n/*------------------added cfouts----------------------*/\r\n');
// s09:=REGEXREPLACE('SHARED pj7 := JOIN\\(pj6,FNAME_props,left.DID=right.DID AND \\(left.FNAME=\'\' OR left.FNAME\\[1\\]=right.FNAME\\[1\\]\\),take_FNAME\\(left,right\\),LEFT OUTER,HASH,HINT\\(parallel_match\\)\\);[ \r\n\t]*SHARED VENDORID_prop5 := JOIN\\(VENDORID_prop4,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL\\);[ \r\n\t]*SHARED VEH_PROP_VENDORID_prop5 := JOIN\\(VEH_PROP_VENDORID_prop4,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL\\);[ \r\n\t]*SHARED UnderLinks_prop5 := JOIN\\(UnderLinks_prop4,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL\\);[ \r\n\t]*SHARED RelativeLinks_prop5 := JOIN\\(RelativeLinks_prop4,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL\\);',s08,'SHARED pj7 := JOIN(pj6,FNAME_props,left.DID=right.DID AND (left.FNAME=\'\' OR left.FNAME[1]=right.FNAME[1]),take_FNAME(left,right),LEFT OUTER,HASH,HINT(parallel_match));\r\n/*------------------added cfouts----------------------*/\r\nSHARED VENDORID_prop6 := JOIN(VENDORID_prop5,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop6 := JOIN(VEH_PROP_VENDORID_prop5,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop6 := JOIN(UnderLinks_prop5,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop6 := JOIN(RelativeLinks_prop5,FNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n/*------------------added cfouts----------------------*/\r\n');
// s10:=REGEXREPLACE('SHARED pj8 := JOIN\\(pj7,MNAME_props,left.DID=right.DID AND \\(left.MNAME=\'\' OR left.MNAME\\[1\\]=right.MNAME\\[1\\]\\),take_MNAME\\(left,right\\),LEFT OUTER,HASH,HINT\\(parallel_match\\)\\);',s09,'SHARED pj8 := JOIN(pj7,MNAME_props,left.DID=right.DID AND (left.MNAME=\'\' OR left.MNAME[1]=right.MNAME[1]),take_MNAME(left,right),LEFT OUTER,HASH,HINT(parallel_match));\r\n/*------------------added cfouts----------------------*/\r\nSHARED VENDORID_prop7 := JOIN(VENDORID_prop6,MNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop7 := JOIN(VEH_PROP_VENDORID_prop6,MNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop7 := JOIN(UnderLinks_prop6,MNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop7 := JOIN(RelativeLinks_prop6,MNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n/*------------------added cfouts----------------------*/');
// s11:=REGEXREPLACE('SHARED pj9 := JOIN\\(pj8,LNAME_props,left.DID=right.DID AND \\(left.LNAME=\'\' OR left.LNAME\\[1\\]=right.LNAME\\[1\\]\\),take_LNAME\\(left,right\\),LEFT OUTER,HASH,HINT\\(parallel_match\\)\\);',s10,'SHARED pj9 := JOIN(pj8,LNAME_props,left.DID=right.DID AND (left.LNAME=\'\' OR left.LNAME[1]=right.LNAME[1]),take_LNAME(left,right),LEFT OUTER,HASH,HINT(parallel_match));\r\n/*------------------added cfouts----------------------*/\r\nSHARED VENDORID_prop8 := JOIN(VENDORID_prop7,LNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop8 := JOIN(VEH_PROP_VENDORID_prop7,LNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop8 := JOIN(UnderLinks_prop7,LNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop8 := JOIN(RelativeLinks_prop7,LNAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n/*------------------added cfouts----------------------*/');
// s12:=REGEXREPLACE('SHARED VENDORID_prp := VENDORID_prop5;[ \r\n\t]*SHARED VEH_PROP_VENDORID_prp := VEH_PROP_VENDORID_prop5;[ \r\n\t]*SHARED UnderLinks_prp := UnderLinks_prop5;[ \r\n\t]*SHARED RelativeLinks_prp := RelativeLinks_prop5;',s11,'/*-----------added cfouts----------------*/\r\n'+salt_version+'.mac_prop_field(with_props(PRIM_NAME NOT IN SET(s.nulls_PRIM_NAME,PRIM_NAME)),PRIM_NAME,DID,PRIM_NAME_props);\r\nSHARED VENDORID_prop9 := JOIN(VENDORID_prop8,PRIM_NAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop9 := JOIN(VEH_PROP_VENDORID_prop8,PRIM_NAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop9 := JOIN(UnderLinks_prop8,PRIM_NAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop9 := JOIN(RelativeLinks_prop8,PRIM_NAME_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n'+salt_version+'.mac_prop_field(with_props(PRIM_RANGE NOT IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE)),PRIM_RANGE,DID,PRIM_RANGE_props); // For every DID find the best FULL PRIM_RANGE\r\nSHARED VENDORID_prop10 := JOIN(VENDORID_prop9,PRIM_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop10 := JOIN(VEH_PROP_VENDORID_prop9,PRIM_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop10 := JOIN(UnderLinks_prop9,PRIM_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop10 := JOIN(RelativeLinks_prop9,PRIM_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n'+salt_version+'.mac_prop_field(with_props(SEC_RANGE NOT IN SET(s.nulls_SEC_RANGE,SEC_RANGE)),SEC_RANGE,DID,SEC_RANGE_props); // For every DID find the best FULL SEC_RANGE\r\nSHARED VENDORID_prop11 := JOIN(VENDORID_prop10,SEC_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop11 := JOIN(VEH_PROP_VENDORID_prop10,SEC_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop11 := JOIN(UnderLinks_prop10,SEC_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop11 := JOIN(RelativeLinks_prop10,SEC_RANGE_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n'+salt_version+'.mac_prop_field(with_props(CITY NOT IN SET(s.nulls_CITY,CITY)),CITY,DID,CITY_props); // For every DID find the best FULL CITY\r\nSHARED VENDORID_prop12 := JOIN(VENDORID_prop11,CITY_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop12 := JOIN(VEH_PROP_VENDORID_prop11,CITY_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop12 := JOIN(UnderLinks_prop11,CITY_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop12 := JOIN(RelativeLinks_prop11,CITY_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n'+salt_version+'.mac_prop_field(with_props(ST NOT IN SET(s.nulls_ST,ST)),ST,DID,ST_props); // For every DID find the best FULL ST\r\nSHARED VENDORID_prop13 := JOIN(VENDORID_prop12,ST_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop13 := JOIN(VEH_PROP_VENDORID_prop12,ST_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop13 := JOIN(UnderLinks_prop12,ST_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop13 := JOIN(RelativeLinks_prop12,ST_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\n'+salt_version+'.mac_prop_field(with_props(ZIP NOT IN SET(s.nulls_ZIP,ZIP)),ZIP,DID,ZIP_props); // For every DID find the best FULL ZIP\r\nSHARED VENDORID_prop14 := JOIN(VENDORID_prop13,ZIP_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED VEH_PROP_VENDORID_prop14 := JOIN(VEH_PROP_VENDORID_prop13,ZIP_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED UnderLinks_prop14 := JOIN(UnderLinks_prop13,ZIP_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nSHARED RelativeLinks_prop14 := JOIN(RelativeLinks_prop13,ZIP_props,left.DID=right.DID,LEFT OUTER,LOCAL);\r\nVENDORID_prop15_layout := RECORD\r\n  VENDORID_prop14;\r\n  UNSIGNED4 MAINNAME;\r\nEND;\r\nVENDORID_prop15_layout VENDORID_addconceptMAINNAME(VENDORID_prop14 le) := TRANSFORM\r\n  SELF := le;\r\n  self.MAINNAME := hash32(('+salt_version+'.StrType)le.FNAME,('+salt_version+'.StrType)le.MNAME,('+salt_version+'.StrType)le.LNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VENDORID_prop15 := PROJECT(VENDORID_prop14,VENDORID_addconceptMAINNAME(LEFT));\r\nVEH_PROP_VENDORID_prop15_layout := RECORD\r\n  VEH_PROP_VENDORID_prop14;\r\n  UNSIGNED4 MAINNAME;\r\nEND;\r\nVEH_PROP_VENDORID_prop15_layout VEH_PROP_VENDORID_addconceptMAINNAME(VEH_PROP_VENDORID_prop14 le) := TRANSFORM\r\n  SELF := le;\r\n  self.MAINNAME := hash32(('+salt_version+'.StrType)le.FNAME,('+salt_version+'.StrType)le.MNAME,('+salt_version+'.StrType)le.LNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VEH_PROP_VENDORID_prop15 := PROJECT(VEH_PROP_VENDORID_prop14,VEH_PROP_VENDORID_addconceptMAINNAME(LEFT));\r\nUnderLinks_prop15_layout := RECORD\r\n  UnderLinks_prop14;\r\n  UNSIGNED4 MAINNAME;\r\nEND;\r\nUnderLinks_prop15_layout UnderLinks_addconceptMAINNAME(UnderLinks_prop14 le) := TRANSFORM\r\n  SELF := le;\r\n  self.MAINNAME := hash32(('+salt_version+'.StrType)le.FNAME,('+salt_version+'.StrType)le.MNAME,('+salt_version+'.StrType)le.LNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED UnderLinks_prop15 := PROJECT(UnderLinks_prop14,UnderLinks_addconceptMAINNAME(LEFT));\r\nRelativeLinks_prop15_layout := RECORD\r\n  RelativeLinks_prop14;\r\n  UNSIGNED4 MAINNAME;\r\nEND;\r\nRelativeLinks_prop15_layout RelativeLinks_addconceptMAINNAME(RelativeLinks_prop14 le) := TRANSFORM\r\n  SELF := le;\r\n  self.MAINNAME := hash32(('+salt_version+'.StrType)le.FNAME,('+salt_version+'.StrType)le.MNAME,('+salt_version+'.StrType)le.LNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED RelativeLinks_prop15 := PROJECT(RelativeLinks_prop14,RelativeLinks_addconceptMAINNAME(LEFT));\r\nVENDORID_prop16_layout := RECORD\r\n  VENDORID_prop15;\r\n  UNSIGNED4 ADDR1;\r\nEND;\r\nVENDORID_prop16_layout VENDORID_addconceptADDR1(VENDORID_prop15 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDR1 := hash32(('+salt_version+'.StrType)le.PRIM_RANGE,('+salt_version+'.StrType)le.SEC_RANGE,('+salt_version+'.StrType)le.PRIM_NAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VENDORID_prop16 := PROJECT(VENDORID_prop15,VENDORID_addconceptADDR1(LEFT));\r\nVEH_PROP_VENDORID_prop16_layout := RECORD\r\n  VEH_PROP_VENDORID_prop15;\r\n  UNSIGNED4 ADDR1;\r\nEND;\r\nVEH_PROP_VENDORID_prop16_layout VEH_PROP_VENDORID_addconceptADDR1(VEH_PROP_VENDORID_prop15 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDR1 := hash32(('+salt_version+'.StrType)le.PRIM_RANGE,('+salt_version+'.StrType)le.SEC_RANGE,('+salt_version+'.StrType)le.PRIM_NAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VEH_PROP_VENDORID_prop16 := PROJECT(VEH_PROP_VENDORID_prop15,VEH_PROP_VENDORID_addconceptADDR1(LEFT));\r\nUnderLinks_prop16_layout := RECORD\r\n  UnderLinks_prop15;\r\n  UNSIGNED4 ADDR1;\r\nEND;\r\nUnderLinks_prop16_layout UnderLinks_addconceptADDR1(UnderLinks_prop15 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDR1 := hash32(('+salt_version+'.StrType)le.PRIM_RANGE,('+salt_version+'.StrType)le.SEC_RANGE,('+salt_version+'.StrType)le.PRIM_NAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED UnderLinks_prop16 := PROJECT(UnderLinks_prop15,UnderLinks_addconceptADDR1(LEFT));\r\nRelativeLinks_prop16_layout := RECORD\r\n  RelativeLinks_prop15;\r\n  UNSIGNED4 ADDR1;\r\nEND;\r\nRelativeLinks_prop16_layout RelativeLinks_addconceptADDR1(RelativeLinks_prop15 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDR1 := hash32(('+salt_version+'.StrType)le.PRIM_RANGE,('+salt_version+'.StrType)le.SEC_RANGE,('+salt_version+'.StrType)le.PRIM_NAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED RelativeLinks_prop16 := PROJECT(RelativeLinks_prop15,RelativeLinks_addconceptADDR1(LEFT));\r\nVENDORID_prop17_layout := RECORD\r\n  VENDORID_prop16;\r\n  UNSIGNED4 LOCALE;\r\nEND;\r\nVENDORID_prop17_layout VENDORID_addconceptLOCALE(VENDORID_prop16 le) := TRANSFORM\r\n  SELF := le;\r\n  self.LOCALE := hash32(('+salt_version+'.StrType)le.CITY,('+salt_version+'.StrType)le.ST,('+salt_version+'.StrType)le.ZIP); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VENDORID_prop17 := PROJECT(VENDORID_prop16,VENDORID_addconceptLOCALE(LEFT));\r\nVEH_PROP_VENDORID_prop17_layout := RECORD\r\n  VEH_PROP_VENDORID_prop16;\r\n  UNSIGNED4 LOCALE;\r\nEND;\r\nVEH_PROP_VENDORID_prop17_layout VEH_PROP_VENDORID_addconceptLOCALE(VEH_PROP_VENDORID_prop16 le) := TRANSFORM\r\n  SELF := le;\r\n  self.LOCALE := hash32(('+salt_version+'.StrType)le.CITY,('+salt_version+'.StrType)le.ST,('+salt_version+'.StrType)le.ZIP); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VEH_PROP_VENDORID_prop17 := PROJECT(VEH_PROP_VENDORID_prop16,VEH_PROP_VENDORID_addconceptLOCALE(LEFT));\r\nUnderLinks_prop17_layout := RECORD\r\n  UnderLinks_prop16;\r\n  UNSIGNED4 LOCALE;\r\nEND;\r\nUnderLinks_prop17_layout UnderLinks_addconceptLOCALE(UnderLinks_prop16 le) := TRANSFORM\r\n  SELF := le;\r\n  self.LOCALE := hash32(('+salt_version+'.StrType)le.CITY,('+salt_version+'.StrType)le.ST,('+salt_version+'.StrType)le.ZIP); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED UnderLinks_prop17 := PROJECT(UnderLinks_prop16,UnderLinks_addconceptLOCALE(LEFT));\r\nRelativeLinks_prop17_layout := RECORD\r\n  RelativeLinks_prop16;\r\n  UNSIGNED4 LOCALE;\r\nEND;\r\nRelativeLinks_prop17_layout RelativeLinks_addconceptLOCALE(RelativeLinks_prop16 le) := TRANSFORM\r\n  SELF := le;\r\n  self.LOCALE := hash32(('+salt_version+'.StrType)le.CITY,('+salt_version+'.StrType)le.ST,('+salt_version+'.StrType)le.ZIP); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED RelativeLinks_prop17 := PROJECT(RelativeLinks_prop16,RelativeLinks_addconceptLOCALE(LEFT));\r\nVENDORID_prop18_layout := RECORD\r\n  VENDORID_prop17;\r\n  UNSIGNED4 ADDRESS;\r\nEND;\r\nVENDORID_prop18_layout VENDORID_addconceptADDRESS(VENDORID_prop17 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDRESS := hash32(('+salt_version+'.StrType)le.ADDR1,('+salt_version+'.StrType)le.LOCALE); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VENDORID_prop18 := PROJECT(VENDORID_prop17,VENDORID_addconceptADDRESS(LEFT));\r\nVEH_PROP_VENDORID_prop18_layout := RECORD\r\n  VEH_PROP_VENDORID_prop17;\r\n  UNSIGNED4 ADDRESS;\r\nEND;\r\nVEH_PROP_VENDORID_prop18_layout VEH_PROP_VENDORID_addconceptADDRESS(VEH_PROP_VENDORID_prop17 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDRESS := hash32(('+salt_version+'.StrType)le.ADDR1,('+salt_version+'.StrType)le.LOCALE); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VEH_PROP_VENDORID_prop18 := PROJECT(VEH_PROP_VENDORID_prop17,VEH_PROP_VENDORID_addconceptADDRESS(LEFT));\r\nUnderLinks_prop18_layout := RECORD\r\n  UnderLinks_prop17;\r\n  UNSIGNED4 ADDRESS;\r\nEND;\r\nUnderLinks_prop18_layout UnderLinks_addconceptADDRESS(UnderLinks_prop17 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDRESS := hash32(('+salt_version+'.StrType)le.ADDR1,('+salt_version+'.StrType)le.LOCALE); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED UnderLinks_prop18 := PROJECT(UnderLinks_prop17,UnderLinks_addconceptADDRESS(LEFT));\r\nRelativeLinks_prop18_layout := RECORD\r\n  RelativeLinks_prop17;\r\n  UNSIGNED4 ADDRESS;\r\nEND;\r\nRelativeLinks_prop18_layout RelativeLinks_addconceptADDRESS(RelativeLinks_prop17 le) := TRANSFORM\r\n  SELF := le;\r\n  self.ADDRESS := hash32(('+salt_version+'.StrType)le.ADDR1,('+salt_version+'.StrType)le.LOCALE); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED RelativeLinks_prop18 := PROJECT(RelativeLinks_prop17,RelativeLinks_addconceptADDRESS(LEFT));\r\nVENDORID_prop19_layout := RECORD\r\n  VENDORID_prop18;\r\n  UNSIGNED4 FULLNAME;\r\nEND;\r\nVENDORID_prop19_layout VENDORID_addconceptFULLNAME(VENDORID_prop18 le) := TRANSFORM\r\n  SELF := le;\r\n  self.FULLNAME := hash32(('+salt_version+'.StrType)le.MAINNAME,('+salt_version+'.StrType)le.SNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VENDORID_prop19 := PROJECT(VENDORID_prop18,VENDORID_addconceptFULLNAME(LEFT));\r\nVEH_PROP_VENDORID_prop19_layout := RECORD\r\n  VEH_PROP_VENDORID_prop18;\r\n  UNSIGNED4 FULLNAME;\r\nEND;\r\nVEH_PROP_VENDORID_prop19_layout VEH_PROP_VENDORID_addconceptFULLNAME(VEH_PROP_VENDORID_prop18 le) := TRANSFORM\r\n  SELF := le;\r\n  self.FULLNAME := hash32(('+salt_version+'.StrType)le.MAINNAME,('+salt_version+'.StrType)le.SNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED VEH_PROP_VENDORID_prop19 := PROJECT(VEH_PROP_VENDORID_prop18,VEH_PROP_VENDORID_addconceptFULLNAME(LEFT));\r\nUnderLinks_prop19_layout := RECORD\r\n  UnderLinks_prop18;\r\n  UNSIGNED4 FULLNAME;\r\nEND;\r\nUnderLinks_prop19_layout UnderLinks_addconceptFULLNAME(UnderLinks_prop18 le) := TRANSFORM\r\n  SELF := le;\r\n  self.FULLNAME := hash32(('+salt_version+'.StrType)le.MAINNAME,('+salt_version+'.StrType)le.SNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED UnderLinks_prop19 := PROJECT(UnderLinks_prop18,UnderLinks_addconceptFULLNAME(LEFT));\r\nRelativeLinks_prop19_layout := RECORD\r\n  RelativeLinks_prop18;\r\n  UNSIGNED4 FULLNAME;\r\nEND;\r\nRelativeLinks_prop19_layout RelativeLinks_addconceptFULLNAME(RelativeLinks_prop18 le) := TRANSFORM\r\n  SELF := le;\r\n  self.FULLNAME := hash32(('+salt_version+'.StrType)le.MAINNAME,('+salt_version+'.StrType)le.SNAME); // Need to recompute hash as children have changed\r\nEND;\r\nSHARED RelativeLinks_prop19 := PROJECT(RelativeLinks_prop18,RelativeLinks_addconceptFULLNAME(LEFT));\r\nshared VENDORID_prp := VENDORID_prop19;\r\nshared VEH_PROP_VENDORID_prp := VEH_PROP_VENDORID_prop19;\r\nshared UnderLinks_prp := UnderLinks_prop19;\r\nshared RelativeLinks_prp := RelativeLinks_prop19;\r\n/*-----------added cfouts----------------*/');
//s13:=REGEXREPLACE('^([^\r\n]*)Grpd := GROUP\\( SORT\\(([^\r\n]*)$',s12,'/*   Grpd := GROUP( SORT(');
// s14:=REGEXREPLACE('^([^\r\n]*)SHARED h0 := UNGROUP\\(ROLLUP\\(Grpd,TRUE,Tr\\(LEFT,RIGHT\\)\\)\\);// Only one copy of each record',s13,'   SHARED h0 := UNGROUP(ROLLUP(Grpd,TRUE,Tr(LEFT,RIGHT)));// Only one copy of each record\r\n*/\r\nSHARED h0 := DEDUP( SORT ( DISTRIBUTE(propogated,HASH(DID)),  EXCEPT RID, LOCAL ), EXCEPT RID, LOCAL );');
// s15:=REGEXREPLACE('^([^\r\n]*)EXPORT Layout_VENDORID_Candidates := RECORD[ \r\n\t]*  \\{VENDORID_prp\\};[ \r\n\t]*INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*BOOLEAN SSN_isnull := \\(VENDORID_prp.SSN  IN SET\\(s.nulls_SSN,SSN\\) OR VENDORID_prp.SSN = \\(TYPEOF\\(VENDORID_prp.SSN\\)\\)\'\'\\); // Simplify later processing[ \r\n\t]*UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING4 SSN_Right4 := \\(STRING4\\)\'\';[ \r\n\t]*UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4[ \r\n\t]*UNSIGNED1 SSN_len := LENGTH\\(TRIM\\(VENDORID_prp.SSN\\)\\);[ \r\n\t]*BOOLEAN DOB_year_isnull := VENDORID_prp.DOB_year IN SET\\(s.nulls_DOB_year,DOB_year\\); // Simplifies later processing[ \r\n\t]*BOOLEAN DOB_month_isnull := VENDORID_prp.DOB_month IN SET\\(s.nulls_DOB_month,DOB_month\\); // Do for each of three parts of date[ \r\n\t]*BOOLEAN DOB_day_isnull := VENDORID_prp.DOB_day IN SET\\(s.nulls_DOB_day,DOB_day\\);[ \r\n\t]*UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*  BOOLEAN FNAME_isnull := \\(VENDORID_prp.FNAME  IN SET\\(s.nulls_FNAME,FNAME\\) OR VENDORID_prp.FNAME = \\(TYPEOF\\(VENDORID_prp.FNAME\\)\\)\'\'\\); // Simplify later processing [ \r\n\t]*  UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*  UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*  UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*  STRING20 FNAME_PreferredName := \\(STRING20\\)\'\';[ \r\n\t]*  UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName[ \r\n\t]*  UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW[ \r\n\t]*  UNSIGNED1 FNAME_len := LENGTH\\(TRIM\\(VENDORID_prp.FNAME\\)\\);',s12,'EXPORT Layout_VENDORID_Candidates := RECORD\r\n  {VENDORID_prp};\r\n  INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SSN_isnull := (VENDORID_prp.SSN  IN SET(s.nulls_SSN,SSN) OR VENDORID_prp.SSN = (TYPEOF(VENDORID_prp.SSN))\'\'); // Simplify later processing \r\n  UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING4 SSN_Right4 := (STRING4)\'\';\r\n  UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4\r\n  UNSIGNED1 SSN_len := LENGTH(TRIM(VENDORID_prp.SSN));\r\n  BOOLEAN DOB_year_isnull := VENDORID_prp.DOB_year IN SET(s.nulls_DOB_year,DOB_year); // Simplifies later processing\r\n  BOOLEAN DOB_month_isnull := VENDORID_prp.DOB_month IN SET(s.nulls_DOB_month,DOB_month); // Do for each of three parts of date\r\n  BOOLEAN DOB_day_isnull := VENDORID_prp.DOB_day IN SET(s.nulls_DOB_day,DOB_day);\r\n  UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity\r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 SNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SNAME_isnull := VENDORID_prp.SNAME  IN SET(s.nulls_SNAME,SNAME); // Simplify later processing \r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FNAME_isnull := (VENDORID_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) OR VENDORID_prp.FNAME = (TYPEOF(VENDORID_prp.FNAME))\'\'); // Simplify later processing \r\n  UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING20 FNAME_PreferredName := (STRING20)\'\';\r\n  UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName\r\n  UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  // UNSIGNED1 FNAME_len := LENGTH(TRIM(VENDORID_prp.FNAME));\r\n	/*---------------added cfouts --------------*/\r\n  INTEGER2 MNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 MNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MNAME_isnull := VENDORID_prp.MNAME  IN SET(s.nulls_MNAME,MNAME); // Simplify later processing\r\n  UNSIGNED MNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED MNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED MNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 LNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 LNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LNAME_isnull := VENDORID_prp.LNAME  IN SET(s.nulls_LNAME,LNAME); // Simplify later processing \r\n  UNSIGNED LNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED LNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED LNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 PRIM_NAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_NAME_isnull := VENDORID_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME); // Simplify later processing\r\n  INTEGER2 PRIM_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_RANGE_isnull := VENDORID_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE); // Simplify later processing\r\n  INTEGER2 SEC_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SEC_RANGE_isnull := VENDORID_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE); // Simplify later processing\r\n  INTEGER2 CITY_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN CITY_isnull := VENDORID_prp.CITY  IN SET(s.nulls_CITY,CITY); // Simplify later processing\r\n  INTEGER2 ST_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ST_isnull := VENDORID_prp.ST  IN SET(s.nulls_ST,ST); // Simplify later processing\r\n  INTEGER2 ZIP_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ZIP_isnull := VENDORID_prp.ZIP  IN SET(s.nulls_ZIP,ZIP); // Simplify later processing\r\n  INTEGER2 MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MAINNAME_isnull := (VENDORID_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND VENDORID_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND VENDORID_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)); // Simplify later processing\r\n  INTEGER2 ADDR1_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDR1_isnull := (VENDORID_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND VENDORID_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND VENDORID_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)); // Simplify later processing\r\n  INTEGER2 LOCALE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LOCALE_isnull := (VENDORID_prp.CITY  IN SET(s.nulls_CITY,CITY) AND VENDORID_prp.ST  IN SET(s.nulls_ST,ST) AND VENDORID_prp.ZIP  IN SET(s.nulls_ZIP,ZIP)); // Simplify later processing\r\n  INTEGER2 ADDRESS_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDRESS_isnull := ((VENDORID_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND VENDORID_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND VENDORID_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)) AND (VENDORID_prp.CITY  IN SET(s.nulls_CITY,CITY) AND VENDORID_prp.ST  IN SET(s.nulls_ST,ST) AND VENDORID_prp.ZIP  IN SET(s.nulls_ZIP,ZIP))); // Simplify later processing\r\n  INTEGER2 FULLNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FULLNAME_isnull := ((VENDORID_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND VENDORID_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND VENDORID_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)) AND VENDORID_prp.SNAME  IN SET(s.nulls_SNAME,SNAME)); // Simplify later processing\r\n	/*---------------added cfouts --------------*/');
// s16:=REGEXREPLACE('^([^\r\n]*)EXPORT Layout_VEH_PROP_VENDORID_Candidates := RECORD[ \r\n\t]*\\{VEH_PROP_VENDORID_prp\\};[ \r\n\t]*INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*BOOLEAN SSN_isnull := \\(VEH_PROP_VENDORID_prp.SSN  IN SET\\(s.nulls_SSN,SSN\\) OR VEH_PROP_VENDORID_prp.SSN = \\(TYPEOF\\(VEH_PROP_VENDORID_prp.SSN\\)\\)\'\'\\); // Simplify later processing[ \r\n\t]*UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING4 SSN_Right4 := \\(STRING4\\)\'\';[ \r\n\t]*UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4[ \r\n\t]*UNSIGNED1 SSN_len := LENGTH\\(TRIM\\(VEH_PROP_VENDORID_prp.SSN\\)\\);[ \r\n\t]*BOOLEAN DOB_year_isnull := VEH_PROP_VENDORID_prp.DOB_year IN SET\\(s.nulls_DOB_year,DOB_year\\); // Simplifies later processing[ \r\n\t]*BOOLEAN DOB_month_isnull := VEH_PROP_VENDORID_prp.DOB_month IN SET\\(s.nulls_DOB_month,DOB_month\\); // Do for each of three parts of date[ \r\n\t]*BOOLEAN DOB_day_isnull := VEH_PROP_VENDORID_prp.DOB_day IN SET\\(s.nulls_DOB_day,DOB_day\\);[ \r\n\t]*UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*  BOOLEAN FNAME_isnull := \\(VEH_PROP_VENDORID_prp.FNAME  IN SET\\(s.nulls_FNAME,FNAME\\) OR VEH_PROP_VENDORID_prp.FNAME = \\(TYPEOF\\(VEH_PROP_VENDORID_prp.FNAME\\)\\)\'\'\\); // Simplify later processing [ \r\n\t]*UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING20 FNAME_PreferredName := \\(STRING20\\)\'\';[ \r\n\t]*UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName[ \r\n\t]*UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW[ \r\n\t]*UNSIGNED1 FNAME_len := LENGTH\\(TRIM\\(VEH_PROP_VENDORID_prp.FNAME\\)\\);',s15,'EXPORT Layout_VEH_PROP_VENDORID_Candidates := RECORD\r\n  {VEH_PROP_VENDORID_prp};\r\n  INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SSN_isnull := (VEH_PROP_VENDORID_prp.SSN  IN SET(s.nulls_SSN,SSN) OR VEH_PROP_VENDORID_prp.SSN = (TYPEOF(VEH_PROP_VENDORID_prp.SSN))\'\'); // Simplify later processing \r\n  UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING4 SSN_Right4 := (STRING4)\'\';\r\n  UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4\r\n  UNSIGNED1 SSN_len := LENGTH(TRIM(VEH_PROP_VENDORID_prp.SSN));\r\n  BOOLEAN DOB_year_isnull := VEH_PROP_VENDORID_prp.DOB_year IN SET(s.nulls_DOB_year,DOB_year); // Simplifies later processing\r\n  BOOLEAN DOB_month_isnull := VEH_PROP_VENDORID_prp.DOB_month IN SET(s.nulls_DOB_month,DOB_month); // Do for each of three parts of date\r\n  BOOLEAN DOB_day_isnull := VEH_PROP_VENDORID_prp.DOB_day IN SET(s.nulls_DOB_day,DOB_day);\r\n  UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity\r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 SNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SNAME_isnull := VEH_PROP_VENDORID_prp.SNAME  IN SET(s.nulls_SNAME,SNAME); // Simplify later processing \r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FNAME_isnull := (VEH_PROP_VENDORID_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) OR VEH_PROP_VENDORID_prp.FNAME = (TYPEOF(VEH_PROP_VENDORID_prp.FNAME))\'\'); // Simplify later processing\r\n  UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING20 FNAME_PreferredName := (STRING20)\'\';\r\n  UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName\r\n  UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  // UNSIGNED1 FNAME_len := LENGTH(TRIM(VEH_PROP_VENDORID_prp.FNAME));\r\n	/*---------------added cfouts --------------*/\r\n  INTEGER2 MNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 MNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MNAME_isnull := VEH_PROP_VENDORID_prp.MNAME  IN SET(s.nulls_MNAME,MNAME); // Simplify later processing\r\n  UNSIGNED MNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED MNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED MNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 LNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 LNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LNAME_isnull := VEH_PROP_VENDORID_prp.LNAME  IN SET(s.nulls_LNAME,LNAME); // Simplify later processing \r\n  UNSIGNED LNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED LNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED LNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 PRIM_NAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_NAME_isnull := VEH_PROP_VENDORID_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME); // Simplify later processing\r\n  INTEGER2 PRIM_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_RANGE_isnull := VEH_PROP_VENDORID_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE); // Simplify later processing\r\n  INTEGER2 SEC_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SEC_RANGE_isnull := VEH_PROP_VENDORID_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE); // Simplify later processing\r\n  INTEGER2 CITY_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN CITY_isnull := VEH_PROP_VENDORID_prp.CITY  IN SET(s.nulls_CITY,CITY); // Simplify later processing\r\n  INTEGER2 ST_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ST_isnull := VEH_PROP_VENDORID_prp.ST  IN SET(s.nulls_ST,ST); // Simplify later processing\r\n  INTEGER2 ZIP_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ZIP_isnull := VEH_PROP_VENDORID_prp.ZIP  IN SET(s.nulls_ZIP,ZIP); // Simplify later processing\r\n  INTEGER2 MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MAINNAME_isnull := (VEH_PROP_VENDORID_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND VEH_PROP_VENDORID_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND VEH_PROP_VENDORID_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)); // Simplify later processing\r\n  INTEGER2 ADDR1_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDR1_isnull := (VEH_PROP_VENDORID_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND VEH_PROP_VENDORID_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND VEH_PROP_VENDORID_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)); // Simplify later processing\r\n  INTEGER2 LOCALE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LOCALE_isnull := (VEH_PROP_VENDORID_prp.CITY  IN SET(s.nulls_CITY,CITY) AND VEH_PROP_VENDORID_prp.ST  IN SET(s.nulls_ST,ST) AND VEH_PROP_VENDORID_prp.ZIP  IN SET(s.nulls_ZIP,ZIP)); // Simplify later processing\r\n  INTEGER2 ADDRESS_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDRESS_isnull := ((VEH_PROP_VENDORID_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND VEH_PROP_VENDORID_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND VEH_PROP_VENDORID_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)) AND (VEH_PROP_VENDORID_prp.CITY  IN SET(s.nulls_CITY,CITY) AND VEH_PROP_VENDORID_prp.ST  IN SET(s.nulls_ST,ST) AND VEH_PROP_VENDORID_prp.ZIP  IN SET(s.nulls_ZIP,ZIP))); // Simplify later processing\r\n  INTEGER2 FULLNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FULLNAME_isnull := ((VEH_PROP_VENDORID_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND VEH_PROP_VENDORID_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND VEH_PROP_VENDORID_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)) AND VEH_PROP_VENDORID_prp.SNAME  IN SET(s.nulls_SNAME,SNAME)); // Simplify later processing\r\n	/*---------------added cfouts --------------*/');
// s17:=REGEXREPLACE('^([^\r\n]*)EXPORT Layout_UnderLinks_Candidates := RECORD\r\n  \\{UnderLinks_prp\\};[ \r\n\t]*INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*BOOLEAN SSN_isnull := \\(UnderLinks_prp.SSN  IN SET\\(s.nulls_SSN,SSN\\) OR UnderLinks_prp.SSN = \\(TYPEOF\\(UnderLinks_prp.SSN\\)\\)\'\'\\); // Simplify later processing[ \r\n\t]*UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING4 SSN_Right4 := \\(STRING4\\)\'\';[ \r\n\t]*UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4[ \r\n\t]*UNSIGNED1 SSN_len := LENGTH\\(TRIM\\(UnderLinks_prp.SSN\\)\\);[ \r\n\t]*BOOLEAN DOB_year_isnull := UnderLinks_prp.DOB_year IN SET\\(s.nulls_DOB_year,DOB_year\\); // Simplifies later processing[ \r\n\t]*BOOLEAN DOB_month_isnull := UnderLinks_prp.DOB_month IN SET\\(s.nulls_DOB_month,DOB_month\\); // Do for each of three parts of date[ \r\n\t]*BOOLEAN DOB_day_isnull := UnderLinks_prp.DOB_day IN SET\\(s.nulls_DOB_day,DOB_day\\);[ \r\n\t]*UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*BOOLEAN FNAME_isnull := \\(UnderLinks_prp.FNAME  IN SET\\(s.nulls_FNAME,FNAME\\) OR UnderLinks_prp.FNAME = \\(TYPEOF\\(UnderLinks_prp.FNAME\\)\\)\'\'\\); // Simplify later processing[ \r\n\t]*UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING20 FNAME_PreferredName := \\(STRING20\\)\'\';[ \r\n\t]*UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName[ \r\n\t]*UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW[ \r\n\t]*UNSIGNED1 FNAME_len := LENGTH\\(TRIM\\(UnderLinks_prp.FNAME\\)\\);',s16,'EXPORT Layout_UnderLinks_Candidates := RECORD\r\n  {UnderLinks_prp};\r\n  INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SSN_isnull := (UnderLinks_prp.SSN  IN SET(s.nulls_SSN,SSN) OR UnderLinks_prp.SSN = (TYPEOF(UnderLinks_prp.SSN))\'\'); // Simplify later processing \r\n  UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING4 SSN_Right4 := (STRING4)\'\';\r\n  UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4\r\n  UNSIGNED1 SSN_len := LENGTH(TRIM(UnderLinks_prp.SSN));\r\n  BOOLEAN DOB_year_isnull := UnderLinks_prp.DOB_year IN SET(s.nulls_DOB_year,DOB_year); // Simplifies later processing\r\n  BOOLEAN DOB_month_isnull := UnderLinks_prp.DOB_month IN SET(s.nulls_DOB_month,DOB_month); // Do for each of three parts of date\r\n  BOOLEAN DOB_day_isnull := UnderLinks_prp.DOB_day IN SET(s.nulls_DOB_day,DOB_day);\r\n  UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity\r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 SNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SNAME_isnull := UnderLinks_prp.SNAME  IN SET(s.nulls_SNAME,SNAME); // Simplify later processing \r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FNAME_isnull := (UnderLinks_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) OR UnderLinks_prp.FNAME = (TYPEOF(UnderLinks_prp.FNAME))\'\'); // Simplify later processing\r\n  UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING20 FNAME_PreferredName := (STRING20)\'\';\r\n  UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName\r\n  UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  // UNSIGNED1 FNAME_len := LENGTH(TRIM(UnderLinks_prp.FNAME));\r\n	/*---------------added cfouts --------------*/\r\n  INTEGER2 MNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 MNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MNAME_isnull := UnderLinks_prp.MNAME  IN SET(s.nulls_MNAME,MNAME); // Simplify later processing\r\n  UNSIGNED MNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED MNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED MNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 LNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 LNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LNAME_isnull := UnderLinks_prp.LNAME  IN SET(s.nulls_LNAME,LNAME); // Simplify later processing \r\n  UNSIGNED LNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED LNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED LNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 PRIM_NAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_NAME_isnull := UnderLinks_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME); // Simplify later processing\r\n  INTEGER2 PRIM_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_RANGE_isnull := UnderLinks_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE); // Simplify later processing\r\n  INTEGER2 SEC_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SEC_RANGE_isnull := UnderLinks_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE); // Simplify later processing\r\n  INTEGER2 CITY_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN CITY_isnull := UnderLinks_prp.CITY  IN SET(s.nulls_CITY,CITY); // Simplify later processing\r\n  INTEGER2 ST_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ST_isnull := UnderLinks_prp.ST  IN SET(s.nulls_ST,ST); // Simplify later processing\r\n  INTEGER2 ZIP_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ZIP_isnull := UnderLinks_prp.ZIP  IN SET(s.nulls_ZIP,ZIP); // Simplify later processing\r\n  INTEGER2 MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MAINNAME_isnull := (UnderLinks_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND UnderLinks_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND UnderLinks_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)); // Simplify later processing\r\n  INTEGER2 ADDR1_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDR1_isnull := (UnderLinks_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND UnderLinks_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND UnderLinks_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)); // Simplify later processing\r\n  INTEGER2 LOCALE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LOCALE_isnull := (UnderLinks_prp.CITY  IN SET(s.nulls_CITY,CITY) AND UnderLinks_prp.ST  IN SET(s.nulls_ST,ST) AND UnderLinks_prp.ZIP  IN SET(s.nulls_ZIP,ZIP)); // Simplify later processing\r\n  INTEGER2 ADDRESS_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDRESS_isnull := ((UnderLinks_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND UnderLinks_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND UnderLinks_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)) AND (UnderLinks_prp.CITY  IN SET(s.nulls_CITY,CITY) AND UnderLinks_prp.ST  IN SET(s.nulls_ST,ST) AND UnderLinks_prp.ZIP  IN SET(s.nulls_ZIP,ZIP))); // Simplify later processing\r\n  INTEGER2 FULLNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FULLNAME_isnull := ((UnderLinks_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND UnderLinks_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND UnderLinks_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)) AND UnderLinks_prp.SNAME  IN SET(s.nulls_SNAME,SNAME)); // Simplify later processing\r\n	/*---------------added cfouts --------------*/');
// s18:=REGEXREPLACE('^([^\r\n]*)EXPORT Layout_RelativeLinks_Candidates := RECORD[ \r\n\t]*\\{RelativeLinks_prp\\};[ \r\n\t]*INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*BOOLEAN SSN_isnull := \\(RelativeLinks_prp.SSN  IN SET\\(s.nulls_SSN,SSN\\) OR RelativeLinks_prp.SSN = \\(TYPEOF\\(RelativeLinks_prp.SSN\\)\\)\'\'\\); // Simplify later processing[ \r\n\t]*UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING4 SSN_Right4 := \\(STRING4\\)\'\';[ \r\n\t]*UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4[ \r\n\t]*UNSIGNED1 SSN_len := LENGTH\\(TRIM\\(RelativeLinks_prp.SSN\\)\\);[ \r\n\t]*BOOLEAN DOB_year_isnull := RelativeLinks_prp.DOB_year IN SET\\(s.nulls_DOB_year,DOB_year\\); // Simplifies later processing[ \r\n\t]*BOOLEAN DOB_month_isnull := RelativeLinks_prp.DOB_month IN SET\\(s.nulls_DOB_month,DOB_month\\); // Do for each of three parts of date[ \r\n\t]*BOOLEAN DOB_day_isnull := RelativeLinks_prp.DOB_day IN SET\\(s.nulls_DOB_day,DOB_day\\);[ \r\n\t]*UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity[ \r\n\t]*BOOLEAN FNAME_isnull := \\(RelativeLinks_prp.FNAME  IN SET\\(s.nulls_FNAME,FNAME\\) OR RelativeLinks_prp.FNAME = \\(TYPEOF\\(RelativeLinks_prp.FNAME\\)\\)\'\'\\); // Simplify later processing[ \r\n\t]*UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value[ \r\n\t]*UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance[ \r\n\t]*STRING20 FNAME_PreferredName := \\(STRING20\\)\'\';[ \r\n\t]*UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName[ \r\n\t]*UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW[ \r\n\t]*UNSIGNED1 FNAME_len := LENGTH\\(TRIM\\(RelativeLinks_prp.FNAME\\)\\);',s17,'EXPORT Layout_RelativeLinks_Candidates := RECORD\r\n  {RelativeLinks_prp};\r\n  INTEGER2 SSN_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SSN_isnull := (RelativeLinks_prp.SSN  IN SET(s.nulls_SSN,SSN) OR RelativeLinks_prp.SSN = (TYPEOF(RelativeLinks_prp.SSN))\'\'); // Simplify later processing \r\n  UNSIGNED SSN_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED SSN_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING4 SSN_Right4 := (STRING4)\'\';\r\n  UNSIGNED SSN_Right4_cnt := 0; // Number of names instances matching this one using Right4\r\n  UNSIGNED1 SSN_len := LENGTH(TRIM(RelativeLinks_prp.SSN));\r\n  BOOLEAN DOB_year_isnull := RelativeLinks_prp.DOB_year IN SET(s.nulls_DOB_year,DOB_year); // Simplifies later processing\r\n  BOOLEAN DOB_month_isnull := RelativeLinks_prp.DOB_month IN SET(s.nulls_DOB_month,DOB_month); // Do for each of three parts of date\r\n  BOOLEAN DOB_day_isnull := RelativeLinks_prp.DOB_day IN SET(s.nulls_DOB_day,DOB_day);\r\n  UNSIGNED2 DOB_year_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_month_weight100 := 0; // Contains 100x the specificity\r\n  UNSIGNED2 DOB_day_weight100 := 0; // Contains 100x the specificity\r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 SNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SNAME_isnull := RelativeLinks_prp.SNAME  IN SET(s.nulls_SNAME,SNAME); // Simplify later processing \r\n	/*------------------added cfouts----------------------*/\r\n  INTEGER2 FNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_MAINNAME_fuzzy_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 FNAME_initial_char_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FNAME_isnull := (RelativeLinks_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) OR RelativeLinks_prp.FNAME = (TYPEOF(RelativeLinks_prp.FNAME))\'\'); // Simplify later processing\r\n  UNSIGNED FNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED FNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED FNAME_e1_cnt := 0; // Number of names instances matching this one by edit distance\r\n  STRING20 FNAME_PreferredName := (STRING20)\'\';\r\n  UNSIGNED FNAME_PreferredName_cnt := 0; // Number of names instances matching this one using PreferredName\r\n  UNSIGNED FNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  // UNSIGNED1 FNAME_len := LENGTH(TRIM(RelativeLinks_prp.FNAME));\r\n	/*---------------added cfouts --------------*/\r\n  INTEGER2 MNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 MNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MNAME_isnull := RelativeLinks_prp.MNAME  IN SET(s.nulls_MNAME,MNAME); // Simplify later processing\r\n  UNSIGNED MNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED MNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED MNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 LNAME_weight100 := 0; // Contains 100x the specificity\r\n  INTEGER2 LNAME_MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LNAME_isnull := RelativeLinks_prp.LNAME  IN SET(s.nulls_LNAME,LNAME); // Simplify later processing \r\n  UNSIGNED LNAME_cnt := 0; // Number of instances with this particular field value\r\n  UNSIGNED LNAME_e2_cnt := 0; // Number of names instances matching this one by edit distance\r\n  UNSIGNED LNAME_MAINNAME_cnt := 0; // Number of name instances matching this one in CONCEPT as BOW\r\n  INTEGER2 PRIM_NAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_NAME_isnull := RelativeLinks_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME); // Simplify later processing\r\n  INTEGER2 PRIM_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN PRIM_RANGE_isnull := RelativeLinks_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE); // Simplify later processing\r\n  INTEGER2 SEC_RANGE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN SEC_RANGE_isnull := RelativeLinks_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE); // Simplify later processing\r\n  INTEGER2 CITY_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN CITY_isnull := RelativeLinks_prp.CITY  IN SET(s.nulls_CITY,CITY); // Simplify later processing\r\n  INTEGER2 ST_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ST_isnull := RelativeLinks_prp.ST  IN SET(s.nulls_ST,ST); // Simplify later processing\r\n  INTEGER2 ZIP_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ZIP_isnull := RelativeLinks_prp.ZIP  IN SET(s.nulls_ZIP,ZIP); // Simplify later processing\r\n  INTEGER2 MAINNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN MAINNAME_isnull := (RelativeLinks_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND RelativeLinks_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND RelativeLinks_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)); // Simplify later processing\r\n  INTEGER2 ADDR1_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDR1_isnull := (RelativeLinks_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND RelativeLinks_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND RelativeLinks_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)); // Simplify later processing\r\n  INTEGER2 LOCALE_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN LOCALE_isnull := (RelativeLinks_prp.CITY  IN SET(s.nulls_CITY,CITY) AND RelativeLinks_prp.ST  IN SET(s.nulls_ST,ST) AND RelativeLinks_prp.ZIP  IN SET(s.nulls_ZIP,ZIP)); // Simplify later processing\r\n  INTEGER2 ADDRESS_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN ADDRESS_isnull := ((RelativeLinks_prp.PRIM_RANGE  IN SET(s.nulls_PRIM_RANGE,PRIM_RANGE) AND RelativeLinks_prp.SEC_RANGE  IN SET(s.nulls_SEC_RANGE,SEC_RANGE) AND RelativeLinks_prp.PRIM_NAME  IN SET(s.nulls_PRIM_NAME,PRIM_NAME)) AND (RelativeLinks_prp.CITY  IN SET(s.nulls_CITY,CITY) AND RelativeLinks_prp.ST  IN SET(s.nulls_ST,ST) AND RelativeLinks_prp.ZIP  IN SET(s.nulls_ZIP,ZIP))); // Simplify later processing\r\n  INTEGER2 FULLNAME_weight100 := 0; // Contains 100x the specificity\r\n  BOOLEAN FULLNAME_isnull := ((RelativeLinks_prp.FNAME  IN SET(s.nulls_FNAME,FNAME) AND RelativeLinks_prp.MNAME  IN SET(s.nulls_MNAME,MNAME) AND RelativeLinks_prp.LNAME  IN SET(s.nulls_LNAME,LNAME)) AND RelativeLinks_prp.SNAME  IN SET(s.nulls_SNAME,SNAME)); // Simplify later processing\r\n	/*---------------added cfouts --------------*/');
//s25:=REGEXREPLACE('SHARED Annotated := DISTRIBUTE\\(j0,hash\\(DID\\)\\) : PERSIST\\(\'~temp::DID::'+sModule+'::mc\',EXPIRE\\('+sModule+'.Config.PersistExpire\\)\\); // Distributed for keybuild case',s18,'SHARED Annotated := DISTRIBUTE(j0,hash(DID)) : PERSIST(\'~temp::\' + Config.Infix + \'::DID::'+sModule+'::mc\',EXPIRE('+sModule+'.Config.PersistExpire)); // Distributed for keybuild case\r\n	/*-------------------added cfouts----------------------*/	\r\nlayout_VENDORID_candidates add_VENDORID_ADDRESS(layout_VENDORID_candidates le,Specificities(ih).ADDRESS_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDRESS_weight100 := MAP (le.ADDRESS_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDRESS_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(VENDORID_pp,s.nulls_ADDRESS,Specificities(ih).ADDRESS_values_persisted,ADDRESS,ADDRESS_weight100,add_VENDORID_ADDRESS,jVENDORID_0);\r\n	/*-------------------added cfouts----------------------*/	');
//s26:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(VENDORID_pp,s.nulls_SSN,Specificities\\(ih\\).SSN_values_persisted,SSN,SSN_weight100,add_VENDORID_SSN,jVENDORID_1\\);',s25,salt_version+'.MAC_Choose_JoinType(jVENDORID_0,s.nulls_SSN,Specificities(ih).SSN_values_persisted,SSN,SSN_weight100,add_VENDORID_SSN,jVENDORID_1);\r\n	/*-------------------added cfouts----------------------*/\r\nlayout_VENDORID_candidates add_VENDORID_FULLNAME(layout_VENDORID_candidates le,Specificities(ih).FULLNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.FULLNAME_weight100 := MAP (le.FULLNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.FULLNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_1,s.nulls_FULLNAME,Specificities(ih).FULLNAME_values_persisted,FULLNAME,FULLNAME_weight100,add_VENDORID_FULLNAME,jVENDORID_5);\r\nlayout_VENDORID_candidates add_VENDORID_MAINNAME(layout_VENDORID_candidates le,Specificities(ih).MAINNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MAINNAME_weight100 := MAP (le.MAINNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MAINNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_5,s.nulls_MAINNAME,Specificities(ih).MAINNAME_values_persisted,MAINNAME,MAINNAME_weight100,add_VENDORID_MAINNAME,jVENDORID_6);\r\nlayout_VENDORID_candidates add_VENDORID_ADDR1(layout_VENDORID_candidates le,Specificities(ih).ADDR1_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDR1_weight100 := MAP (le.ADDR1_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDR1_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_6,s.nulls_ADDR1,Specificities(ih).ADDR1_values_persisted,ADDR1,ADDR1_weight100,add_VENDORID_ADDR1,jVENDORID_7);\r\n	/*-------------------added cfouts----------------------*/	');
//s27:=REGEXREPLACE('jVENDORID_9002 := JOIN\\(jVENDORID_9001,PULL\\(Specificities\\(ih\\).DOB_day_values_persisted\\),LEFT.DOB_day=RIGHT.DOB_day,add_VENDORID_DOB_day\\(LEFT,RIGHT,TRUE\\),LOOKUP,FEW,LEFT OUTER\\);',s26,'jVENDORID_9002 := JOIN(jVENDORID_9001,PULL(Specificities(ih).DOB_day_values_persisted),LEFT.DOB_day=RIGHT.DOB_day,add_VENDORID_DOB_day(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_VENDORID_candidates add_VENDORID_ZIP(layout_VENDORID_candidates le,Specificities(ih).ZIP_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ZIP_weight100 := MAP (le.ZIP_isnull => 0, patch_default and ri.field_specificity=0 => s.ZIP_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_9002,s.nulls_ZIP,Specificities(ih).ZIP_values_persisted,ZIP,ZIP_weight100,add_VENDORID_ZIP,jVENDORID_9);\r\nlayout_VENDORID_candidates add_VENDORID_LOCALE(layout_VENDORID_candidates le,Specificities(ih).LOCALE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LOCALE_weight100 := MAP (le.LOCALE_isnull => 0, patch_default and ri.field_specificity=0 => s.LOCALE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_9,s.nulls_LOCALE,Specificities(ih).LOCALE_values_persisted,LOCALE,LOCALE_weight100,add_VENDORID_LOCALE,jVENDORID_10);\r\nlayout_VENDORID_candidates add_VENDORID_PRIM_NAME(layout_VENDORID_candidates le,Specificities(ih).PRIM_NAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_NAME_weight100 := MAP (le.PRIM_NAME_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_NAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_10,s.nulls_PRIM_NAME,Specificities(ih).PRIM_NAME_values_persisted,PRIM_NAME,PRIM_NAME_weight100,add_VENDORID_PRIM_NAME,jVENDORID_11);\r\nlayout_VENDORID_candidates add_VENDORID_LNAME(layout_VENDORID_candidates le,Specificities(ih).LNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LNAME_cnt := ri.cnt;\r\n  SELF.LNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 LNAME_weight100 := MAP (le.LNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.LNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.LNAME_weight100 := LNAME_weight100;\r\n  SELF.LNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.LNAME_MAINNAME_weight100 := IF(LNAME_weight100>0,'+salt_version+'.Min1(LNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_11,s.nulls_LNAME,Specificities(ih).LNAME_values_persisted,LNAME,LNAME_weight100,add_VENDORID_LNAME,jVENDORID_12);\r\nlayout_VENDORID_candidates add_VENDORID_PRIM_RANGE(layout_VENDORID_candidates le,Specificities(ih).PRIM_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_RANGE_weight100 := MAP (le.PRIM_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_12,s.nulls_PRIM_RANGE,Specificities(ih).PRIM_RANGE_values_persisted,PRIM_RANGE,PRIM_RANGE_weight100,add_VENDORID_PRIM_RANGE,jVENDORID_13);\r\nlayout_VENDORID_candidates add_VENDORID_CITY(layout_VENDORID_candidates le,Specificities(ih).CITY_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.CITY_weight100 := MAP (le.CITY_isnull => 0, patch_default and ri.field_specificity=0 => s.CITY_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_13,s.nulls_CITY,Specificities(ih).CITY_values_persisted,CITY,CITY_weight100,add_VENDORID_CITY,jVENDORID_14);\r\n	/*-------------------added cfouts----------------------*/');	
//s28:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(jVENDORID_9002,s.nulls_FNAME,Specificities\\(ih\\).FNAME_values_persisted,FNAME,FNAME_weight100,add_VENDORID_FNAME,jVENDORID_15\\);',s27,salt_version+'.MAC_Choose_JoinType(jVENDORID_14,s.nulls_FNAME,Specificities(ih).FNAME_values_persisted,FNAME,FNAME_weight100,add_VENDORID_FNAME,jVENDORID_15);\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_VENDORID_candidates add_VENDORID_SEC_RANGE(layout_VENDORID_candidates le,Specificities(ih).SEC_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.SEC_RANGE_weight100 := MAP (le.SEC_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.SEC_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVENDORID_15,s.nulls_SEC_RANGE,Specificities(ih).SEC_RANGE_values_persisted,SEC_RANGE,SEC_RANGE_weight100,add_VENDORID_SEC_RANGE,jVENDORID_16);\r\nlayout_VENDORID_candidates add_VENDORID_MNAME(layout_VENDORID_candidates le,Specificities(ih).MNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MNAME_cnt := ri.cnt;\r\n  SELF.MNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 MNAME_weight100 := MAP (le.MNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.MNAME_weight100 := MNAME_weight100;\r\n  SELF.MNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.MNAME_MAINNAME_weight100 := IF(MNAME_weight100>0,'+salt_version+'.Min1(MNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\njVENDORID_17 := JOIN(jVENDORID_16,PULL(Specificities(ih).MNAME_values_persisted),LEFT.MNAME=RIGHT.MNAME,add_VENDORID_MNAME(LEFT,RIGHT,TRUE),LOOKUP,LEFT OUTER);\r\nlayout_VENDORID_candidates add_VENDORID_ST(layout_VENDORID_candidates le,Specificities(ih).ST_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ST_weight100 := MAP (le.ST_isnull => 0, patch_default and ri.field_specificity=0 => s.ST_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\njVENDORID_18 := JOIN(jVENDORID_17,PULL(Specificities(ih).ST_values_persisted),LEFT.ST=RIGHT.ST,add_VENDORID_ST(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\nlayout_VENDORID_candidates add_VENDORID_SNAME(layout_VENDORID_candidates le,Specificities(ih).SNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.SNAME_weight100 := MAP (le.SNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.SNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\njVENDORID_19 := JOIN(jVENDORID_18,PULL(Specificities(ih).SNAME_values_persisted),LEFT.SNAME=RIGHT.SNAME,add_VENDORID_SNAME(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n	/*-------------------added cfouts----------------------*/');	
//s29:=REGEXREPLACE('EXPORT VENDORID_candidates := jVENDORID_15 : PERSIST\\(\'~temp::DID::'+sModule+'::mc::VENDORID\',EXPIRE\\('+sModule+'.Config.PersistExpire\\)\\);',s28,'EXPORT VENDORID_candidates := jVENDORID_19 : PERSIST(\'~temp::\' + Config.Infix + \'::DID::'+sModule+'::mc::VENDORID\',EXPIRE('+sModule+'.Config.PersistExpire));\r\n//Now prepare candidate file for VEH_PROP_VENDORID attribute file\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_ADDRESS(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).ADDRESS_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDRESS_weight100 := MAP (le.ADDRESS_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDRESS_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(VEH_PROP_VENDORID_pp,s.nulls_ADDRESS,Specificities(ih).ADDRESS_values_persisted,ADDRESS,ADDRESS_weight100,add_VEH_PROP_VENDORID_ADDRESS,jVEH_PROP_VENDORID_0);\r\n	/*-------------------added cfouts----------------------*/	');
//s30:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(VEH_PROP_VENDORID_pp,s.nulls_SSN,Specificities\\(ih\\).SSN_values_persisted,SSN,SSN_weight100,add_VEH_PROP_VENDORID_SSN,jVEH_PROP_VENDORID_1\\);',s29,salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_0,s.nulls_SSN,Specificities(ih).SSN_values_persisted,SSN,SSN_weight100,add_VEH_PROP_VENDORID_SSN,jVEH_PROP_VENDORID_1);\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_FULLNAME(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).FULLNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.FULLNAME_weight100 := MAP (le.FULLNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.FULLNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_1,s.nulls_FULLNAME,Specificities(ih).FULLNAME_values_persisted,FULLNAME,FULLNAME_weight100,add_VEH_PROP_VENDORID_FULLNAME,jVEH_PROP_VENDORID_5);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_MAINNAME(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).MAINNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MAINNAME_weight100 := MAP (le.MAINNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MAINNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_5,s.nulls_MAINNAME,Specificities(ih).MAINNAME_values_persisted,MAINNAME,MAINNAME_weight100,add_VEH_PROP_VENDORID_MAINNAME,jVEH_PROP_VENDORID_6);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_ADDR1(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).ADDR1_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDR1_weight100 := MAP (le.ADDR1_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDR1_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_6,s.nulls_ADDR1,Specificities(ih).ADDR1_values_persisted,ADDR1,ADDR1_weight100,add_VEH_PROP_VENDORID_ADDR1,jVEH_PROP_VENDORID_7);\r\n	/*-------------------added cfouts----------------------*/	');
//s31:=REGEXREPLACE('jVEH_PROP_VENDORID_9000 := JOIN\\(jVEH_PROP_VENDORID_1',s30,hack_ind + 'jVEH_PROP_VENDORID_9000 := JOIN(jVEH_PROP_VENDORID_7');
//s32:=REGEXREPLACE('jVEH_PROP_VENDORID_9002 := JOIN\\(jVEH_PROP_VENDORID_9001,PULL\\(Specificities\\(ih\\).DOB_day_values_persisted\\),LEFT.DOB_day=RIGHT.DOB_day,add_VEH_PROP_VENDORID_DOB_day\\(LEFT,RIGHT,TRUE\\),LOOKUP,FEW,LEFT OUTER\\);',s31,'jVEH_PROP_VENDORID_9002 := JOIN(jVEH_PROP_VENDORID_9001,PULL(Specificities(ih).DOB_day_values_persisted),LEFT.DOB_day=RIGHT.DOB_day,add_VEH_PROP_VENDORID_DOB_day(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_ZIP(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).ZIP_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ZIP_weight100 := MAP (le.ZIP_isnull => 0, patch_default and ri.field_specificity=0 => s.ZIP_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_9002,s.nulls_ZIP,Specificities(ih).ZIP_values_persisted,ZIP,ZIP_weight100,add_VEH_PROP_VENDORID_ZIP,jVEH_PROP_VENDORID_9);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_LOCALE(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).LOCALE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LOCALE_weight100 := MAP (le.LOCALE_isnull => 0, patch_default and ri.field_specificity=0 => s.LOCALE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_9,s.nulls_LOCALE,Specificities(ih).LOCALE_values_persisted,LOCALE,LOCALE_weight100,add_VEH_PROP_VENDORID_LOCALE,jVEH_PROP_VENDORID_10);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_PRIM_NAME(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).PRIM_NAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_NAME_weight100 := MAP (le.PRIM_NAME_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_NAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_10,s.nulls_PRIM_NAME,Specificities(ih).PRIM_NAME_values_persisted,PRIM_NAME,PRIM_NAME_weight100,add_VEH_PROP_VENDORID_PRIM_NAME,jVEH_PROP_VENDORID_11);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_LNAME(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).LNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LNAME_cnt := ri.cnt;\r\n  SELF.LNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 LNAME_weight100 := MAP (le.LNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.LNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.LNAME_weight100 := LNAME_weight100;\r\n  SELF.LNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.LNAME_MAINNAME_weight100 := IF(LNAME_weight100>0,'+salt_version+'.Min1(LNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_11,s.nulls_LNAME,Specificities(ih).LNAME_values_persisted,LNAME,LNAME_weight100,add_VEH_PROP_VENDORID_LNAME,jVEH_PROP_VENDORID_12);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_PRIM_RANGE(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).PRIM_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_RANGE_weight100 := MAP (le.PRIM_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_12,s.nulls_PRIM_RANGE,Specificities(ih).PRIM_RANGE_values_persisted,PRIM_RANGE,PRIM_RANGE_weight100,add_VEH_PROP_VENDORID_PRIM_RANGE,jVEH_PROP_VENDORID_13);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_CITY(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).CITY_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.CITY_weight100 := MAP (le.CITY_isnull => 0, patch_default and ri.field_specificity=0 => s.CITY_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_13,s.nulls_CITY,Specificities(ih).CITY_values_persisted,CITY,CITY_weight100,add_VEH_PROP_VENDORID_CITY,jVEH_PROP_VENDORID_14);\r\n	/*-------------------added cfouts----------------------*/	');
//s33:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(jVEH_PROP_VENDORID_9002,s.nulls_FNAME,Specificities\\(ih\\).FNAME_values_persisted,FNAME,FNAME_weight100,add_VEH_PROP_VENDORID_FNAME,jVEH_PROP_VENDORID_15\\);',s32,salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_14,s.nulls_FNAME,Specificities(ih).FNAME_values_persisted,FNAME,FNAME_weight100,add_VEH_PROP_VENDORID_FNAME,jVEH_PROP_VENDORID_15);\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_SEC_RANGE(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).SEC_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.SEC_RANGE_weight100 := MAP (le.SEC_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.SEC_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jVEH_PROP_VENDORID_15,s.nulls_SEC_RANGE,Specificities(ih).SEC_RANGE_values_persisted,SEC_RANGE,SEC_RANGE_weight100,add_VEH_PROP_VENDORID_SEC_RANGE,jVEH_PROP_VENDORID_16);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_MNAME(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).MNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MNAME_cnt := ri.cnt;\r\n  SELF.MNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 MNAME_weight100 := MAP (le.MNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.MNAME_weight100 := MNAME_weight100;\r\n  SELF.MNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.MNAME_MAINNAME_weight100 := IF(MNAME_weight100>0,'+salt_version+'.Min1(MNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\njVEH_PROP_VENDORID_17 := JOIN(jVEH_PROP_VENDORID_16,PULL(Specificities(ih).MNAME_values_persisted),LEFT.MNAME=RIGHT.MNAME,add_VEH_PROP_VENDORID_MNAME(LEFT,RIGHT,TRUE),LOOKUP,LEFT OUTER);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_ST(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).ST_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ST_weight100 := MAP (le.ST_isnull => 0, patch_default and ri.field_specificity=0 => s.ST_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\njVEH_PROP_VENDORID_18 := JOIN(jVEH_PROP_VENDORID_17,PULL(Specificities(ih).ST_values_persisted),LEFT.ST=RIGHT.ST,add_VEH_PROP_VENDORID_ST(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\nlayout_VEH_PROP_VENDORID_candidates add_VEH_PROP_VENDORID_SNAME(layout_VEH_PROP_VENDORID_candidates le,Specificities(ih).SNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.SNAME_weight100 := MAP (le.SNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.SNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\njVEH_PROP_VENDORID_19 := JOIN(jVEH_PROP_VENDORID_18,PULL(Specificities(ih).SNAME_values_persisted),LEFT.SNAME=RIGHT.SNAME,add_VEH_PROP_VENDORID_SNAME(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n	/*-------------------added cfouts----------------------*/	');
//s34:=REGEXREPLACE('EXPORT VEH_PROP_VENDORID_candidates := jVEH_PROP_VENDORID_15 : PERSIST\\(\'~temp::DID::'+sModule+'::mc::VEH_PROP_VENDORID\',EXPIRE\\('+sModule+'.Config.PersistExpire\\)\\);',s33,'EXPORT VEH_PROP_VENDORID_candidates := jVEH_PROP_VENDORID_19 : PERSIST(\'~temp::\' + Config.Infix + \'::DID::'+sModule+'::mc::VEH_PROP_VENDORID\',EXPIRE('+sModule+'.Config.PersistExpire));');
//s35:=REGEXREPLACE('//Now prepare candidate file for UnderLinks attribute file',s34,'//Now prepare candidate file for UnderLinks attribute file\r\n	/*-------------------added cfouts----------------------*/	\r\nlayout_UnderLinks_candidates add_UnderLinks_ADDRESS(layout_UnderLinks_candidates le,Specificities(ih).ADDRESS_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDRESS_weight100 := MAP (le.ADDRESS_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDRESS_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(UnderLinks_pp,s.nulls_ADDRESS,Specificities(ih).ADDRESS_values_persisted,ADDRESS,ADDRESS_weight100,add_UnderLinks_ADDRESS,jUnderLinks_0);\r\n	/*-------------------added cfouts----------------------*/	');
//s36:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(UnderLinks_pp,s.nulls_SSN,Specificities\\(ih\\).SSN_values_persisted,SSN,SSN_weight100,add_UnderLinks_SSN,jUnderLinks_1\\);',s35,salt_version+'.MAC_Choose_JoinType(jUnderLinks_0,s.nulls_SSN,Specificities(ih).SSN_values_persisted,SSN,SSN_weight100,add_UnderLinks_SSN,jUnderLinks_1);\r\n	/*-------------------added cfouts----------------------*/	\r\nlayout_UnderLinks_candidates add_UnderLinks_FULLNAME(layout_UnderLinks_candidates le,Specificities(ih).FULLNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.FULLNAME_weight100 := MAP (le.FULLNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.FULLNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_1,s.nulls_FULLNAME,Specificities(ih).FULLNAME_values_persisted,FULLNAME,FULLNAME_weight100,add_UnderLinks_FULLNAME,jUnderLinks_5);\r\nlayout_UnderLinks_candidates add_UnderLinks_MAINNAME(layout_UnderLinks_candidates le,Specificities(ih).MAINNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MAINNAME_weight100 := MAP (le.MAINNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MAINNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_5,s.nulls_MAINNAME,Specificities(ih).MAINNAME_values_persisted,MAINNAME,MAINNAME_weight100,add_UnderLinks_MAINNAME,jUnderLinks_6);\r\nlayout_UnderLinks_candidates add_UnderLinks_ADDR1(layout_UnderLinks_candidates le,Specificities(ih).ADDR1_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDR1_weight100 := MAP (le.ADDR1_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDR1_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_6,s.nulls_ADDR1,Specificities(ih).ADDR1_values_persisted,ADDR1,ADDR1_weight100,add_UnderLinks_ADDR1,jUnderLinks_7);\r\n	/*-------------------added cfouts----------------------*/	');
//s37:=REGEXREPLACE('jUnderLinks_9000 := JOIN\\(jUnderLinks_1',s36,'jUnderLinks_9000 := JOIN(jUnderLinks_7');
//s38:=REGEXREPLACE('jUnderLinks_9002 := JOIN\\(jUnderLinks_9001,PULL\\(Specificities\\(ih\\).DOB_day_values_persisted\\),LEFT.DOB_day=RIGHT.DOB_day,add_UnderLinks_DOB_day\\(LEFT,RIGHT,TRUE\\),LOOKUP,FEW,LEFT OUTER\\);',s37,'jUnderLinks_9002 := JOIN(jUnderLinks_9001,PULL(Specificities(ih).DOB_day_values_persisted),LEFT.DOB_day=RIGHT.DOB_day,add_UnderLinks_DOB_day(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n	/*-------------------added cfouts----------------------*/	\r\nlayout_UnderLinks_candidates add_UnderLinks_ZIP(layout_UnderLinks_candidates le,Specificities(ih).ZIP_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ZIP_weight100 := MAP (le.ZIP_isnull => 0, patch_default and ri.field_specificity=0 => s.ZIP_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_9002,s.nulls_ZIP,Specificities(ih).ZIP_values_persisted,ZIP,ZIP_weight100,add_UnderLinks_ZIP,jUnderLinks_9);\r\nlayout_UnderLinks_candidates add_UnderLinks_LOCALE(layout_UnderLinks_candidates le,Specificities(ih).LOCALE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LOCALE_weight100 := MAP (le.LOCALE_isnull => 0, patch_default and ri.field_specificity=0 => s.LOCALE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_9,s.nulls_LOCALE,Specificities(ih).LOCALE_values_persisted,LOCALE,LOCALE_weight100,add_UnderLinks_LOCALE,jUnderLinks_10);\r\nlayout_UnderLinks_candidates add_UnderLinks_PRIM_NAME(layout_UnderLinks_candidates le,Specificities(ih).PRIM_NAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_NAME_weight100 := MAP (le.PRIM_NAME_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_NAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_10,s.nulls_PRIM_NAME,Specificities(ih).PRIM_NAME_values_persisted,PRIM_NAME,PRIM_NAME_weight100,add_UnderLinks_PRIM_NAME,jUnderLinks_11);\r\nlayout_UnderLinks_candidates add_UnderLinks_LNAME(layout_UnderLinks_candidates le,Specificities(ih).LNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LNAME_cnt := ri.cnt;\r\n  SELF.LNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 LNAME_weight100 := MAP (le.LNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.LNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.LNAME_weight100 := LNAME_weight100;\r\n  SELF.LNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.LNAME_MAINNAME_weight100 := IF(LNAME_weight100>0,'+salt_version+'.Min1(LNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_11,s.nulls_LNAME,Specificities(ih).LNAME_values_persisted,LNAME,LNAME_weight100,add_UnderLinks_LNAME,jUnderLinks_12);\r\nlayout_UnderLinks_candidates add_UnderLinks_PRIM_RANGE(layout_UnderLinks_candidates le,Specificities(ih).PRIM_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_RANGE_weight100 := MAP (le.PRIM_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_12,s.nulls_PRIM_RANGE,Specificities(ih).PRIM_RANGE_values_persisted,PRIM_RANGE,PRIM_RANGE_weight100,add_UnderLinks_PRIM_RANGE,jUnderLinks_13);\r\nlayout_UnderLinks_candidates add_UnderLinks_CITY(layout_UnderLinks_candidates le,Specificities(ih).CITY_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.CITY_weight100 := MAP (le.CITY_isnull => 0, patch_default and ri.field_specificity=0 => s.CITY_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_13,s.nulls_CITY,Specificities(ih).CITY_values_persisted,CITY,CITY_weight100,add_UnderLinks_CITY,jUnderLinks_14);\r\n	/*-------------------added cfouts----------------------*/');
//s39:=	REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(jUnderLinks_9002,s.nulls_FNAME,Specificities\\(ih\\).FNAME_values_persisted,FNAME,FNAME_weight100,add_UnderLinks_FNAME,jUnderLinks_15\\);',s38,salt_version+'.MAC_Choose_JoinType(jUnderLinks_14,s.nulls_FNAME,Specificities(ih).FNAME_values_persisted,FNAME,FNAME_weight100,add_UnderLinks_FNAME,jUnderLinks_15);\r\n	/*-------------------added cfouts----------------------*/\r\n	layout_UnderLinks_candidates add_UnderLinks_SEC_RANGE(layout_UnderLinks_candidates le,Specificities(ih).SEC_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n	  SELF.SEC_RANGE_weight100 := MAP (le.SEC_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.SEC_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n	  SELF := le;\r\n	END;\r\n	'+salt_version+'.MAC_Choose_JoinType(jUnderLinks_15,s.nulls_SEC_RANGE,Specificities(ih).SEC_RANGE_values_persisted,SEC_RANGE,SEC_RANGE_weight100,add_UnderLinks_SEC_RANGE,jUnderLinks_16);\r\n	layout_UnderLinks_candidates add_UnderLinks_MNAME(layout_UnderLinks_candidates le,Specificities(ih).MNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n	  SELF.MNAME_cnt := ri.cnt;\r\n	  SELF.MNAME_e2_cnt := ri.e2_cnt;\r\n	  INTEGER2 MNAME_weight100 := MAP (le.MNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n	  SELF.MNAME_weight100 := MNAME_weight100;\r\n	  SELF.MNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n	  SELF.MNAME_MAINNAME_weight100 := IF(MNAME_weight100>0,'+salt_version+'.Min1(MNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n	  SELF := le;\r\n	END;\r\n	jUnderLinks_17 := JOIN(jUnderLinks_16,PULL(Specificities(ih).MNAME_values_persisted),LEFT.MNAME=RIGHT.MNAME,add_UnderLinks_MNAME(LEFT,RIGHT,TRUE),LOOKUP,LEFT OUTER);\r\n	layout_UnderLinks_candidates add_UnderLinks_ST(layout_UnderLinks_candidates le,Specificities(ih).ST_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n	  SELF.ST_weight100 := MAP (le.ST_isnull => 0, patch_default and ri.field_specificity=0 => s.ST_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n	  SELF := le;\r\n	END;\r\n	jUnderLinks_18 := JOIN(jUnderLinks_17,PULL(Specificities(ih).ST_values_persisted),LEFT.ST=RIGHT.ST,add_UnderLinks_ST(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n	layout_UnderLinks_candidates add_UnderLinks_SNAME(layout_UnderLinks_candidates le,Specificities(ih).SNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n	  SELF.SNAME_weight100 := MAP (le.SNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.SNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n	  SELF := le;\r\n	END;\r\n	jUnderLinks_19 := JOIN(jUnderLinks_18,PULL(Specificities(ih).SNAME_values_persisted),LEFT.SNAME=RIGHT.SNAME,add_UnderLinks_SNAME(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n		/*-------------------added cfouts----------------------*/');
//s40:=REGEXREPLACE('EXPORT UnderLinks_candidates := jUnderLinks_15 : PERSIST\\(\'~temp::DID::'+sModule+'::mc::UnderLinks\',EXPIRE\\('+sModule+'.Config.PersistExpire\\)\\);',s39,'EXPORT UnderLinks_candidates := jUnderLinks_19 : PERSIST\\(\'~temp::\' + Config.Infix + \'::DID::'+sModule+'::mc::UnderLinks\',EXPIRE('+sModule+'.Config.PersistExpire));');
//s41:=REGEXREPLACE('//Now prepare candidate file for RelativeLinks attribute file',s40,'//Now prepare candidate file for RelativeLinks attribute file\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_RelativeLinks_candidates add_RelativeLinks_ADDRESS(layout_RelativeLinks_candidates le,Specificities(ih).ADDRESS_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDRESS_weight100 := MAP (le.ADDRESS_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDRESS_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(RelativeLinks_pp,s.nulls_ADDRESS,Specificities(ih).ADDRESS_values_persisted,ADDRESS,ADDRESS_weight100,add_RelativeLinks_ADDRESS,jRelativeLinks_0);\r\n	/*-------------------added cfouts----------------------*/');	
//s42:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(RelativeLinks_pp,s.nulls_SSN,Specificities\\(ih\\).SSN_values_persisted,SSN,SSN_weight100,add_RelativeLinks_SSN,jRelativeLinks_1\\);',s41,salt_version+'.MAC_Choose_JoinType(jRelativeLinks_0,s.nulls_SSN,Specificities(ih).SSN_values_persisted,SSN,SSN_weight100,add_RelativeLinks_SSN,jRelativeLinks_1);\r\n	/*-------------------added cfouts----------------------*/	\r\nlayout_RelativeLinks_candidates add_RelativeLinks_FULLNAME(layout_RelativeLinks_candidates le,Specificities(ih).FULLNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.FULLNAME_weight100 := MAP (le.FULLNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.FULLNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_1,s.nulls_FULLNAME,Specificities(ih).FULLNAME_values_persisted,FULLNAME,FULLNAME_weight100,add_RelativeLinks_FULLNAME,jRelativeLinks_5);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_MAINNAME(layout_RelativeLinks_candidates le,Specificities(ih).MAINNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MAINNAME_weight100 := MAP (le.MAINNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MAINNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_5,s.nulls_MAINNAME,Specificities(ih).MAINNAME_values_persisted,MAINNAME,MAINNAME_weight100,add_RelativeLinks_MAINNAME,jRelativeLinks_6);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_ADDR1(layout_RelativeLinks_candidates le,Specificities(ih).ADDR1_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ADDR1_weight100 := MAP (le.ADDR1_isnull => 0, patch_default and ri.field_specificity=0 => s.ADDR1_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_6,s.nulls_ADDR1,Specificities(ih).ADDR1_values_persisted,ADDR1,ADDR1_weight100,add_RelativeLinks_ADDR1,jRelativeLinks_7);\r\n	/*-------------------added cfouts----------------------*/');	
//s43:=REGEXREPLACE('jRelativeLinks_9000 := JOIN\\(jRelativeLinks_1',s42,'jRelativeLinks_9000 := JOIN(jRelativeLinks_7');
//s44:=REGEXREPLACE('jRelativeLinks_9002 := JOIN\\(jRelativeLinks_9001,PULL\\(Specificities\\(ih\\).DOB_day_values_persisted\\),LEFT.DOB_day=RIGHT.DOB_day,add_RelativeLinks_DOB_day\\(LEFT,RIGHT,TRUE\\),LOOKUP,FEW,LEFT OUTER\\);',s43,'jRelativeLinks_9002 := JOIN(jRelativeLinks_9001,PULL(Specificities(ih).DOB_day_values_persisted),LEFT.DOB_day=RIGHT.DOB_day,add_RelativeLinks_DOB_day(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n/*-------------------added cfouts----------------------*/	\r\nlayout_RelativeLinks_candidates add_RelativeLinks_ZIP(layout_RelativeLinks_candidates le,Specificities(ih).ZIP_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ZIP_weight100 := MAP (le.ZIP_isnull => 0, patch_default and ri.field_specificity=0 => s.ZIP_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_9002,s.nulls_ZIP,Specificities(ih).ZIP_values_persisted,ZIP,ZIP_weight100,add_RelativeLinks_ZIP,jRelativeLinks_9);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_LOCALE(layout_RelativeLinks_candidates le,Specificities(ih).LOCALE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LOCALE_weight100 := MAP (le.LOCALE_isnull => 0, patch_default and ri.field_specificity=0 => s.LOCALE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_9,s.nulls_LOCALE,Specificities(ih).LOCALE_values_persisted,LOCALE,LOCALE_weight100,add_RelativeLinks_LOCALE,jRelativeLinks_10);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_PRIM_NAME(layout_RelativeLinks_candidates le,Specificities(ih).PRIM_NAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_NAME_weight100 := MAP (le.PRIM_NAME_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_NAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_10,s.nulls_PRIM_NAME,Specificities(ih).PRIM_NAME_values_persisted,PRIM_NAME,PRIM_NAME_weight100,add_RelativeLinks_PRIM_NAME,jRelativeLinks_11);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_LNAME(layout_RelativeLinks_candidates le,Specificities(ih).LNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.LNAME_cnt := ri.cnt;\r\n  SELF.LNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 LNAME_weight100 := MAP (le.LNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.LNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.LNAME_weight100 := LNAME_weight100;\r\n  SELF.LNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.LNAME_MAINNAME_weight100 := IF(LNAME_weight100>0,'+salt_version+'.Min1(LNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_11,s.nulls_LNAME,Specificities(ih).LNAME_values_persisted,LNAME,LNAME_weight100,add_RelativeLinks_LNAME,jRelativeLinks_12);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_PRIM_RANGE(layout_RelativeLinks_candidates le,Specificities(ih).PRIM_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.PRIM_RANGE_weight100 := MAP (le.PRIM_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.PRIM_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_12,s.nulls_PRIM_RANGE,Specificities(ih).PRIM_RANGE_values_persisted,PRIM_RANGE,PRIM_RANGE_weight100,add_RelativeLinks_PRIM_RANGE,jRelativeLinks_13);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_CITY(layout_RelativeLinks_candidates le,Specificities(ih).CITY_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.CITY_weight100 := MAP (le.CITY_isnull => 0, patch_default and ri.field_specificity=0 => s.CITY_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_13,s.nulls_CITY,Specificities(ih).CITY_values_persisted,CITY,CITY_weight100,add_RelativeLinks_CITY,jRelativeLinks_14);\r\n	/*-------------------added cfouts----------------------*/	');
//s45:=REGEXREPLACE(salt_version+'.MAC_Choose_JoinType\\(jRelativeLinks_9002,s.nulls_FNAME,Specificities\\(ih\\).FNAME_values_persisted,FNAME,FNAME_weight100,add_RelativeLinks_FNAME,jRelativeLinks_15\\);',s44,salt_version+'.MAC_Choose_JoinType(jRelativeLinks_14,s.nulls_FNAME,Specificities(ih).FNAME_values_persisted,FNAME,FNAME_weight100,add_RelativeLinks_FNAME,jRelativeLinks_15);\r\n	/*-------------------added cfouts----------------------*/	\r\nlayout_RelativeLinks_candidates add_RelativeLinks_SEC_RANGE(layout_RelativeLinks_candidates le,Specificities(ih).SEC_RANGE_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.SEC_RANGE_weight100 := MAP (le.SEC_RANGE_isnull => 0, patch_default and ri.field_specificity=0 => s.SEC_RANGE_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\n'+salt_version+'.MAC_Choose_JoinType(jRelativeLinks_15,s.nulls_SEC_RANGE,Specificities(ih).SEC_RANGE_values_persisted,SEC_RANGE,SEC_RANGE_weight100,add_RelativeLinks_SEC_RANGE,jRelativeLinks_16);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_MNAME(layout_RelativeLinks_candidates le,Specificities(ih).MNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.MNAME_cnt := ri.cnt;\r\n  SELF.MNAME_e2_cnt := ri.e2_cnt;\r\n  INTEGER2 MNAME_weight100 := MAP (le.MNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.MNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF.MNAME_weight100 := MNAME_weight100;\r\n  SELF.MNAME_MAINNAME_cnt := ri.MAINNAME_cnt;\r\n  SELF.MNAME_MAINNAME_weight100 := IF(MNAME_weight100>0,'+salt_version+'.Min1(MNAME_weight100 + 100*log(ri.cnt/ri.MAINNAME_cnt)/log(2)),0); // Precompute CONCEPT-WORDBAG specificity \r\n  SELF := le;\r\nEND;\r\njRelativeLinks_17 := JOIN(jRelativeLinks_16,PULL(Specificities(ih).MNAME_values_persisted),LEFT.MNAME=RIGHT.MNAME,add_RelativeLinks_MNAME(LEFT,RIGHT,TRUE),LOOKUP,LEFT OUTER);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_ST(layout_RelativeLinks_candidates le,Specificities(ih).ST_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.ST_weight100 := MAP (le.ST_isnull => 0, patch_default and ri.field_specificity=0 => s.ST_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\njRelativeLinks_18 := JOIN(jRelativeLinks_17,PULL(Specificities(ih).ST_values_persisted),LEFT.ST=RIGHT.ST,add_RelativeLinks_ST(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\nlayout_RelativeLinks_candidates add_RelativeLinks_SNAME(layout_RelativeLinks_candidates le,Specificities(ih).SNAME_values_persisted ri,BOOLEAN patch_default) := TRANSFORM\r\n  SELF.SNAME_weight100 := MAP (le.SNAME_isnull => 0, patch_default and ri.field_specificity=0 => s.SNAME_maximum, ri.field_specificity) * 100; // If never seen before - must be rare\r\n  SELF := le;\r\nEND;\r\njRelativeLinks_19 := JOIN(jRelativeLinks_18,PULL(Specificities(ih).SNAME_values_persisted),LEFT.SNAME=RIGHT.SNAME,add_RelativeLinks_SNAME(LEFT,RIGHT,TRUE),LOOKUP,FEW,LEFT OUTER);\r\n	/*-------------------added cfouts----------------------*/	');
//s46:=REGEXREPLACE('EXPORT RelativeLinks_candidates := jRelativeLinks_15 : PERSIST\\(\'~temp::DID::'+sModule+'::mc::RelativeLinks\',EXPIRE\\('+sModule+'.Config.PersistExpire\\)\\);',s45,'EXPORT RelativeLinks_candidates := jRelativeLinks_19 : PERSIST(\'~temp::\' + Config.Infix + \'::DID::'+sModule+'::mc::RelativeLinks\',EXPIRE(InsuranceHeader_Salt_T46.Config.PersistExpire));');
//s47:=REGEXREPLACE('EXPORT BuddyCounts := TABLE\\(Annotated,\\{ buddies, Cnt := COUNT\\(GROUP\\) \\}, buddies, FEW\\);',s46,'// EXPORT BuddyCounts := TABLE(Annotated,{ buddies, Cnt := COUNT(GROUP) }, buddies, FEW);');
//s48:=REGEXREPLACE('EXPORT HasBuddies := TABLE\\(Annotated\\(buddies>0\\), \\{ RID \\}\\);',s47,'// EXPORT HasBuddies := TABLE(Annotated(buddies>0), { RID });');
//s49:=REGEXREPLACE('EXPORT Candidates := Annotated\\(\\); //Attribute Files might bring total score up to threshold',s48,'EXPORT Candidates := Annotated(); //Attribute Files might bring total score up to threshold\r\n	/*-------------------added cfouts----------------------*/\r\n	Annotated_ded_pre := DEDUP(SORT(DISTRIBUTE(Annotated,HASH(DID)), did,ssn,dob_year,dob_month,dob_day,dl_nbr,sname,fname,mname,lname,gender,derived_gender,prim_name,prim_range,sec_range,city,st,zip,policy_number,claim_number,cleavepenalty,dl_state,ambest,salt_partition,-dt_first_seen,-dt_last_seen,LOCAL ), \r\n											did,ssn,dob_year,dob_month,dob_day,dl_nbr,sname,fname,mname,lname,gender,derived_gender,prim_name,prim_range,sec_range,city,st,zip,policy_number,claim_number,cleavepenalty,dl_state,ambest,salt_partition,LOCAL);// Only one copy of each record\r\n	//Using HASH(did) to get smoother distribution\r\n	SHARED Annotated_ded := DISTRIBUTE(Annotated_ded_pre,hash(DID)) : PERSIST(\'temp::\' + Config.Infix + \'::HEADER_mc_lite\',EXPIRE('+sModule+'.Config.PersistExpire)); // Distributed for keybuild case\r\n	//Now see if these records are actually linkable\r\n	TotalWeight_ded := Annotated_ded.ADDRESS_weight100 + Annotated_ded.SSN_weight100 + Annotated_ded.POLICY_NUMBER_weight100 + Annotated_ded.CLAIM_NUMBER_weight100 + Annotated_ded.DL_NBR_weight100 + Annotated_ded.FULLNAME_weight100 + Annotated_ded.DOB_year_weight100 + Annotated_ded.DOB_month_weight100 + Annotated_ded.DOB_day_weight100 + Annotated_ded.GENDER_weight100 + Annotated_ded.DERIVED_GENDER_weight100;\r\n	SHARED Linkable_ded := TotalWeight_ded >= Config.MatchThreshold;\r\n	EXPORT Unlinkables_ded := Annotated_ded(~Linkable_ded); // Insufficient data to ever get a match\r\n	EXPORT Candidates_ded := Annotated_ded(); //Attribute Files might bring total score up to threshold\r\n		/*-------------------added cfouts----------------------*/	');
s50:= REGEXREPLACE('~temp::DID::'+sModule,s,'~temp::\' + Config.Infix + \'::DID'+sModule);
// s51:=REGEXREPLACE('jVENDORID_9000 := JOIN\\(jVENDORID_1',s50,hack_ind + 'jVENDORID_9000 := JOIN(jVENDORID_7');
sNew := s50;
EXPORT aMatchCandidateChanges := fSaveChange(attrName, s, sNew);

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// specificities changes
attrName := 'specificities';
s:=fGetAttribute(attrName);
salt_version0	:= REGEXFIND('SALT[0-9]+\\.StrType', s, 0);
salt_version	:= REGEXFIND('SALT[0-9]+', salt_version0, 0);
//s01:=REGEXREPLACE('^[ \t]*h02[ \t]\\:\\=[^\r\n]*$', s, hack_ind + 'shared h02 := project(h01,do_computes(left))(not (fname = \'\' and lname = \'\' and prim_name = \'\' and city = \'\'));');
//s02:= REGEXREPLACE('^([^\r\n]*)\'~temp::DID::'+sModule+'::([^\r\n]*)$', s01, '$1' + '\'~temp::\' + Config.Infix + \'::DID::' + '$2');
//s03 := REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*DT_FIRST_SEEN_deduped([^\r\n]*)$', s01,'$1' + '/*EXPORT DT_FIRST_SEEN_deduped' + '$2');
//s04 := REGEXREPLACE('values::DT_LAST_SEEN\',EXPIRE\\('+sModule+'.Config.PersistExpire\\)\\);', s03, 'values::DT_LAST_SEEN\',EXPIRE(Config.PersistExpire));*/');
//s05 := REGEXREPLACE('^([^\r\n]*)EXPORT SSNValuesIndexKeyName := ([^\r\n]*)$',s04,hack_ind + '$1'+ 'SHARED KeyNamePrevSuffix	:= \'_prev\';\r\nEXPORT SSNValuesIndexKeyName := ' + '$2');

fnew(string field, string s_ver) := FUNCTION
  RETURN REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*'+field+'ValuesIndexKeyName \\:\\= \'~\'\\+\'key::'+sModule+'::DID::Word::'+field+'\';([^\r\n]*)$',s_ver,hack_ind + 'EXPORT '+field+'ValuesIndexKeyName(STRING Version) := Filenames.spec_'+field +'_LF(version);\r\nEXPORT '+field+'ValuesIndexKeyNameSuper := CASE(Config.Superfile_Name, \'full\' => Filenames.spec_'+field +'_Full_SF.current,\'qa\' => Filenames.spec_'+field +'_QA_SF.current, Filenames.spec_'+field +'_SF.current);\r\n');			
END;

s06 := 	fnew('SSN',s);								
s07 := 	fnew('DOB_year',s06);								
s08 := 	fnew('DOB_month',s07);								
s09 := 	fnew('DOB_day',s08);								
s10 := 	fnew('DL_NBR',s09);								
s11 := 	fnew('SNAME',s10);								
s12 := 	fnew('FNAME',s11);								
s13 := 	fnew('MNAME',s12);								
s14 := 	fnew('LNAME',s13);								
s15 := 	fnew('GENDER',s14);								
s16 := 	fnew('DERIVED_GENDER',s15);								
s17 := 	fnew('PRIM_NAME',s16);								
s18 := 	fnew('PRIM_RANGE',s17);								
s19 := 	fnew('SEC_RANGE',s18);								
s20 := 	fnew('CITY',s19);								
s21 := 	fnew('ST',s20);								
s22 := 	fnew('ZIP',s21);								
s23 := 	fnew('POLICY_NUMBER',s22);								
s24 := 	fnew('CLAIM_NUMBER',s23);								
s25 := 	fnew('MAINNAME',s24);								
s26 := 	fnew('ADDR1',s25);								
s27 := 	fnew('LOCALE',s26);								
s28 := 	fnew('ADDRESS',s27);								
s29 := 	fnew('FULLNAME',s28);	
s30 := 	fnew('DT_FIRST_SEEN',s29);	
s31 := 	fnew('DT_LAST_SEEN',s30);	

// s30 := REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*DT_FIRST_SEENValuesIndexKeyName([^\r\n]*)$', s29,'$1' + '/*DT_FIRST_SEENValuesIndexKeyName' + '$2');
// s31 := REGEXREPLACE('^([^\r\n]*)DT_LAST_SEEN_specificity \\:\\= ol;([^\r\n]*)$', s30, '$1' + 'DT_LAST_SEEN_specificity := ol;*/' + '$2');
// fnew2(string field, string s_ver) := FUNCTION
// RETURN REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*'+field+'ValuesIndexKeyName \\:\\= \'~\'\\+\'key::'+sModule+'::DID::Word::'+field+'\';([^\r\n]*)$',s_ver,hack_ind + 'EXPORT '+field+'ValuesIndexKeyName := \'~\'+\'key::\' + Config.Infix + \'::DID::Word::'+field+'\';\r\nEXPORT '+field+'ValuesIndexKeyName_Prev := '+field+'ValuesIndexKeyName + KeyNamePrevSuffix;\r\n');			
// END;
// s32 := fnew2('VENDORID',s31);
// s33 := fnew2('VEH_PROP_VENDORID',s32);
// s34 := fnew2('UnderLinks',s33);
// s35 := fnew2('RelativeLinks',s34);
fnew3(string field, string s_ver) := FUNCTION
RETURN REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*'+field+'_values_index \\:\\= INDEX\\('+field+'_values_persisted(_temp|0),\\{'+field+'\\},\\{'+field+'_values_persisted(_temp|0)\\},'+field+'ValuesIndexKeyName\\);([^\r\n]*)$',s_ver,hack_ind + 'EXPORT '+field+'_values_index := INDEX('+field+'_values_persisted$2,{'+field+'},{'+field+'_values_persisted$3},'+field+'ValuesIndexKeyNameSuper);\r\nEXPORT '+field+'_values_index_Logical(STRING version) := INDEX('+field+'_values_persisted$2,{'+field+'},{'+field+'_values_persisted$3},'+field+'ValuesIndexKeyName(version));\r\n');			
END;

s32 := 	fnew3('SSN',s31);								
s33 := 	fnew3('DOB_year',s32);								
s34 := 	fnew3('DOB_month',s33);								
s35 := 	fnew3('DOB_day',s34);								
s36 := 	fnew3('DL_NBR',s35);								
s37 := 	fnew3('SNAME',s36);								
s38 := 	fnew3('FNAME',s37);								
s39 := 	fnew3('MNAME',s38);								
s40 := 	fnew3('LNAME',s39);								
s41 := 	fnew3('GENDER',s40);								
s42 := 	fnew3('DERIVED_GENDER',s41);								
s43 := 	fnew3('PRIM_NAME',s42);								
s44 := 	fnew3('PRIM_RANGE',s43);								
s45 := 	fnew3('SEC_RANGE',s44);								
s46 := 	fnew3('CITY',s45);								
s47 := 	fnew3('ST',s46);								
s48 := 	fnew3('ZIP',s47);								
s49 := 	fnew3('POLICY_NUMBER',s48);								
s50 := 	fnew3('CLAIM_NUMBER',s49);								
s51 := 	fnew3('MAINNAME',s50);								
s52 := 	fnew3('ADDR1',s51);								
s53 := 	fnew3('LOCALE',s52);								
s54 := 	fnew3('ADDRESS',s53);								
s55 := 	fnew3('FULLNAME',s54);	
s56 := 	fnew3('DT_FIRST_SEEN',s55);	
s57 := 	fnew3('DT_LAST_SEEN',s56);	
// s36 := fnew3('VENDORID',s35);
// s37 := fnew3('VEH_PROP_VENDORID',s36);
// s38 := fnew3('UnderLinks',s37);
// s39 := fnew3('RelativeLinks',s38);
s58 := REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*SpecIndexKeyName \\:\\= \'~\'\\+\'key::'+sModule+'::DID::Specificities\';([^\r\n]*)$',s57,hack_ind + 'EXPORT SpecIndexKeyName(STRING version) := Filenames.spec_SPECIFICITIES_LF(version);\r\nEXPORT SpecIndexKeyNameSuper := Filenames.spec_SPECIFICITIES_SF.current;');
s59 := REGEXREPLACE('^([^\r\n]*)iSpecificities \\:\\= DATASET',s58,'SHARED iSpecificities := DATASET');
s60 := REGEXREPLACE('^([^\r\n]*)EXPORT[ \t]*Specificities_Index \\:\\= INDEX\\(iSpecificities,\\{1\\},\\{iSpecificities\\},SpecIndexKeyName\\);([^\r\n]*)$',s59,hack_ind + 'EXPORT Specificities_Index := INDEX(iSpecificities,{1},{iSpecificities},SpecIndexKeyNameSuper);\r\nEXPORT Specificities_Index_Logical(STRING version) := INDEX(iSpecificities,{1},{iSpecificities},SpecIndexKeyName(version));');
s61 := REGEXREPLACE('^([^\r\n]*)integer1[ \t]*DT_FIRST_SEEN_shift0([^\r\n]*)$', s60,'$1' + '/*integer1 DT_FIRST_SEEN_shift0' + '$2');
s62 := REGEXREPLACE('^([^\r\n]*)DT_LAST_SEEN_switch_shift0 \\:\\= ROUND\\(1000\\*Specificities\\[1\\].DT_LAST_SEEN_switch - 0\\);([^\r\n]*)$', s61, '$1' + 'DT_LAST_SEEN_switch_shift0 := ROUND(1000*Specificities[1].DT_LAST_SEEN_switch - 0);*/' + '$2');
s63:=REGEXREPLACE(salt_version+'.MAC_Concept3_Specificities\\(MAINNAME_fuzzy_cnt,ofile,FNAME,e1_cnt,0,MNAME_values_persisted_temp,MNAME,e2_cnt,0,LNAME_values_persisted_temp,LNAME,e2_cnt,0,ofile_wfuzzy\\)[ \r\n\t]*SHARED FNAME_values_persisted0 := ofile_wfuzzy;',s62,'SHARED FNAME_values_persisted0 := ofile;');
s64:=REGEXREPLACE(salt_version+'.MAC_Concept3_Specificities\\(MAINNAME_fuzzy_cnt,ofile,MNAME,e2_cnt,0,FNAME_values_persisted_temp,FNAME,e1_cnt,0,LNAME_values_persisted_temp,LNAME,e2_cnt,0,ofile_wfuzzy\\)[ \r\n\t]*SHARED MNAME_values_persisted0 := ofile_wfuzzy;',s63,'SHARED MNAME_values_persisted0 := ofile;');
s65:=REGEXREPLACE(salt_version+'.MAC_Concept3_Specificities\\(MAINNAME_fuzzy_cnt,ofile,LNAME,e2_cnt,0,FNAME_values_persisted_temp,FNAME,e1_cnt,0,MNAME_values_persisted_temp,MNAME,e2_cnt,0,ofile_wfuzzy\\)[ \r\n\t]*SHARED LNAME_values_persisted0 := ofile_wfuzzy;',s64,'SHARED LNAME_values_persisted0 := ofile;');
s66:=REGEXREPLACE('EXPORT BuildFields := PARALLEL\\(BUILDINDEX\\(SSN_values_index, OVERWRITE\\),BUILDINDEX\\(DOB_year_values_index, OVERWRITE\\),BUILDINDEX\\(DOB_month_values_index, OVERWRITE\\),BUILDINDEX\\(DOB_day_values_index, OVERWRITE\\),BUILDINDEX\\(DL_NBR_values_index, OVERWRITE\\),BUILDINDEX\\(SNAME_values_index, OVERWRITE\\),BUILDINDEX\\(FNAME_values_index, OVERWRITE\\),BUILDINDEX\\(MNAME_values_index, OVERWRITE\\),BUILDINDEX\\(LNAME_values_index, OVERWRITE\\),BUILDINDEX\\(GENDER_values_index, OVERWRITE\\),BUILDINDEX\\(DERIVED_GENDER_values_index, OVERWRITE\\),BUILDINDEX\\(PRIM_NAME_values_index, OVERWRITE\\),BUILDINDEX\\(PRIM_RANGE_values_index, OVERWRITE\\),BUILDINDEX\\(SEC_RANGE_values_index, OVERWRITE\\),BUILDINDEX\\(CITY_values_index, OVERWRITE\\),BUILDINDEX\\(ST_values_index, OVERWRITE\\),BUILDINDEX\\(ZIP_values_index, OVERWRITE\\),BUILDINDEX\\(POLICY_NUMBER_values_index, OVERWRITE\\),BUILDINDEX\\(CLAIM_NUMBER_values_index, OVERWRITE\\),BUILDINDEX\\(DT_FIRST_SEEN_values_index, OVERWRITE\\),BUILDINDEX\\(DT_LAST_SEEN_values_index, OVERWRITE\\),BUILDINDEX\\(MAINNAME_values_index, OVERWRITE\\),BUILDINDEX\\(ADDR1_values_index, OVERWRITE\\),BUILDINDEX\\(LOCALE_values_index, OVERWRITE\\),BUILDINDEX\\(ADDRESS_values_index, OVERWRITE\\),BUILDINDEX\\(FULLNAME_values_index, OVERWRITE\\)\\);',s65,hack_ind+'EXPORT BuildFields(STRING version) := PARALLEL(BUILDINDEX(SSN_values_index_logical(version), OVERWRITE),BUILDINDEX(DOB_year_values_index_logical(version), OVERWRITE),BUILDINDEX(DOB_month_values_index_logical(version), OVERWRITE),BUILDINDEX(DOB_day_values_index_logical(version), OVERWRITE),BUILDINDEX(DL_NBR_values_index_logical(version), OVERWRITE),BUILDINDEX(SNAME_values_index_logical(version), OVERWRITE),BUILDINDEX(FNAME_values_index_logical(version), OVERWRITE),BUILDINDEX(MNAME_values_index_logical(version), OVERWRITE),BUILDINDEX(LNAME_values_index_logical(version), OVERWRITE),BUILDINDEX(GENDER_values_index_logical(version), OVERWRITE),BUILDINDEX(DERIVED_GENDER_values_index_logical(version), OVERWRITE),BUILDINDEX(PRIM_NAME_values_index_logical(version), OVERWRITE),BUILDINDEX(PRIM_RANGE_values_index_logical(version), OVERWRITE),BUILDINDEX(SEC_RANGE_values_index_logical(version), OVERWRITE),BUILDINDEX(CITY_values_index_logical(version), OVERWRITE),BUILDINDEX(ST_values_index_logical(version), OVERWRITE),BUILDINDEX(ZIP_values_index_logical(version), OVERWRITE),BUILDINDEX(POLICY_NUMBER_values_index_logical(version), OVERWRITE),BUILDINDEX(CLAIM_NUMBER_values_index_logical(version), OVERWRITE),BUILDINDEX(DT_FIRST_SEEN_values_index_logical(version), OVERWRITE),BUILDINDEX(DT_LAST_SEEN_values_index_logical(version), OVERWRITE),BUILDINDEX(MAINNAME_values_index_logical(version), OVERWRITE),BUILDINDEX(ADDR1_values_index_logical(version), OVERWRITE),BUILDINDEX(LOCALE_values_index_logical(version), OVERWRITE),BUILDINDEX(ADDRESS_values_index_logical(version), OVERWRITE),BUILDINDEX(FULLNAME_values_index_logical(version), OVERWRITE));');
s67:=REGEXREPLACE('EXPORT BuildAll := BuildFields;',s66,hack_ind+'EXPORT BuildAll(STRING version) := BuildFields(version);');
s68:=REGEXREPLACE('EXPORT Build := SEQUENTIAL \\( BuildAll, BUILDINDEX\\(Specificities_Index, OVERWRITE, FEW\\) \\);',s67,hack_ind+'EXPORT BuildSpec(STRING version) := BUILDINDEX(Specificities_Index_Logical(version), OVERWRITE, FEW);\r\n'+hack_ind+'EXPORT Build(STRING version) := SEQUENTIAL ( BuildAll(version), BUILDINDEX(Specificities_Index_Logical(version), OVERWRITE, FEW) );');

sNew := s68;
EXPORT aspecificitiesChanges := fSaveChange(attrName, s, sNew);

EXPORT aDoAll:=SEQUENTIAL(
	aConfigChanges,
	aDebugChanges,
	aMatchCandidateChanges,
	aspecificitiesChanges
);

END;