//BWR to show using the remote linking function directly. 
//FCRA and Boca based products will want to use this approach. 
IMPORT STD,_Control;

IP_Address := InsuranceHeader_RemoteLinking.Constants.HEADER_SERVICE_ROXIE_IP;

InsuranceHeader_RemoteLinking.Layouts.ServiceInputLayout_Batch Inquiry_Data(UNSIGNED C) := TRANSFORM
    SELF.ReferenceID := C;
    SELF.Inquiry_Lexid := 0;
    SELF.Results_Lexid := 0;
    SELF.VENDOR_ID_Inq := '';
    SELF.BOCA_DID_Inq := 0;
    SELF.SRC_Inq := '';
    SELF.SSN_Inq := '';
    SELF.DOB_Inq := 0;
    SELF.SNAME_Inq := '';
    SELF.FNAME_Inq := '';
    SELF.MNAME_Inq := '';
    SELF.LNAME_Inq := '';
    SELF.GENDER_Inq := '';
    SELF.DERIVED_GENDER_Inq := '';
    SELF.PRIM_NAME_Inq := '';
    SELF.PRIM_RANGE_Inq := '';
    SELF.SEC_RANGE_Inq := '';
    SELF.CITY_Inq := '';
    SELF.ST_Inq := '';
    SELF.ZIP_Inq := '';
    SELF.POLICY_NUMBER_Inq := '';
    SELF.CLAIM_NUMBER_Inq := '';
    SELF.DT_FIRST_SEEN_Inq := 0;
    SELF.DT_LAST_SEEN_Inq := 0;
    SELF.DL_STATE_Inq := '';
    SELF.DL_NBR_Inq := '';
    SELF.AMBEST_Inq := '';
    SELF.VENDOR_ID_Res := '';
    SELF.BOCA_DID_Res := 0;
    SELF.SRC_Res := '';
    SELF.SSN_Res := '';
    SELF.DOB_Res := 0;
    SELF.SNAME_Res := '';
    SELF.FNAME_Res := '';
    SELF.MNAME_Res := '';
    SELF.LNAME_Res := '';
    SELF.GENDER_Res := '';
    SELF.DERIVED_GENDER_Res := '';
    SELF.PRIM_NAME_Res := '';
    SELF.PRIM_RANGE_Res := '';
    SELF.SEC_RANGE_Res := '';
    SELF.CITY_Res := '';
    SELF.ST_Res := '';
    SELF.ZIP_Res := '';
    SELF.POLICY_NUMBER_Res := '';
    SELF.CLAIM_NUMBER_Res := '';
    SELF.DT_FIRST_SEEN_Res := 0;
    SELF.DT_LAST_SEEN_Res := 0;
    SELF.DL_STATE_Res := '';
    SELF.DL_NBR_Res := '';
    SELF.AMBEST_Res := '';
END;
InsuranceHeader_RemoteLinking.Layouts.ServiceInputLayout_Batch Inquiry_Data1(UNSIGNED C) := TRANSFORM
    SELF.ReferenceID := C;
    SELF.Inquiry_Lexid := 0;
    SELF.Results_Lexid := 0;
    SELF.VENDOR_ID_Inq := '';
    SELF.BOCA_DID_Inq := 0;
    SELF.SRC_Inq := '';
    SELF.SSN_Inq := '';
    SELF.DOB_Inq := 0;
    SELF.SNAME_Inq := '';
    SELF.FNAME_Inq := '';
    SELF.MNAME_Inq := '';
    SELF.LNAME_Inq := '';
    SELF.GENDER_Inq := '';
    SELF.DERIVED_GENDER_Inq := '';
    SELF.PRIM_NAME_Inq := '';
    SELF.PRIM_RANGE_Inq := '';
    SELF.SEC_RANGE_Inq := '';
    SELF.CITY_Inq := '';
    SELF.ST_Inq := '';
    SELF.ZIP_Inq := '';
    SELF.POLICY_NUMBER_Inq := '';
    SELF.CLAIM_NUMBER_Inq := '';
    SELF.DT_FIRST_SEEN_Inq := 0;
    SELF.DT_LAST_SEEN_Inq := 0;
    SELF.DL_STATE_Inq := '';
    SELF.DL_NBR_Inq := '';
    SELF.AMBEST_Inq := '';
    SELF.VENDOR_ID_Res := '';
    SELF.BOCA_DID_Res := 0;
    SELF.SRC_Res := '';
    SELF.SSN_Res := '';
    SELF.DOB_Res := 0;
    SELF.SNAME_Res := '';
    SELF.FNAME_Res := '';
    SELF.MNAME_Res := '';
    SELF.LNAME_Res := '';
    SELF.GENDER_Res := '';
    SELF.DERIVED_GENDER_Res := '';
    SELF.PRIM_NAME_Res := '';
    SELF.PRIM_RANGE_Res := '';
    SELF.SEC_RANGE_Res := '';
    SELF.CITY_Res := '';
    SELF.ST_Res := '';
    SELF.ZIP_Res := '';
    SELF.POLICY_NUMBER_Res := '';
    SELF.CLAIM_NUMBER_Res := '';
    SELF.DT_FIRST_SEEN_Res := 0;
    SELF.DT_LAST_SEEN_Res := 0;
    SELF.DL_STATE_Res := '';
    SELF.DL_NBR_Res := '';
    SELF.AMBEST_Res := '';
END;
InsuranceHeader_RemoteLinking.Layouts.ServiceInputLayout_Batch Inquiry_Data2(UNSIGNED C) := TRANSFORM
    SELF.ReferenceID := C;
    SELF.Inquiry_Lexid := 0;
    SELF.Results_Lexid := 0;
    SELF.VENDOR_ID_Inq := '';
    SELF.BOCA_DID_Inq := 0;
    SELF.SRC_Inq := '';
    SELF.SSN_Inq := '';
    SELF.DOB_Inq := 0;
    SELF.SNAME_Inq := '';
    SELF.FNAME_Inq := '';
    SELF.MNAME_Inq := '';
    SELF.LNAME_Inq := '';
    SELF.GENDER_Inq := '';
    SELF.DERIVED_GENDER_Inq := '';
    SELF.PRIM_NAME_Inq := '';
    SELF.PRIM_RANGE_Inq := '';
    SELF.SEC_RANGE_Inq := '';
    SELF.CITY_Inq := '';
    SELF.ST_Inq := '';
    SELF.ZIP_Inq := '';
    SELF.POLICY_NUMBER_Inq := '';
    SELF.CLAIM_NUMBER_Inq := '';
    SELF.DT_FIRST_SEEN_Inq := 0;
    SELF.DT_LAST_SEEN_Inq := 0;
    SELF.DL_STATE_Inq := '';
    SELF.DL_NBR_Inq := '';
    SELF.AMBEST_Inq := '';
    SELF.VENDOR_ID_Res := '';
    SELF.BOCA_DID_Res := 0;
    SELF.SRC_Res := '';
    SELF.SSN_Res := '';
    SELF.DOB_Res := 0;
    SELF.SNAME_Res := '';
    SELF.FNAME_Res := '';
    SELF.MNAME_Res := '';
    SELF.LNAME_Res := '';
    SELF.GENDER_Res := '';
    SELF.DERIVED_GENDER_Res := '';
    SELF.PRIM_NAME_Res := '';
    SELF.PRIM_RANGE_Res := '';
    SELF.SEC_RANGE_Res := '';
    SELF.CITY_Res := '';
    SELF.ST_Res := '';
    SELF.ZIP_Res := '';
    SELF.POLICY_NUMBER_Res := '';
    SELF.CLAIM_NUMBER_Res := '';
    SELF.DT_FIRST_SEEN_Res := 0;
    SELF.DT_LAST_SEEN_Res := 0;
    SELF.DL_STATE_Res := '';
    SELF.DL_NBR_Res := '';
    SELF.AMBEST_Res := '';
END;
Input_Data := DATASET([Inquiry_Data(1)]) + DATASET([Inquiry_Data1(2)]) + DATASET([Inquiry_Data2(1)]);

//Input_Data := Normalize(Input_Data1,34,Inquiry_Data(COUNTER)) + Normalize(Input_Data1,33,Inquiry_Data1(COUNTER + 34)) + Normalize(Input_Data1,33,Inquiry_Data2(COUNTER+67));

out_rec := RECORD
    STRING50 IPAddress;
    STRING20 Enviroment;
    BOOLEAN  checkpassed;
  END;
user_info := DATASET([{IP_Address,STD.Str.ToUpperCase(_Control.ThisEnvironment.RoxieEnv),STD.Str.ToUpperCase(_Control.ThisEnvironment.RoxieEnv) = 'PROD'}],out_rec);
OUTPUT(user_info,NAMED('User_Info'));
  

InsuranceHeader_RemoteLinking.fn_RemoteLinking_Soapcall_Batch(Input_Data,IP_Address);
