  // #workunit('name', 'CellPhoneOwnersStrata' );
Import STRATA;
Export Out_Base_Stats_Population(String Filedate) := function
BaseFile :=CellPhone_Owners.File_Base_CellPhoneOwners;
      
rPopulationStats_BaseFile  :=   record
		Countgroup	:=	Count(Group);
		BaseFile.State;
		Bdid_Cnt := Sum(Group,If(BaseFile.Bdid<>0,1,0));
		Bdid_Score_Cnt := Sum(Group,If(BaseFile.Bdid_Score<>0,1,0));
		Did_Cnt := Sum(Group,If(BaseFile.Did<>0,1,0));
		Did_Score_Cnt := Sum(Group,If(BaseFile.Did_Score<>0,1,0));
		Raw_Aid_Cnt := Sum(Group,If(BaseFile.Raw_Aid<>0,1,0));
		MachineName_Cnt := Sum(Group,If(BaseFile.MachineName<>'',1,0));
		Date_First_Seen_Cnt := Sum(Group,If(BaseFile.Date_First_Seen<>'',1,0));
		Date_Last_Seen_Cnt := Sum(Group,If(BaseFile.Date_Last_Seen<>'',1,0));
		Vendor_First_Reported_Cnt := Sum(Group,If(BaseFile.Vendor_First_Reported<>'',1,0));
		Vendor_Last_Reported_Cnt := Sum(Group,If(BaseFile.Vendor_Last_Reported<>'',1,0));
		Appended_First_Name_Cnt := Sum(Group,If(BaseFile.Appended_First_Name<>'',1,0));
		Appended_Middle_Name_Cnt := Sum(Group,If(BaseFile.Appended_Middle_Name<>'',1,0));
		Appended_Surname_Cnt := Sum(Group,If(BaseFile.Appended_Surname<>'',1,0));
		Appended_Company_Name_Cnt := Sum(Group,If(BaseFile.Appended_Company_Name<>'',1,0));
		Appended_Callerid_Name_Cnt := Sum(Group,If(BaseFile.Appended_Callerid_Name<>'',1,0));
		Appended_Street_Number_Cnt := Sum(Group,If(BaseFile.Appended_Street_Number<>'',1,0));
		Appended_Pre_Directional_Cnt := Sum(Group,If(BaseFile.Appended_Pre_Directional<>'',1,0));
		Appended_Street_Name_Cnt := Sum(Group,If(BaseFile.Appended_Street_Name<>'',1,0));
		Appended_Street_Suffix_Cnt := Sum(Group,If(BaseFile.Appended_Street_Suffix<>'',1,0));
		Appended_Post_Directional_Cnt := Sum(Group,If(BaseFile.Appended_Post_Directional<>'',1,0));
		Appended_Unit_Designator_Cnt := Sum(Group,If(BaseFile.Appended_Unit_Designator<>'',1,0));
		Appended_Unit_Number_Cnt := Sum(Group,If(BaseFile.Appended_Unit_Number<>'',1,0));
		Appended_City_Cnt := Sum(Group,If(BaseFile.Appended_City<>'',1,0));
		Appended_State_Code_Cnt := Sum(Group,If(BaseFile.Appended_State_Code<>'',1,0));
		Appended_Zip_Code_Cnt := Sum(Group,If(BaseFile.Appended_Zip_Code<>'',1,0));
		Appended_Zip_Code_Extension_Cnt := Sum(Group,If(BaseFile.Appended_Zip_Code_Extension<>'',1,0));
		Delivery_Point_Code_Cnt := Sum(Group,If(BaseFile.Delivery_Point_Code<>'',1,0));
		Carrier_Route_Code_Cnt := Sum(Group,If(BaseFile.Carrier_Route_Code<>'',1,0));
		Appended_County_Code_Cnt := Sum(Group,If(BaseFile.Appended_County_Code<>'',1,0));
		Zip4_Type_Code_Cnt := Sum(Group,If(BaseFile.Zip4_Type_Code<>'',1,0));
		Delivery_Point_Validation_Cnt := Sum(Group,If(BaseFile.Delivery_Point_Validation<>'',1,0));
		Appended_Mail_Able_Flag_Cnt := Sum(Group,If(BaseFile.Appended_Mail_Able_Flag<>'',1,0));
		Validation_Date_Cnt := Sum(Group,If(BaseFile.Validation_Date<>'',1,0));
		Appended_Phone_Cnt := Sum(Group,If(BaseFile.Appended_Phone<>'',1,0));
		Appended_Phone_Type_Cnt := Sum(Group,If(BaseFile.Appended_Phone_Type<>'',1,0));
		Appended_Direct_In_Dial_Flag_Cnt := Sum(Group,If(BaseFile.Appended_Direct_In_Dial_Flag<>'',1,0));
		Appended_Record_Type_Cnt := Sum(Group,If(BaseFile.Appended_Record_Type<>'',1,0));
		Appended_First_Date_Cnt := Sum(Group,If(BaseFile.Appended_First_Date<>'',1,0));
		Appended_Last_Date_Cnt := Sum(Group,If(BaseFile.Appended_Last_Date<>'',1,0));
		Appended_Telco_Name_Cnt := Sum(Group,If(BaseFile.Appended_Telco_Name<>'',1,0));
		Appended_Phone_Score_Cnt := Sum(Group,If(BaseFile.Appended_Phone_Score<>'',1,0));
		Appended_Directory_Assistance_Flag_Cnt := Sum(Group,If(BaseFile.Appended_Directory_Assistance_Flag<>'',1,0));
		Mcd_Match_Code_Cnt := Sum(Group,If(BaseFile.Mcd_Match_Code<>'',1,0));
		Match_Type_Cnt := Sum(Group,If(BaseFile.Match_Type<>'',1,0));
		Match_Level_Cnt := Sum(Group,If(BaseFile.Match_Level<>'',1,0));
		Lexis_Nexis_Match_Code_Cnt := Sum(Group,If(BaseFile.Lexis_Nexis_Match_Code<>'',1,0));
		Prepaid_Phone_Flag_Cnt := Sum(Group,If(BaseFile.Prepaid_Phone_Flag<>'',1,0));
		Filler_Field_4_Cnt := Sum(Group,If(BaseFile.Filler_Field_4<>'',1,0));
		Nametype_Cnt := Sum(Group,If(BaseFile.Nametype<>'',1,0));
		Cln_Title_Cnt := Sum(Group,If(BaseFile.Cln_Title<>'',1,0));
		Cln_Fname_Cnt := Sum(Group,If(BaseFile.Cln_Fname<>'',1,0));
		Cln_Mname_Cnt := Sum(Group,If(BaseFile.Cln_Mname<>'',1,0));
		Cln_Lname_Cnt := Sum(Group,If(BaseFile.Cln_Lname<>'',1,0));
		Cln_Suffix_Cnt := Sum(Group,If(BaseFile.Cln_Suffix<>'',1,0));
		Street_Pre_Direction_Cnt := Sum(Group,If(BaseFile.Street_Pre_Direction<>'',1,0));
		Street_Post_Direction_Cnt := Sum(Group,If(BaseFile.Street_Post_Direction<>'',1,0));
		Street_Number_Cnt := Sum(Group,If(BaseFile.Street_Number<>'',1,0));
		Street_Name_Cnt := Sum(Group,If(BaseFile.Street_Name<>'',1,0));
		Street_Suffix_Cnt := Sum(Group,If(BaseFile.Street_Suffix<>'',1,0));
		Unit_Number_Cnt := Sum(Group,If(BaseFile.Unit_Number<>'',1,0));
		Unit_Designation_Cnt := Sum(Group,If(BaseFile.Unit_Designation<>'',1,0));
		Zip5_Cnt := Sum(Group,If(BaseFile.Zip5<>'',1,0));
		Zip4_Cnt := Sum(Group,If(BaseFile.Zip4<>'',1,0));
		City_Cnt := Sum(Group,If(BaseFile.City<>'',1,0));
		State_Cnt := Sum(Group,If(BaseFile.State<>'',1,0));
 END;
 
BaseStrata:=Sort(Table(BaseFile, rPopulationStats_BaseFile), State, Few);
Strata.Createxmlstats(BaseStrata,'Cellphone Owners Stats','Data',Filedate,'',StrataResults);
 
 Return StrataResults;
End;
