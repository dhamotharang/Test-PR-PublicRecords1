import Scrubs_DCA, DCAV2, Data_Services;

dBaseContacts:= DCAV2.Files().Base.Contacts.built;
	
	// Transform to flatten out the file due to nested fields in the Base layout
	Scrubs_DCA.Base_Contacts_Layout_DCA trf(DCAV2.Layouts.Base.Contacts l):= transform
			self.rawfields_Enterprise_num					:= l.rawfields.Enterprise_num;
			self.rawfields_Level      						:= l.rawfields.Level;      
			self.rawfields_Name    								:= l.rawfields.Name;    
			self.rawfields_address1_PO_Box_Bldg   := l.rawfields.address1.PO_Box_Bldg;      
			self.rawfields_address1_Street     		:= l.rawfields.address1.Street;     
			self.rawfields_address1_Foreign_PO    := l.rawfields.address1.Foreign_PO;     
			self.rawfields_address1_Misc__adr     := l.rawfields.address1.Misc__adr;     
			self.rawfields_address1_Postal_Code_1 := l.rawfields.address1.Postal_Code_1;     
			self.rawfields_address1_City      		:= l.rawfields.address1.City;      
			self.rawfields_address1_State      		:= l.rawfields.address1.State;      
			self.rawfields_address1_Zip     			:= l.rawfields.address1.Zip;     
			self.rawfields_address1_Province     	:= l.rawfields.address1.Province;     
			self.rawfields_address1_Postal_Code_2	:= l.rawfields.address1.Postal_Code_2;      
			self.rawfields_address1_Country     	:= l.rawfields.address1.Country;     
			self.rawfields_address1_Postal_Code_3	:= l.rawfields.address1.Postal_Code_3;     
			self.rawfields_Phone     							:= l.rawfields.Phone;     
			self.rawfields_Fax      							:= l.rawfields.Fax;      
			self.rawfields_Telex     							:= l.rawfields.Telex;     
			self.rawfields_address2_PO_Box_Bldg  	:= l.rawfields.address2.PO_Box_Bldg;      
			self.rawfields_address2_Street     		:= l.rawfields.address2.Street;     
			self.rawfields_address2_Foreign_PO   	:= l.rawfields.address2.Foreign_PO;     
			self.rawfields_address2_Misc__adr     := l.rawfields.address2.Misc__adr;     
			self.rawfields_address2_Postal_Code_1 := l.rawfields.address2.Postal_Code_1;     
			self.rawfields_address2_City      		:= l.rawfields.address2.City;      
			self.rawfields_address2_State      		:= l.rawfields.address2.State;      
			self.rawfields_address2_Zip     			:= l.rawfields.address2.Zip;     
			self.rawfields_address2_Province     	:= l.rawfields.address2.Province;     
			self.rawfields_address2_Postal_Code_2 := l.rawfields.address2.Postal_Code_2;      
			self.rawfields_address2_Country     	:= l.rawfields.address2.Country;     
			self.rawfields_address2_Postal_Code_3	:= l.rawfields.address2.Postal_Code_3;    
			self.rawfields_executive_Name     	  := l.rawfields.executive.Name;     
			self.rawfields_executive_Title     	  := l.rawfields.executive.Title;     
			self.rawfields_executive_code 			  := l.rawfields.executive.code; 
			self.rawfields_Update_Date						:= l.rawfields.Update_Date;
			self.clean_name_title									:= l.clean_name.title;
			self.clean_name_fname									:= l.clean_name.fname;
			self.clean_name_mname									:= l.clean_name.mname;
			self.clean_name_lname									:= l.clean_name.lname;
			self.clean_name_name_suffix						:= l.clean_name.name_suffix;
			self.clean_name_name_score						:= l.clean_name.name_score;
			self.physical_address_prim_range 			:= l.physical_address.prim_range; 
			self.physical_address_predir					:= l.physical_address.predir;
			self.physical_address_prim_name				:= l.physical_address.prim_name;
			self.physical_address_addr_suffix  		:= l.physical_address.addr_suffix;  
			self.physical_address_postdir					:= l.physical_address.postdir;
			self.physical_address_unit_desig			:= l.physical_address.unit_desig;
			self.physical_address_sec_range				:= l.physical_address.sec_range;
			self.physical_address_p_city_name			:= l.physical_address.p_city_name;
			self.physical_address_v_city_name  		:= l.physical_address.v_city_name;  
			self.physical_address_st							:= l.physical_address.st;
			self.physical_address_zip							:= l.physical_address.zip;
			self.physical_address_zip4						:= l.physical_address.zip4;
			self.physical_address_cart						:= l.physical_address.cart;
			self.physical_address_cr_sort_sz			:= l.physical_address.cr_sort_sz;
			self.physical_address_lot							:= l.physical_address.lot;
			self.physical_address_lot_order				:= l.physical_address.lot_order;
			self.physical_address_dbpc						:= l.physical_address.dbpc;
			self.physical_address_chk_digit				:= l.physical_address.chk_digit;
			self.physical_address_rec_type				:= l.physical_address.rec_type;
			self.physical_address_fips_state			:= l.physical_address.fips_state;
			self.physical_address_fips_county			:= l.physical_address.fips_county;
			self.physical_address_geo_lat					:= l.physical_address.geo_lat;
			self.physical_address_geo_long				:= l.physical_address.geo_long;
			self.physical_address_msa							:= l.physical_address.msa;
			self.physical_address_geo_blk					:= l.physical_address.geo_blk;
			self.physical_address_geo_match				:= l.physical_address.geo_match;
			self.physical_address_err_stat				:= l.physical_address.err_stat;
			self.mailing_address_prim_range 			:= l.mailing_address.prim_range; 
			self.mailing_address_predir						:= l.mailing_address.predir;
			self.mailing_address_prim_name				:= l.mailing_address.prim_name;
			self.mailing_address_addr_suffix 			:= l.mailing_address.addr_suffix; 
			self.mailing_address_postdir					:= l.mailing_address.postdir;
			self.mailing_address_unit_desig				:= l.mailing_address.unit_desig;
			self.mailing_address_sec_range				:= l.mailing_address.sec_range;
			self.mailing_address_p_city_name			:= l.mailing_address.p_city_name;
			self.mailing_address_v_city_name 			:= l.mailing_address.v_city_name; 
			self.mailing_address_st								:= l.mailing_address.st;
			self.mailing_address_zip							:= l.mailing_address.zip;
			self.mailing_address_zip4							:= l.mailing_address.zip4;
			self.mailing_address_cart							:= l.mailing_address.cart;
			self.mailing_address_cr_sort_sz				:= l.mailing_address.cr_sort_sz;
			self.mailing_address_lot							:= l.mailing_address.lot;
			self.mailing_address_lot_order				:= l.mailing_address.lot_order;
			self.mailing_address_dbpc							:= l.mailing_address.dbpc;
			self.mailing_address_chk_digit				:= l.mailing_address.chk_digit;
			self.mailing_address_rec_type					:= l.mailing_address.rec_type;
			self.mailing_address_fips_state				:= l.mailing_address.fips_state;
			self.mailing_address_fips_county			:= l.mailing_address.fips_county;
			self.mailing_address_geo_lat					:= l.mailing_address.geo_lat;
			self.mailing_address_geo_long					:= l.mailing_address.geo_long;
			self.mailing_address_msa							:= l.mailing_address.msa;
			self.mailing_address_geo_blk					:= l.mailing_address.geo_blk;
			self.mailing_address_geo_match				:= l.mailing_address.geo_match;
			self.mailing_address_err_stat					:= l.mailing_address.err_stat;
			self.clean_phones_Phone     					:= l.clean_phones.Phone;     
			self.clean_phones_Fax      						:= l.clean_phones.Fax;      
			self.clean_phones_Telex 							:= l.clean_phones.Telex; 
			self                             			:= l;																				
			self														 			:= [];
	end; 

  EXPORT Base_Contacts_In_DCA := project(dBaseContacts, trf(left));