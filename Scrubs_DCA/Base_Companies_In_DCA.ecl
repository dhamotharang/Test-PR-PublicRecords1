import Scrubs_DCA, DCAV2, Data_Services;

dBaseCompanies:= DCAV2.Files().Base.Companies.built;

	// Transform to flatten out the file due to nested fields in the Base layout
	Scrubs_DCA.Base_Companies_Layout_DCA trf(DCAV2.Layouts.Base.Companies l):= transform
			self.rawfields_Enterprise_num								:= l.rawfields.Enterprise_num;
			self.rawfields_Parent_Enterprise_number  		:= l.rawfields.Parent_Enterprise_number ;
			self.rawfields_Ultimate_Enterprise_number  	:= l.rawfields.Ultimate_Enterprise_number ;
			self.rawfields_Company_Type   							:= l.rawfields.Company_Type;
			self.rawfields_Name   											:= l.rawfields.Name;
			self.rawfields_Note   											:= l.rawfields.Note;
			self.rawfields_Level   											:= l.rawfields.Level;
			self.rawfields_Root   											:= l.rawfields.Root;
			self.rawfields_Sub   												:= l.rawfields.Sub;
			self.rawfields_Parent_Name   								:= l.rawfields.Parent_Name;
			self.rawfields_Parent_Number   							:= l.rawfields.Parent_Number;
			self.rawfields_JV_Parent1   								:= l.rawfields.JV_Parent1;
			self.rawfields_JV1_num   										:= l.rawfields.JV1_num;
			self.rawfields_JV_Parent2   								:= l.rawfields.JV_Parent2;
			self.rawfields_JV2_num   										:= l.rawfields.JV2_num;
			self.rawfields_address1_PO_Box_Bldg   			:= l.rawfields.address1.PO_Box_Bldg;
			self.rawfields_address1_Street   						:= l.rawfields.address1.Street;
			self.rawfields_address1_Foreign_PO   				:= l.rawfields.address1.Foreign_PO;
			self.rawfields_address1_Misc__adr   				:= l.rawfields.address1.Misc__adr;
			self.rawfields_address1_Postal_Code_1   		:= l.rawfields.address1.Postal_Code_1;
			self.rawfields_address1_City   							:= l.rawfields.address1.City;
			self.rawfields_address1_State   						:= l.rawfields.address1.State;
			self.rawfields_address1_Zip   							:= l.rawfields.address1.Zip;
			self.rawfields_address1_Province   					:= l.rawfields.address1.Province;
			self.rawfields_address1_Postal_Code_2   		:= l.rawfields.address1.Postal_Code_2;
			self.rawfields_address1_Country   					:= l.rawfields.address1.Country;
			self.rawfields_address1_Postal_Code_3   		:= l.rawfields.address1.Postal_Code_3;
			self.rawfields_Phone   											:= l.rawfields.Phone;
			self.rawfields_Fax   												:= l.rawfields.Fax;
			self.rawfields_Telex   											:= l.rawfields.Telex;
			self.rawfields_E_mail   										:= l.rawfields.E_mail;
			self.rawfields_URL   												:= l.rawfields.URL;
			self.rawfields_address2_PO_Box_Bldg   			:= l.rawfields.address2.PO_Box_Bldg;
			self.rawfields_address2_Street   						:= l.rawfields.address2.Street;
			self.rawfields_address2_Foreign_PO   				:= l.rawfields.address2.Foreign_PO;
			self.rawfields_address2_Misc__adr   				:= l.rawfields.address2.Misc__adr;
			self.rawfields_address2_Postal_Code_1   		:= l.rawfields.address2.Postal_Code_1;
			self.rawfields_address2_City   							:= l.rawfields.address2.City;
			self.rawfields_address2_State   						:= l.rawfields.address2.State;
			self.rawfields_address2_Zip   							:= l.rawfields.address2.Zip;
			self.rawfields_address2_Province   					:= l.rawfields.address2.Province;
			self.rawfields_address2_Postal_Code_2   		:= l.rawfields.address2.Postal_Code_2;
			self.rawfields_address2_Country   					:= l.rawfields.address2.Country;
			self.rawfields_address2_Postal_Code_3   		:= l.rawfields.address2.Postal_Code_3;
			self.rawfields_Incorp   										:= l.rawfields.Incorp;
			self.rawfields_percent_owned   							:= l.rawfields.percent_owned;
			self.rawfields_Earnings    									:= l.rawfields.Earnings ;
			self.rawfields_Sales   											:= l.rawfields.Sales;
			self.rawfields_Sales_Desc   								:= l.rawfields.Sales_Desc;
			self.rawfields_Assets   										:= l.rawfields.Assets;
			self.rawfields_Liabilities   								:= l.rawfields.Liabilities;
			self.rawfields_Net_Worth   									:= l.rawfields.Net_Worth;
			self.rawfields_FYE   												:= l.rawfields.FYE;
			self.rawfields_EMP_NUM   										:= l.rawfields.EMP_NUM;
			self.rawfields_DoesImport   								:= l.rawfields.DoesImport;
			self.rawfields_DoesExport   								:= l.rawfields.DoesExport;
			self.rawfields_Bus_Desc    									:= l.rawfields.Bus_Desc ;
			self.rawfields_Sic1   											:= l.rawfields.Sic1;
			self.rawfields_Text1   											:= l.rawfields.Text1;
			self.rawfields_Sic2   											:= l.rawfields.Sic2;
			self.rawfields_Text2   											:= l.rawfields.Text2;
			self.rawfields_Sic3   											:= l.rawfields.Sic3;
			self.rawfields_Text3   											:= l.rawfields.Text3;
			self.rawfields_Sic4   											:= l.rawfields.Sic4;
			self.rawfields_Text4   											:= l.rawfields.Text4;
			self.rawfields_Sic5   											:= l.rawfields.Sic5;
			self.rawfields_Text5   											:= l.rawfields.Text5;
			self.rawfields_Sic6   											:= l.rawfields.Sic6;
			self.rawfields_Text6   											:= l.rawfields.Text6;
			self.rawfields_Sic7   											:= l.rawfields.Sic7;
			self.rawfields_Text7   											:= l.rawfields.Text7;
			self.rawfields_Sic8   											:= l.rawfields.Sic8;
			self.rawfields_Text8   											:= l.rawfields.Text8;
			self.rawfields_Sic9   											:= l.rawfields.Sic9;
			self.rawfields_Text9   											:= l.rawfields.Text9;
			self.rawfields_Sic10   											:= l.rawfields.Sic10;
			self.rawfields_Text10   										:= l.rawfields.Text10;
			self.rawfields_Ticker_Symbol   							:= l.rawfields.Ticker_Symbol;
			self.rawfields_Exchange1   									:= l.rawfields.Exchange1;
			self.rawfields_Exchange2   									:= l.rawfields.Exchange2;
			self.rawfields_Exchange3   									:= l.rawfields.Exchange3;
			self.rawfields_Exchange4   									:= l.rawfields.Exchange4;
			self.rawfields_Exchange5   									:= l.rawfields.Exchange5;
			self.rawfields_Exchange6   									:= l.rawfields.Exchange6;
			self.rawfields_Exchange7   									:= l.rawfields.Exchange7;
			self.rawfields_Exchange8   									:= l.rawfields.Exchange8;
			self.rawfields_Exchange9   									:= l.rawfields.Exchange9;
			self.rawfields_Exchange10  								 	:= l.rawfields.Exchange10;
			self.rawfields_Exchange11   								:= l.rawfields.Exchange11;
			self.rawfields_Exchange12   								:= l.rawfields.Exchange12;
			self.rawfields_Exchange13   								:= l.rawfields.Exchange13;
			self.rawfields_Exchange14   								:= l.rawfields.Exchange14;
			self.rawfields_Exchange15   								:= l.rawfields.Exchange15;
			self.rawfields_Exchange16   								:= l.rawfields.Exchange16;
			self.rawfields_Exchange17   								:= l.rawfields.Exchange17;
			self.rawfields_Exchange18   								:= l.rawfields.Exchange18;
			self.rawfields_Exchange19										:= l.rawfields.Exchange19;
			self.rawfields_Exchange20   								:= l.rawfields.Exchange20;
			self.rawfields_Extended_Profile 						:= l.rawfields.Extended_Profile;
			self.rawfields_CBSA													:= l.rawfields.CBSA;
			self.rawfields_Competitors									:= l.rawfields.Competitors;
			self.rawfields_Naics1												:= l.rawfields.Naics1;
			self.rawfields_Naics_Text1 									:= l.rawfields.Naics_Text1;
			self.rawfields_Naics2												:= l.rawfields.Naics2;
			self.rawfields_Naics_Text2									:= l.rawfields.Naics_Text2;
			self.rawfields_Naics3												:= l.rawfields.Naics3;
			self.rawfields_Naics_Text3 									:= l.rawfields.Naics_Text3;
			self.rawfields_Naics4												:= l.rawfields.Naics4;
			self.rawfields_Naics_Text4									:= l.rawfields.Naics_Text4;
			self.rawfields_Naics5												:= l.rawfields.Naics5;
			self.rawfields_Naics_Text5 									:= l.rawfields.Naics_Text5;
			self.rawfields_Naics6												:= l.rawfields.Naics6;
			self.rawfields_Naics_Text6									:= l.rawfields.Naics_Text6;
			self.rawfields_Naics7												:= l.rawfields.Naics7;
			self.rawfields_Naics_Text7 									:= l.rawfields.Naics_Text7;
			self.rawfields_Naics8												:= l.rawfields.Naics8;
			self.rawfields_Naics_Text8									:= l.rawfields.Naics_Text8;
			self.rawfields_Naics9												:= l.rawfields.Naics9;
			self.rawfields_Naics_Text9 									:= l.rawfields.Naics_Text9;
			self.rawfields_Naics10											:= l.rawfields.Naics10;
			self.rawfields_Naics_Text10									:= l.rawfields.Naics_Text10;
			self.rawfields_Update_Date									:= l.rawfields.Update_Date;
			self.killreport_company_id									:= l.killreport.company_id;
			self.killreport_company_name								:= l.killreport.company_name;
			self.killreport_is_major_us_stk							:= l.killreport.is_major_us_stk;
			self.killreport_comp_type										:= l.killreport.comp_type;
			self.killreport_kill_reason									:= l.killreport.kill_reason;
			self.killreport_kill_date_raw								:= l.killreport.kill_date_raw;
			self.killreport_kill_date_clean							:= l.killreport.kill_date_clean;
			self.killreport_kill_reason_clean						:= l.killreport.kill_reason_clean;
			self.killreport_kill_enterprise_nbr					:= l.killreport.kill_enterprise_nbr;
			self.killreport_filedate								    := l.killreport.filedate;
			self.mergeracquis_MnA_Type									:= l.mergeracquis.MnA_Type;
			self.mergeracquis_MnA_Status								:= l.mergeracquis.MnA_Status;
			self.mergeracquis_Status_Marked_in_dB				:= l.mergeracquis.Status_Marked_in_dB;
			self.mergeracquis_Target_Company						:= l.mergeracquis.Target_Company;
			self.mergeracquis_What_Happened							:= l.mergeracquis.What_Happened;
			self.mergeracquis_MnA_Amount_Offered				:= l.mergeracquis.MnA_Amount_Offered;
			self.mergeracquis_MnA_Close_Date						:= l.mergeracquis.MnA_Close_Date;
			self.mergeracquis_LexisNexis_Posting_Date		:= l.mergeracquis.LexisNexis_Posting_Date;
			self.mergeracquis_Editorial_Comments				:= l.mergeracquis.Editorial_Comments;
			self.mergeracquis_Last_Change_Date					:= l.mergeracquis.Last_Change_Date;
			self.mergeracquis_Updated_By								:= l.mergeracquis.Updated_By;
			self.mergeracquis_target_enterprise_nbr			:= l.mergeracquis.target_enterprise_nbr;
			self.mergeracquis_buyer1_enterprise_nbr			:= l.mergeracquis.buyer1_enterprise_nbr;
			self.mergeracquis_buyer2_enterprise_nbr			:= l.mergeracquis.buyer2_enterprise_nbr;
			self.mergeracquis_buyer3_enterprise_nbr			:= l.mergeracquis.buyer3_enterprise_nbr;
			self.mergeracquis_seller1_enterprise_nbr		:= l.mergeracquis.seller1_enterprise_nbr;
			self.mergeracquis_seller2_enterprise_nbr		:= l.mergeracquis.seller2_enterprise_nbr;
			self.mergeracquis_seller3_enterprise_nbr		:= l.mergeracquis.seller3_enterprise_nbr;
			self.mergeracquis_MnA_Close_Date_clean			:= l.mergeracquis.MnA_Close_Date_clean;
			self.mergeracquis_LN_Posting_Date_clean			:= l.mergeracquis.LN_Posting_Date_clean;
			self.mergeracquis_Last_Change_Date_clean		:= l.mergeracquis.Last_Change_Date_clean;
			self.mergeracquis_filedate									:= l.mergeracquis.filedate;
			self.physical_address_prim_range 						:= l.physical_address.prim_range;
			self.physical_address_predir								:= l.physical_address.predir;
			self.physical_address_prim_name							:= l.physical_address.prim_name;
			self.physical_address_addr_suffix 					:= l.physical_address.addr_suffix;
			self.physical_address_postdir								:= l.physical_address.postdir;
			self.physical_address_unit_desig						:= l.physical_address.unit_desig;
			self.physical_address_sec_range							:= l.physical_address.sec_range;
			self.physical_address_p_city_name						:= l.physical_address.p_city_name;
			self.physical_address_v_city_name  					:= l.physical_address.v_city_name ;
			self.physical_address_st										:= l.physical_address.st;
			self.physical_address_zip										:= l.physical_address.zip;
			self.physical_address_zip4									:= l.physical_address.zip4;
			self.physical_address_cart									:= l.physical_address.cart;
			self.physical_address_cr_sort_sz						:= l.physical_address.cr_sort_sz;
			self.physical_address_lot										:= l.physical_address.lot;
			self.physical_address_lot_order							:= l.physical_address.lot_order;
			self.physical_address_dbpc								  := l.physical_address.dbpc;
			self.physical_address_chk_digit							:= l.physical_address.chk_digit;
			self.physical_address_rec_type							:= l.physical_address.rec_type;
			self.physical_address_fips_state						:= l.physical_address.fips_state;
			self.physical_address_fips_county						:= l.physical_address.fips_county;
			self.physical_address_geo_lat								:= l.physical_address.geo_lat;
			self.physical_address_geo_long							:= l.physical_address.geo_long;
			self.physical_address_msa										:= l.physical_address.msa;
			self.physical_address_geo_blk								:= l.physical_address.geo_blk;
			self.physical_address_geo_match							:= l.physical_address.geo_match;
			self.physical_address_err_stat							:= l.physical_address.err_stat;
			self.mailing_address_prim_range 						:= l.mailing_address.prim_range;
			self.mailing_address_predir									:= l.mailing_address.predir;
			self.mailing_address_prim_name							:= l.mailing_address.prim_name;
			self.mailing_address_addr_suffix 						:= l.mailing_address.addr_suffix;
			self.mailing_address_postdir								:= l.mailing_address.postdir;
			self.mailing_address_unit_desig							:= l.mailing_address.unit_desig;
			self.mailing_address_sec_range							:= l.mailing_address.sec_range;
			self.mailing_address_p_city_name						:= l.mailing_address.p_city_name;
			self.mailing_address_v_city_name 						:= l.mailing_address.v_city_name;
			self.mailing_address_st											:= l.mailing_address.st;
			self.mailing_address_zip										:= l.mailing_address.zip;
			self.mailing_address_zip4										:= l.mailing_address.zip4;
			self.mailing_address_cart										:= l.mailing_address.cart;
			self.mailing_address_cr_sort_sz							:= l.mailing_address.cr_sort_sz;
			self.mailing_address_lot										:= l.mailing_address.lot;
			self.mailing_address_lot_order							:= l.mailing_address.lot_order;
			self.mailing_address_dbpc										:= l.mailing_address.dbpc;
			self.mailing_address_chk_digit							:= l.mailing_address.chk_digit;
			self.mailing_address_rec_type								:= l.mailing_address.rec_type;
			self.mailing_address_fips_state							:= l.mailing_address.fips_state;
			self.mailing_address_fips_county						:= l.mailing_address.fips_county;
			self.mailing_address_geo_lat								:= l.mailing_address.geo_lat;
			self.mailing_address_geo_long								:= l.mailing_address.geo_long;
			self.mailing_address_msa										:= l.mailing_address.msa;
			self.mailing_address_geo_blk								:= l.mailing_address.geo_blk;
			self.mailing_address_geo_match							:= l.mailing_address.geo_match;
			self.mailing_address_err_stat								:= l.mailing_address.err_stat;
			self.clean_phones_Phone   									:= l.clean_phones.Phone;
			self.clean_phones_Fax   										:= l.clean_phones.Fax;
			self.clean_phones_Telex   									:= l.clean_phones.Telex;
			self.clean_dates_update_date 								:= l.clean_dates.update_date;
			self                             						:= l;																				
			self														 						:= [];
	end; 

  EXPORT Base_Companies_In_DCA := project(dBaseCompanies, trf(left));