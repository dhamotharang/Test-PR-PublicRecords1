import strata;
pInput := file_whois_base;
Layout_pInput_stat :=
record
	unsigned8 CountGroup                                                                  := count(group);
	pInput.state;
	unsigned8 did_CountNonZero                                                            := sum(group, if(pInput.did                           <> 0   ,1,0));
	unsigned8 bdid_CountNonZero                                                           := sum(group, if(pInput.bdid                          <> 0   ,1,0));
	unsigned8 date_first_seen_CountNonBlank                                               := sum(group, if(pInput.date_first_seen               <> ''  ,1,0));
	unsigned8 date_last_seen_CountNonBlank                                                := sum(group, if(pInput.date_last_seen                <> ''  ,1,0));
	unsigned8 current_flag_CountNonBlank                                                  := sum(group, if(pInput.current_flag                  <> ''  ,1,0));
	unsigned8 registrant_name_CountNonBlank                                               := sum(group, if(pInput.registrant_name               <> ''  ,1,0));
	unsigned8 registrant_address1_CountNonBlank                                           := sum(group, if(pInput.registrant_address1           <> ''  ,1,0));
	unsigned8 registrant_address2_CountNonBlank                                           := sum(group, if(pInput.registrant_address2           <> ''  ,1,0));
	unsigned8 registrant_address3_CountNonBlank                                           := sum(group, if(pInput.registrant_address3           <> ''  ,1,0));
	unsigned8 registrant_address4_CountNonBlank                                           := sum(group, if(pInput.registrant_address4           <> ''  ,1,0));
	unsigned8 registrant_address5_CountNonBlank                                           := sum(group, if(pInput.registrant_address5           <> ''  ,1,0));
	unsigned8 registrant_address6_CountNonBlank                                           := sum(group, if(pInput.registrant_address6           <> ''  ,1,0));
	unsigned8 registrant_address7_CountNonBlank                                           := sum(group, if(pInput.registrant_address7           <> ''  ,1,0));
	unsigned8 registrant_address8_CountNonBlank                                           := sum(group, if(pInput.registrant_address8           <> ''  ,1,0));
	unsigned8 registrant_address9_CountNonBlank                                           := sum(group, if(pInput.registrant_address9           <> ''  ,1,0));
	unsigned8 registrant_address10_CountNonBlank                                          := sum(group, if(pInput.registrant_address10          <> ''  ,1,0));
	unsigned8 domain_name_CountNonBlank                                                   := sum(group, if(pInput.domain_name                   <> ''  ,1,0));
	unsigned8 admin_name_CountNonBlank                                                    := sum(group, if(pInput.admin_name                    <> ''  ,1,0));
	unsigned8 admin_email_CountNonBlank                                                   := sum(group, if(pInput.admin_email                   <> ''  ,1,0));
	unsigned8 admin_address1_CountNonBlank                                                := sum(group, if(pInput.admin_address1                <> ''  ,1,0));
	unsigned8 admin_address2_CountNonBlank                                                := sum(group, if(pInput.admin_address2                <> ''  ,1,0));
	unsigned8 admin_address3_CountNonBlank                                                := sum(group, if(pInput.admin_address3                <> ''  ,1,0));
	unsigned8 admin_address4_CountNonBlank                                                := sum(group, if(pInput.admin_address4                <> ''  ,1,0));
	unsigned8 admin_address5_CountNonBlank                                                := sum(group, if(pInput.admin_address5                <> ''  ,1,0));
	unsigned8 admin_address6_CountNonBlank                                                := sum(group, if(pInput.admin_address6                <> ''  ,1,0));
	unsigned8 admin_address7_CountNonBlank                                                := sum(group, if(pInput.admin_address7                <> ''  ,1,0));
	unsigned8 admin_address8_CountNonBlank                                                := sum(group, if(pInput.admin_address8                <> ''  ,1,0));
	unsigned8 admin_address9_CountNonBlank                                                := sum(group, if(pInput.admin_address9                <> ''  ,1,0));
	unsigned8 admin_address10_CountNonBlank                                               := sum(group, if(pInput.admin_address10               <> ''  ,1,0));
	unsigned8 admin_address11_CountNonBlank                                               := sum(group, if(pInput.admin_address11               <> ''  ,1,0));
	unsigned8 admin_address12_CountNonBlank                                               := sum(group, if(pInput.admin_address12               <> ''  ,1,0));
	unsigned8 tech_name_CountNonBlank                                                     := sum(group, if(pInput.tech_name                     <> ''  ,1,0));
	unsigned8 tech_email_CountNonBlank                                                    := sum(group, if(pInput.tech_email                    <> ''  ,1,0));
	unsigned8 tech_address1_CountNonBlank                                                 := sum(group, if(pInput.tech_address1                 <> ''  ,1,0));
	unsigned8 tech_address2_CountNonBlank                                                 := sum(group, if(pInput.tech_address2                 <> ''  ,1,0));
	unsigned8 tech_address3_CountNonBlank                                                 := sum(group, if(pInput.tech_address3                 <> ''  ,1,0));
	unsigned8 tech_address4_CountNonBlank                                                 := sum(group, if(pInput.tech_address4                 <> ''  ,1,0));
	unsigned8 tech_address5_CountNonBlank                                                 := sum(group, if(pInput.tech_address5                 <> ''  ,1,0));
	unsigned8 tech_address6_CountNonBlank                                                 := sum(group, if(pInput.tech_address6                 <> ''  ,1,0));
	unsigned8 tech_address7_CountNonBlank                                                 := sum(group, if(pInput.tech_address7                 <> ''  ,1,0));
	unsigned8 tech_address8_CountNonBlank                                                 := sum(group, if(pInput.tech_address8                 <> ''  ,1,0));
	unsigned8 tech_address9_CountNonBlank                                                 := sum(group, if(pInput.tech_address9                 <> ''  ,1,0));
	unsigned8 tech_address10_CountNonBlank                                                := sum(group, if(pInput.tech_address10                <> ''  ,1,0));
	unsigned8 tech_address11_CountNonBlank                                                := sum(group, if(pInput.tech_address11                <> ''  ,1,0));
	unsigned8 tech_address12_CountNonBlank                                                := sum(group, if(pInput.tech_address12                <> ''  ,1,0));
	unsigned8 update_date_CountNonBlank                                                   := sum(group, if(pInput.update_date                   <> ''  ,1,0));
	unsigned8 expire_date_CountNonBlank                                                   := sum(group, if(pInput.expire_date                   <> ''  ,1,0));
	unsigned8 create_date_CountNonBlank                                                   := sum(group, if(pInput.create_date                   <> ''  ,1,0));
	unsigned8 database_date_CountNonBlank                                                 := sum(group, if(pInput.database_date                 <> ''  ,1,0));
	unsigned8 optout_flag_CountNonBlank                                                   := sum(group, if(pInput.optout_flag                   <> ''  ,1,0));
	unsigned8 domain_server1_CountNonBlank                                                := sum(group, if(pInput.domain_server1                <> ''  ,1,0));
	unsigned8 domain_server2_CountNonBlank                                                := sum(group, if(pInput.domain_server2                <> ''  ,1,0));
	unsigned8 domain_server3_CountNonBlank                                                := sum(group, if(pInput.domain_server3                <> ''  ,1,0));
	unsigned8 domain_server4_CountNonBlank                                                := sum(group, if(pInput.domain_server4                <> ''  ,1,0));
	unsigned8 domain_server5_CountNonBlank                                                := sum(group, if(pInput.domain_server5                <> ''  ,1,0));
	unsigned8 domain_server6_CountNonBlank                                                := sum(group, if(pInput.domain_server6                <> ''  ,1,0));
	unsigned8 domain_server7_CountNonBlank                                                := sum(group, if(pInput.domain_server7                <> ''  ,1,0));
	unsigned8 domain_server8_CountNonBlank                                                := sum(group, if(pInput.domain_server8                <> ''  ,1,0));
	unsigned8 prim_range_CountNonBlank                                                    := sum(group, if(pInput.prim_range                    <> ''  ,1,0));
	unsigned8 predir_CountNonBlank                                                        := sum(group, if(pInput.predir                        <> ''  ,1,0));
	unsigned8 prim_name_CountNonBlank                                                     := sum(group, if(pInput.prim_name                     <> ''  ,1,0));
	unsigned8 suffix_CountNonBlank                                                        := sum(group, if(pInput.suffix                        <> ''  ,1,0));
	unsigned8 postdir_CountNonBlank                                                       := sum(group, if(pInput.postdir                       <> ''  ,1,0));
	unsigned8 unit_desig_CountNonBlank                                                    := sum(group, if(pInput.unit_desig                    <> ''  ,1,0));
	unsigned8 sec_range_CountNonBlank                                                     := sum(group, if(pInput.sec_range                     <> ''  ,1,0));
	unsigned8 p_city_name_CountNonBlank                                                   := sum(group, if(pInput.p_city_name                   <> ''  ,1,0));
	unsigned8 v_city_name_CountNonBlank                                                   := sum(group, if(pInput.v_city_name                   <> ''  ,1,0));
	unsigned8 zip_CountNonBlank                                                           := sum(group, if(pInput.zip                           <> ''  ,1,0));
	unsigned8 zip4_CountNonBlank                                                          := sum(group, if(pInput.zip4                          <> ''  ,1,0));
	unsigned8 cart_CountNonBlank                                                          := sum(group, if(pInput.cart                          <> ''  ,1,0));
	unsigned8 cr_sort_sz_CountNonBlank                                                    := sum(group, if(pInput.cr_sort_sz                    <> ''  ,1,0));
	unsigned8 lot_CountNonBlank                                                           := sum(group, if(pInput.lot                           <> ''  ,1,0));
	unsigned8 lot_order_CountNonBlank                                                     := sum(group, if(pInput.lot_order                     <> ''  ,1,0));
	unsigned8 dbpc_CountNonBlank                                                          := sum(group, if(pInput.dbpc                          <> ''  ,1,0));
	unsigned8 chk_digit_CountNonBlank                                                     := sum(group, if(pInput.chk_digit                     <> ''  ,1,0));
	unsigned8 rec_type_CountNonBlank                                                      := sum(group, if(pInput.rec_type                      <> ''  ,1,0));
	unsigned8 county_CountNonBlank                                                        := sum(group, if(pInput.county                        <> ''  ,1,0));
	unsigned8 geo_lat_CountNonBlank                                                       := sum(group, if(pInput.geo_lat                       <> ''  ,1,0));
	unsigned8 geo_long_CountNonBlank                                                      := sum(group, if(pInput.geo_long                      <> ''  ,1,0));
	unsigned8 msa_CountNonBlank                                                           := sum(group, if(pInput.msa                           <> ''  ,1,0));
	unsigned8 geo_blk_CountNonBlank                                                       := sum(group, if(pInput.geo_blk                       <> ''  ,1,0));
	unsigned8 geo_match_CountNonBlank                                                     := sum(group, if(pInput.geo_match                     <> ''  ,1,0));
	unsigned8 err_stat_CountNonBlank                                                      := sum(group, if(pInput.err_stat                      <> ''  ,1,0));
	unsigned8 admin_prim_range_CountNonBlank                                              := sum(group, if(pInput.admin_prim_range              <> ''  ,1,0));
	unsigned8 admin_predir_CountNonBlank                                                  := sum(group, if(pInput.admin_predir                  <> ''  ,1,0));
	unsigned8 admin_prim_name_CountNonBlank                                               := sum(group, if(pInput.admin_prim_name               <> ''  ,1,0));
	unsigned8 admin_suffix_CountNonBlank                                                  := sum(group, if(pInput.admin_suffix                  <> ''  ,1,0));
	unsigned8 admin_postdir_CountNonBlank                                                 := sum(group, if(pInput.admin_postdir                 <> ''  ,1,0));
	unsigned8 admin_unit_desig_CountNonBlank                                              := sum(group, if(pInput.admin_unit_desig              <> ''  ,1,0));
	unsigned8 admin_sec_range_CountNonBlank                                               := sum(group, if(pInput.admin_sec_range               <> ''  ,1,0));
	unsigned8 admin_p_city_name_CountNonBlank                                             := sum(group, if(pInput.admin_p_city_name             <> ''  ,1,0));
	unsigned8 admin_v_city_name_CountNonBlank                                             := sum(group, if(pInput.admin_v_city_name             <> ''  ,1,0));
	unsigned8 admin_state_CountNonBlank                                                   := sum(group, if(pInput.admin_state                   <> ''  ,1,0));
	unsigned8 admin_zip_CountNonBlank                                                     := sum(group, if(pInput.admin_zip                     <> ''  ,1,0));
	unsigned8 admin_zip4_CountNonBlank                                                    := sum(group, if(pInput.admin_zip4                    <> ''  ,1,0));
	unsigned8 admin_cart_CountNonBlank                                                    := sum(group, if(pInput.admin_cart                    <> ''  ,1,0));
	unsigned8 admin_cr_sort_sz_CountNonBlank                                              := sum(group, if(pInput.admin_cr_sort_sz              <> ''  ,1,0));
	unsigned8 admin_lot_CountNonBlank                                                     := sum(group, if(pInput.admin_lot                     <> ''  ,1,0));
	unsigned8 admin_lot_order_CountNonBlank                                               := sum(group, if(pInput.admin_lot_order               <> ''  ,1,0));
	unsigned8 admin_dbpc_CountNonBlank                                                    := sum(group, if(pInput.admin_dbpc                    <> ''  ,1,0));
	unsigned8 admin_chk_digit_CountNonBlank                                               := sum(group, if(pInput.admin_chk_digit               <> ''  ,1,0));
	unsigned8 admin_rec_type_CountNonBlank                                                := sum(group, if(pInput.admin_rec_type                <> ''  ,1,0));
	unsigned8 admin_county_CountNonBlank                                                  := sum(group, if(pInput.admin_county                  <> ''  ,1,0));
	unsigned8 admin_geo_lat_CountNonBlank                                                 := sum(group, if(pInput.admin_geo_lat                 <> ''  ,1,0));
	unsigned8 admin_geo_long_CountNonBlank                                                := sum(group, if(pInput.admin_geo_long                <> ''  ,1,0));
	unsigned8 admin_msa_CountNonBlank                                                     := sum(group, if(pInput.admin_msa                     <> ''  ,1,0));
	unsigned8 admin_geo_blk_CountNonBlank                                                 := sum(group, if(pInput.admin_geo_blk                 <> ''  ,1,0));
	unsigned8 admin_geo_match_CountNonBlank                                               := sum(group, if(pInput.admin_geo_match               <> ''  ,1,0));
	unsigned8 admin_err_stat_CountNonBlank                                                := sum(group, if(pInput.admin_err_stat                <> ''  ,1,0));
	unsigned8 tech_prim_range_CountNonBlank                                               := sum(group, if(pInput.tech_prim_range               <> ''  ,1,0));
	unsigned8 tech_predir_CountNonBlank                                                   := sum(group, if(pInput.tech_predir                   <> ''  ,1,0));
	unsigned8 tech_prim_name_CountNonBlank                                                := sum(group, if(pInput.tech_prim_name                <> ''  ,1,0));
	unsigned8 tech_suffix_CountNonBlank                                                   := sum(group, if(pInput.tech_suffix                   <> ''  ,1,0));
	unsigned8 tech_postdir_CountNonBlank                                                  := sum(group, if(pInput.tech_postdir                  <> ''  ,1,0));
	unsigned8 tech_unit_desig_CountNonBlank                                               := sum(group, if(pInput.tech_unit_desig               <> ''  ,1,0));
	unsigned8 tech_sec_range_CountNonBlank                                                := sum(group, if(pInput.tech_sec_range                <> ''  ,1,0));
	unsigned8 tech_p_city_name_CountNonBlank                                              := sum(group, if(pInput.tech_p_city_name              <> ''  ,1,0));
	unsigned8 tech_v_city_name_CountNonBlank                                              := sum(group, if(pInput.tech_v_city_name              <> ''  ,1,0));
	unsigned8 tech_state_CountNonBlank                                                    := sum(group, if(pInput.tech_state                    <> ''  ,1,0));
	unsigned8 tech_zip_CountNonBlank                                                      := sum(group, if(pInput.tech_zip                      <> ''  ,1,0));
	unsigned8 tech_zip4_CountNonBlank                                                     := sum(group, if(pInput.tech_zip4                     <> ''  ,1,0));
	unsigned8 tech_cart_CountNonBlank                                                     := sum(group, if(pInput.tech_cart                     <> ''  ,1,0));
	unsigned8 tech_cr_sort_sz_CountNonBlank                                               := sum(group, if(pInput.tech_cr_sort_sz               <> ''  ,1,0));
	unsigned8 tech_lot_CountNonBlank                                                      := sum(group, if(pInput.tech_lot                      <> ''  ,1,0));
	unsigned8 tech_lot_order_CountNonBlank                                                := sum(group, if(pInput.tech_lot_order                <> ''  ,1,0));
	unsigned8 tech_dbpc_CountNonBlank                                                     := sum(group, if(pInput.tech_dbpc                     <> ''  ,1,0));
	unsigned8 tech_chk_digit_CountNonBlank                                                := sum(group, if(pInput.tech_chk_digit                <> ''  ,1,0));
	unsigned8 tech_rec_type_CountNonBlank                                                 := sum(group, if(pInput.tech_rec_type                 <> ''  ,1,0));
	unsigned8 tech_county_CountNonBlank                                                   := sum(group, if(pInput.tech_county                   <> ''  ,1,0));
	unsigned8 tech_geo_lat_CountNonBlank                                                  := sum(group, if(pInput.tech_geo_lat                  <> ''  ,1,0));
	unsigned8 tech_geo_long_CountNonBlank                                                 := sum(group, if(pInput.tech_geo_long                 <> ''  ,1,0));
	unsigned8 tech_msa_CountNonBlank                                                      := sum(group, if(pInput.tech_msa                      <> ''  ,1,0));
	unsigned8 tech_geo_blk_CountNonBlank                                                  := sum(group, if(pInput.tech_geo_blk                  <> ''  ,1,0));
	unsigned8 tech_geo_match_CountNonBlank                                                := sum(group, if(pInput.tech_geo_match                <> ''  ,1,0));
	unsigned8 tech_err_stat_CountNonBlank                                                 := sum(group, if(pInput.tech_err_stat                 <> ''  ,1,0));
	unsigned8 title_CountNonBlank                                                         := sum(group, if(pInput.title                         <> ''  ,1,0));
	unsigned8 fname_CountNonBlank                                                         := sum(group, if(pInput.fname                         <> ''  ,1,0));
	unsigned8 mname_CountNonBlank                                                         := sum(group, if(pInput.mname                         <> ''  ,1,0));
	unsigned8 lname_CountNonBlank                                                         := sum(group, if(pInput.lname                         <> ''  ,1,0));
	unsigned8 name_suffix_CountNonBlank                                                   := sum(group, if(pInput.name_suffix                   <> ''  ,1,0));
	unsigned8 name_score_CountNonBlank                                                    := sum(group, if(pInput.name_score                    <> ''  ,1,0));
	//BIPV2 fields have been added for Strata
	unsigned8 source_rec_id	                 									                      			:= sum(group,if(pInput.source_rec_id									<>  0  ,1,0));
  unsigned8 DotID_CountNonZeros	                 									                      := sum(group,if(pInput.DotID													<>  0  ,1,0));
  unsigned8 DotScore_CountNonZeros	               								                      := sum(group,if(pInput.DotScore												<>  0  ,1,0));
  unsigned8 DotWeight_CountNonZeros	             								 	                      := sum(group,if(pInput.DotWeight											<>  0  ,1,0));
  unsigned8 EmpID_CountNonZeros	                   							                        := sum(group,if(pInput.EmpID													<>  0  ,1,0));
  unsigned8 EmpScore_CountNonZeros	             									                      := sum(group,if(pInput.EmpScore												<>  0  ,1,0));
  unsigned8 EmpWeight_CountNonZeros	                 							                      := sum(group,if(pInput.EmpWeight											<>  0  ,1,0));
  unsigned8 POWID_CountNonZeros	                          			                        := sum(group,if(pInput.POWID													<>  0  ,1,0));
  unsigned8 POWScore_CountNonZeros	                      			                        := sum(group,if(pInput.POWScore												<>  0  ,1,0));
  unsigned8 POWWeight_CountNonZeros	                      			                        := sum(group,if(pInput.POWWeight											<>  0  ,1,0));
  unsigned8 ProxID_CountNonZeros	                        			                        := sum(group,if(pInput.ProxID													<>  0  ,1,0));
  unsigned8 ProxScore_CountNonZeros	                      			                        := sum(group,if(pInput.ProxScore											<>  0  ,1,0));
  unsigned8 ProxWeight_CountNonZeros	                                  			          := sum(group,if(pInput.ProxWeight											<>  0  ,1,0));
	unsigned8 SELEID_CountNonZeros	                        															:= sum(group,if(pInput.SELEID											    <>  0  ,1,0));
	unsigned8	SELEScore_CountNonZeros	                      															:= sum(group,if(pInput.SELEScore											<>  0  ,1,0));
	unsigned8	SELEWeight_CountNonZeros	                    															:= sum(group,if(pInput.SELEWeight											<>  0  ,1,0));
  unsigned8 OrgID_CountNonZeros	                          			                        := sum(group,if(pInput.OrgID													<>  0  ,1,0));
  unsigned8 OrgScore_CountNonZeros	                      			                        := sum(group,if(pInput.OrgScore												<>  0  ,1,0));
  unsigned8 OrgWeight_CountNonZeros	                      			                        := sum(group,if(pInput.OrgWeight											<>  0  ,1,0));
  unsigned8 UltID_CountNonZeros	                          			                        := sum(group,if(pInput.UltID													<>  0  ,1,0));
  unsigned8 UltScore_CountNonZeros	                      			                        := sum(group,if(pInput.UltScore												<>  0  ,1,0));
  unsigned8 UltWeight_CountNonZeros	                      			                        := sum(group,if(pInput.UltWeight											<>  0  ,1,0));
    
end;
pInput_stat := table(pInput, Layout_pInput_stat, state  , few);
strata.createXMLStats(pInput_stat, 'Whois', 'Base_File', Domains.Whois_Build_Date, 'lbentley@seisint.com', resultsOut, 'View', 'Population');

export Strata_Population_Stats := resultsOut;