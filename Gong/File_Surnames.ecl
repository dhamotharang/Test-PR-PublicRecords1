#option ('activitiesPerCpp', 50);
import Nid, Address;

boolean isGoodName(string lname) := LENGTH(TRIM(lname)) > 0 AND TRIM(stringlib.stringfilter(lname,'@.0123456789()"')) = '';
f := Gong.File_History_Full_Prepped_for_Keys(listing_type_res = 'R',current_record_flag='Y',isGoodName(name_last));

//Nid.Mac_CleanFullNames(f, f_clean, listed_name); 
Nid.Mac_CleanParsedNames(f, f_clean, name_first,name_middle,name_last,name_suffix); 

overrides := ['HAMPDEN PRESS','DAIRY QUEEN','DRESS BARN','SHOP N GO'];
badlistings := ['HAMPDEN PRESS','DAIRY QUEEN','DRESS BARN','SHOP N GO',
'WINCHESTER HIRAM LODGE NO 21 AF & AM',
'IN ACTION CHRIST',
'IN ACTION FAITH',
'IN ACTION OREGONIANS',
'IN ADVERTISIN ADVENTUR',
'A CLEAN IMAGE IN BAY AREA',
'OF GOD IN BETHEL',
'ROOM IN BLOOM',
'ROOMS IN BLOOM',
'ALWAYS IN BLOOM FLORALS',
'IN BROADMOOR MOBILITY ATT RETAIL DEMO',
'IN CARE OF YOU',
'IN CARE OF ROBERT DIXON E.C. HOPE',
'PW DROP IN CENTER',
'HUNTINGDON DROP IN CENTER',
'FRIENDLY HARBOR DROP IN CENTER',
'IN CHICAGO MAID',
'LOST IN CHICO',
'GOD IN CHRIST NEW SMYRNA',
'BETHEL BRETHREN IN CHRIST PARSONAGE',
'GOD IN CHRIST WAYSIDE CHURCH OF',
'BRETHREN IN CHRIST SUSQUEHANNA',
'GOD IN CHRIST NEW SMYRNA',
'PHONICS FOR LATINOS-ABC\'S IN COMMON',
'COMMERCIAL IN CONCORD',
'POOL SUPPLIES IN CRESCENT',
'WOMAN IN CRIS BERKS',
'HARVESTING IN DANIEL C',
'STATE FARM IN DANNY DITOLA',
'IN EDDY STREET COMMONS ATT RETAIL DEMO',
'IN GLENDALE ATT OFFL DEMOLT',
'REFLECTIONS IN GOLD AND DIAMONDS',
'IN GOOD SHAPE FITNESS',
'IN HOME PRIMARY CARE',
'STONE TILE IN HOME',
'IN HOME DECORATING',
'IN HOME LEARNING DREAM STATION',
'ASSOCIATES,IN JOYE &',
'ADHESIVES, IN L AND D',
'SURVEYS IN LAND MAPS AND',
'IN LEIU OF YOU CONCIERGE SERVICES',
'ENTERPRISE IN LEKBERG',
'RELOCATION IN MARYLAND',
'IN MY TUMMY YUMMY',
'SALON FOR KID J & J THREE IN ONE',
'IN AND OUT ENT',
'PAWS IN PARADISE',
'IN THE POTTER\'S HAND',
'BISTRO IN RED BANK THE',
'IN ROBERT MANZKE ALLSTATE',
'PARTS IN ROMAC INDUSTRIAL',
'ORTHOPAEDIC IN SANTA CRUZ',
'ADVENTURES IN SENIOR',
'AND SUPPLY IN SHORE FA',
'IN STEP PODIATRY P A',
'IN THE MIX CD\'S & TAPES',
'IN THEGULCH VELOCITY',
'DOCTORS IN TOWN',
'IN THE WOODS E',
'ON 4TH JOHNSONS',
'ON A WHIM FIBER',
'ON ALCHOLISM COUNCIL',
'ON CALL ESTIMATORS',
'ON CHARCOAL',
'ON CHERRY JUDY\'S',
'ON COMMUNICAT RAMBLE',
'ON DEAFNESS MAINE CENTER',
'ON DECK SPORTS',
'ON EARTH HEAVEN',
'ON NEW GROUND SOUTHERNERS',
'ON LINE BINDERY',
'ON OUR OWN V',
'ON ONE RENOVATI',
'ON PARK OFFIC POLOS',
'ON US PRESSURES',
'NOW & LATER-ROSEVILLE',
'THE MAIN STREET COTTAGE',
'BAR & TAVERNS COOBAH',
'BAR AN ARCADE KEVINS',
'EL PATIO BAR AN D GRILL',
'E AND L BAR B QUE',
'S BAR B RANCH',
'RUDY\'S COUNTRY STORE AND BAR B Q-NE',
'BAR-B-CUTIE *',
'YOGURT BAR BERRY MANGO\'S',
'CARDIO BAR BEVERLY HILLS',
'J BAR E RANCH',
'BAR JO\'S SUSHI',
'BAR MITZVAH BOYS ENTERTAINMENT',
'DOUBLE RANCH BAR T',
'SUSHI BAR YAMATO HIBACHI',
'RENT A WRECK',
'RENT A HARLEY',
'RENT A SPACE',
'RENT A CAR',
'RENT A TENT',
'CAR&LIMO RADISSON',
'CAR ATLANTA Z',
'CAR CAR COACH',
'CAR CITY MUSCLE',
'CAR CITY MAMA',
'CAR RENTAL MARKS 1',
'CAR RENTAL SENSIBLE',
'CAR RENTAL AFFILIAT',
'CAR RENTAL AVIDA',
'CAR SERVICE GERMAN',
'SERVICE BOTTOMLINE BOOKKEPPING',
'SERVICE CENTR RUXTON',
'SERVICE CENTE RIDGELAN',
'SERVICE KENNYWOOD MESSENGE',
'SERVICE KISHAN N PATEL INSUR',
'SERVICE SHUTEY\'S TRANSMISS',
'ATLANTA MINUTEMAN PRESS',
'ATLANTA JOURNAL RES OF PHIL GROEN',
'CINCINNATI BELL TELEPHONE CO',
'CINCINNATI SPORTS LEAGUES',
'CHICAGO SOUTH VALPAK',
'HARBINGERS OF A NEW AGE',
'NEW AGE ROBUSTERS',
'NEW DIMENSIONS BEAUTY & BARBE',
'NEW BETHEL YOUTH COMMUNITY CENTER',
'NEW BETHEL CHRISTIAN UNION',
'NEW BETHEL BAPTIST CHURCH PARSONAGE',
'NEW BETHEL BAPTIST PARSONAGE',
'NEW BRIDGE VETERINARY PRACTICE',
'COUNCELING SERV NEW BRIDGE',
'SEE C-3805 NO 2 499-5000 NEW BRUNS',
'SEE C-3805 NO 2 499-5000 NEW BRUNSWICK DIR',
'NEW CONCEPT HEARING AID CO',
'THE NEW CANAAN NATURE RESIDENCE',
'NEW HOPE CHURCH OF GOD & CHRIST',
'NEW JERUSALEM CHURCH OF GOD & CHRIST',
'NEW DAWN EARTH CENTER',
'NEW DAY ASSEMBLY',
'NEW DAY OF AVERY COUNTY',
'NEW EDEN MINISTRIES INTERNATIONAL',
'NEW ENGLAND MARBLE RESTORATION CO',
'NEW ENGLAND SIGNAL',
'NEW ERA NURSEY',
'NEW ERA LOGISTICS',
'4239 NEW GLENDALE RD ELIZABETHTOWN',
'NEW HARMONY BAPTIST CHURCH PASTORIUM',
'NEW HAVEN SCHOLARSHIP FUND THE',
'NEW HOPE GROCERY',
'NEW HOPE FELLOWSHIP SBC',
'NEW HOPE LUTHERAN PARISH',
'NEW JEFFERSON MEMORIAL CO',
'EASTERN ORTHODONTIC ASSOCIATES OF UNION WOODBRIDGE & OLD BRIDGE',
'OLD TIME TRADE DAYS',
'OLD DOMINION COLLISION & GLASS',
'OLD MILL PIZZA BUFFET',
'OLD MILL HUNTING PRESERVE CABIN',
'1782 OLD OAKLAND RD BROOKSVILLE',
'HALF MOON RANCH OLD WEST EMPORIUM',
'OLD WEST COMICS AND GAMES',
'HARCOURT RENEE I4 DESIGN',
'SKI & SPORT WINTER',
'MOTOR SPORT MID GEORGIA',
'SPORT C WHITING MUNICIPAL', 
'SPEED AND SPORT BRADLEY'
];
EXPORT File_Surnames := 
				f_clean(nametype='P',fullname not in overrides,NOT REGEXFIND('\\b(FOR|UNLISTED|UNPUBLISHED|BLOCKED)\\b',fullname),
										listed_name not in badlistings);
//										: PERSIST('~thor_data400::persist::gong_cleaned_surnames');
