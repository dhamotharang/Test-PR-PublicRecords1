import salesChannel as s;
import Scrubs_SalesChannel as x;

ds := S.Files().base.qa;
layout := x.layout_SalesChannel;

layout flatten(ds L) := TRANSFORM
    self.rawfields_row_id           :=    L.rawfields.row_id;
    self.rawfields_company_name     :=    L.rawfields.company_name;
    self.rawfields_web_address      :=    L.rawfields.web_address;
    self.rawfields_prefix           :=    L.rawfields.prefix;
    self.rawfields_contact_name     :=    L.rawfields.contact_name;
    self.rawfields_first_name       :=    L.rawfields.first_name;
    self.rawfields_middle_name      :=    L.rawfields.middle_name;
    self.rawfields_last_name        :=    L.rawfields.last_name;
    self.rawfields_title            :=    L.rawfields.title;
    self.rawfields_address          :=    L.rawfields.address;
    self.rawfields_address1         :=    L.rawfields.address1;
    self.rawfields_city             :=    L.rawfields.city;
    self.rawfields_state            :=    L.rawfields.state;
    self.rawfields_zip_code         :=    L.rawfields.zip_code;
    self.rawfields_country          :=    L.rawfields.country;
    self.rawfields_phone_number     :=    L.rawfields.phone_number;
    self.rawfields_email            :=    L.rawfields.email;
    self.clean_name_title           :=    L.clean_name.title;
    self.clean_name_fname           :=    L.clean_name.fname;
    self.clean_name_mname           :=    L.clean_name.mname;
    self.clean_name_lname           :=    L.clean_name.lname;
    self.clean_name_name_suffix      :=    L.clean_name.name_suffix;
    self.clean_name_name_score       :=    L.clean_name.name_score;
    self.clean_address_prim_range    :=    L.clean_address.prim_range;
    self.clean_address_predir        :=    L.clean_address.predir;
    self.clean_address_prim_name     :=    L.clean_address.prim_name;
    self.clean_address_addr_suffix   :=    L.clean_address.addr_suffix;
    self.clean_address_postdir       :=    L.clean_address.postdir;
    self.clean_address_unit_desig    :=   L.clean_address.unit_desig;
    self.clean_address_sec_range     :=    L.clean_address.sec_range;
    self.clean_address_p_city_name   :=    L.clean_address.p_city_name;
    self.clean_address_v_city_name   :=    L.clean_address.v_city_name;
    self.clean_address_st            :=    L.clean_address.st;
    self.clean_address_zip           :=    L.clean_address.zip;
    self.clean_address_zip4          :=    L.clean_address.zip4;
    self.clean_address_cart          :=    L.clean_address.cart;
    self.clean_address_cr_sort_sz    :=    L.clean_address.cr_sort_sz;
    self.clean_address_lot           :=    L.clean_address.lot;
    self.clean_address_lot_order     :=    L.clean_address.lot_order;
    self.clean_address_dbpc          :=    L.clean_address.dbpc;
    self.clean_address_chk_digit     :=    L.clean_address.chk_digit;
    self.clean_address_rec_type      :=    L.clean_address.rec_type;
    self.clean_address_fips_state    :=    L.clean_address.fips_state;
    self.clean_address_fips_county   :=    L.clean_address.fips_county;
    self.clean_address_geo_lat       :=    L.clean_address.geo_lat;
    self.clean_address_geo_long      :=    L.clean_address.geo_long;
    self.clean_address_msa           :=    L.clean_address.msa;
    self.clean_address_geo_blk       :=    L.clean_address.geo_blk;
    self.clean_address_geo_match     :=    L.clean_address.geo_match;
    self.clean_address_err_stat      :=    L.clean_address.err_stat;
    SELF := l;
END;

EXPORT in_salesChannel := PROJECT(ds, flatten(LEFT));