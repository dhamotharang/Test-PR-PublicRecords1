IMPORT corp2, lib_stringlib;

EXPORT Functions := Module

	//********************************************************************
		//fGetStateCode: validates vendor codes and Returns '**' if we receive invalid or new codes from vendor 
	//********************************************************************	
		EXPORT fGetStateCode(string code) 
	        := map (corp2.t2u(code) in 
									['AA','AB','AE','AK','AL','AP','AR','AS','AZ','BC','BR','CA','CN',
									 'CO','CT','DC','DE','FL','FM','GA','GU','HI','IA','ID','IL','IN',
									 'IO','IO','JA','KS','KY','LA','LB','MA','MB','MD','ME','MH','MI',
									 'MN','MO','MP','MS','MT','NB','NC','ND','NE','NH','NJ','NL','NM',
									 'NO','NS','NT','NU','NV','NY','OH','OK','ON','OR','PA','PE','PR',
									 'PW','QC','SA','SC','SD','SK','TH','TN','TX','UT','US','VA','VI',
									 'VT','WA','WI','WV','WY','YT','YT']				 => corp2.t2u(code),
									 corp2.t2u(code) in ['GS','NW','TE','FC',''] =>'',
									 '**');
									
	//********************************************************************
	//fGetStateDesc: Returns full name from "Two digit State_Code" 
	//********************************************************************	
	EXPORT  string fGetStateDesc(STRING state) := FUNCTION

		st  :=  corp2.t2u(state);
		RETURN case(st,
								'AA'=>'ARMED FORCES AMERICAS EXCEPT CANADA',
								'AB'=>'ALBERTA',	
								'AE'=>'ARMED FORCES EUROPE, THE MIDDLE EAST,AND CANADA',
								'AK'=>'ALASKA',
								'AL'=>'ALABAMA',
								'AP'=>'ARMED FORCES PACIFIC',
								'AR'=>'ARKANSAS',
								'AS'=>'AMERICAN SAMOA',
								'AZ'=>'ARIZONA',
								'BC'=>'BRITISH COLUMBIA',
								'BR'=>'BRITISH COLUMBIA',
								'CA'=>'CALIFORNIA',
								'CN'=>'CANADA',
								'CO'=>'COLORADO',
								'CT'=>'CONNECTICUT',
								'DC'=>'DISTRICT OF COLUMBIA',
								'DE'=>'DELAWARE',
								'FL'=>'FLORIDA',
								'FM'=>'FEDERATED STATES OF MICRONESIA',
								'GA'=>'GEORGIA',
								'GU'=>'GUAM',
								'HI'=>'HAWAII',
								'IA'=>'IOWA',
								'ID'=>'IDAHO',
								'IL'=>'ILLINOIS',
								'IN'=>'INDIANA',
								'IO'=>'BRITISH INDIAN OCEAN TERRITORY',
								'JA'=>'JAPAN',
								'KS'=>'KANSAS',
								'KY'=>'KENTUCKY',
								'LA'=>'LOUISIANA',
								'LB'=>'LUXEMBOURG',
								'MA'=>'MASSACHUSETTS',
								'MB'=>'MANITOBA',
								'MD'=>'MARYLAND',
								'ME'=>'MAINE',
								'MH'=>'MARSHALL ISLANDS',
								'MI'=>'MICHIGAN',
								'MN'=>'MINNESOTA',
								'MO'=>'MISSOURI',
								'MP'=>'NORTHERN MARIANA ISLANDS',
								'MS'=>'MISSISSIPPI',
								'MT'=>'MONTANA',
								'NB'=>'NEW BRUNSWICK',
								'NC'=>'NORTH CAROLINA',
								'ND'=>'NORTH DAKOTA',
								'NE'=>'NEBRASKA',
								'NH'=>'NEW HAMPSHIRE',
								'NJ'=>'NEW JERSEY',
								'NL'=>'NEWFOUNDLAND AND LABRADOR',
								'NM'=>'NEW MEXICO',
								'NO'=>'NORWAY',
								'NS'=>'NOVA SCOTIA',
								'NT'=>'NORTHWEST TERRITORIES',
								'NU'=>'NUNAVUT',
								'NV'=>'NEVADA',
								'NY'=>'NEW YORK',
								'OH'=>'OHIO',
								'OK'=>'OKLAHOMA',
								'ON'=>'ONTARIO',
								'OR'=>'OREGON',
								'PA'=>'PENNSYLVANIA',
								'PE'=>'PRINCE EDWARD ISLAND',
								'PR'=>'PUERTO RICO',
								'PW'=>'PALAU',
								'QC'=>'QUEBEC',
								'SA'=>'SASKATCHEWAN',
								'SC'=>'SOUTH CAROLINA',
								'SD'=>'SOUTH DAKOTA',
								'SK'=>'SASKATCHEWAN',
								'TH'=>'NETHERLANDS',
								'TN'=>'TENNESSEE',
								'TX'=>'TEXAS',
								'UT'=>'UTAH',
								'US'=>'US',
								'VA'=>'VIRGINIA',
								'VI'=>'VIRGIN ISLANDS',
								'VT'=>'VERMONT',
								'WA'=>'WASHINGTON',
								'WI'=>'WISCONSIN',
								'WV'=>'WEST VIRGINIA',
								'WY'=>'WYOMING',
								'YT'=>'YUKON',
								''  =>'',
								'FC'=>'',
								'GS'=>'',
								'NW'=>'',
								'TE'=>'',
								'**|'+ st);
							
		END;
			
	EXPORT ForgnCountryDesc(string code) :=function
	
	uc:=corp2.t2u(code);
					// US States, Territories, and Native American Tribes 
	Country := map(uc in ['AK','AL','AR','AZ','CA','CL','CO','CT','DC','DE','FL','FR',
												'GA','GY','HI','IA','ID','IL','IN','JA','KS','KY','LA','LB',
												'MA','MD','ME','MI','MN','MO','MS','MT','NC','ND','NE','NH',
												'NJ','NM','NV','NY','OH','OK','OR','PA','PH','PR','RI','SC',
												'SD','SG','TN','TX','U.S.','U.S.A','U.S.A.','UNI','US','USA',
												'UT','VA','VI','VT','WA','WI','WV','WY','YSA'] => 'US',
								// Canadian Provinces
								uc in ['AB','BC','MB','NB','NF','NS','NT','ON','PE','PQ','QC','SK','YT']	=> 'CANADA',	
								uc='ABW' =>'ARUBA',
								uc='AFG' =>'AFGHANISTAN',
								uc='AGO' =>'ANGOLA',
								uc='AIA' =>'ANGUILLA',
								uc='ALA' =>'ALAND ISLANDS',
								uc='ALB' =>'ALBANIA',
								uc='AND' =>'ANDORRA',
								uc='ANT' =>'NETHERLANDS ANTILLES',
								uc='ARE' =>'UNITED ARAB EMIRATES',
								uc='ARG' =>'ARGENTINA',
								uc='ARM' =>'ARMENIA',
								uc='ASM' =>'AMERICAN SAMOA',
								uc='ATA' =>'ANTARCTICA',
								uc='ATF' =>'FRENCH SOUTHERN TERRITORIES',
								uc='ATG' =>'ANTIGUA AND BARBUDA',
								uc='AUS' =>'AUSTRALIA',
								uc='AUT' =>'AUSTRIA',
								uc='AZE' =>'AZERBAIJAN',
								uc='BDI' =>'BURUNDI',
								uc='BEL' =>'BELGIUM',
								uc='BEN' =>'BENIN',
								uc='BFA' =>'BURKINA FASO',
								uc='BGD' =>'BANGLADESH',
								uc='BGR' =>'BULGARIA',
								uc='BHR' =>'BAHRAIN',
								uc='BHS' =>'BAHAMAS',
								uc='BIH' =>'BOSNIA AND HERZEGOVINA',
								uc='BLR' =>'BELARUS',
								uc='BLZ' =>'BELIZE',
								uc='BMU' =>'BERMUDA',
								uc='BOL' =>'BOLIVIA',
								uc='BRA' =>'BRAZIL',
								uc='BRB' =>'BARBADOS',
								uc='BRN' =>'BRUNEI DARUSSALAM',
								uc='BTN' =>'BHUTAN',															
								uc in ['BV','BVI'] =>'BRITISH VIRGIN ISLANDS',
								uc='BVT' =>'BOUVET ISLAND',
								uc='BWA' =>'BOTSWANA',
								uc='CAF' =>'CENTRAL AFRICAN REPUBLIC',
								uc='CAN' =>'CANADA',
								uc='CCK' =>'COCOS (KEELING) ISLANDS',
								uc='CHE' =>'SWITZERLAND',
								uc='CHL' =>'CHILE',
								uc='CHN' =>'CHINA',
								uc='CIV' =>'COTE DIVOIRE',
								uc='CMR' =>'CAMEROON',
								uc='COD' =>'CONGO, THE DEMOCRATIC REPUBLIC',
								uc='COG' =>'CONGO',
								uc='COK' =>'COOK ISLANDS',
								uc='COL' =>'COLOMBIA',
								uc='COM' =>'COMOROS',
								uc='CPV' =>'CAPE VERDE',
								uc='CRI' =>'COSTA RICA',
								uc='CUB' =>'CUBA',
								uc='CXR' =>'CHRISTMAS ISLAND',
								uc='CYM' =>'CAYMAN ISLANDS',
								uc='CYP' =>'CYPRUS',
								uc='CZE' =>'CZECH REPUBLIC',
								uc='DEU' =>'GERMANY',
								uc='DJI' =>'DJIBOUTI',
								uc='DMA' =>'DOMINICA',
								uc='DNK' =>'DENMARK',
								uc='DOM' =>'DOMINICAN REPUBLIC',
								uc='DZA' =>'ALGERIA',
								uc='ECU' =>'ECUADOR',
								uc='EGY' =>'EGYPT',
								uc='ERI' =>'ERITREA',
								uc='ESH' =>'WESTERN SAHARA',
								uc='ESP' =>'SPAIN',
								uc='EST' =>'ESTONIA',
								uc='ETH' =>'ETHIOPIA',
								uc='FIN' =>'FINLAND',
								uc='FJI' =>'FIJI',
								uc='FLK' =>'FALKLAND ISLANDS (MALVINAS)',
								uc='FRA' =>'FRANCE',
								uc='FRO' =>'FAROE ISLANDS',
								uc='FSM' =>'MICRONESIA, FEDERATED STATES OF',
								uc='GAB' =>'GABON',
								uc='GBR' =>'UNITED KINGDOM',
								uc='GEO' =>'GEORGIA',
								uc='GGY' =>'GUERNSEY',
								uc='GHA' =>'GHANA',
								uc='GIB' =>'GIBRALTAR',
								uc='GIN' =>'GUINEA',
								uc='GLP' =>'GUADELOUPE',
								uc='GMB' =>'GAMBIA',
								uc='GNB' =>'GUINEA-BISSAU',
								uc='GNQ' =>'EQUATORIAL GUINEA',
								uc='GRC' =>'GREECE',
								uc='GRD' =>'GRENADA',
								uc='GRL' =>'GREENLAND',
								uc='GTM' =>'GUATEMALA',
								uc='GUF' =>'FRENCH GUIANA',
								uc='GUM' =>'GUAM',
								uc='GUY' =>'GUYANA',
								uc='HKG' =>'HONG KONG',
								uc='HMD' =>'HEARD ISLAND AND MCDONALD ISLANDS',
								uc='HND' =>'HONDURAS',
								uc='HRV' =>'CROATIA',
								uc='HTI' =>'HAITI',
								uc='HUN' =>'HUNGARY',
								uc='IDN' =>'INDONESIA',
								uc='IMN' =>'ISLE OF MAN',
								uc='IND' =>'INDIA',
								uc='IOT' =>'BRITISH INDIAN OCEAN TERRITORY',
								uc='IRL' =>'IRELAND',
								uc='IRN' =>'IRAN, ISLAMIC REPUBLIC',
								uc='IRQ' =>'IRAQ',
								uc='ISL' =>'ICELAND',
								uc='ISR' =>'ISRAEL',
								uc='ITA' =>'ITALY',
								uc='JAM' =>'JAMAICA',
								uc='JEY' =>'JERSEY',
								uc='JOR' =>'JORDAN',
								uc in ['JP','JPN'] =>'JAPAN',
								uc='KAZ' =>'KAZAKHSTAN',
								uc='KEN' =>'KENYA',
								uc='KGZ' =>'KYRGYZSTAN',
								uc='KHM' =>'CAMBODIA',
								uc='KIR' =>'KIRIBATI',
								uc='KNA' =>'SAINT KITTS AND NEVIS',
								uc='KOR' =>'KOREA, REPUBLIC OF',
								uc='KWT' =>'KUWAIT',
								uc='LAO' =>'LAO PEOPLES DEMOCRATIC REPUBLIC',
								uc='LBN' =>'LEBANON',
								uc='LBR' =>'LIBERIA',
								uc='LBY' =>'LIBYAN ARAB JAMAHIRIYA',
								uc='LCA' =>'SAINT LUCIA',
								uc='LIE' =>'LIECHTENSTEIN',
								uc='LKA' =>'SRI LANKA',
								uc='LSO' =>'LESOTHO',
								uc='LTU' =>'LITHUANIA',
								uc='LUX' =>'LUXEMBOURG',
								uc='LVA' =>'LATVIA',
								uc='MAC' =>'MACAO',
								uc='MAR' =>'MOROCCO',
								uc='MCO' =>'MONACO',
								uc='MDA' =>'MOLDOVA, REPUBLIC',
								uc='MDG' =>'MADAGASCAR',
								uc='MDV' =>'MALDIVES',
								uc='MEX' =>'MEXICO',
								uc='MHL' =>'MARSHALL ISLANDS',
								uc='MKD' =>'MACEDONIA, THE FORMER YUGOSLAV REPUBLIC',
								uc='MLI' =>'MALI',
								uc='MLT' =>'MALTA',
								uc='MMR' =>'MYANMAR',
								uc='MNE' =>'MONTENEGRO',
								uc='MNG' =>'MONGOLIA',
								uc='MNP' =>'NORTHERN MARIANA ISLANDS',
								uc='MOZ' =>'MOZAMBIQUE',
								uc='MRT' =>'MAURITANIA',
								uc='MSR' =>'MONTSERRAT',
								uc='MTQ' =>'MARTINIQUE',
								uc='MUS' =>'MAURITIUS',
								uc='MWI' =>'MALAWI',
								uc='MYS' =>'MALAYSIA',
								uc='MYT' =>'MAYOTTE',
								uc='NAM' =>'NAMIBIA',
								uc='NCL' =>'NEW CALEDONIA',
								uc='NER' =>'NIGER',
								uc='NFK' =>'NORFOLK ISLAND',
								uc='NGA' =>'NIGERIA',
								uc='NIC' =>'NICARAGUA',
								uc='NIU' =>'NIUE',
								uc='NLD' =>'NETHERLANDS',
								uc='NOR' =>'NORWAY',
								uc='NPL' =>'NEPAL',
								uc='NRU' =>'NAURU',
								uc='NZL' =>'NEW ZEALAND',
								uc='OMN' =>'OMAN',
								uc='PAK' =>'PAKISTAN',
								uc='PAN' =>'PANAMA',
								uc='PCN' =>'PITCAIRN',
								uc='PER' =>'PERU',
								uc='PHL' =>'PHILIPPINES',
								uc='PLW' =>'PALAU',
								uc='PNG' =>'PAPUA NEW GUINEA',
								uc='POL' =>'POLAND',
								uc='PRI' =>'PUERTO RICO',
								uc='PRK' =>'KOREA, DEMOCRATIC PEOPLES REPUBLIC',
								uc='PRT' =>'PORTUGAL',
								uc='PRY' =>'PARAGUAY',
								uc='PSE' =>'PALESTINIAN TERRITORY, OCCUPIED',
								uc='PYF' =>'FRENCH POLYNESIA',
								uc='QAT' =>'QATAR',
								uc='REU' =>'REUNION',
								uc='ROU' =>'ROMANIA',
								uc='RUS' =>'RUSSIAN FEDERATION',
								uc='RWA' =>'RWANDA',
								uc in['SA','SAU']=>'SAUDI ARABIA',
								uc='SDN' =>'SUDAN',
								uc='SEN' =>'SENEGAL',
								uc='SGP' =>'SINGAPORE',
								uc='SGS' =>'SOUTH GEORGIA AND THE SOUTH SANDWICH ISLANDS',
								uc='SHN' =>'SAINT HELENA',
								uc='SJM' =>'SVALBARD AND JAN MAYEN',
								uc='SLB' =>'SOLOMON ISLANDS',
								uc='SLE' =>'SIERRA LEONE',
								uc='SLV' =>'EL SALVADOR',
								uc='SMR' =>'SAN MARINO',
								uc='SOM' =>'SOMALIA',
								uc='SPM' =>'SAINT PIERRE AND MIQUELON',								
								uc='SPA' =>'SPAIN',
								uc='SRB' =>'SERBIA',
								uc='STP' =>'SAO TOME AND PRINCIPE',
								uc='SUR' =>'SURINAME',
								uc='SVN' =>'SLOVENIA',
								uc='SWE' =>'SWEDEN',
								uc='SWZ' =>'SWAZILAND',
								uc='SYC' =>'SEYCHELLES',
								uc='SYR' =>'SYRIAN ARAB REPUBLIC',
								uc='TCA' =>'TURKS AND CAICOS ISLANDS',
								uc='TCD' =>'CHAD',
								uc='TGO' =>'TOGO',
								uc='THA' =>'THAILAND',
								uc='TJK' =>'TAJIKISTAN',
								uc='TKL' =>'TOKELAU',
								uc='TKM' =>'TURKMENISTAN',
								uc='TLS' =>'TIMOR-LESTE',
								uc='TON' =>'TONGA',
								uc='TTO' =>'TRINIDAD AND TOBAGO',
								uc='TUN' =>'TUNISIA',
								uc='TUR' =>'TURKEY',
								uc='TUV' =>'TUVALU',
								uc='TWN' =>'TAIWAN, PROVINCE OF CHINA',
								uc='TZA' =>'TANZANIA, UNITED REPUBLIC',
								uc='UGA' =>'UGANDA',
								uc='UKR' =>'UKRAINE',
								uc='UMI' =>'UNITED STATES MINOR OUTLYING ISLANDS',
								uc='URY' =>'URUGUAY',
								uc='UK'  =>'UNITED KINGDOM',
								uc='UZB' =>'UZBEKISTAN',
								uc='VAT' =>'HOLY SEE (VATICAN CITY STATE)',
								uc='VCT' =>'SAINT VINCENT AND THE GRENADINES',
								uc='VEN' =>'VENEZUELA',
								uc='VGB' =>'VIRGIN ISLANDS, BRITISH',
								uc='VIR' =>'VIRGIN ISLANDS, U.S.',
								uc='VNM' =>'VIET NAM',
								uc='VUT' =>'VANUATU',
								uc='WLF' =>'WALLIS AND FUTUNA',
								uc='WSM' =>'SAMOA',
								uc='YEM' =>'YEMEN',
								uc='ZAF' =>'SOUTH AFRICA',
								uc='ZMB' =>'ZAMBIA',
								uc='ZWE' =>'ZIMBABWE',
								uc in ['CAM','CHA','FC','GEN','GER','ISA','JAP','NA','SAN','SUA','U','U8S','USS','#','' ] =>'',
								'**|'+ uc
								);// country codes are being scrubed through InternalFields
		return Country;
		
	End;
	
	//JIRA (DF-24000)	: According RI CI, we are allowing any numeric code with any length as “NAIC” code!
  EXPORT GetNaicCode(string code) :=function

		cd         := corp2.t2u(code);
		pos        := lib_stringlib.StringLib.StringFind(cd,'-',1);
		val 			 := if(pos > 0, cd[1..pos-1], cd);

		clean_val  := map(stringlib.stringfilterout(val,'ABCDEFGHIJKLMNOPQRSTUVWXYZ')      =''  =>'',		     //Blank all alpha char Ex:LLC
											stringlib.stringfilterout(val,'0')  										         =''  =>'',	      //Blank all zero's  Ex:00000	& won't be mapped from[000-00,0000-0,etc]	
											stringlib.stringfilterout(val,'9')  										         =''  =>'',	     //Blank all 9's Ex:99999 ,00000	& won't be mapped from[9999-99,999-9,etc]		  
											stringlib.stringfilterout(val,'0123456789') 							       =''  =>val,	  //Map valid code  Ex:45673	
											'');
		return clean_val;
		
  End;
	
END;