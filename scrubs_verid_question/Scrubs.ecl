IMPORT ut,SALT30;
EXPORT Scrubs := MODULE
// The module to handle the case where no scrubs exist
  EXPORT  Expanded_Layout := RECORD(Layout_question)
    UNSIGNED1 QUESTIONSETID_Invalid;
    UNSIGNED1 STRINGCODE_Invalid;
    UNSIGNED1 QUESTIONSETTYPEFIELD_Invalid;
    UNSIGNED1 CREATIONTIME_Invalid;
    UNSIGNED1 ACCOUNTNAME_Invalid;
    UNSIGNED1 SUBSETNUMBER_Invalid;
    UNSIGNED1 TRANSACTIONID_Invalid;
    UNSIGNED1 STARTTIME_Invalid;
    UNSIGNED1 ENDTIME_Invalid;
    UNSIGNED1 GRADE_Invalid;
    UNSIGNED1 SUBSETGRADEOUTCOMETYPEFIELD_Invalid;
    UNSIGNED1 QUESTIONID_Invalid;
    UNSIGNED1 QUESTIONTYPEFIELD_Invalid;
    UNSIGNED1 PRESENTATIONPOSITION_Invalid;
    UNSIGNED1 SHUFFLEWEIGHT_Invalid;
    UNSIGNED1 GRADEMULTICHOICERULETYPEFIELD_Invalid;
    UNSIGNED1 STARTDATE_Invalid;
    UNSIGNED1 ENDDATE_Invalid;
    UNSIGNED1 QUESTIONGRADEOUTCOMETYPEFIELD_Invalid;
    UNSIGNED1 SELECTEDCOUNT_Invalid;
    UNSIGNED1 CORRECTCOUNT_Invalid;
    UNSIGNED1 WASNONEOFTHEABOVESELECTED_Invalid;
    UNSIGNED1 VERITEID_Invalid;
    UNSIGNED1 LANGUAGETYPEFIELD_Invalid;
    UNSIGNED1 QUESTIONTIERTYPEFIELD_Invalid;
    UNSIGNED1 QUESTIONSTATEMENT_Invalid;
    UNSIGNED1 CORRECTANSWER_Invalid;
    UNSIGNED1 SELECTEDANSWER_Invalid;
    UNSIGNED1 DATASOURCETYPEFIELD_Invalid;
  END;
  EXPORT  Bitmap_Layout := RECORD(Layout_question)
    UNSIGNED8 ScrubsBits1;
  END;
EXPORT FromNone(DATASET(Layout_question) h) := MODULE
  Expanded_Layout into(h le) := TRANSFORM
    SELF.QUESTIONSETID_Invalid := Fields.InValid_QUESTIONSETID((SALT30.StrType)le.QUESTIONSETID);
    SELF.STRINGCODE_Invalid := Fields.InValid_STRINGCODE((SALT30.StrType)le.STRINGCODE);
    SELF.QUESTIONSETTYPEFIELD_Invalid := Fields.InValid_QUESTIONSETTYPEFIELD((SALT30.StrType)le.QUESTIONSETTYPEFIELD);
    SELF.CREATIONTIME_Invalid := Fields.InValid_CREATIONTIME((SALT30.StrType)le.CREATIONTIME);
    SELF.ACCOUNTNAME_Invalid := Fields.InValid_ACCOUNTNAME((SALT30.StrType)le.ACCOUNTNAME);
    SELF.SUBSETNUMBER_Invalid := Fields.InValid_SUBSETNUMBER((SALT30.StrType)le.SUBSETNUMBER);
    SELF.TRANSACTIONID_Invalid := Fields.InValid_TRANSACTIONID((SALT30.StrType)le.TRANSACTIONID);
    SELF.STARTTIME_Invalid := Fields.InValid_STARTTIME((SALT30.StrType)le.STARTTIME);
    SELF.ENDTIME_Invalid := Fields.InValid_ENDTIME((SALT30.StrType)le.ENDTIME);
    SELF.GRADE_Invalid := Fields.InValid_GRADE((SALT30.StrType)le.GRADE);
    SELF.SUBSETGRADEOUTCOMETYPEFIELD_Invalid := Fields.InValid_SUBSETGRADEOUTCOMETYPEFIELD((SALT30.StrType)le.SUBSETGRADEOUTCOMETYPEFIELD);
    SELF.QUESTIONID_Invalid := Fields.InValid_QUESTIONID((SALT30.StrType)le.QUESTIONID);
    SELF.QUESTIONTYPEFIELD_Invalid := Fields.InValid_QUESTIONTYPEFIELD((SALT30.StrType)le.QUESTIONTYPEFIELD);
    SELF.PRESENTATIONPOSITION_Invalid := Fields.InValid_PRESENTATIONPOSITION((SALT30.StrType)le.PRESENTATIONPOSITION);
    SELF.SHUFFLEWEIGHT_Invalid := Fields.InValid_SHUFFLEWEIGHT((SALT30.StrType)le.SHUFFLEWEIGHT);
    SELF.GRADEMULTICHOICERULETYPEFIELD_Invalid := Fields.InValid_GRADEMULTICHOICERULETYPEFIELD((SALT30.StrType)le.GRADEMULTICHOICERULETYPEFIELD);
    SELF.STARTDATE_Invalid := Fields.InValid_STARTDATE((SALT30.StrType)le.STARTDATE);
    SELF.ENDDATE_Invalid := Fields.InValid_ENDDATE((SALT30.StrType)le.ENDDATE);
    SELF.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid := Fields.InValid_QUESTIONGRADEOUTCOMETYPEFIELD((SALT30.StrType)le.QUESTIONGRADEOUTCOMETYPEFIELD);
    SELF.SELECTEDCOUNT_Invalid := Fields.InValid_SELECTEDCOUNT((SALT30.StrType)le.SELECTEDCOUNT);
    SELF.CORRECTCOUNT_Invalid := Fields.InValid_CORRECTCOUNT((SALT30.StrType)le.CORRECTCOUNT);
    SELF.WASNONEOFTHEABOVESELECTED_Invalid := Fields.InValid_WASNONEOFTHEABOVESELECTED((SALT30.StrType)le.WASNONEOFTHEABOVESELECTED);
    SELF.VERITEID_Invalid := Fields.InValid_VERITEID((SALT30.StrType)le.VERITEID);
    SELF.LANGUAGETYPEFIELD_Invalid := Fields.InValid_LANGUAGETYPEFIELD((SALT30.StrType)le.LANGUAGETYPEFIELD);
    SELF.QUESTIONTIERTYPEFIELD_Invalid := Fields.InValid_QUESTIONTIERTYPEFIELD((SALT30.StrType)le.QUESTIONTIERTYPEFIELD);
    SELF.QUESTIONSTATEMENT_Invalid := Fields.InValid_QUESTIONSTATEMENT((SALT30.StrType)le.QUESTIONSTATEMENT);
    SELF.CORRECTANSWER_Invalid := Fields.InValid_CORRECTANSWER((SALT30.StrType)le.CORRECTANSWER);
    SELF.SELECTEDANSWER_Invalid := Fields.InValid_SELECTEDANSWER((SALT30.StrType)le.SELECTEDANSWER);
    SELF.DATASOURCETYPEFIELD_Invalid := Fields.InValid_DATASOURCETYPEFIELD((SALT30.StrType)le.DATASOURCETYPEFIELD);
    SELF := le;
  END;
  EXPORT ExpandedInfile := PROJECT(h,Into(LEFT));
  Bitmap_Layout Into(ExpandedInfile le) := TRANSFORM
    SELF.ScrubsBits1 := ( le.QUESTIONSETID_Invalid << 0 ) + ( le.STRINGCODE_Invalid << 2 ) + ( le.QUESTIONSETTYPEFIELD_Invalid << 4 ) + ( le.CREATIONTIME_Invalid << 6 ) + ( le.ACCOUNTNAME_Invalid << 8 ) + ( le.SUBSETNUMBER_Invalid << 10 ) + ( le.TRANSACTIONID_Invalid << 12 ) + ( le.STARTTIME_Invalid << 14 ) + ( le.ENDTIME_Invalid << 16 ) + ( le.GRADE_Invalid << 18 ) + ( le.SUBSETGRADEOUTCOMETYPEFIELD_Invalid << 20 ) + ( le.QUESTIONID_Invalid << 22 ) + ( le.QUESTIONTYPEFIELD_Invalid << 24 ) + ( le.PRESENTATIONPOSITION_Invalid << 26 ) + ( le.SHUFFLEWEIGHT_Invalid << 28 ) + ( le.GRADEMULTICHOICERULETYPEFIELD_Invalid << 30 ) + ( le.STARTDATE_Invalid << 32 ) + ( le.ENDDATE_Invalid << 34 ) + ( le.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid << 36 ) + ( le.SELECTEDCOUNT_Invalid << 38 ) + ( le.CORRECTCOUNT_Invalid << 40 ) + ( le.WASNONEOFTHEABOVESELECTED_Invalid << 42 ) + ( le.VERITEID_Invalid << 44 ) + ( le.LANGUAGETYPEFIELD_Invalid << 46 ) + ( le.QUESTIONTIERTYPEFIELD_Invalid << 48 ) + ( le.QUESTIONSTATEMENT_Invalid << 50 ) + ( le.CORRECTANSWER_Invalid << 52 ) + ( le.SELECTEDANSWER_Invalid << 54 ) + ( le.DATASOURCETYPEFIELD_Invalid << 56 );
    SELF := le;
  END;
  EXPORT BitmapInfile := PROJECT(ExpandedInfile,Into(LEFT));
END;
// Module to use if you already have a scrubs bitmap you wish to expand or compare
EXPORT FromBits(DATASET(Bitmap_Layout) h) := MODULE
  EXPORT Infile := PROJECT(h,Layout_question);
  Expanded_Layout into(h le) := TRANSFORM
    SELF.QUESTIONSETID_Invalid := (le.ScrubsBits1 >> 0) & 3;
    SELF.STRINGCODE_Invalid := (le.ScrubsBits1 >> 2) & 3;
    SELF.QUESTIONSETTYPEFIELD_Invalid := (le.ScrubsBits1 >> 4) & 3;
    SELF.CREATIONTIME_Invalid := (le.ScrubsBits1 >> 6) & 3;
    SELF.ACCOUNTNAME_Invalid := (le.ScrubsBits1 >> 8) & 3;
    SELF.SUBSETNUMBER_Invalid := (le.ScrubsBits1 >> 10) & 3;
    SELF.TRANSACTIONID_Invalid := (le.ScrubsBits1 >> 12) & 3;
    SELF.STARTTIME_Invalid := (le.ScrubsBits1 >> 14) & 3;
    SELF.ENDTIME_Invalid := (le.ScrubsBits1 >> 16) & 3;
    SELF.GRADE_Invalid := (le.ScrubsBits1 >> 18) & 3;
    SELF.SUBSETGRADEOUTCOMETYPEFIELD_Invalid := (le.ScrubsBits1 >> 20) & 3;
    SELF.QUESTIONID_Invalid := (le.ScrubsBits1 >> 22) & 3;
    SELF.QUESTIONTYPEFIELD_Invalid := (le.ScrubsBits1 >> 24) & 3;
    SELF.PRESENTATIONPOSITION_Invalid := (le.ScrubsBits1 >> 26) & 3;
    SELF.SHUFFLEWEIGHT_Invalid := (le.ScrubsBits1 >> 28) & 3;
    SELF.GRADEMULTICHOICERULETYPEFIELD_Invalid := (le.ScrubsBits1 >> 30) & 3;
    SELF.STARTDATE_Invalid := (le.ScrubsBits1 >> 32) & 3;
    SELF.ENDDATE_Invalid := (le.ScrubsBits1 >> 34) & 3;
    SELF.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid := (le.ScrubsBits1 >> 36) & 3;
    SELF.SELECTEDCOUNT_Invalid := (le.ScrubsBits1 >> 38) & 3;
    SELF.CORRECTCOUNT_Invalid := (le.ScrubsBits1 >> 40) & 3;
    SELF.WASNONEOFTHEABOVESELECTED_Invalid := (le.ScrubsBits1 >> 42) & 3;
    SELF.VERITEID_Invalid := (le.ScrubsBits1 >> 44) & 3;
    SELF.LANGUAGETYPEFIELD_Invalid := (le.ScrubsBits1 >> 46) & 3;
    SELF.QUESTIONTIERTYPEFIELD_Invalid := (le.ScrubsBits1 >> 48) & 3;
    SELF.QUESTIONSTATEMENT_Invalid := (le.ScrubsBits1 >> 50) & 3;
    SELF.CORRECTANSWER_Invalid := (le.ScrubsBits1 >> 52) & 3;
    SELF.SELECTEDANSWER_Invalid := (le.ScrubsBits1 >> 54) & 3;
    SELF.DATASOURCETYPEFIELD_Invalid := (le.ScrubsBits1 >> 56) & 3;
    SELF := le;
  END;
  EXPORT ExpandedInfile := PROJECT(h,Into(LEFT));
END;
// This can be thought of as the 'reporting module' - if you don't have an expanded; the other two modules create them ...
EXPORT FromExpanded(DATASET(Expanded_Layout) h) := MODULE
  r := RECORD
    TotalCnt := COUNT(GROUP); // Number of records in total
    QUESTIONSETID_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONSETID_Invalid=1);
    QUESTIONSETID_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONSETID_Invalid=2);
    QUESTIONSETID_Total_ErrorCount := COUNT(GROUP,h.QUESTIONSETID_Invalid>0);
    STRINGCODE_ALLOW_ErrorCount := COUNT(GROUP,h.STRINGCODE_Invalid=1);
    STRINGCODE_LENGTH_ErrorCount := COUNT(GROUP,h.STRINGCODE_Invalid=2);
    STRINGCODE_Total_ErrorCount := COUNT(GROUP,h.STRINGCODE_Invalid>0);
    QUESTIONSETTYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONSETTYPEFIELD_Invalid=1);
    QUESTIONSETTYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONSETTYPEFIELD_Invalid=2);
    QUESTIONSETTYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.QUESTIONSETTYPEFIELD_Invalid>0);
    CREATIONTIME_ALLOW_ErrorCount := COUNT(GROUP,h.CREATIONTIME_Invalid=1);
    CREATIONTIME_LENGTH_ErrorCount := COUNT(GROUP,h.CREATIONTIME_Invalid=2);
    CREATIONTIME_Total_ErrorCount := COUNT(GROUP,h.CREATIONTIME_Invalid>0);
    ACCOUNTNAME_ALLOW_ErrorCount := COUNT(GROUP,h.ACCOUNTNAME_Invalid=1);
    ACCOUNTNAME_LENGTH_ErrorCount := COUNT(GROUP,h.ACCOUNTNAME_Invalid=2);
    ACCOUNTNAME_Total_ErrorCount := COUNT(GROUP,h.ACCOUNTNAME_Invalid>0);
    SUBSETNUMBER_ALLOW_ErrorCount := COUNT(GROUP,h.SUBSETNUMBER_Invalid=1);
    SUBSETNUMBER_LENGTH_ErrorCount := COUNT(GROUP,h.SUBSETNUMBER_Invalid=2);
    SUBSETNUMBER_Total_ErrorCount := COUNT(GROUP,h.SUBSETNUMBER_Invalid>0);
    TRANSACTIONID_ALLOW_ErrorCount := COUNT(GROUP,h.TRANSACTIONID_Invalid=1);
    TRANSACTIONID_LENGTH_ErrorCount := COUNT(GROUP,h.TRANSACTIONID_Invalid=2);
    TRANSACTIONID_Total_ErrorCount := COUNT(GROUP,h.TRANSACTIONID_Invalid>0);
    STARTTIME_ALLOW_ErrorCount := COUNT(GROUP,h.STARTTIME_Invalid=1);
    STARTTIME_LENGTH_ErrorCount := COUNT(GROUP,h.STARTTIME_Invalid=2);
    STARTTIME_Total_ErrorCount := COUNT(GROUP,h.STARTTIME_Invalid>0);
    ENDTIME_ALLOW_ErrorCount := COUNT(GROUP,h.ENDTIME_Invalid=1);
    ENDTIME_LENGTH_ErrorCount := COUNT(GROUP,h.ENDTIME_Invalid=2);
    ENDTIME_Total_ErrorCount := COUNT(GROUP,h.ENDTIME_Invalid>0);
    GRADE_ALLOW_ErrorCount := COUNT(GROUP,h.GRADE_Invalid=1);
    GRADE_LENGTH_ErrorCount := COUNT(GROUP,h.GRADE_Invalid=2);
    GRADE_Total_ErrorCount := COUNT(GROUP,h.GRADE_Invalid>0);
    SUBSETGRADEOUTCOMETYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.SUBSETGRADEOUTCOMETYPEFIELD_Invalid=1);
    SUBSETGRADEOUTCOMETYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.SUBSETGRADEOUTCOMETYPEFIELD_Invalid=2);
    SUBSETGRADEOUTCOMETYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.SUBSETGRADEOUTCOMETYPEFIELD_Invalid>0);
    QUESTIONID_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONID_Invalid=1);
    QUESTIONID_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONID_Invalid=2);
    QUESTIONID_Total_ErrorCount := COUNT(GROUP,h.QUESTIONID_Invalid>0);
    QUESTIONTYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONTYPEFIELD_Invalid=1);
    QUESTIONTYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONTYPEFIELD_Invalid=2);
    QUESTIONTYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.QUESTIONTYPEFIELD_Invalid>0);
    PRESENTATIONPOSITION_ALLOW_ErrorCount := COUNT(GROUP,h.PRESENTATIONPOSITION_Invalid=1);
    PRESENTATIONPOSITION_LENGTH_ErrorCount := COUNT(GROUP,h.PRESENTATIONPOSITION_Invalid=2);
    PRESENTATIONPOSITION_Total_ErrorCount := COUNT(GROUP,h.PRESENTATIONPOSITION_Invalid>0);
    SHUFFLEWEIGHT_ALLOW_ErrorCount := COUNT(GROUP,h.SHUFFLEWEIGHT_Invalid=1);
    SHUFFLEWEIGHT_LENGTH_ErrorCount := COUNT(GROUP,h.SHUFFLEWEIGHT_Invalid=2);
    SHUFFLEWEIGHT_Total_ErrorCount := COUNT(GROUP,h.SHUFFLEWEIGHT_Invalid>0);
    GRADEMULTICHOICERULETYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.GRADEMULTICHOICERULETYPEFIELD_Invalid=1);
    GRADEMULTICHOICERULETYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.GRADEMULTICHOICERULETYPEFIELD_Invalid=2);
    GRADEMULTICHOICERULETYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.GRADEMULTICHOICERULETYPEFIELD_Invalid>0);
    STARTDATE_ALLOW_ErrorCount := COUNT(GROUP,h.STARTDATE_Invalid=1);
    STARTDATE_LENGTH_ErrorCount := COUNT(GROUP,h.STARTDATE_Invalid=2);
    STARTDATE_Total_ErrorCount := COUNT(GROUP,h.STARTDATE_Invalid>0);
    ENDDATE_ALLOW_ErrorCount := COUNT(GROUP,h.ENDDATE_Invalid=1);
    ENDDATE_LENGTH_ErrorCount := COUNT(GROUP,h.ENDDATE_Invalid=2);
    ENDDATE_Total_ErrorCount := COUNT(GROUP,h.ENDDATE_Invalid>0);
    QUESTIONGRADEOUTCOMETYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid=1);
    QUESTIONGRADEOUTCOMETYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid=2);
    QUESTIONGRADEOUTCOMETYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid>0);
    SELECTEDCOUNT_ALLOW_ErrorCount := COUNT(GROUP,h.SELECTEDCOUNT_Invalid=1);
    SELECTEDCOUNT_LENGTH_ErrorCount := COUNT(GROUP,h.SELECTEDCOUNT_Invalid=2);
    SELECTEDCOUNT_Total_ErrorCount := COUNT(GROUP,h.SELECTEDCOUNT_Invalid>0);
    CORRECTCOUNT_ALLOW_ErrorCount := COUNT(GROUP,h.CORRECTCOUNT_Invalid=1);
    CORRECTCOUNT_LENGTH_ErrorCount := COUNT(GROUP,h.CORRECTCOUNT_Invalid=2);
    CORRECTCOUNT_Total_ErrorCount := COUNT(GROUP,h.CORRECTCOUNT_Invalid>0);
    WASNONEOFTHEABOVESELECTED_ALLOW_ErrorCount := COUNT(GROUP,h.WASNONEOFTHEABOVESELECTED_Invalid=1);
    WASNONEOFTHEABOVESELECTED_LENGTH_ErrorCount := COUNT(GROUP,h.WASNONEOFTHEABOVESELECTED_Invalid=2);
    WASNONEOFTHEABOVESELECTED_Total_ErrorCount := COUNT(GROUP,h.WASNONEOFTHEABOVESELECTED_Invalid>0);
    VERITEID_ALLOW_ErrorCount := COUNT(GROUP,h.VERITEID_Invalid=1);
    VERITEID_LENGTH_ErrorCount := COUNT(GROUP,h.VERITEID_Invalid=2);
    VERITEID_Total_ErrorCount := COUNT(GROUP,h.VERITEID_Invalid>0);
    LANGUAGETYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.LANGUAGETYPEFIELD_Invalid=1);
    LANGUAGETYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.LANGUAGETYPEFIELD_Invalid=2);
    LANGUAGETYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.LANGUAGETYPEFIELD_Invalid>0);
    QUESTIONTIERTYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONTIERTYPEFIELD_Invalid=1);
    QUESTIONTIERTYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONTIERTYPEFIELD_Invalid=2);
    QUESTIONTIERTYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.QUESTIONTIERTYPEFIELD_Invalid>0);
    QUESTIONSTATEMENT_ALLOW_ErrorCount := COUNT(GROUP,h.QUESTIONSTATEMENT_Invalid=1);
    QUESTIONSTATEMENT_LENGTH_ErrorCount := COUNT(GROUP,h.QUESTIONSTATEMENT_Invalid=2);
    QUESTIONSTATEMENT_Total_ErrorCount := COUNT(GROUP,h.QUESTIONSTATEMENT_Invalid>0);
    CORRECTANSWER_ALLOW_ErrorCount := COUNT(GROUP,h.CORRECTANSWER_Invalid=1);
    CORRECTANSWER_LENGTH_ErrorCount := COUNT(GROUP,h.CORRECTANSWER_Invalid=2);
    CORRECTANSWER_Total_ErrorCount := COUNT(GROUP,h.CORRECTANSWER_Invalid>0);
    SELECTEDANSWER_ALLOW_ErrorCount := COUNT(GROUP,h.SELECTEDANSWER_Invalid=1);
    SELECTEDANSWER_LENGTH_ErrorCount := COUNT(GROUP,h.SELECTEDANSWER_Invalid=2);
    SELECTEDANSWER_Total_ErrorCount := COUNT(GROUP,h.SELECTEDANSWER_Invalid>0);
    DATASOURCETYPEFIELD_ALLOW_ErrorCount := COUNT(GROUP,h.DATASOURCETYPEFIELD_Invalid=1);
    DATASOURCETYPEFIELD_LENGTH_ErrorCount := COUNT(GROUP,h.DATASOURCETYPEFIELD_Invalid=2);
    DATASOURCETYPEFIELD_Total_ErrorCount := COUNT(GROUP,h.DATASOURCETYPEFIELD_Invalid>0);
  END;
  EXPORT SummaryStats := TABLE(h,r);
  r := RECORD
    STRING10 Src;
    STRING FieldName;
    STRING FieldType;
    STRING ErrorType;
    SALT30.StrType ErrorMessage;
    SALT30.StrType FieldContents;
  END;
  r into(h le,UNSIGNED c) := TRANSFORM
    SELF.Src :=  ''; // Source not provided
    UNSIGNED1 ErrNum := CHOOSE(c,le.QUESTIONSETID_Invalid,le.STRINGCODE_Invalid,le.QUESTIONSETTYPEFIELD_Invalid,le.CREATIONTIME_Invalid,le.ACCOUNTNAME_Invalid,le.SUBSETNUMBER_Invalid,le.TRANSACTIONID_Invalid,le.STARTTIME_Invalid,le.ENDTIME_Invalid,le.GRADE_Invalid,le.SUBSETGRADEOUTCOMETYPEFIELD_Invalid,le.QUESTIONID_Invalid,le.QUESTIONTYPEFIELD_Invalid,le.PRESENTATIONPOSITION_Invalid,le.SHUFFLEWEIGHT_Invalid,le.GRADEMULTICHOICERULETYPEFIELD_Invalid,le.STARTDATE_Invalid,le.ENDDATE_Invalid,le.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid,le.SELECTEDCOUNT_Invalid,le.CORRECTCOUNT_Invalid,le.WASNONEOFTHEABOVESELECTED_Invalid,le.VERITEID_Invalid,le.LANGUAGETYPEFIELD_Invalid,le.QUESTIONTIERTYPEFIELD_Invalid,le.QUESTIONSTATEMENT_Invalid,le.CORRECTANSWER_Invalid,le.SELECTEDANSWER_Invalid,le.DATASOURCETYPEFIELD_Invalid,100);
    SELF.ErrorMessage := IF ( ErrNum = 0, SKIP, CHOOSE(c,Fields.InvalidMessage_QUESTIONSETID(le.QUESTIONSETID_Invalid),Fields.InvalidMessage_STRINGCODE(le.STRINGCODE_Invalid),Fields.InvalidMessage_QUESTIONSETTYPEFIELD(le.QUESTIONSETTYPEFIELD_Invalid),Fields.InvalidMessage_CREATIONTIME(le.CREATIONTIME_Invalid),Fields.InvalidMessage_ACCOUNTNAME(le.ACCOUNTNAME_Invalid),Fields.InvalidMessage_SUBSETNUMBER(le.SUBSETNUMBER_Invalid),Fields.InvalidMessage_TRANSACTIONID(le.TRANSACTIONID_Invalid),Fields.InvalidMessage_STARTTIME(le.STARTTIME_Invalid),Fields.InvalidMessage_ENDTIME(le.ENDTIME_Invalid),Fields.InvalidMessage_GRADE(le.GRADE_Invalid),Fields.InvalidMessage_SUBSETGRADEOUTCOMETYPEFIELD(le.SUBSETGRADEOUTCOMETYPEFIELD_Invalid),Fields.InvalidMessage_QUESTIONID(le.QUESTIONID_Invalid),Fields.InvalidMessage_QUESTIONTYPEFIELD(le.QUESTIONTYPEFIELD_Invalid),Fields.InvalidMessage_PRESENTATIONPOSITION(le.PRESENTATIONPOSITION_Invalid),Fields.InvalidMessage_SHUFFLEWEIGHT(le.SHUFFLEWEIGHT_Invalid),Fields.InvalidMessage_GRADEMULTICHOICERULETYPEFIELD(le.GRADEMULTICHOICERULETYPEFIELD_Invalid),Fields.InvalidMessage_STARTDATE(le.STARTDATE_Invalid),Fields.InvalidMessage_ENDDATE(le.ENDDATE_Invalid),Fields.InvalidMessage_QUESTIONGRADEOUTCOMETYPEFIELD(le.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid),Fields.InvalidMessage_SELECTEDCOUNT(le.SELECTEDCOUNT_Invalid),Fields.InvalidMessage_CORRECTCOUNT(le.CORRECTCOUNT_Invalid),Fields.InvalidMessage_WASNONEOFTHEABOVESELECTED(le.WASNONEOFTHEABOVESELECTED_Invalid),Fields.InvalidMessage_VERITEID(le.VERITEID_Invalid),Fields.InvalidMessage_LANGUAGETYPEFIELD(le.LANGUAGETYPEFIELD_Invalid),Fields.InvalidMessage_QUESTIONTIERTYPEFIELD(le.QUESTIONTIERTYPEFIELD_Invalid),Fields.InvalidMessage_QUESTIONSTATEMENT(le.QUESTIONSTATEMENT_Invalid),Fields.InvalidMessage_CORRECTANSWER(le.CORRECTANSWER_Invalid),Fields.InvalidMessage_SELECTEDANSWER(le.SELECTEDANSWER_Invalid),Fields.InvalidMessage_DATASOURCETYPEFIELD(le.DATASOURCETYPEFIELD_Invalid),'UNKNOWN'));
    SELF.ErrorType := IF ( ErrNum = 0, SKIP, CHOOSE(c
          ,CHOOSE(le.QUESTIONSETID_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.STRINGCODE_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.QUESTIONSETTYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.CREATIONTIME_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.ACCOUNTNAME_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.SUBSETNUMBER_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.TRANSACTIONID_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.STARTTIME_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.ENDTIME_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.GRADE_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.SUBSETGRADEOUTCOMETYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.QUESTIONID_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.QUESTIONTYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.PRESENTATIONPOSITION_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.SHUFFLEWEIGHT_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.GRADEMULTICHOICERULETYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.STARTDATE_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.ENDDATE_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.QUESTIONGRADEOUTCOMETYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.SELECTEDCOUNT_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.CORRECTCOUNT_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.WASNONEOFTHEABOVESELECTED_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.VERITEID_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.LANGUAGETYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.QUESTIONTIERTYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.QUESTIONSTATEMENT_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.CORRECTANSWER_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.SELECTEDANSWER_Invalid,'ALLOW','LENGTH','UNKNOWN')
          ,CHOOSE(le.DATASOURCETYPEFIELD_Invalid,'ALLOW','LENGTH','UNKNOWN'),'UNKNOWN'));
    SELF.FieldName := CHOOSE(c,'QUESTIONSETID','STRINGCODE','QUESTIONSETTYPEFIELD','CREATIONTIME','ACCOUNTNAME','SUBSETNUMBER','TRANSACTIONID','STARTTIME','ENDTIME','GRADE','SUBSETGRADEOUTCOMETYPEFIELD','QUESTIONID','QUESTIONTYPEFIELD','PRESENTATIONPOSITION','SHUFFLEWEIGHT','GRADEMULTICHOICERULETYPEFIELD','STARTDATE','ENDDATE','QUESTIONGRADEOUTCOMETYPEFIELD','SELECTEDCOUNT','CORRECTCOUNT','WASNONEOFTHEABOVESELECTED','VERITEID','LANGUAGETYPEFIELD','QUESTIONTIERTYPEFIELD','QUESTIONSTATEMENT','CORRECTANSWER','SELECTEDANSWER','DATASOURCETYPEFIELD','UNKNOWN');
    SELF.FieldType := CHOOSE(c,'invalid_num','invalid_num','invalid_alphanum','invalid_date','invalid_alpha','invalid_num','invalid_num','invalid_date','invalid_date','invalid_alphanum','invalid_alphanum','invalid_num','invalid_alphanum','invalid_alphanum','invalid_alphanum','invalid_alphanum','invalid_date','invalid_date','invalid_alphanum','invalid_num','invalid_num','invalid_alphanum','invalid_num','invalid_alphanum','invalid_alphanum','invalid_alpha','invalid_alphanum','invalid_alphanum','invalid_alphanum','UNKNOWN');
    SELF.FieldContents := CHOOSE(c,(SALT30.StrType)le.QUESTIONSETID,(SALT30.StrType)le.STRINGCODE,(SALT30.StrType)le.QUESTIONSETTYPEFIELD,(SALT30.StrType)le.CREATIONTIME,(SALT30.StrType)le.ACCOUNTNAME,(SALT30.StrType)le.SUBSETNUMBER,(SALT30.StrType)le.TRANSACTIONID,(SALT30.StrType)le.STARTTIME,(SALT30.StrType)le.ENDTIME,(SALT30.StrType)le.GRADE,(SALT30.StrType)le.SUBSETGRADEOUTCOMETYPEFIELD,(SALT30.StrType)le.QUESTIONID,(SALT30.StrType)le.QUESTIONTYPEFIELD,(SALT30.StrType)le.PRESENTATIONPOSITION,(SALT30.StrType)le.SHUFFLEWEIGHT,(SALT30.StrType)le.GRADEMULTICHOICERULETYPEFIELD,(SALT30.StrType)le.STARTDATE,(SALT30.StrType)le.ENDDATE,(SALT30.StrType)le.QUESTIONGRADEOUTCOMETYPEFIELD,(SALT30.StrType)le.SELECTEDCOUNT,(SALT30.StrType)le.CORRECTCOUNT,(SALT30.StrType)le.WASNONEOFTHEABOVESELECTED,(SALT30.StrType)le.VERITEID,(SALT30.StrType)le.LANGUAGETYPEFIELD,(SALT30.StrType)le.QUESTIONTIERTYPEFIELD,(SALT30.StrType)le.QUESTIONSTATEMENT,(SALT30.StrType)le.CORRECTANSWER,(SALT30.StrType)le.SELECTEDANSWER,(SALT30.StrType)le.DATASOURCETYPEFIELD,'***SALTBUG***');
  END;
  EXPORT AllErrors := NORMALIZE(h,29,Into(LEFT,COUNTER));
   bv := TABLE(AllErrors,{FieldContents, FieldName, Cnt := COUNT(GROUP)},FieldContents, FieldName,MERGE);
  EXPORT BadValues := TOPN(bv,1000,-Cnt);
  // Particular form of stats required for Orbit
  EXPORT OrbitStats(UNSIGNED examples = 10,UNSIGNED Pdate=(UNSIGNED)StringLib.getdateYYYYMMDD(),STRING10 Src='UNK') := FUNCTION
    SALT30.ScrubsOrbitLayout Into(SummaryStats le, UNSIGNED c) := TRANSFORM
      SELF.recordstotal := le.TotalCnt;
      SELF.processdate := Pdate;
      SELF.sourcecode := src;
      SELF.ruledesc := CHOOSE(c
          ,'QUESTIONSETID:invalid_num:ALLOW','QUESTIONSETID:invalid_num:LENGTH'
          ,'STRINGCODE:invalid_num:ALLOW','STRINGCODE:invalid_num:LENGTH'
          ,'QUESTIONSETTYPEFIELD:invalid_alphanum:ALLOW','QUESTIONSETTYPEFIELD:invalid_alphanum:LENGTH'
          ,'CREATIONTIME:invalid_date:ALLOW','CREATIONTIME:invalid_date:LENGTH'
          ,'ACCOUNTNAME:invalid_alpha:ALLOW','ACCOUNTNAME:invalid_alpha:LENGTH'
          ,'SUBSETNUMBER:invalid_num:ALLOW','SUBSETNUMBER:invalid_num:LENGTH'
          ,'TRANSACTIONID:invalid_num:ALLOW','TRANSACTIONID:invalid_num:LENGTH'
          ,'STARTTIME:invalid_date:ALLOW','STARTTIME:invalid_date:LENGTH'
          ,'ENDTIME:invalid_date:ALLOW','ENDTIME:invalid_date:LENGTH'
          ,'GRADE:invalid_alphanum:ALLOW','GRADE:invalid_alphanum:LENGTH'
          ,'SUBSETGRADEOUTCOMETYPEFIELD:invalid_alphanum:ALLOW','SUBSETGRADEOUTCOMETYPEFIELD:invalid_alphanum:LENGTH'
          ,'QUESTIONID:invalid_num:ALLOW','QUESTIONID:invalid_num:LENGTH'
          ,'QUESTIONTYPEFIELD:invalid_alphanum:ALLOW','QUESTIONTYPEFIELD:invalid_alphanum:LENGTH'
          ,'PRESENTATIONPOSITION:invalid_alphanum:ALLOW','PRESENTATIONPOSITION:invalid_alphanum:LENGTH'
          ,'SHUFFLEWEIGHT:invalid_alphanum:ALLOW','SHUFFLEWEIGHT:invalid_alphanum:LENGTH'
          ,'GRADEMULTICHOICERULETYPEFIELD:invalid_alphanum:ALLOW','GRADEMULTICHOICERULETYPEFIELD:invalid_alphanum:LENGTH'
          ,'STARTDATE:invalid_date:ALLOW','STARTDATE:invalid_date:LENGTH'
          ,'ENDDATE:invalid_date:ALLOW','ENDDATE:invalid_date:LENGTH'
          ,'QUESTIONGRADEOUTCOMETYPEFIELD:invalid_alphanum:ALLOW','QUESTIONGRADEOUTCOMETYPEFIELD:invalid_alphanum:LENGTH'
          ,'SELECTEDCOUNT:invalid_num:ALLOW','SELECTEDCOUNT:invalid_num:LENGTH'
          ,'CORRECTCOUNT:invalid_num:ALLOW','CORRECTCOUNT:invalid_num:LENGTH'
          ,'WASNONEOFTHEABOVESELECTED:invalid_alphanum:ALLOW','WASNONEOFTHEABOVESELECTED:invalid_alphanum:LENGTH'
          ,'VERITEID:invalid_num:ALLOW','VERITEID:invalid_num:LENGTH'
          ,'LANGUAGETYPEFIELD:invalid_alphanum:ALLOW','LANGUAGETYPEFIELD:invalid_alphanum:LENGTH'
          ,'QUESTIONTIERTYPEFIELD:invalid_alphanum:ALLOW','QUESTIONTIERTYPEFIELD:invalid_alphanum:LENGTH'
          ,'QUESTIONSTATEMENT:invalid_alpha:ALLOW','QUESTIONSTATEMENT:invalid_alpha:LENGTH'
          ,'CORRECTANSWER:invalid_alphanum:ALLOW','CORRECTANSWER:invalid_alphanum:LENGTH'
          ,'SELECTEDANSWER:invalid_alphanum:ALLOW','SELECTEDANSWER:invalid_alphanum:LENGTH'
          ,'DATASOURCETYPEFIELD:invalid_alphanum:ALLOW','DATASOURCETYPEFIELD:invalid_alphanum:LENGTH','UNKNOWN');
      SELF.rulecnt := CHOOSE(c
          ,le.QUESTIONSETID_ALLOW_ErrorCount,le.QUESTIONSETID_LENGTH_ErrorCount
          ,le.STRINGCODE_ALLOW_ErrorCount,le.STRINGCODE_LENGTH_ErrorCount
          ,le.QUESTIONSETTYPEFIELD_ALLOW_ErrorCount,le.QUESTIONSETTYPEFIELD_LENGTH_ErrorCount
          ,le.CREATIONTIME_ALLOW_ErrorCount,le.CREATIONTIME_LENGTH_ErrorCount
          ,le.ACCOUNTNAME_ALLOW_ErrorCount,le.ACCOUNTNAME_LENGTH_ErrorCount
          ,le.SUBSETNUMBER_ALLOW_ErrorCount,le.SUBSETNUMBER_LENGTH_ErrorCount
          ,le.TRANSACTIONID_ALLOW_ErrorCount,le.TRANSACTIONID_LENGTH_ErrorCount
          ,le.STARTTIME_ALLOW_ErrorCount,le.STARTTIME_LENGTH_ErrorCount
          ,le.ENDTIME_ALLOW_ErrorCount,le.ENDTIME_LENGTH_ErrorCount
          ,le.GRADE_ALLOW_ErrorCount,le.GRADE_LENGTH_ErrorCount
          ,le.SUBSETGRADEOUTCOMETYPEFIELD_ALLOW_ErrorCount,le.SUBSETGRADEOUTCOMETYPEFIELD_LENGTH_ErrorCount
          ,le.QUESTIONID_ALLOW_ErrorCount,le.QUESTIONID_LENGTH_ErrorCount
          ,le.QUESTIONTYPEFIELD_ALLOW_ErrorCount,le.QUESTIONTYPEFIELD_LENGTH_ErrorCount
          ,le.PRESENTATIONPOSITION_ALLOW_ErrorCount,le.PRESENTATIONPOSITION_LENGTH_ErrorCount
          ,le.SHUFFLEWEIGHT_ALLOW_ErrorCount,le.SHUFFLEWEIGHT_LENGTH_ErrorCount
          ,le.GRADEMULTICHOICERULETYPEFIELD_ALLOW_ErrorCount,le.GRADEMULTICHOICERULETYPEFIELD_LENGTH_ErrorCount
          ,le.STARTDATE_ALLOW_ErrorCount,le.STARTDATE_LENGTH_ErrorCount
          ,le.ENDDATE_ALLOW_ErrorCount,le.ENDDATE_LENGTH_ErrorCount
          ,le.QUESTIONGRADEOUTCOMETYPEFIELD_ALLOW_ErrorCount,le.QUESTIONGRADEOUTCOMETYPEFIELD_LENGTH_ErrorCount
          ,le.SELECTEDCOUNT_ALLOW_ErrorCount,le.SELECTEDCOUNT_LENGTH_ErrorCount
          ,le.CORRECTCOUNT_ALLOW_ErrorCount,le.CORRECTCOUNT_LENGTH_ErrorCount
          ,le.WASNONEOFTHEABOVESELECTED_ALLOW_ErrorCount,le.WASNONEOFTHEABOVESELECTED_LENGTH_ErrorCount
          ,le.VERITEID_ALLOW_ErrorCount,le.VERITEID_LENGTH_ErrorCount
          ,le.LANGUAGETYPEFIELD_ALLOW_ErrorCount,le.LANGUAGETYPEFIELD_LENGTH_ErrorCount
          ,le.QUESTIONTIERTYPEFIELD_ALLOW_ErrorCount,le.QUESTIONTIERTYPEFIELD_LENGTH_ErrorCount
          ,le.QUESTIONSTATEMENT_ALLOW_ErrorCount,le.QUESTIONSTATEMENT_LENGTH_ErrorCount
          ,le.CORRECTANSWER_ALLOW_ErrorCount,le.CORRECTANSWER_LENGTH_ErrorCount
          ,le.SELECTEDANSWER_ALLOW_ErrorCount,le.SELECTEDANSWER_LENGTH_ErrorCount
          ,le.DATASOURCETYPEFIELD_ALLOW_ErrorCount,le.DATASOURCETYPEFIELD_LENGTH_ErrorCount,0);
      SELF.rulepcnt := 100 * CHOOSE(c
          ,le.QUESTIONSETID_ALLOW_ErrorCount,le.QUESTIONSETID_LENGTH_ErrorCount
          ,le.STRINGCODE_ALLOW_ErrorCount,le.STRINGCODE_LENGTH_ErrorCount
          ,le.QUESTIONSETTYPEFIELD_ALLOW_ErrorCount,le.QUESTIONSETTYPEFIELD_LENGTH_ErrorCount
          ,le.CREATIONTIME_ALLOW_ErrorCount,le.CREATIONTIME_LENGTH_ErrorCount
          ,le.ACCOUNTNAME_ALLOW_ErrorCount,le.ACCOUNTNAME_LENGTH_ErrorCount
          ,le.SUBSETNUMBER_ALLOW_ErrorCount,le.SUBSETNUMBER_LENGTH_ErrorCount
          ,le.TRANSACTIONID_ALLOW_ErrorCount,le.TRANSACTIONID_LENGTH_ErrorCount
          ,le.STARTTIME_ALLOW_ErrorCount,le.STARTTIME_LENGTH_ErrorCount
          ,le.ENDTIME_ALLOW_ErrorCount,le.ENDTIME_LENGTH_ErrorCount
          ,le.GRADE_ALLOW_ErrorCount,le.GRADE_LENGTH_ErrorCount
          ,le.SUBSETGRADEOUTCOMETYPEFIELD_ALLOW_ErrorCount,le.SUBSETGRADEOUTCOMETYPEFIELD_LENGTH_ErrorCount
          ,le.QUESTIONID_ALLOW_ErrorCount,le.QUESTIONID_LENGTH_ErrorCount
          ,le.QUESTIONTYPEFIELD_ALLOW_ErrorCount,le.QUESTIONTYPEFIELD_LENGTH_ErrorCount
          ,le.PRESENTATIONPOSITION_ALLOW_ErrorCount,le.PRESENTATIONPOSITION_LENGTH_ErrorCount
          ,le.SHUFFLEWEIGHT_ALLOW_ErrorCount,le.SHUFFLEWEIGHT_LENGTH_ErrorCount
          ,le.GRADEMULTICHOICERULETYPEFIELD_ALLOW_ErrorCount,le.GRADEMULTICHOICERULETYPEFIELD_LENGTH_ErrorCount
          ,le.STARTDATE_ALLOW_ErrorCount,le.STARTDATE_LENGTH_ErrorCount
          ,le.ENDDATE_ALLOW_ErrorCount,le.ENDDATE_LENGTH_ErrorCount
          ,le.QUESTIONGRADEOUTCOMETYPEFIELD_ALLOW_ErrorCount,le.QUESTIONGRADEOUTCOMETYPEFIELD_LENGTH_ErrorCount
          ,le.SELECTEDCOUNT_ALLOW_ErrorCount,le.SELECTEDCOUNT_LENGTH_ErrorCount
          ,le.CORRECTCOUNT_ALLOW_ErrorCount,le.CORRECTCOUNT_LENGTH_ErrorCount
          ,le.WASNONEOFTHEABOVESELECTED_ALLOW_ErrorCount,le.WASNONEOFTHEABOVESELECTED_LENGTH_ErrorCount
          ,le.VERITEID_ALLOW_ErrorCount,le.VERITEID_LENGTH_ErrorCount
          ,le.LANGUAGETYPEFIELD_ALLOW_ErrorCount,le.LANGUAGETYPEFIELD_LENGTH_ErrorCount
          ,le.QUESTIONTIERTYPEFIELD_ALLOW_ErrorCount,le.QUESTIONTIERTYPEFIELD_LENGTH_ErrorCount
          ,le.QUESTIONSTATEMENT_ALLOW_ErrorCount,le.QUESTIONSTATEMENT_LENGTH_ErrorCount
          ,le.CORRECTANSWER_ALLOW_ErrorCount,le.CORRECTANSWER_LENGTH_ErrorCount
          ,le.SELECTEDANSWER_ALLOW_ErrorCount,le.SELECTEDANSWER_LENGTH_ErrorCount
          ,le.DATASOURCETYPEFIELD_ALLOW_ErrorCount,le.DATASOURCETYPEFIELD_LENGTH_ErrorCount,0) / le.TotalCnt + 0.5;
    END;
    SummaryInfo := NORMALIZE(SummaryStats,58,Into(LEFT,COUNTER));
    orb_r := RECORD
      AllErrors.Src;
      STRING RuleDesc := TRIM(AllErrors.FieldName)+':'+TRIM(AllErrors.FieldType)+':'+AllErrors.ErrorType;
      SALT30.StrType RawCodeMissing := AllErrors.FieldContents;
    END;
    tab := TABLE(AllErrors,orb_r);
    orb_sum := TABLE(tab,{src,ruledesc,rawcodemissing,rawcodemissingcnt := COUNT(GROUP)},src,ruledesc,rawcodemissing,MERGE);
    gt := GROUP(TOPN(GROUP(orb_sum,src,ruledesc,ALL),examples,-rawcodemissingcnt));
    SALT30.ScrubsOrbitLayout jn(SummaryInfo le, gt ri) := TRANSFORM
      SELF.rawcodemissing := ri.rawcodemissing;
      SELF.rawcodemissingcnt := ri.rawcodemissingcnt;
      SELF := le;
    END;
    j := JOIN(SummaryInfo,gt,LEFT.SourceCode=RIGHT.SRC AND LEFT.ruledesc=RIGHT.ruledesc,jn(LEFT,RIGHT),HASH,LEFT OUTER);
    RETURN IF(examples>0,j,SummaryInfo);
  END;
END;
END;
