EXPORT fRollup(Drid,T,L) := FUNCTIONMACRO
			D1 := JOIN(Drid, T, left.rid = right.id, TRANSFORM(L,
								SELF.s0 := IF(RIGHT.number = 1, RIGHT.ntile, 0),
								SELF.s1 := IF(RIGHT.number = 2, RIGHT.ntile, 0),
								SELF.s2 := IF(RIGHT.number = 3, RIGHT.ntile, 0),
								SELF.s3 := IF(RIGHT.number = 4, RIGHT.ntile, 0),
								SELF.s4 := IF(RIGHT.number = 5, RIGHT.ntile, 0),
								SELF.s5 := IF(RIGHT.number = 6, RIGHT.ntile, 0),
								SELF.s6 := IF(RIGHT.number = 7, RIGHT.ntile, 0),
								SELF.s7 := IF(RIGHT.number = 8, RIGHT.ntile, 0),
								SELF.s8 := IF(RIGHT.number = 9, RIGHT.ntile, 0),
								SELF.s9 := IF(RIGHT.number = 10, RIGHT.ntile, 0),
								SELF.s10 := IF(RIGHT.number = 11, RIGHT.ntile, 0),
								SELF.s11 := IF(RIGHT.number = 12, RIGHT.ntile, 0),
								SELF.s12 := IF(RIGHT.number = 13, RIGHT.ntile, 0),
								SELF.s13 := IF(RIGHT.number = 14, RIGHT.ntile, 0),
								SELF.s14 := IF(RIGHT.number = 15, RIGHT.ntile, 0),
								SELF.s15 := IF(RIGHT.number = 16, RIGHT.ntile, 0),
								SELF.s16 := IF(RIGHT.number = 17, RIGHT.ntile, 0),
								SELF.s17 := IF(RIGHT.number = 18, RIGHT.ntile, 0),
								SELF.s18 := IF(RIGHT.number = 19, RIGHT.ntile, 0),
								SELF.s19 := IF(RIGHT.number = 20, RIGHT.ntile, 0),
								SELF.s20 := IF(RIGHT.number = 21, RIGHT.ntile, 0),
								SELF.s21 := IF(RIGHT.number = 22, RIGHT.ntile, 0),
								SELF.s22 := IF(RIGHT.number = 23, RIGHT.ntile, 0),
								SELF.s23 := IF(RIGHT.number = 24, RIGHT.ntile, 0),
								SELF.s24 := IF(RIGHT.number = 25, RIGHT.ntile, 0),
								SELF.s25 := IF(RIGHT.number = 26, RIGHT.ntile, 0),
								SELF.s26 := IF(RIGHT.number = 27, RIGHT.ntile, 0),
								SELF.s27 := IF(RIGHT.number = 28, RIGHT.ntile, 0),
								SELF.s28 := IF(RIGHT.number = 29, RIGHT.ntile, 0),
								SELF.s29 := IF(RIGHT.number = 30, RIGHT.ntile, 0),
								SELF.s30 := IF(RIGHT.number = 31, RIGHT.ntile, 0),
								SELF.s31 := IF(RIGHT.number = 32, RIGHT.ntile, 0),
								SELF.s32 := IF(RIGHT.number = 33, RIGHT.ntile, 0),
								SELF.s33 := IF(RIGHT.number = 34, RIGHT.ntile, 0),
								SELF.s34 := IF(RIGHT.number = 35, RIGHT.ntile, 0),
								SELF.s35 := IF(RIGHT.number = 36, RIGHT.ntile, 0),
								SELF.s36 := IF(RIGHT.number = 37, RIGHT.ntile, 0),
								SELF.s37 := IF(RIGHT.number = 38, RIGHT.ntile, 0),
								SELF.s38 := IF(RIGHT.number = 39, RIGHT.ntile, 0),
								SELF.s39 := IF(RIGHT.number = 40, RIGHT.ntile, 0),
								SELF.s40 := IF(RIGHT.number = 41, RIGHT.ntile, 0),
								SELF.s41 := IF(RIGHT.number = 42, RIGHT.ntile, 0),
								SELF.s42 := IF(RIGHT.number = 43, RIGHT.ntile, 0),
								SELF.s43 := IF(RIGHT.number = 44, RIGHT.ntile, 0),
								SELF.s44 := IF(RIGHT.number = 45, RIGHT.ntile, 0),
								SELF.s45 := IF(RIGHT.number = 46, RIGHT.ntile, 0),
								SELF.s46 := IF(RIGHT.number = 47, RIGHT.ntile, 0),
								SELF.s47 := IF(RIGHT.number = 48, RIGHT.ntile, 0),
								SELF.s48 := IF(RIGHT.number = 49, RIGHT.ntile, 0),
								SELF.s49 := IF(RIGHT.number = 50, RIGHT.ntile, 0),
								SELF.s50 := IF(RIGHT.number = 51, RIGHT.ntile, 0),
								SELF.s51 := IF(RIGHT.number = 52, RIGHT.ntile, 0),
								SELF.s52 := IF(RIGHT.number = 53, RIGHT.ntile, 0),
								SELF.s53 := IF(RIGHT.number = 54, RIGHT.ntile, 0),
								SELF.s54 := IF(RIGHT.number = 55, RIGHT.ntile, 0),
								SELF.s55 := IF(RIGHT.number = 56, RIGHT.ntile, 0),
								SELF.s56 := IF(RIGHT.number = 57, RIGHT.ntile, 0),
								SELF.s57 := IF(RIGHT.number = 58, RIGHT.ntile, 0),
								SELF.s58 := IF(RIGHT.number = 59, RIGHT.ntile, 0),
								SELF.s59 := IF(RIGHT.number = 60, RIGHT.ntile, 0),
								SELF.s60 := IF(RIGHT.number = 61, RIGHT.ntile, 0),
								SELF.s61 := IF(RIGHT.number = 62, RIGHT.ntile, 0),
								SELF.s62 := IF(RIGHT.number = 63, RIGHT.ntile, 0),
								SELF.s63 := IF(RIGHT.number = 64, RIGHT.ntile, 0),
								SELF.s64 := IF(RIGHT.number = 65, RIGHT.ntile, 0),
								SELF.s65 := IF(RIGHT.number = 66, RIGHT.ntile, 0),
								SELF.s66 := IF(RIGHT.number = 67, RIGHT.ntile, 0),
								SELF.s67 := IF(RIGHT.number = 68, RIGHT.ntile, 0),
								SELF.s68 := IF(RIGHT.number = 69, RIGHT.ntile, 0),
								SELF.s69 := IF(RIGHT.number = 70, RIGHT.ntile, 0),
								SELF.s70 := IF(RIGHT.number = 71, RIGHT.ntile, 0),
								SELF.s71 := IF(RIGHT.number = 72, RIGHT.ntile, 0),
								SELF.s72 := IF(RIGHT.number = 73, RIGHT.ntile, 0),
								SELF.s73 := IF(RIGHT.number = 74, RIGHT.ntile, 0),
								SELF.s74 := IF(RIGHT.number = 75, RIGHT.ntile, 0),
								SELF.s75 := IF(RIGHT.number = 76, RIGHT.ntile, 0),
								SELF.s76 := IF(RIGHT.number = 77, RIGHT.ntile, 0),
								SELF.s77 := IF(RIGHT.number = 78, RIGHT.ntile, 0),
								SELF.s78 := IF(RIGHT.number = 79, RIGHT.ntile, 0),
								SELF.s79 := IF(RIGHT.number = 80, RIGHT.ntile, 0),
								SELF.s80 := IF(RIGHT.number = 81, RIGHT.ntile, 0),
								SELF.s81 := IF(RIGHT.number = 82, RIGHT.ntile, 0),
								SELF.s82 := IF(RIGHT.number = 83, RIGHT.ntile, 0),
								SELF.s83 := IF(RIGHT.number = 84, RIGHT.ntile, 0),
								SELF.s84 := IF(RIGHT.number = 85, RIGHT.ntile, 0),
								SELF.s85 := IF(RIGHT.number = 86, RIGHT.ntile, 0),
								SELF.s86 := IF(RIGHT.number = 87, RIGHT.ntile, 0),
								SELF.s87 := IF(RIGHT.number = 88, RIGHT.ntile, 0),
								SELF.s88 := IF(RIGHT.number = 89, RIGHT.ntile, 0),
								SELF.s89 := IF(RIGHT.number = 90, RIGHT.ntile, 0),
								SELF.s90 := IF(RIGHT.number = 91, RIGHT.ntile, 0),
								SELF.s91 := IF(RIGHT.number = 92, RIGHT.ntile, 0),
								SELF.s92 := IF(RIGHT.number = 93, RIGHT.ntile, 0),
								SELF.s93 := IF(RIGHT.number = 94, RIGHT.ntile, 0),
								SELF.s94 := IF(RIGHT.number = 95, RIGHT.ntile, 0),
								SELF.s95 := IF(RIGHT.number = 96, RIGHT.ntile, 0),
								SELF.s96 := IF(RIGHT.number = 97, RIGHT.ntile, 0),
								SELF.s97 := IF(RIGHT.number = 98, RIGHT.ntile, 0),
								SELF.s98 := IF(RIGHT.number = 99, RIGHT.ntile, 0),
								SELF.s99 := IF(RIGHT.number = 100, RIGHT.ntile, 0),
								SELf := LEFT
							));

		RETURN 
			ROLLUP(SORT(D1, rid), LEFT.rid = RIGHT.rid,
							TRANSFORM(L,
								SELF.s0 := IF(LEFT.s0>0,LEFT.s0, RIGHT.s0),
								SELF.s1 := IF(LEFT.s1>0,LEFT.s1, RIGHT.s1),
								SELF.s2 := IF(LEFT.s2>0,LEFT.s2, RIGHT.s2),
								SELF.s3 := IF(LEFT.s3>0,LEFT.s3, RIGHT.s3),
								SELF.s4 := IF(LEFT.s4>0,LEFT.s4, RIGHT.s4),
								SELF.s5 := IF(LEFT.s5>0,LEFT.s5, RIGHT.s5),
								SELF.s6 := IF(LEFT.s6>0,LEFT.s6, RIGHT.s6),
								SELF.s7 := IF(LEFT.s7>0,LEFT.s7, RIGHT.s7),
								SELF.s8 := IF(LEFT.s8>0,LEFT.s8, RIGHT.s8),
								SELF.s9 := IF(LEFT.s9>0,LEFT.s9, RIGHT.s9),
								SELF.s10 := IF(LEFT.s10>0,LEFT.s10, RIGHT.s10),
								SELF.s11 := IF(LEFT.s11>0,LEFT.s11, RIGHT.s11),
								SELF.s12 := IF(LEFT.s12>0,LEFT.s12, RIGHT.s12),
								SELF.s13 := IF(LEFT.s13>0,LEFT.s13, RIGHT.s13),
								SELF.s14 := IF(LEFT.s14>0,LEFT.s14, RIGHT.s14),
								SELF.s15 := IF(LEFT.s15>0,LEFT.s15, RIGHT.s15),
								SELF.s16 := IF(LEFT.s16>0,LEFT.s16, RIGHT.s16),
								SELF.s17 := IF(LEFT.s17>0,LEFT.s17, RIGHT.s17),
								SELF.s18 := IF(LEFT.s18>0,LEFT.s18, RIGHT.s18),
								SELF.s19 := IF(LEFT.s19>0,LEFT.s19, RIGHT.s19),
								SELF.s20 := IF(LEFT.s20>0,LEFT.s20, RIGHT.s20),
								SELF.s21 := IF(LEFT.s21>0,LEFT.s21, RIGHT.s21),
								SELF.s22 := IF(LEFT.s22>0,LEFT.s22, RIGHT.s22),
								SELF.s23 := IF(LEFT.s23>0,LEFT.s23, RIGHT.s23),
								SELF.s24 := IF(LEFT.s24>0,LEFT.s24, RIGHT.s24),
								SELF.s25 := IF(LEFT.s25>0,LEFT.s25, RIGHT.s25),
								SELF.s26 := IF(LEFT.s26>0,LEFT.s26, RIGHT.s26),
								SELF.s27 := IF(LEFT.s27>0,LEFT.s27, RIGHT.s27),
								SELF.s28 := IF(LEFT.s28>0,LEFT.s28, RIGHT.s28),
								SELF.s29 := IF(LEFT.s29>0,LEFT.s29, RIGHT.s29),
								SELF.s30 := IF(LEFT.s30>0,LEFT.s30, RIGHT.s30),
								SELF.s31 := IF(LEFT.s31>0,LEFT.s31, RIGHT.s31),
								SELF.s32 := IF(LEFT.s32>0,LEFT.s32, RIGHT.s32),
								SELF.s33 := IF(LEFT.s33>0,LEFT.s33, RIGHT.s33),
								SELF.s34 := IF(LEFT.s34>0,LEFT.s34, RIGHT.s34),
								SELF.s35 := IF(LEFT.s35>0,LEFT.s35, RIGHT.s35),
								SELF.s36 := IF(LEFT.s36>0,LEFT.s36, RIGHT.s36),
								SELF.s37 := IF(LEFT.s37>0,LEFT.s37, RIGHT.s37),
								SELF.s38 := IF(LEFT.s38>0,LEFT.s38, RIGHT.s38),
								SELF.s39 := IF(LEFT.s39>0,LEFT.s39, RIGHT.s39),
								SELF.s40 := IF(LEFT.s40>0,LEFT.s40, RIGHT.s40),
								SELF.s41 := IF(LEFT.s41>0,LEFT.s41, RIGHT.s41),
								SELF.s42 := IF(LEFT.s42>0,LEFT.s42, RIGHT.s42),
								SELF.s43 := IF(LEFT.s43>0,LEFT.s43, RIGHT.s43),
								SELF.s44 := IF(LEFT.s44>0,LEFT.s44, RIGHT.s44),
								SELF.s45 := IF(LEFT.s45>0,LEFT.s45, RIGHT.s45),
								SELF.s46 := IF(LEFT.s46>0,LEFT.s46, RIGHT.s46),
								SELF.s47 := IF(LEFT.s47>0,LEFT.s47, RIGHT.s47),
								SELF.s48 := IF(LEFT.s48>0,LEFT.s48, RIGHT.s48),
								SELF.s49 := IF(LEFT.s49>0,LEFT.s49, RIGHT.s49),
								SELF.s50 := IF(LEFT.s50>0,LEFT.s50, RIGHT.s50),
								SELF.s51 := IF(LEFT.s51>0,LEFT.s51, RIGHT.s51),
								SELF.s52 := IF(LEFT.s52>0,LEFT.s52, RIGHT.s52),
								SELF.s53 := IF(LEFT.s53>0,LEFT.s53, RIGHT.s53),
								SELF.s54 := IF(LEFT.s54>0,LEFT.s54, RIGHT.s54),
								SELF.s55 := IF(LEFT.s55>0,LEFT.s55, RIGHT.s55),
								SELF.s56 := IF(LEFT.s56>0,LEFT.s56, RIGHT.s56),
								SELF.s57 := IF(LEFT.s57>0,LEFT.s57, RIGHT.s57),
								SELF.s58 := IF(LEFT.s58>0,LEFT.s58, RIGHT.s58),
								SELF.s59 := IF(LEFT.s59>0,LEFT.s59, RIGHT.s59),
								SELF.s60 := IF(LEFT.s60>0,LEFT.s60, RIGHT.s60),
								SELF.s61 := IF(LEFT.s61>0,LEFT.s61, RIGHT.s61),
								SELF.s62 := IF(LEFT.s62>0,LEFT.s62, RIGHT.s62),
								SELF.s63 := IF(LEFT.s63>0,LEFT.s63, RIGHT.s63),
								SELF.s64 := IF(LEFT.s64>0,LEFT.s64, RIGHT.s64),
								SELF.s65 := IF(LEFT.s65>0,LEFT.s65, RIGHT.s65),
								SELF.s66 := IF(LEFT.s66>0,LEFT.s66, RIGHT.s66),
								SELF.s67 := IF(LEFT.s67>0,LEFT.s67, RIGHT.s67),
								SELF.s68 := IF(LEFT.s68>0,LEFT.s68, RIGHT.s68),
								SELF.s69 := IF(LEFT.s69>0,LEFT.s69, RIGHT.s69),
								SELF.s70 := IF(LEFT.s70>0,LEFT.s70, RIGHT.s70),
								SELF.s71 := IF(LEFT.s71>0,LEFT.s71, RIGHT.s71),
								SELF.s72 := IF(LEFT.s72>0,LEFT.s72, RIGHT.s72),
								SELF.s73 := IF(LEFT.s73>0,LEFT.s73, RIGHT.s73),
								SELF.s74 := IF(LEFT.s74>0,LEFT.s74, RIGHT.s74),
								SELF.s75 := IF(LEFT.s75>0,LEFT.s75, RIGHT.s75),
								SELF.s76 := IF(LEFT.s76>0,LEFT.s76, RIGHT.s76),
								SELF.s77 := IF(LEFT.s77>0,LEFT.s77, RIGHT.s77),
								SELF.s78 := IF(LEFT.s78>0,LEFT.s78, RIGHT.s78),
								SELF.s79 := IF(LEFT.s79>0,LEFT.s79, RIGHT.s79),
								SELF.s80 := IF(LEFT.s80>0,LEFT.s80, RIGHT.s80),
								SELF.s81 := IF(LEFT.s81>0,LEFT.s81, RIGHT.s81),
								SELF.s82 := IF(LEFT.s82>0,LEFT.s82, RIGHT.s82),
								SELF.s83 := IF(LEFT.s83>0,LEFT.s83, RIGHT.s83),
								SELF.s84 := IF(LEFT.s84>0,LEFT.s84, RIGHT.s84),
								SELF.s85 := IF(LEFT.s85>0,LEFT.s85, RIGHT.s85),
								SELF.s86 := IF(LEFT.s86>0,LEFT.s86, RIGHT.s86),
								SELF.s87 := IF(LEFT.s87>0,LEFT.s87, RIGHT.s87),
								SELF.s88 := IF(LEFT.s88>0,LEFT.s88, RIGHT.s88),
								SELF.s89 := IF(LEFT.s89>0,LEFT.s89, RIGHT.s89),
								SELF.s90 := IF(LEFT.s90>0,LEFT.s90, RIGHT.s90),
								SELF.s91 := IF(LEFT.s91>0,LEFT.s91, RIGHT.s91),
								SELF.s92 := IF(LEFT.s92>0,LEFT.s92, RIGHT.s92),
								SELF.s93 := IF(LEFT.s93>0,LEFT.s93, RIGHT.s93),
								SELF.s94 := IF(LEFT.s94>0,LEFT.s94, RIGHT.s94),
								SELF.s95 := IF(LEFT.s95>0,LEFT.s95, RIGHT.s95),
								SELF.s96 := IF(LEFT.s96>0,LEFT.s96, RIGHT.s96),
								SELF.s97 := IF(LEFT.s97>0,LEFT.s97, RIGHT.s97),
								SELF.s98 := IF(LEFT.s98>0,LEFT.s98, RIGHT.s98),
								SELF.s99 := IF(LEFT.s99>0,LEFT.s99, RIGHT.s99),
								SELF := LEFT
								));
	ENDMACRO;