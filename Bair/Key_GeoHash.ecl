import data_services;

r := RECORD
  unsigned1 etype;
  string10 class;
  string4 gh4;
  unsigned4 yyyymm;
	boolean raids;
  string23 eid;
  string8 gh8;
  unsigned7 date;
  string10 latitude;
  string11 longitude;
  string10 ori;
	unsigned2 group_id;
  unsigned4 stamp;
  unsigned1 s0;
  unsigned1 s1;
  unsigned1 s2;
  unsigned1 s3;
  unsigned1 s4;
  unsigned1 s5;
  unsigned1 s6;
  unsigned1 s7;
  unsigned1 s8;
  unsigned1 s9;
  unsigned1 s10;
  unsigned1 s11;
  unsigned1 s12;
  unsigned1 s13;
  unsigned1 s14;
  unsigned1 s15;
  unsigned1 s16;
  unsigned1 s17;
  unsigned1 s18;
  unsigned1 s19;
  unsigned1 s20;
  unsigned1 s21;
  unsigned1 s22;
  unsigned1 s23;
  unsigned1 s24;
  unsigned1 s25;
  unsigned1 s26;
  unsigned1 s27;
  unsigned1 s28;
  unsigned1 s29;
  unsigned1 s30;
  unsigned1 s31;
  unsigned1 s32;
  unsigned1 s33;
  unsigned1 s34;
  unsigned1 s35;
  unsigned1 s36;
  unsigned1 s37;
  unsigned1 s38;
  unsigned1 s39;
  unsigned1 s40;
  unsigned1 s41;
  unsigned1 s42;
  unsigned1 s43;
  unsigned1 s44;
  unsigned1 s45;
  unsigned1 s46;
  unsigned1 s47;
  unsigned1 s48;
  unsigned1 s49;
  unsigned1 s50;
  unsigned1 s51;
  unsigned1 s52;
  unsigned1 s53;
  unsigned1 s54;
  unsigned1 s55;
  unsigned1 s56;
  unsigned1 s57;
  unsigned1 s58;
  unsigned1 s59;
  unsigned1 s60;
  unsigned1 s61;
  unsigned1 s62;
  unsigned1 s63;
  unsigned1 s64;
  unsigned1 s65;
  unsigned1 s66;
  unsigned1 s67;
  unsigned1 s68;
  unsigned1 s69;
  unsigned1 s70;
  unsigned1 s71;
  unsigned1 s72;
  unsigned1 s73;
  unsigned1 s74;
  unsigned1 s75;
  unsigned1 s76;
  unsigned1 s77;
  unsigned1 s78;
  unsigned1 s79;
  unsigned1 s80;
  unsigned1 s81;
  unsigned1 s82;
  unsigned1 s83;
  unsigned1 s84;
  unsigned1 s85;
  unsigned1 s86;
  unsigned1 s87;
  unsigned1 s88;
  unsigned1 s89;
  unsigned1 s90;
  unsigned1 s91;
  unsigned1 s92;
  unsigned1 s93;
  unsigned1 s94;
  unsigned1 s95;
  unsigned1 s96;
  unsigned1 s97;
  unsigned1 s98;
  unsigned1 s99;
 END;

d:=dataset([],r);


EXPORT Key_GeoHash(string v = 'qa',boolean isDelta = false) := index(d,{etype,class,gh4,YYYYMM,raids,eid}, {gh8,date,latitude,longitude,ori,group_id,stamp,s0,s1,s2,s3,s4,s5,s6,s7,s8,s9,s10,s11,s12,s13,s14,s15,s16,s17,s18,s19,s20,s21,s22,s23,s24,s25,s26,s27,s28,s29,s30,s31,s32,s33,s34,s35,s36,s37,s38,s39,s40,s41,s42,s43,s44,s45,s46,s47,s48,s49,s50,s51,s52,s53,s54,s55,s56,s57,s58,s59,s60,s61,s62,s63,s64,s65,s66,s67,s68,s69,s70,s71,s72,s73,s74,s75,s76,s77,s78,s79,s80,s81,s82,s83,s84,s85,s86,s87,s88,s89,s90,s91,s92,s93,s94,s95,s96,s97,s98,s99},
	data_services.Data_location.Prefix('BAIR')+'thor_data400::key::bair::geohash::'+if(isDelta, 'delta::', '')+v, OPT);

