import Data_Services;

r := RECORD
  string23 eid;
  string12 gh12;
  unsigned1 etype;
  string id;
  string64 agency_offender_id;
  string64 name_type;
  string64 last_name;
  string64 first_name;
  string64 middle_name;
  string104 moniker;
  string255 address;
  real8 x_coordinate;
  real8 y_coordinate;
  string50 coordinate;
  string25 dob;
  string30 race;
  string12 sex;
  string30 hair;
  string20 hair_length;
  string20 eyes;
  string12 hand_use;
  string30 speech;
  string30 teeth;
  string64 physical_condition;
  string20 build;
  string30 complexion;
  string30 facial_hair;
  string20 hat;
  string20 mask;
  string20 glasses;
  string20 appearance;
  string20 shirt;
  string20 pants;
  string20 shoes;
  string20 jacket;
  string50 soundex;
  unsigned3 weight_1;
  unsigned3 weight_2;
  unsigned3 height_1;
  unsigned3 height_2;
  integer2 age_1;
  integer2 age_2;
  string20 offenders_sid;
  string24 dl_number;
  string24 dl_state;
  string24 fbi_number;
  string picture;
  string25 edit_date;
  string1 quarantined;
  unsigned2 group_id;
  real8 bair_score;
  string25 raids_activitydate;
  unsigned2 import_instance_id;
  string20 admin_state;
  string96 agency_name;
  string255 user_text_1;
  string255 user_text_2;
  unsigned2 user_integer;
  real8 user_float;
  string25 user_datetime;
  string8 classification_code;
  string30 classification_description;
  string50 classification_guid;
  string8 classification;
  string64 agency_category;
  string64 agency_level;
  string10 agency_score;
  string75 case_reference_number;
  string255 charge_offense;
  string64 probation_type;
  string50 probation_officer;
  string64 warrant_type;
  string64 warrant_number;
  string64 gang_name;
  string10 gang_role;
  string25 classification_date;
  string25 expiration_date;
  unsigned4 data_provider_id;
  string50 data_provider_ori;
  string200 data_provider_name;
	unsigned8 lexid;
	boolean has_image;
 END;

d:=dataset([],r);

EXPORT Key_Payload_Offender(string v='qa',boolean isDelta = false) := 
	index(d,{eid},{d},data_services.Data_location.Prefix('BAIR')+'thor_data400::key::bair::offenders::'+ if(isDelta, 'delta::', '')+v+'::eid');