import Data_Services;

r := RECORD
  string23 eid;
  string12 gh12;
  unsigned1 etype;
  unsigned4 id;
  string100 case_number;
  string100 reportnumber;
  string25 report_date;
  string255 address;
  string20 county;
  string50 crash_city;
  string20 crash_state;
  string50 coordinate;
  real8 x;
  real8 y;
  string1 hitandrun;
  string1 intersectionrelated;
  string50 officername;
  string20 crashtype;
  string25 locationtype;
  string60 accidentclass;
  string50 specialcircumstance1;
  string50 specialcircumstance2;
  string50 specialcircumstance3;
  string50 lightcondition;
  string50 weathercondition;
  string50 surfacetype;
  string60 roadspecialfeature1;
  string60 roadspecialfeature2;
  string60 roadspecialfeature3;
  string60 surfacecondition;
  string150 trafficcontrolpresent;
  string1 quarantined;
  unsigned2 crash_import_id;
  unsigned4 per_id;
  unsigned4 per_crashid;
  unsigned4 vehicleid;
  string1 driver;
  string50 first_name;
  string50 last_name;
  string50 licensenumber;
  string20 licensestate;
  string50 race;
  string10 sex;
  string50 per_city;
  string25 per_state;
  unsigned2 age;
  string150 driveractions;
  string50 airbag;
  string50 seatbelt;
  unsigned4 agency_person_id;
  unsigned5 per_crash_import_id;
  unsigned4 veh_id;
  unsigned4 veh_crashid;
  string100 vin;
  string100 plate;
  string100 platestate;
  string10 year;
  string50 make;
  string50 model;
  string1 towed;
  string50 vehicle_type;
  string255 damage;
  string255 action;
  string255 sequence;
  string255 driverimpairment;
  string128 agency_vehicle_id;
  unsigned5 veh_crash_import_id;
  unsigned4 data_provider_id;
  string50 data_provider_ori;
  string200 data_provider_name;
  string1 sourcep;
  string1 sourcev;
	unsigned8 lexid;
 END;


d:=dataset([],r);

EXPORT Key_Payload_Crash(string v='qa',boolean isDelta = false) := 
	index(d,{eid},{d},data_services.Data_location.Prefix('BAIR')+'thor_data400::key::bair::crash::' + if(isDelta, 'delta::', '') +v+'::eid');
