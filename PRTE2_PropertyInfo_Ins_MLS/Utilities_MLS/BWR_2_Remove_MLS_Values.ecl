/* **********************************************************************************************************
We have been told that none of the fields being blanked out here should have any MLS values.
********************************************************************************************************** */
IMPORT PRTE2_PropertyInfo_Ins_MLS,PRTE2_Common,PRTE2_PropertyInfo_Ins_PreMLS;

// READ THE DEV BASE FILE SINCE WE SAVED STEP 1 there.
DS_Prop := SORT(PRTE2_PropertyInfo_Ins_MLS.Files.PII_ALPHA_BASE_SF_DS,property_rid);
Keep_asis := DS_Prop(vendor_source <> 'E');
PropInfo_E := DS_Prop(vendor_source = 'E');

NewProp_E := PROJECT(PropInfo_E,
                TRANSFORM({PropInfo_E},
                    SELF.basement_finish := '';
                    SELF.src_basement_finish := '';
                    SELF.tax_dt_basement_finish := '';
                    SELF.construction_type := '';
                    SELF.src_construction_type := '';
                    SELF.tax_dt_construction_type := '';
                    SELF.flood_zone_panel := '';
                    SELF.src_flood_zone_panel := '';
                    SELF.tax_dt_flood_zone_panel := '';
                    SELF.first_floor_square_footage := '';
                    SELF.src_first_floor_square_footage := '';
                    SELF.tax_dt_first_floor_square_footage := '';
                    SELF.roof_type := '';
                    SELF.src_roof_type := '';
                    SELF.tax_dt_roof_type		 := '';
                    SELF.basement_square_footage := '';
                    SELF.src_basement_square_footage := '';
                    SELF.tax_dt_basement_square_footage := '';
                    SELF.effective_year_built := '';
                    SELF.src_effective_year_built := '';
                    SELF.tax_dt_effective_year_built := '';
                    SELF.garage_square_footage := '';
                    SELF.src_garage_square_footage := '';
                    SELF.tax_dt_garage_square_footage := '';
                    SELF.stories_type := '';
                    SELF.src_stories_type := '';
                    SELF.tax_dt_stories_type := '';
                    SELF.apn_number := '';
                    SELF.src_apn_number := '';
                    SELF.tax_dt_apn_number := '';
                    SELF.census_tract := '';
                    SELF.src_census_tract := '';
                    SELF.tax_dt_census_tract := '';
                    SELF.range := '';
                    SELF.src_range := '';
                    SELF.tax_dt_range := '';
                    SELF.zoning := '';
                    SELF.src_zoning := '';
                    SELF.tax_dt_zoning := '';
                    SELF.block_number := '';
                    SELF.src_block_number := '';
                    SELF.tax_dt_block_number := '';
                    SELF.county_name := '';
                    SELF.src_county_name := '';
                    SELF.tax_dt_county_name := '';
                    SELF.fips_code := '';
                    SELF.src_fips_code := '';
                    SELF.tax_dt_fips_code := '';
                    SELF.municipality := '';
                    SELF.src_municipality := '';
                    SELF.tax_dt_municipality := '';
                    SELF.township := '';
                    SELF.src_township := '';
                    SELF.tax_dt_township := '';
                    SELF.homestead_exemption_ind := '';
                    SELF.src_homestead_exemption_ind := '';
                    SELF.tax_dt_homestead_exemption_ind := '';
                    SELF.land_use_code := '';
                    SELF.src_land_use_code := '';
                    SELF.tax_dt_land_use_code := '';
                    SELF.latitude := '';
                    SELF.src_latitude := '';
                    SELF.tax_dt_latitude := '';
                    SELF.longitude := '';
                    SELF.src_longitude := '';
                    SELF.tax_dt_longitude := '';
                    SELF.location_influence_code := '';
                    SELF.src_location_influence_code := '';
                    SELF.tax_dt_location_influence_code := '';
                    SELF.lot_depth_footage := '';
                    SELF.src_lot_depth_footage := '';
                    SELF.tax_dt_lot_depth_footage := '';
                    SELF.lot_front_footage := '';
                    SELF.src_lot_front_footage := '';
                    SELF.tax_dt_lot_front_footage := '';
                    SELF.lot_number := '';
                    SELF.src_lot_number := '';
                    SELF.tax_dt_lot_number := '';
                    SELF.water := '';
                    SELF.src_water := '';
                    SELF.tax_dt_water := '';
                    SELF.assessed_land_value := '';
                    SELF.src_assessed_land_value := '';
                    SELF.tax_dt_assessed_land_value := '';
                    SELF.tax_year := '';
                    SELF.src_tax_year := '';
                    SELF.market_land_value := '';
                    SELF.src_market_land_value := '';
                    SELF.tax_dt_market_land_value := '';
                    SELF.improvement_value := '';
                    SELF.src_improvement_value := '';
                    SELF.tax_dt_improvement_value := '';
                    SELF.percent_improved := 0;
                    SELF.src_percent_improved := '';
                    SELF.tax_dt_percent_improved := '';
                    SELF.total_assessed_value := '';
                    SELF.src_total_assessed_value := '';
                    SELF.tax_dt_total_assessed_value := '';
                    SELF.total_calculated_value := '';
                    SELF.src_total_calculated_value := '';
                    SELF.tax_dt_total_calculated_value := '';
                    SELF.total_land_value := '';
                    SELF.src_total_land_value := '';
                    SELF.tax_dt_total_land_value := '';
                    SELF.total_market_value := '';
                    SELF.src_total_market_value := '';
                    SELF.tax_dt_total_market_value := '';
                    SELF.frame_type := '';
                    SELF.src_frame_type := '';
                    SELF.tax_dt_frame_type := '';
                    SELF.fuel_type := '';
                    SELF.src_fuel_type := '';
                    SELF.tax_dt_fuel_type := '';
                    SELF.no_of_bath_fixtures := '';
                    SELF.src_no_of_bath_fixtures := '';
                    SELF.tax_dt_no_of_bath_fixtures := '';
                    SELF.assessment_document_number := '';
                    SELF.src_assessment_document_number := '';
                    SELF.tax_dt_assessment_document_number := '';
                    SELF.assessment_recording_date := '';
                    SELF.src_assessment_recording_date := '';
                    SELF.tax_dt_assessment_recording_date := '';
                    SELF.deed_document_number := '';
                    SELF.src_deed_document_number := '';
                    SELF.rec_dt_deed_document_number := '';
                    SELF.deed_recording_date := '';
                    SELF.src_deed_recording_date := '';
                    SELF.full_part_sale := '';
                    SELF.src_full_part_sale := '';
                    SELF.rec_dt_full_part_sale := '';
                    SELF.sale_type_code := '';
                    SELF.src_sale_type_code := '';
                    SELF.rec_dt_sale_type_code := '';
                    SELF.mortgage_company_name := '';
                    SELF.src_mortgage_company_name := '';
                    SELF.rec_dt_mortgage_company_name := '';
                    SELF.loan_amount := '';
                    SELF.src_loan_amount := '';
                    SELF.rec_dt_loan_amount := '';
                    SELF.second_loan_amount := '';
                    SELF.src_second_loan_amount := '';
                    SELF.rec_dt_second_loan_amount := '';
                    SELF.loan_type_code := '';
                    SELF.src_loan_type_code := '';
                    SELF.rec_dt_loan_type_code := '';
                    SELF.interest_rate_type_code := '';
                    SELF.src_interest_rate_type_code := '';
                    SELF.rec_dt_interest_rate_type_code := '';
                    SELF.category := '';
                    SELF.material := '';
                    SELF.value := 0;
                    SELF.quality := '';
                    SELF.condition := '';
                    SELF.age := 0;
                    SELF := LEFT;
                ));
// -------------------------------------------------------------------------------------
EXPORT_DSa := Keep_asis+NewProp_E;
EXPORT_DS := SORT(EXPORT_DSa,fares_unformatted_apn,property_rid);
OUTPUT('COUNTS:'+COUNT(DS_Prop)+COUNT(EXPORT_DS));
// -------------------------------------------------------------------------------------
dateString 		:= PRTE2_Common.Constants.TodayString;
desprayName 	:= 'PropertyInfo_2_MLS_RemoveValues_'+dateString+'.csv';
lzFilePathFile	:= PRTE2_PropertyInfo_Ins_PreMLS.Constants.SourcePathForPIICSV + desprayName;
LandingZoneIP 	:= PRTE2_PropertyInfo_Ins_PreMLS.Constants.LandingZoneIP;
TempCSV			:= PRTE2_PropertyInfo_Ins_PreMLS.Files.Alpha_Spray_Name;

PRTE2_Common.DesprayCSV(EXPORT_DS, TempCSV, LandingZoneIP, lzFilePathFile);

Files := PRTE2_PropertyInfo_Ins_MLS.Files;
NewDataDS := DISTRIBUTE(EXPORT_DS,HASH(fares_unformatted_apn,property_rid));
buildPIIBase := PRTE2_Common.Promote_Supers.mac_SFBuildProcess(NewDataDS, Files.PII_ALPHA_BASE_SF);
SEQUENTIAL(buildPIIBase);