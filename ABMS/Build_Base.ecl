IMPORT tools;

EXPORT Build_Base(
	STRING																	pversion,
	DATASET(Layouts.Base.Main)							pBaseMainFile								=	Files().Base.Main.QA,
	DATASET(Layouts.Base.Career)						pBaseCareerFile							=	Files().Base.Career.QA,
	DATASET(Layouts.Base.Cert)							pBaseCertFile								=	Files().Base.Cert.QA,
	DATASET(Layouts.Base.Education)					pBaseEducationFile					=	Files().Base.Education.QA,
	DATASET(Layouts.Base.Membership)				pBaseMembershipFile					=	Files().Base.Membership.QA,
	DATASET(Layouts.Base.TypeOfPractice)		pBaseTypeOfPracticeFile			=	Files().Base.TypeOfPractice.QA,
	DATASET(Layouts.Input.BIOG)							pUpdateBIOGFile							=	Files().Input.BIOG.Sprayed,
	DATASET(Layouts.Input.Address)					pUpdateAddressFile					=	Files().Input.Address.Sprayed,
	DATASET(Layouts.Input.Contact)					pUpdateContactFile					=	Files().Input.Contact.Sprayed,
	DATASET(Layouts.Input.Deceased)					pUpdateDeceasedFile					=	Files().Input.Deceased.Sprayed,
	DATASET(Layouts.Input.MOCParticipation)	pUpdateMOCParticipationFile	=	Files().Input.MOCParticipation.Sprayed,
	DATASET(Layouts.Input.Career)						pUpdateCareerFile						=	Files().Input.Career.Sprayed,
	DATASET(Layouts.Input.Cert)							pUpdateCertFile							=	Files().Input.Cert.Sprayed,
	DATASET(Layouts.Input.Education)				pUpdateEducationFile				=	Files().Input.Education.Sprayed,
	DATASET(Layouts.Input.Membership)				pUpdateMembershipFile				=	Files().Input.Membership.Sprayed,
	DATASET(Layouts.Input.TypeOfPractice)		pUpdateTypeOfPracticeFile		=	Files().Input.TypeOfPractice.Sprayed,
	DATASET(Layouts.Input.Schools)					pUpdateSchoolsFile					=	Files().Input.Schools.Sprayed) := MODULE

	EXPORT All := IF(tools.fun_IsValidVersion(pversion),
									 SEQUENTIAL(PARALLEL(Build_Base_Main(pversion,
																											 pBaseMainFile,
																											 pUpdateBIOGFile,
																											 pUpdateAddressFile,
																											 pUpdateContactFile,
																											 pUpdateDeceasedFile,
																											 pUpdateMOCParticipationFile).All,
																			 Build_Base_Career(pversion,
																												 pBaseCareerFile,
																												 pUpdateCareerFile).All,
																			 Build_Base_Cert(pversion,
																											 pBaseCertFile,
																											 pUpdateCertFile).All,
																			 Build_Base_Education(pversion,
																											      pBaseEducationFile,
																											      pUpdateEducationFile,
																														pUpdateSchoolsFile).All,
																			 Build_Base_Membership(pversion,
																											       pBaseMembershipFile,
																											       pUpdateMembershipFile).All,
																			 Build_Base_TypeOfPractice(pversion,
																											           pBaseTypeOfPracticeFile,
																											           pUpdateTypeOfPracticeFile).All),
															Promote().Inputfiles.Sprayed2Using
									 ),
									 OUTPUT('No Valid version parameter passed, skipping ABMS.Build_Base atribute'));

END;