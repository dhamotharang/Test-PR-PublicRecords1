import BIPV2;
dbase35 := BIPV2_ProxID.files().base.qa(proxid in [5705425,5532372]) : global;
setdots := set(dbase35,dotid);
dbase34 := BIPV2_ProxID.files(BIPV2.KeySuffix + '_34').base.logical(dotid in setdots) : global;
dbase33 := BIPV2_ProxID.files(BIPV2.KeySuffix + '_33').base.logical(dotid in setdots) : global;
dagg    := BIPV2_ProxID.AggregateProxidElements(dbase35);
dagg_34 := BIPV2_ProxID.AggregateProxidElements(dbase34);
dagg_33 := BIPV2_ProxID.AggregateProxidElements(dbase33);
daddrs := table(dbase35,{prim_range, prim_name, st,unsigned8 cnt := count(group)},prim_range, prim_name, st,few);
djoin := join(dbase35,daddrs,left.prim_range = right.prim_range and left.prim_name = right.prim_name and left.st = right.st,transform(left),lookup);
dagg_join := BIPV2_ProxID.AggregateProxidElements(djoin);
output(dagg   ,named('dagg'  ),all);
output(dagg_34,named('dagg_34'),all);
output(dagg_33,named('dagg_33'),all);
output(dbase35 ,named('dbase35'),all);
output(dbase34 ,named('dbase34'),all);
output(dbase33 ,named('dbase33'),all);
output(daddrs ,named('daddrs'),all);
output(count(djoin) ,named('countdjoin'),all);
output(djoin        ,named('djoin'));
output(count(dagg_join)    ,named('countdagg_join'));
output(choosen(dagg_join,300)    ,named('dagg_join'),all);
