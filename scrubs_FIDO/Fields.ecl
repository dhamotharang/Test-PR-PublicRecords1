IMPORT ut,SALT30;
EXPORT Fields := MODULE
EXPORT SALT30.StrType FieldName(UNSIGNED2 i) := CHOOSE(i,'customer_account_sk','platform_cd','hh_id','hh_name','current_subaccount_id','hist_subaccount_id','subaccount_name','mbs_gc_id','mbs_reseller_parent_gc_id','mbs_reseller_parent_company_id','mbs_company_id','mbs_billing_id','mbs_product_id','mbs_sub_product_id','vc_id','ins_account','ins_account_suffix','dyt_sub_acct_id','ins_control_nbr','ins_control_name','ins_company_nbr','ins_company_name','dyt_account_id','dyt_account_name','dyt_customer_name','mbs_reseller_parent_name','cancel_reason','internal_flag','dummy_subaccount_flag','primary_market_gen_1','primary_market_cd','primary_market_desc','secondary_market_cd','secondary_market_desc','Sub_market','sub_market_gen_1','sub_market_gen_2','segment_lead','subaccount_status','acc_application_type','acc_company_type','bussrv_crd_customer','integrator','migration_type','aba_flag','acquisition_tracking','acquisition_tracking_Gen01','acquisition_tracking_Gen02','acquisition_tracking_Gen03','new_subaccount_year','new_subaccount_year_month','new_hh_year','new_hh_year_month','subaccount_attrition_year','subaccount_attrition_year_month','hh_attrition_year','hh_attrition_year_month','bussrv_r12m_tier_cd','bussrv_r12m_tier_desc','bussrv_r12m_tier_gen_1','bussrv_r12m_tier_gen_2','bussrv_py_tier_cd','bussrv_py_tier_desc','bussrv_py_tier_gen_1','bussrv_py_tier_gen_2','govt_cy_tier','cy_vertical_sk','py_vertical_sk','current_primary_territory_sk','current_secondary_territory_sk','ins_business_line','ins_market_code','ins_platform_type','mvr_alt1_gen01','mvr_alt1_gen02','mvr_alt1_gen03','mvr_alt1_gen04','mvr_rate_type','legal_entity_id','legal_entity_code','legal_entity_name','currency_id','currency_code','lang_code','lang_name','country','country_gen3','country_gen2','country_gen1','country_tier','PMK_Customer_Product','use_case','market_segment');
EXPORT FieldNum(SALT30.StrType fn) := CASE(fn,'customer_account_sk' => 1,'platform_cd' => 2,'hh_id' => 3,'hh_name' => 4,'current_subaccount_id' => 5,'hist_subaccount_id' => 6,'subaccount_name' => 7,'mbs_gc_id' => 8,'mbs_reseller_parent_gc_id' => 9,'mbs_reseller_parent_company_id' => 10,'mbs_company_id' => 11,'mbs_billing_id' => 12,'mbs_product_id' => 13,'mbs_sub_product_id' => 14,'vc_id' => 15,'ins_account' => 16,'ins_account_suffix' => 17,'dyt_sub_acct_id' => 18,'ins_control_nbr' => 19,'ins_control_name' => 20,'ins_company_nbr' => 21,'ins_company_name' => 22,'dyt_account_id' => 23,'dyt_account_name' => 24,'dyt_customer_name' => 25,'mbs_reseller_parent_name' => 26,'cancel_reason' => 27,'internal_flag' => 28,'dummy_subaccount_flag' => 29,'primary_market_gen_1' => 30,'primary_market_cd' => 31,'primary_market_desc' => 32,'secondary_market_cd' => 33,'secondary_market_desc' => 34,'Sub_market' => 35,'sub_market_gen_1' => 36,'sub_market_gen_2' => 37,'segment_lead' => 38,'subaccount_status' => 39,'acc_application_type' => 40,'acc_company_type' => 41,'bussrv_crd_customer' => 42,'integrator' => 43,'migration_type' => 44,'aba_flag' => 45,'acquisition_tracking' => 46,'acquisition_tracking_Gen01' => 47,'acquisition_tracking_Gen02' => 48,'acquisition_tracking_Gen03' => 49,'new_subaccount_year' => 50,'new_subaccount_year_month' => 51,'new_hh_year' => 52,'new_hh_year_month' => 53,'subaccount_attrition_year' => 54,'subaccount_attrition_year_month' => 55,'hh_attrition_year' => 56,'hh_attrition_year_month' => 57,'bussrv_r12m_tier_cd' => 58,'bussrv_r12m_tier_desc' => 59,'bussrv_r12m_tier_gen_1' => 60,'bussrv_r12m_tier_gen_2' => 61,'bussrv_py_tier_cd' => 62,'bussrv_py_tier_desc' => 63,'bussrv_py_tier_gen_1' => 64,'bussrv_py_tier_gen_2' => 65,'govt_cy_tier' => 66,'cy_vertical_sk' => 67,'py_vertical_sk' => 68,'current_primary_territory_sk' => 69,'current_secondary_territory_sk' => 70,'ins_business_line' => 71,'ins_market_code' => 72,'ins_platform_type' => 73,'mvr_alt1_gen01' => 74,'mvr_alt1_gen02' => 75,'mvr_alt1_gen03' => 76,'mvr_alt1_gen04' => 77,'mvr_rate_type' => 78,'legal_entity_id' => 79,'legal_entity_code' => 80,'legal_entity_name' => 81,'currency_id' => 82,'currency_code' => 83,'lang_code' => 84,'lang_name' => 85,'country' => 86,'country_gen3' => 87,'country_gen2' => 88,'country_gen1' => 89,'country_tier' => 90,'PMK_Customer_Product' => 91,'use_case' => 92,'market_segment' => 93,0);
//Individual field level validation
EXPORT Make_customer_account_sk(SALT30.StrType s0) := s0;
EXPORT InValid_customer_account_sk(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_customer_account_sk(UNSIGNED1 wh) := '';
EXPORT Make_platform_cd(SALT30.StrType s0) := s0;
EXPORT InValid_platform_cd(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_platform_cd(UNSIGNED1 wh) := '';
EXPORT Make_hh_id(SALT30.StrType s0) := s0;
EXPORT InValid_hh_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_hh_id(UNSIGNED1 wh) := '';
EXPORT Make_hh_name(SALT30.StrType s0) := s0;
EXPORT InValid_hh_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_hh_name(UNSIGNED1 wh) := '';
EXPORT Make_current_subaccount_id(SALT30.StrType s0) := s0;
EXPORT InValid_current_subaccount_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_current_subaccount_id(UNSIGNED1 wh) := '';
EXPORT Make_hist_subaccount_id(SALT30.StrType s0) := s0;
EXPORT InValid_hist_subaccount_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_hist_subaccount_id(UNSIGNED1 wh) := '';
EXPORT Make_subaccount_name(SALT30.StrType s0) := s0;
EXPORT InValid_subaccount_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_subaccount_name(UNSIGNED1 wh) := '';
EXPORT Make_mbs_gc_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_gc_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_gc_id(UNSIGNED1 wh) := '';
EXPORT Make_mbs_reseller_parent_gc_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_reseller_parent_gc_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_reseller_parent_gc_id(UNSIGNED1 wh) := '';
EXPORT Make_mbs_reseller_parent_company_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_reseller_parent_company_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_reseller_parent_company_id(UNSIGNED1 wh) := '';
EXPORT Make_mbs_company_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_company_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_company_id(UNSIGNED1 wh) := '';
EXPORT Make_mbs_billing_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_billing_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_billing_id(UNSIGNED1 wh) := '';
EXPORT Make_mbs_product_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_product_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_product_id(UNSIGNED1 wh) := '';
EXPORT Make_mbs_sub_product_id(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_sub_product_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_sub_product_id(UNSIGNED1 wh) := '';
EXPORT Make_vc_id(SALT30.StrType s0) := s0;
EXPORT InValid_vc_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_vc_id(UNSIGNED1 wh) := '';
EXPORT Make_ins_account(SALT30.StrType s0) := s0;
EXPORT InValid_ins_account(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_account(UNSIGNED1 wh) := '';
EXPORT Make_ins_account_suffix(SALT30.StrType s0) := s0;
EXPORT InValid_ins_account_suffix(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_account_suffix(UNSIGNED1 wh) := '';
EXPORT Make_dyt_sub_acct_id(SALT30.StrType s0) := s0;
EXPORT InValid_dyt_sub_acct_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_dyt_sub_acct_id(UNSIGNED1 wh) := '';
EXPORT Make_ins_control_nbr(SALT30.StrType s0) := s0;
EXPORT InValid_ins_control_nbr(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_control_nbr(UNSIGNED1 wh) := '';
EXPORT Make_ins_control_name(SALT30.StrType s0) := s0;
EXPORT InValid_ins_control_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_control_name(UNSIGNED1 wh) := '';
EXPORT Make_ins_company_nbr(SALT30.StrType s0) := s0;
EXPORT InValid_ins_company_nbr(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_company_nbr(UNSIGNED1 wh) := '';
EXPORT Make_ins_company_name(SALT30.StrType s0) := s0;
EXPORT InValid_ins_company_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_company_name(UNSIGNED1 wh) := '';
EXPORT Make_dyt_account_id(SALT30.StrType s0) := s0;
EXPORT InValid_dyt_account_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_dyt_account_id(UNSIGNED1 wh) := '';
EXPORT Make_dyt_account_name(SALT30.StrType s0) := s0;
EXPORT InValid_dyt_account_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_dyt_account_name(UNSIGNED1 wh) := '';
EXPORT Make_dyt_customer_name(SALT30.StrType s0) := s0;
EXPORT InValid_dyt_customer_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_dyt_customer_name(UNSIGNED1 wh) := '';
EXPORT Make_mbs_reseller_parent_name(SALT30.StrType s0) := s0;
EXPORT InValid_mbs_reseller_parent_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mbs_reseller_parent_name(UNSIGNED1 wh) := '';
EXPORT Make_cancel_reason(SALT30.StrType s0) := s0;
EXPORT InValid_cancel_reason(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_cancel_reason(UNSIGNED1 wh) := '';
EXPORT Make_internal_flag(SALT30.StrType s0) := s0;
EXPORT InValid_internal_flag(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_internal_flag(UNSIGNED1 wh) := '';
EXPORT Make_dummy_subaccount_flag(SALT30.StrType s0) := s0;
EXPORT InValid_dummy_subaccount_flag(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_dummy_subaccount_flag(UNSIGNED1 wh) := '';
EXPORT Make_primary_market_gen_1(SALT30.StrType s0) := s0;
EXPORT InValid_primary_market_gen_1(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_primary_market_gen_1(UNSIGNED1 wh) := '';
EXPORT Make_primary_market_cd(SALT30.StrType s0) := s0;
EXPORT InValid_primary_market_cd(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_primary_market_cd(UNSIGNED1 wh) := '';
EXPORT Make_primary_market_desc(SALT30.StrType s0) := s0;
EXPORT InValid_primary_market_desc(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_primary_market_desc(UNSIGNED1 wh) := '';
EXPORT Make_secondary_market_cd(SALT30.StrType s0) := s0;
EXPORT InValid_secondary_market_cd(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_secondary_market_cd(UNSIGNED1 wh) := '';
EXPORT Make_secondary_market_desc(SALT30.StrType s0) := s0;
EXPORT InValid_secondary_market_desc(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_secondary_market_desc(UNSIGNED1 wh) := '';
EXPORT Make_Sub_market(SALT30.StrType s0) := s0;
EXPORT InValid_Sub_market(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_Sub_market(UNSIGNED1 wh) := '';
EXPORT Make_sub_market_gen_1(SALT30.StrType s0) := s0;
EXPORT InValid_sub_market_gen_1(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_sub_market_gen_1(UNSIGNED1 wh) := '';
EXPORT Make_sub_market_gen_2(SALT30.StrType s0) := s0;
EXPORT InValid_sub_market_gen_2(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_sub_market_gen_2(UNSIGNED1 wh) := '';
EXPORT Make_segment_lead(SALT30.StrType s0) := s0;
EXPORT InValid_segment_lead(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_segment_lead(UNSIGNED1 wh) := '';
EXPORT Make_subaccount_status(SALT30.StrType s0) := s0;
EXPORT InValid_subaccount_status(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_subaccount_status(UNSIGNED1 wh) := '';
EXPORT Make_acc_application_type(SALT30.StrType s0) := s0;
EXPORT InValid_acc_application_type(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_acc_application_type(UNSIGNED1 wh) := '';
EXPORT Make_acc_company_type(SALT30.StrType s0) := s0;
EXPORT InValid_acc_company_type(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_acc_company_type(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_crd_customer(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_crd_customer(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_crd_customer(UNSIGNED1 wh) := '';
EXPORT Make_integrator(SALT30.StrType s0) := s0;
EXPORT InValid_integrator(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_integrator(UNSIGNED1 wh) := '';
EXPORT Make_migration_type(SALT30.StrType s0) := s0;
EXPORT InValid_migration_type(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_migration_type(UNSIGNED1 wh) := '';
EXPORT Make_aba_flag(SALT30.StrType s0) := s0;
EXPORT InValid_aba_flag(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_aba_flag(UNSIGNED1 wh) := '';
EXPORT Make_acquisition_tracking(SALT30.StrType s0) := s0;
EXPORT InValid_acquisition_tracking(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_acquisition_tracking(UNSIGNED1 wh) := '';
EXPORT Make_acquisition_tracking_Gen01(SALT30.StrType s0) := s0;
EXPORT InValid_acquisition_tracking_Gen01(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_acquisition_tracking_Gen01(UNSIGNED1 wh) := '';
EXPORT Make_acquisition_tracking_Gen02(SALT30.StrType s0) := s0;
EXPORT InValid_acquisition_tracking_Gen02(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_acquisition_tracking_Gen02(UNSIGNED1 wh) := '';
EXPORT Make_acquisition_tracking_Gen03(SALT30.StrType s0) := s0;
EXPORT InValid_acquisition_tracking_Gen03(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_acquisition_tracking_Gen03(UNSIGNED1 wh) := '';
EXPORT Make_new_subaccount_year(SALT30.StrType s0) := s0;
EXPORT InValid_new_subaccount_year(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_new_subaccount_year(UNSIGNED1 wh) := '';
EXPORT Make_new_subaccount_year_month(SALT30.StrType s0) := s0;
EXPORT InValid_new_subaccount_year_month(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_new_subaccount_year_month(UNSIGNED1 wh) := '';
EXPORT Make_new_hh_year(SALT30.StrType s0) := s0;
EXPORT InValid_new_hh_year(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_new_hh_year(UNSIGNED1 wh) := '';
EXPORT Make_new_hh_year_month(SALT30.StrType s0) := s0;
EXPORT InValid_new_hh_year_month(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_new_hh_year_month(UNSIGNED1 wh) := '';
EXPORT Make_subaccount_attrition_year(SALT30.StrType s0) := s0;
EXPORT InValid_subaccount_attrition_year(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_subaccount_attrition_year(UNSIGNED1 wh) := '';
EXPORT Make_subaccount_attrition_year_month(SALT30.StrType s0) := s0;
EXPORT InValid_subaccount_attrition_year_month(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_subaccount_attrition_year_month(UNSIGNED1 wh) := '';
EXPORT Make_hh_attrition_year(SALT30.StrType s0) := s0;
EXPORT InValid_hh_attrition_year(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_hh_attrition_year(UNSIGNED1 wh) := '';
EXPORT Make_hh_attrition_year_month(SALT30.StrType s0) := s0;
EXPORT InValid_hh_attrition_year_month(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_hh_attrition_year_month(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_r12m_tier_cd(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_r12m_tier_cd(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_r12m_tier_cd(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_r12m_tier_desc(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_r12m_tier_desc(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_r12m_tier_desc(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_r12m_tier_gen_1(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_r12m_tier_gen_1(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_r12m_tier_gen_1(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_r12m_tier_gen_2(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_r12m_tier_gen_2(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_r12m_tier_gen_2(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_py_tier_cd(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_py_tier_cd(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_py_tier_cd(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_py_tier_desc(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_py_tier_desc(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_py_tier_desc(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_py_tier_gen_1(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_py_tier_gen_1(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_py_tier_gen_1(UNSIGNED1 wh) := '';
EXPORT Make_bussrv_py_tier_gen_2(SALT30.StrType s0) := s0;
EXPORT InValid_bussrv_py_tier_gen_2(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_bussrv_py_tier_gen_2(UNSIGNED1 wh) := '';
EXPORT Make_govt_cy_tier(SALT30.StrType s0) := s0;
EXPORT InValid_govt_cy_tier(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_govt_cy_tier(UNSIGNED1 wh) := '';
EXPORT Make_cy_vertical_sk(SALT30.StrType s0) := s0;
EXPORT InValid_cy_vertical_sk(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_cy_vertical_sk(UNSIGNED1 wh) := '';
EXPORT Make_py_vertical_sk(SALT30.StrType s0) := s0;
EXPORT InValid_py_vertical_sk(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_py_vertical_sk(UNSIGNED1 wh) := '';
EXPORT Make_current_primary_territory_sk(SALT30.StrType s0) := s0;
EXPORT InValid_current_primary_territory_sk(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_current_primary_territory_sk(UNSIGNED1 wh) := '';
EXPORT Make_current_secondary_territory_sk(SALT30.StrType s0) := s0;
EXPORT InValid_current_secondary_territory_sk(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_current_secondary_territory_sk(UNSIGNED1 wh) := '';
EXPORT Make_ins_business_line(SALT30.StrType s0) := s0;
EXPORT InValid_ins_business_line(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_business_line(UNSIGNED1 wh) := '';
EXPORT Make_ins_market_code(SALT30.StrType s0) := s0;
EXPORT InValid_ins_market_code(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_market_code(UNSIGNED1 wh) := '';
EXPORT Make_ins_platform_type(SALT30.StrType s0) := s0;
EXPORT InValid_ins_platform_type(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_ins_platform_type(UNSIGNED1 wh) := '';
EXPORT Make_mvr_alt1_gen01(SALT30.StrType s0) := s0;
EXPORT InValid_mvr_alt1_gen01(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mvr_alt1_gen01(UNSIGNED1 wh) := '';
EXPORT Make_mvr_alt1_gen02(SALT30.StrType s0) := s0;
EXPORT InValid_mvr_alt1_gen02(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mvr_alt1_gen02(UNSIGNED1 wh) := '';
EXPORT Make_mvr_alt1_gen03(SALT30.StrType s0) := s0;
EXPORT InValid_mvr_alt1_gen03(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mvr_alt1_gen03(UNSIGNED1 wh) := '';
EXPORT Make_mvr_alt1_gen04(SALT30.StrType s0) := s0;
EXPORT InValid_mvr_alt1_gen04(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mvr_alt1_gen04(UNSIGNED1 wh) := '';
EXPORT Make_mvr_rate_type(SALT30.StrType s0) := s0;
EXPORT InValid_mvr_rate_type(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_mvr_rate_type(UNSIGNED1 wh) := '';
EXPORT Make_legal_entity_id(SALT30.StrType s0) := s0;
EXPORT InValid_legal_entity_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_legal_entity_id(UNSIGNED1 wh) := '';
EXPORT Make_legal_entity_code(SALT30.StrType s0) := s0;
EXPORT InValid_legal_entity_code(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_legal_entity_code(UNSIGNED1 wh) := '';
EXPORT Make_legal_entity_name(SALT30.StrType s0) := s0;
EXPORT InValid_legal_entity_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_legal_entity_name(UNSIGNED1 wh) := '';
EXPORT Make_currency_id(SALT30.StrType s0) := s0;
EXPORT InValid_currency_id(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_currency_id(UNSIGNED1 wh) := '';
EXPORT Make_currency_code(SALT30.StrType s0) := s0;
EXPORT InValid_currency_code(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_currency_code(UNSIGNED1 wh) := '';
EXPORT Make_lang_code(SALT30.StrType s0) := s0;
EXPORT InValid_lang_code(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_lang_code(UNSIGNED1 wh) := '';
EXPORT Make_lang_name(SALT30.StrType s0) := s0;
EXPORT InValid_lang_name(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_lang_name(UNSIGNED1 wh) := '';
EXPORT Make_country(SALT30.StrType s0) := s0;
EXPORT InValid_country(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_country(UNSIGNED1 wh) := '';
EXPORT Make_country_gen3(SALT30.StrType s0) := s0;
EXPORT InValid_country_gen3(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_country_gen3(UNSIGNED1 wh) := '';
EXPORT Make_country_gen2(SALT30.StrType s0) := s0;
EXPORT InValid_country_gen2(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_country_gen2(UNSIGNED1 wh) := '';
EXPORT Make_country_gen1(SALT30.StrType s0) := s0;
EXPORT InValid_country_gen1(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_country_gen1(UNSIGNED1 wh) := '';
EXPORT Make_country_tier(SALT30.StrType s0) := s0;
EXPORT InValid_country_tier(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_country_tier(UNSIGNED1 wh) := '';
EXPORT Make_PMK_Customer_Product(SALT30.StrType s0) := s0;
EXPORT InValid_PMK_Customer_Product(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_PMK_Customer_Product(UNSIGNED1 wh) := '';
EXPORT Make_use_case(SALT30.StrType s0) := s0;
EXPORT InValid_use_case(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_use_case(UNSIGNED1 wh) := '';
EXPORT Make_market_segment(SALT30.StrType s0) := s0;
EXPORT InValid_market_segment(SALT30.StrType s) := FALSE;
EXPORT InValidMessage_market_segment(UNSIGNED1 wh) := '';
// This macro will compute and count field level differences based upon a pivot expression
export MAC_CountDifferencesByPivot(in_left,in_right,pivot_exp,bad_pivots,out_counts) := MACRO
  IMPORT SALT30,scrubs_FIDO;
//Find those highly occuring pivot values to remove them from consideration
#uniquename(tr)
  %tr% := table(in_left+in_right,{ val := pivot_exp; });
#uniquename(r1)
  %r1% := record
    %tr%.val;    unsigned Cnt := COUNT(GROUP);
  end;
#uniquename(t1)
  %t1% := table(%tr%,%r1%,val,local); // Pre-aggregate before distribute
#uniquename(r2)
  %r2% := record
    %t1%.val;    unsigned Cnt := SUM(GROUP,%t1%.Cnt);
  end;
#uniquename(t2)
  %t2% := table(%t1%,%r2%,val); // Now do global aggregate
Bad_Pivots := %t2%(Cnt>100);
#uniquename(dl)
  %dl% := RECORD
    BOOLEAN Diff_customer_account_sk;
    BOOLEAN Diff_platform_cd;
    BOOLEAN Diff_hh_id;
    BOOLEAN Diff_hh_name;
    BOOLEAN Diff_current_subaccount_id;
    BOOLEAN Diff_hist_subaccount_id;
    BOOLEAN Diff_subaccount_name;
    BOOLEAN Diff_mbs_gc_id;
    BOOLEAN Diff_mbs_reseller_parent_gc_id;
    BOOLEAN Diff_mbs_reseller_parent_company_id;
    BOOLEAN Diff_mbs_company_id;
    BOOLEAN Diff_mbs_billing_id;
    BOOLEAN Diff_mbs_product_id;
    BOOLEAN Diff_mbs_sub_product_id;
    BOOLEAN Diff_vc_id;
    BOOLEAN Diff_ins_account;
    BOOLEAN Diff_ins_account_suffix;
    BOOLEAN Diff_dyt_sub_acct_id;
    BOOLEAN Diff_ins_control_nbr;
    BOOLEAN Diff_ins_control_name;
    BOOLEAN Diff_ins_company_nbr;
    BOOLEAN Diff_ins_company_name;
    BOOLEAN Diff_dyt_account_id;
    BOOLEAN Diff_dyt_account_name;
    BOOLEAN Diff_dyt_customer_name;
    BOOLEAN Diff_mbs_reseller_parent_name;
    BOOLEAN Diff_cancel_reason;
    BOOLEAN Diff_internal_flag;
    BOOLEAN Diff_dummy_subaccount_flag;
    BOOLEAN Diff_primary_market_gen_1;
    BOOLEAN Diff_primary_market_cd;
    BOOLEAN Diff_primary_market_desc;
    BOOLEAN Diff_secondary_market_cd;
    BOOLEAN Diff_secondary_market_desc;
    BOOLEAN Diff_Sub_market;
    BOOLEAN Diff_sub_market_gen_1;
    BOOLEAN Diff_sub_market_gen_2;
    BOOLEAN Diff_segment_lead;
    BOOLEAN Diff_subaccount_status;
    BOOLEAN Diff_acc_application_type;
    BOOLEAN Diff_acc_company_type;
    BOOLEAN Diff_bussrv_crd_customer;
    BOOLEAN Diff_integrator;
    BOOLEAN Diff_migration_type;
    BOOLEAN Diff_aba_flag;
    BOOLEAN Diff_acquisition_tracking;
    BOOLEAN Diff_acquisition_tracking_Gen01;
    BOOLEAN Diff_acquisition_tracking_Gen02;
    BOOLEAN Diff_acquisition_tracking_Gen03;
    BOOLEAN Diff_new_subaccount_year;
    BOOLEAN Diff_new_subaccount_year_month;
    BOOLEAN Diff_new_hh_year;
    BOOLEAN Diff_new_hh_year_month;
    BOOLEAN Diff_subaccount_attrition_year;
    BOOLEAN Diff_subaccount_attrition_year_month;
    BOOLEAN Diff_hh_attrition_year;
    BOOLEAN Diff_hh_attrition_year_month;
    BOOLEAN Diff_bussrv_r12m_tier_cd;
    BOOLEAN Diff_bussrv_r12m_tier_desc;
    BOOLEAN Diff_bussrv_r12m_tier_gen_1;
    BOOLEAN Diff_bussrv_r12m_tier_gen_2;
    BOOLEAN Diff_bussrv_py_tier_cd;
    BOOLEAN Diff_bussrv_py_tier_desc;
    BOOLEAN Diff_bussrv_py_tier_gen_1;
    BOOLEAN Diff_bussrv_py_tier_gen_2;
    BOOLEAN Diff_govt_cy_tier;
    BOOLEAN Diff_cy_vertical_sk;
    BOOLEAN Diff_py_vertical_sk;
    BOOLEAN Diff_current_primary_territory_sk;
    BOOLEAN Diff_current_secondary_territory_sk;
    BOOLEAN Diff_ins_business_line;
    BOOLEAN Diff_ins_market_code;
    BOOLEAN Diff_ins_platform_type;
    BOOLEAN Diff_mvr_alt1_gen01;
    BOOLEAN Diff_mvr_alt1_gen02;
    BOOLEAN Diff_mvr_alt1_gen03;
    BOOLEAN Diff_mvr_alt1_gen04;
    BOOLEAN Diff_mvr_rate_type;
    BOOLEAN Diff_legal_entity_id;
    BOOLEAN Diff_legal_entity_code;
    BOOLEAN Diff_legal_entity_name;
    BOOLEAN Diff_currency_id;
    BOOLEAN Diff_currency_code;
    BOOLEAN Diff_lang_code;
    BOOLEAN Diff_lang_name;
    BOOLEAN Diff_country;
    BOOLEAN Diff_country_gen3;
    BOOLEAN Diff_country_gen2;
    BOOLEAN Diff_country_gen1;
    BOOLEAN Diff_country_tier;
    BOOLEAN Diff_PMK_Customer_Product;
    BOOLEAN Diff_use_case;
    BOOLEAN Diff_market_segment;
    UNSIGNED Num_Diffs;
    SALT30.StrType Val {MAXLENGTH(1024)};
  END;
#uniquename(fd)
  %dl% %fd%(in_left le,in_right ri) := TRANSFORM
    SELF.Diff_customer_account_sk := le.customer_account_sk <> ri.customer_account_sk;
    SELF.Diff_platform_cd := le.platform_cd <> ri.platform_cd;
    SELF.Diff_hh_id := le.hh_id <> ri.hh_id;
    SELF.Diff_hh_name := le.hh_name <> ri.hh_name;
    SELF.Diff_current_subaccount_id := le.current_subaccount_id <> ri.current_subaccount_id;
    SELF.Diff_hist_subaccount_id := le.hist_subaccount_id <> ri.hist_subaccount_id;
    SELF.Diff_subaccount_name := le.subaccount_name <> ri.subaccount_name;
    SELF.Diff_mbs_gc_id := le.mbs_gc_id <> ri.mbs_gc_id;
    SELF.Diff_mbs_reseller_parent_gc_id := le.mbs_reseller_parent_gc_id <> ri.mbs_reseller_parent_gc_id;
    SELF.Diff_mbs_reseller_parent_company_id := le.mbs_reseller_parent_company_id <> ri.mbs_reseller_parent_company_id;
    SELF.Diff_mbs_company_id := le.mbs_company_id <> ri.mbs_company_id;
    SELF.Diff_mbs_billing_id := le.mbs_billing_id <> ri.mbs_billing_id;
    SELF.Diff_mbs_product_id := le.mbs_product_id <> ri.mbs_product_id;
    SELF.Diff_mbs_sub_product_id := le.mbs_sub_product_id <> ri.mbs_sub_product_id;
    SELF.Diff_vc_id := le.vc_id <> ri.vc_id;
    SELF.Diff_ins_account := le.ins_account <> ri.ins_account;
    SELF.Diff_ins_account_suffix := le.ins_account_suffix <> ri.ins_account_suffix;
    SELF.Diff_dyt_sub_acct_id := le.dyt_sub_acct_id <> ri.dyt_sub_acct_id;
    SELF.Diff_ins_control_nbr := le.ins_control_nbr <> ri.ins_control_nbr;
    SELF.Diff_ins_control_name := le.ins_control_name <> ri.ins_control_name;
    SELF.Diff_ins_company_nbr := le.ins_company_nbr <> ri.ins_company_nbr;
    SELF.Diff_ins_company_name := le.ins_company_name <> ri.ins_company_name;
    SELF.Diff_dyt_account_id := le.dyt_account_id <> ri.dyt_account_id;
    SELF.Diff_dyt_account_name := le.dyt_account_name <> ri.dyt_account_name;
    SELF.Diff_dyt_customer_name := le.dyt_customer_name <> ri.dyt_customer_name;
    SELF.Diff_mbs_reseller_parent_name := le.mbs_reseller_parent_name <> ri.mbs_reseller_parent_name;
    SELF.Diff_cancel_reason := le.cancel_reason <> ri.cancel_reason;
    SELF.Diff_internal_flag := le.internal_flag <> ri.internal_flag;
    SELF.Diff_dummy_subaccount_flag := le.dummy_subaccount_flag <> ri.dummy_subaccount_flag;
    SELF.Diff_primary_market_gen_1 := le.primary_market_gen_1 <> ri.primary_market_gen_1;
    SELF.Diff_primary_market_cd := le.primary_market_cd <> ri.primary_market_cd;
    SELF.Diff_primary_market_desc := le.primary_market_desc <> ri.primary_market_desc;
    SELF.Diff_secondary_market_cd := le.secondary_market_cd <> ri.secondary_market_cd;
    SELF.Diff_secondary_market_desc := le.secondary_market_desc <> ri.secondary_market_desc;
    SELF.Diff_Sub_market := le.Sub_market <> ri.Sub_market;
    SELF.Diff_sub_market_gen_1 := le.sub_market_gen_1 <> ri.sub_market_gen_1;
    SELF.Diff_sub_market_gen_2 := le.sub_market_gen_2 <> ri.sub_market_gen_2;
    SELF.Diff_segment_lead := le.segment_lead <> ri.segment_lead;
    SELF.Diff_subaccount_status := le.subaccount_status <> ri.subaccount_status;
    SELF.Diff_acc_application_type := le.acc_application_type <> ri.acc_application_type;
    SELF.Diff_acc_company_type := le.acc_company_type <> ri.acc_company_type;
    SELF.Diff_bussrv_crd_customer := le.bussrv_crd_customer <> ri.bussrv_crd_customer;
    SELF.Diff_integrator := le.integrator <> ri.integrator;
    SELF.Diff_migration_type := le.migration_type <> ri.migration_type;
    SELF.Diff_aba_flag := le.aba_flag <> ri.aba_flag;
    SELF.Diff_acquisition_tracking := le.acquisition_tracking <> ri.acquisition_tracking;
    SELF.Diff_acquisition_tracking_Gen01 := le.acquisition_tracking_Gen01 <> ri.acquisition_tracking_Gen01;
    SELF.Diff_acquisition_tracking_Gen02 := le.acquisition_tracking_Gen02 <> ri.acquisition_tracking_Gen02;
    SELF.Diff_acquisition_tracking_Gen03 := le.acquisition_tracking_Gen03 <> ri.acquisition_tracking_Gen03;
    SELF.Diff_new_subaccount_year := le.new_subaccount_year <> ri.new_subaccount_year;
    SELF.Diff_new_subaccount_year_month := le.new_subaccount_year_month <> ri.new_subaccount_year_month;
    SELF.Diff_new_hh_year := le.new_hh_year <> ri.new_hh_year;
    SELF.Diff_new_hh_year_month := le.new_hh_year_month <> ri.new_hh_year_month;
    SELF.Diff_subaccount_attrition_year := le.subaccount_attrition_year <> ri.subaccount_attrition_year;
    SELF.Diff_subaccount_attrition_year_month := le.subaccount_attrition_year_month <> ri.subaccount_attrition_year_month;
    SELF.Diff_hh_attrition_year := le.hh_attrition_year <> ri.hh_attrition_year;
    SELF.Diff_hh_attrition_year_month := le.hh_attrition_year_month <> ri.hh_attrition_year_month;
    SELF.Diff_bussrv_r12m_tier_cd := le.bussrv_r12m_tier_cd <> ri.bussrv_r12m_tier_cd;
    SELF.Diff_bussrv_r12m_tier_desc := le.bussrv_r12m_tier_desc <> ri.bussrv_r12m_tier_desc;
    SELF.Diff_bussrv_r12m_tier_gen_1 := le.bussrv_r12m_tier_gen_1 <> ri.bussrv_r12m_tier_gen_1;
    SELF.Diff_bussrv_r12m_tier_gen_2 := le.bussrv_r12m_tier_gen_2 <> ri.bussrv_r12m_tier_gen_2;
    SELF.Diff_bussrv_py_tier_cd := le.bussrv_py_tier_cd <> ri.bussrv_py_tier_cd;
    SELF.Diff_bussrv_py_tier_desc := le.bussrv_py_tier_desc <> ri.bussrv_py_tier_desc;
    SELF.Diff_bussrv_py_tier_gen_1 := le.bussrv_py_tier_gen_1 <> ri.bussrv_py_tier_gen_1;
    SELF.Diff_bussrv_py_tier_gen_2 := le.bussrv_py_tier_gen_2 <> ri.bussrv_py_tier_gen_2;
    SELF.Diff_govt_cy_tier := le.govt_cy_tier <> ri.govt_cy_tier;
    SELF.Diff_cy_vertical_sk := le.cy_vertical_sk <> ri.cy_vertical_sk;
    SELF.Diff_py_vertical_sk := le.py_vertical_sk <> ri.py_vertical_sk;
    SELF.Diff_current_primary_territory_sk := le.current_primary_territory_sk <> ri.current_primary_territory_sk;
    SELF.Diff_current_secondary_territory_sk := le.current_secondary_territory_sk <> ri.current_secondary_territory_sk;
    SELF.Diff_ins_business_line := le.ins_business_line <> ri.ins_business_line;
    SELF.Diff_ins_market_code := le.ins_market_code <> ri.ins_market_code;
    SELF.Diff_ins_platform_type := le.ins_platform_type <> ri.ins_platform_type;
    SELF.Diff_mvr_alt1_gen01 := le.mvr_alt1_gen01 <> ri.mvr_alt1_gen01;
    SELF.Diff_mvr_alt1_gen02 := le.mvr_alt1_gen02 <> ri.mvr_alt1_gen02;
    SELF.Diff_mvr_alt1_gen03 := le.mvr_alt1_gen03 <> ri.mvr_alt1_gen03;
    SELF.Diff_mvr_alt1_gen04 := le.mvr_alt1_gen04 <> ri.mvr_alt1_gen04;
    SELF.Diff_mvr_rate_type := le.mvr_rate_type <> ri.mvr_rate_type;
    SELF.Diff_legal_entity_id := le.legal_entity_id <> ri.legal_entity_id;
    SELF.Diff_legal_entity_code := le.legal_entity_code <> ri.legal_entity_code;
    SELF.Diff_legal_entity_name := le.legal_entity_name <> ri.legal_entity_name;
    SELF.Diff_currency_id := le.currency_id <> ri.currency_id;
    SELF.Diff_currency_code := le.currency_code <> ri.currency_code;
    SELF.Diff_lang_code := le.lang_code <> ri.lang_code;
    SELF.Diff_lang_name := le.lang_name <> ri.lang_name;
    SELF.Diff_country := le.country <> ri.country;
    SELF.Diff_country_gen3 := le.country_gen3 <> ri.country_gen3;
    SELF.Diff_country_gen2 := le.country_gen2 <> ri.country_gen2;
    SELF.Diff_country_gen1 := le.country_gen1 <> ri.country_gen1;
    SELF.Diff_country_tier := le.country_tier <> ri.country_tier;
    SELF.Diff_PMK_Customer_Product := le.PMK_Customer_Product <> ri.PMK_Customer_Product;
    SELF.Diff_use_case := le.use_case <> ri.use_case;
    SELF.Diff_market_segment := le.market_segment <> ri.market_segment;
    SELF.Val := (SALT30.StrType)evaluate(le,pivot_exp);
    SELF.Num_Diffs := 0+ IF( SELF.Diff_customer_account_sk,1,0)+ IF( SELF.Diff_platform_cd,1,0)+ IF( SELF.Diff_hh_id,1,0)+ IF( SELF.Diff_hh_name,1,0)+ IF( SELF.Diff_current_subaccount_id,1,0)+ IF( SELF.Diff_hist_subaccount_id,1,0)+ IF( SELF.Diff_subaccount_name,1,0)+ IF( SELF.Diff_mbs_gc_id,1,0)+ IF( SELF.Diff_mbs_reseller_parent_gc_id,1,0)+ IF( SELF.Diff_mbs_reseller_parent_company_id,1,0)+ IF( SELF.Diff_mbs_company_id,1,0)+ IF( SELF.Diff_mbs_billing_id,1,0)+ IF( SELF.Diff_mbs_product_id,1,0)+ IF( SELF.Diff_mbs_sub_product_id,1,0)+ IF( SELF.Diff_vc_id,1,0)+ IF( SELF.Diff_ins_account,1,0)+ IF( SELF.Diff_ins_account_suffix,1,0)+ IF( SELF.Diff_dyt_sub_acct_id,1,0)+ IF( SELF.Diff_ins_control_nbr,1,0)+ IF( SELF.Diff_ins_control_name,1,0)+ IF( SELF.Diff_ins_company_nbr,1,0)+ IF( SELF.Diff_ins_company_name,1,0)+ IF( SELF.Diff_dyt_account_id,1,0)+ IF( SELF.Diff_dyt_account_name,1,0)+ IF( SELF.Diff_dyt_customer_name,1,0)+ IF( SELF.Diff_mbs_reseller_parent_name,1,0)+ IF( SELF.Diff_cancel_reason,1,0)+ IF( SELF.Diff_internal_flag,1,0)+ IF( SELF.Diff_dummy_subaccount_flag,1,0)+ IF( SELF.Diff_primary_market_gen_1,1,0)+ IF( SELF.Diff_primary_market_cd,1,0)+ IF( SELF.Diff_primary_market_desc,1,0)+ IF( SELF.Diff_secondary_market_cd,1,0)+ IF( SELF.Diff_secondary_market_desc,1,0)+ IF( SELF.Diff_Sub_market,1,0)+ IF( SELF.Diff_sub_market_gen_1,1,0)+ IF( SELF.Diff_sub_market_gen_2,1,0)+ IF( SELF.Diff_segment_lead,1,0)+ IF( SELF.Diff_subaccount_status,1,0)+ IF( SELF.Diff_acc_application_type,1,0)+ IF( SELF.Diff_acc_company_type,1,0)+ IF( SELF.Diff_bussrv_crd_customer,1,0)+ IF( SELF.Diff_integrator,1,0)+ IF( SELF.Diff_migration_type,1,0)+ IF( SELF.Diff_aba_flag,1,0)+ IF( SELF.Diff_acquisition_tracking,1,0)+ IF( SELF.Diff_acquisition_tracking_Gen01,1,0)+ IF( SELF.Diff_acquisition_tracking_Gen02,1,0)+ IF( SELF.Diff_acquisition_tracking_Gen03,1,0)+ IF( SELF.Diff_new_subaccount_year,1,0)+ IF( SELF.Diff_new_subaccount_year_month,1,0)+ IF( SELF.Diff_new_hh_year,1,0)+ IF( SELF.Diff_new_hh_year_month,1,0)+ IF( SELF.Diff_subaccount_attrition_year,1,0)+ IF( SELF.Diff_subaccount_attrition_year_month,1,0)+ IF( SELF.Diff_hh_attrition_year,1,0)+ IF( SELF.Diff_hh_attrition_year_month,1,0)+ IF( SELF.Diff_bussrv_r12m_tier_cd,1,0)+ IF( SELF.Diff_bussrv_r12m_tier_desc,1,0)+ IF( SELF.Diff_bussrv_r12m_tier_gen_1,1,0)+ IF( SELF.Diff_bussrv_r12m_tier_gen_2,1,0)+ IF( SELF.Diff_bussrv_py_tier_cd,1,0)+ IF( SELF.Diff_bussrv_py_tier_desc,1,0)+ IF( SELF.Diff_bussrv_py_tier_gen_1,1,0)+ IF( SELF.Diff_bussrv_py_tier_gen_2,1,0)+ IF( SELF.Diff_govt_cy_tier,1,0)+ IF( SELF.Diff_cy_vertical_sk,1,0)+ IF( SELF.Diff_py_vertical_sk,1,0)+ IF( SELF.Diff_current_primary_territory_sk,1,0)+ IF( SELF.Diff_current_secondary_territory_sk,1,0)+ IF( SELF.Diff_ins_business_line,1,0)+ IF( SELF.Diff_ins_market_code,1,0)+ IF( SELF.Diff_ins_platform_type,1,0)+ IF( SELF.Diff_mvr_alt1_gen01,1,0)+ IF( SELF.Diff_mvr_alt1_gen02,1,0)+ IF( SELF.Diff_mvr_alt1_gen03,1,0)+ IF( SELF.Diff_mvr_alt1_gen04,1,0)+ IF( SELF.Diff_mvr_rate_type,1,0)+ IF( SELF.Diff_legal_entity_id,1,0)+ IF( SELF.Diff_legal_entity_code,1,0)+ IF( SELF.Diff_legal_entity_name,1,0)+ IF( SELF.Diff_currency_id,1,0)+ IF( SELF.Diff_currency_code,1,0)+ IF( SELF.Diff_lang_code,1,0)+ IF( SELF.Diff_lang_name,1,0)+ IF( SELF.Diff_country,1,0)+ IF( SELF.Diff_country_gen3,1,0)+ IF( SELF.Diff_country_gen2,1,0)+ IF( SELF.Diff_country_gen1,1,0)+ IF( SELF.Diff_country_tier,1,0)+ IF( SELF.Diff_PMK_Customer_Product,1,0)+ IF( SELF.Diff_use_case,1,0)+ IF( SELF.Diff_market_segment,1,0);
  END;
// Now need to remove bad pivots from comparison
#uniquename(L)
  %L% := JOIN(in_left,bad_pivots,evaluate(LEFT,pivot_exp)=right.val,transform(left),left only,lookup);
#uniquename(R)
  %R% := JOIN(in_right,bad_pivots,evaluate(LEFT,pivot_exp)=right.val,transform(left),left only,lookup);
#uniquename(DiffL)
  %DiffL% := JOIN(%L%,%R%,evaluate(left,pivot_exp)=evaluate(right,pivot_exp),%fd%(left,right),hash);
#uniquename(Closest)
  %Closest% := DEDUP(SORT(%DiffL%,Val,Num_Diffs,local),Val,local); // Join will have distributed by pivot_exp
#uniquename(AggRec)
  %AggRec% := RECORD
    Count_Diff_customer_account_sk := COUNT(GROUP,%Closest%.Diff_customer_account_sk);
    Count_Diff_platform_cd := COUNT(GROUP,%Closest%.Diff_platform_cd);
    Count_Diff_hh_id := COUNT(GROUP,%Closest%.Diff_hh_id);
    Count_Diff_hh_name := COUNT(GROUP,%Closest%.Diff_hh_name);
    Count_Diff_current_subaccount_id := COUNT(GROUP,%Closest%.Diff_current_subaccount_id);
    Count_Diff_hist_subaccount_id := COUNT(GROUP,%Closest%.Diff_hist_subaccount_id);
    Count_Diff_subaccount_name := COUNT(GROUP,%Closest%.Diff_subaccount_name);
    Count_Diff_mbs_gc_id := COUNT(GROUP,%Closest%.Diff_mbs_gc_id);
    Count_Diff_mbs_reseller_parent_gc_id := COUNT(GROUP,%Closest%.Diff_mbs_reseller_parent_gc_id);
    Count_Diff_mbs_reseller_parent_company_id := COUNT(GROUP,%Closest%.Diff_mbs_reseller_parent_company_id);
    Count_Diff_mbs_company_id := COUNT(GROUP,%Closest%.Diff_mbs_company_id);
    Count_Diff_mbs_billing_id := COUNT(GROUP,%Closest%.Diff_mbs_billing_id);
    Count_Diff_mbs_product_id := COUNT(GROUP,%Closest%.Diff_mbs_product_id);
    Count_Diff_mbs_sub_product_id := COUNT(GROUP,%Closest%.Diff_mbs_sub_product_id);
    Count_Diff_vc_id := COUNT(GROUP,%Closest%.Diff_vc_id);
    Count_Diff_ins_account := COUNT(GROUP,%Closest%.Diff_ins_account);
    Count_Diff_ins_account_suffix := COUNT(GROUP,%Closest%.Diff_ins_account_suffix);
    Count_Diff_dyt_sub_acct_id := COUNT(GROUP,%Closest%.Diff_dyt_sub_acct_id);
    Count_Diff_ins_control_nbr := COUNT(GROUP,%Closest%.Diff_ins_control_nbr);
    Count_Diff_ins_control_name := COUNT(GROUP,%Closest%.Diff_ins_control_name);
    Count_Diff_ins_company_nbr := COUNT(GROUP,%Closest%.Diff_ins_company_nbr);
    Count_Diff_ins_company_name := COUNT(GROUP,%Closest%.Diff_ins_company_name);
    Count_Diff_dyt_account_id := COUNT(GROUP,%Closest%.Diff_dyt_account_id);
    Count_Diff_dyt_account_name := COUNT(GROUP,%Closest%.Diff_dyt_account_name);
    Count_Diff_dyt_customer_name := COUNT(GROUP,%Closest%.Diff_dyt_customer_name);
    Count_Diff_mbs_reseller_parent_name := COUNT(GROUP,%Closest%.Diff_mbs_reseller_parent_name);
    Count_Diff_cancel_reason := COUNT(GROUP,%Closest%.Diff_cancel_reason);
    Count_Diff_internal_flag := COUNT(GROUP,%Closest%.Diff_internal_flag);
    Count_Diff_dummy_subaccount_flag := COUNT(GROUP,%Closest%.Diff_dummy_subaccount_flag);
    Count_Diff_primary_market_gen_1 := COUNT(GROUP,%Closest%.Diff_primary_market_gen_1);
    Count_Diff_primary_market_cd := COUNT(GROUP,%Closest%.Diff_primary_market_cd);
    Count_Diff_primary_market_desc := COUNT(GROUP,%Closest%.Diff_primary_market_desc);
    Count_Diff_secondary_market_cd := COUNT(GROUP,%Closest%.Diff_secondary_market_cd);
    Count_Diff_secondary_market_desc := COUNT(GROUP,%Closest%.Diff_secondary_market_desc);
    Count_Diff_Sub_market := COUNT(GROUP,%Closest%.Diff_Sub_market);
    Count_Diff_sub_market_gen_1 := COUNT(GROUP,%Closest%.Diff_sub_market_gen_1);
    Count_Diff_sub_market_gen_2 := COUNT(GROUP,%Closest%.Diff_sub_market_gen_2);
    Count_Diff_segment_lead := COUNT(GROUP,%Closest%.Diff_segment_lead);
    Count_Diff_subaccount_status := COUNT(GROUP,%Closest%.Diff_subaccount_status);
    Count_Diff_acc_application_type := COUNT(GROUP,%Closest%.Diff_acc_application_type);
    Count_Diff_acc_company_type := COUNT(GROUP,%Closest%.Diff_acc_company_type);
    Count_Diff_bussrv_crd_customer := COUNT(GROUP,%Closest%.Diff_bussrv_crd_customer);
    Count_Diff_integrator := COUNT(GROUP,%Closest%.Diff_integrator);
    Count_Diff_migration_type := COUNT(GROUP,%Closest%.Diff_migration_type);
    Count_Diff_aba_flag := COUNT(GROUP,%Closest%.Diff_aba_flag);
    Count_Diff_acquisition_tracking := COUNT(GROUP,%Closest%.Diff_acquisition_tracking);
    Count_Diff_acquisition_tracking_Gen01 := COUNT(GROUP,%Closest%.Diff_acquisition_tracking_Gen01);
    Count_Diff_acquisition_tracking_Gen02 := COUNT(GROUP,%Closest%.Diff_acquisition_tracking_Gen02);
    Count_Diff_acquisition_tracking_Gen03 := COUNT(GROUP,%Closest%.Diff_acquisition_tracking_Gen03);
    Count_Diff_new_subaccount_year := COUNT(GROUP,%Closest%.Diff_new_subaccount_year);
    Count_Diff_new_subaccount_year_month := COUNT(GROUP,%Closest%.Diff_new_subaccount_year_month);
    Count_Diff_new_hh_year := COUNT(GROUP,%Closest%.Diff_new_hh_year);
    Count_Diff_new_hh_year_month := COUNT(GROUP,%Closest%.Diff_new_hh_year_month);
    Count_Diff_subaccount_attrition_year := COUNT(GROUP,%Closest%.Diff_subaccount_attrition_year);
    Count_Diff_subaccount_attrition_year_month := COUNT(GROUP,%Closest%.Diff_subaccount_attrition_year_month);
    Count_Diff_hh_attrition_year := COUNT(GROUP,%Closest%.Diff_hh_attrition_year);
    Count_Diff_hh_attrition_year_month := COUNT(GROUP,%Closest%.Diff_hh_attrition_year_month);
    Count_Diff_bussrv_r12m_tier_cd := COUNT(GROUP,%Closest%.Diff_bussrv_r12m_tier_cd);
    Count_Diff_bussrv_r12m_tier_desc := COUNT(GROUP,%Closest%.Diff_bussrv_r12m_tier_desc);
    Count_Diff_bussrv_r12m_tier_gen_1 := COUNT(GROUP,%Closest%.Diff_bussrv_r12m_tier_gen_1);
    Count_Diff_bussrv_r12m_tier_gen_2 := COUNT(GROUP,%Closest%.Diff_bussrv_r12m_tier_gen_2);
    Count_Diff_bussrv_py_tier_cd := COUNT(GROUP,%Closest%.Diff_bussrv_py_tier_cd);
    Count_Diff_bussrv_py_tier_desc := COUNT(GROUP,%Closest%.Diff_bussrv_py_tier_desc);
    Count_Diff_bussrv_py_tier_gen_1 := COUNT(GROUP,%Closest%.Diff_bussrv_py_tier_gen_1);
    Count_Diff_bussrv_py_tier_gen_2 := COUNT(GROUP,%Closest%.Diff_bussrv_py_tier_gen_2);
    Count_Diff_govt_cy_tier := COUNT(GROUP,%Closest%.Diff_govt_cy_tier);
    Count_Diff_cy_vertical_sk := COUNT(GROUP,%Closest%.Diff_cy_vertical_sk);
    Count_Diff_py_vertical_sk := COUNT(GROUP,%Closest%.Diff_py_vertical_sk);
    Count_Diff_current_primary_territory_sk := COUNT(GROUP,%Closest%.Diff_current_primary_territory_sk);
    Count_Diff_current_secondary_territory_sk := COUNT(GROUP,%Closest%.Diff_current_secondary_territory_sk);
    Count_Diff_ins_business_line := COUNT(GROUP,%Closest%.Diff_ins_business_line);
    Count_Diff_ins_market_code := COUNT(GROUP,%Closest%.Diff_ins_market_code);
    Count_Diff_ins_platform_type := COUNT(GROUP,%Closest%.Diff_ins_platform_type);
    Count_Diff_mvr_alt1_gen01 := COUNT(GROUP,%Closest%.Diff_mvr_alt1_gen01);
    Count_Diff_mvr_alt1_gen02 := COUNT(GROUP,%Closest%.Diff_mvr_alt1_gen02);
    Count_Diff_mvr_alt1_gen03 := COUNT(GROUP,%Closest%.Diff_mvr_alt1_gen03);
    Count_Diff_mvr_alt1_gen04 := COUNT(GROUP,%Closest%.Diff_mvr_alt1_gen04);
    Count_Diff_mvr_rate_type := COUNT(GROUP,%Closest%.Diff_mvr_rate_type);
    Count_Diff_legal_entity_id := COUNT(GROUP,%Closest%.Diff_legal_entity_id);
    Count_Diff_legal_entity_code := COUNT(GROUP,%Closest%.Diff_legal_entity_code);
    Count_Diff_legal_entity_name := COUNT(GROUP,%Closest%.Diff_legal_entity_name);
    Count_Diff_currency_id := COUNT(GROUP,%Closest%.Diff_currency_id);
    Count_Diff_currency_code := COUNT(GROUP,%Closest%.Diff_currency_code);
    Count_Diff_lang_code := COUNT(GROUP,%Closest%.Diff_lang_code);
    Count_Diff_lang_name := COUNT(GROUP,%Closest%.Diff_lang_name);
    Count_Diff_country := COUNT(GROUP,%Closest%.Diff_country);
    Count_Diff_country_gen3 := COUNT(GROUP,%Closest%.Diff_country_gen3);
    Count_Diff_country_gen2 := COUNT(GROUP,%Closest%.Diff_country_gen2);
    Count_Diff_country_gen1 := COUNT(GROUP,%Closest%.Diff_country_gen1);
    Count_Diff_country_tier := COUNT(GROUP,%Closest%.Diff_country_tier);
    Count_Diff_PMK_Customer_Product := COUNT(GROUP,%Closest%.Diff_PMK_Customer_Product);
    Count_Diff_use_case := COUNT(GROUP,%Closest%.Diff_use_case);
    Count_Diff_market_segment := COUNT(GROUP,%Closest%.Diff_market_segment);
  END;
  out_counts := table(%Closest%,%AggRec%,true);
ENDMACRO;
END;
