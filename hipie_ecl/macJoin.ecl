EXPORT macJoin(d01,d02,f):=FUNCTIONMACRO
  RETURN JOIN(d01,d02,#EXPAND(REGEXREPLACE(',',REGEXREPLACE('([^,]+)',f,'LEFT.$1=RIGHT.$1'),' AND ')),TRANSFORM({RECORDOF(LEFT) OR RECORDOF(RIGHT);},SELF:=LEFT;SELF:=RIGHT;), HASH);
ENDMACRO;
