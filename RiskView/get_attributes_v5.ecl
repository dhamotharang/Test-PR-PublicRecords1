import risk_indicators, riskprocessing, models;

EXPORT get_attributes_v5(grouped DATASET(risk_indicators.Layout_Boca_Shell) clam,
												boolean isPrescreen)
:= function

riskview.layouts.attributes_internal_layout map_attributes(clam le) := transform
	self.accountnumber := '';
				
	self.seq := le.seq;
	self.did := le.did;
	
	attr := models.Attributes_Master(le, true);
		
	self.InputProvidedFirstName	:= attr.InputProvidedFirstName;
	self.InputProvidedLastName	:= attr.InputProvidedLastName;
	self.InputProvidedStreetAddress	:= attr.InputProvidedStreetAddress;
	self.InputProvidedCity	:= attr.InputProvidedCity;
	self.InputProvidedState	:= attr.InputProvidedState;
	self.InputProvidedZipCode	:= attr.InputProvidedZipCode;
	self.InputProvidedSSN	:= attr.InputProvidedSSN;
	self.InputProvidedDateofBirth	:= attr.InputProvidedDateofBirth;
	self.InputProvidedPhone	:= attr.InputProvidedPhone;
	self.InputProvidedLexID	:= attr.InputProvidedLexID;  
	
	self.SubjectRecordTimeOldest	:= attr.SubjectRecordTimeOldest;  
	self.SubjectRecordTimeNewest	:= attr.SubjectRecordTimeNewest;
	self.SubjectNewestRecord12Month	:= attr.SubjectNewestRecord12Month;	
	self.SubjectActivityIndex03Month	:= attr.SubjectActivityIndex03Month;	
	self.SubjectActivityIndex06Month	:= attr.SubjectActivityIndex06Month;
	self.SubjectActivityIndex12Month	:= attr.SubjectActivityIndex12Month;
			
	self.SubjectAge	:= if(not le.truedid, '-1', attr.BestReportedAge(isPreScreen));
	self.SubjectDeceased	:= attr.SubjectDeceased;		
	self.SubjectSSNCount	:= if(not le.truedid, '-1', attr.SubjectSSNCount);
	
	self.SubjectStabilityIndex	:= '';// this is set in it's own transform later
	self.SubjectStabilityPrimaryFactor	:= '';// this is set in it's own transform later
	self.SubjectAbilityIndex	:= '';// this is set in it's own transform later
	self.SubjectAbilityPrimaryFactor	:= '';// this is set in it's own transform later
	self.SubjectWillingnessIndex	:= '';// this is set in it's own transform later
	self.SubjectWillingnessPrimaryFactor	:= '';// this is set in it's own transform later
	self.ConfirmationSubjectFound	:= attr.ConfirmationSubjectFound;
			
	self.ConfirmationInputName	:= attr.VerifiedName;
	self.ConfirmationInputDOB	:= if(not le.truedid, '-1', attr.VerifiedDOB);
	self.ConfirmationInputSSN	:= attr.ConfirmationInputSSN;
	self.ConfirmationInputAddress	:= attr.VerifiedAddress;
	self.SourceNonDerogProfileIndex	:= attr.SourceNonDerogProfileIndex;
	self.SourceNonDerogCount	:= if(not le.truedid, '-1', attr.NonDerogCount);
	self.SourceNonDerogCount03Month	:= if(not le.truedid, '-1', attr.NonDerogCount03);
	self.SourceNonDerogCount06Month	:= if(not le.truedid, '-1', attr.NonDerogCount06);
	self.SourceNonDerogCount12Month	:= if(not le.truedid, '-1', attr.NonDerogCount12);
	self.SourceCredHeaderTimeOldest	:= attr.SourceCredHeaderTimeOldest;
	self.SourceCredHeaderTimeNewest	:= attr.SourceCredHeaderTimeNewest;
	self.SourceVoterRegistration	:= attr.SourceVoterRegistration;
	self.EducationAttendance	:= attr.EducationAttendance;								
	self.EducationEvidence	:= attr.EducationEvidence;
	self.EducationProgramAttended	:= attr.EducationProgramAttended;
	self.EducationInstitutionPrivate	:= attr.EducationInstitutionPrivate_v5;
	self.EducationInstitutionRating	:= attr.EducationInstitutionRating_v5;
	self.ProfLicCount	:= if(not le.truedid, '-1', attr.ProfLicCount);
	self.ProfLicTypeCategory	:= attr.ProfLicTypeCategory_v5;
	self.BusinessAssociation	:= attr.BusinessAssociation;
	self.BusinessAssociationIndex	:= attr.BusinessAssociationIndex;
	self.BusinessAssociationTimeOldest	:= attr.BusinessAssociationTimeOldest;
	self.BusinessTitleLeadership	:= attr.BusinessTitleLeadership;
					
	self.AssetIndex	:= '';// this is set in it's own transform later
	self.AssetIndexPrimaryFactor	:= '';// this is set in it's own transform later
	
	self.AssetOwnership	:= if(not le.truedid, '-1', attr.AssetOwner);
	self.AssetProp	:= if(not le.truedid, '-1', attr.PropertyOwner);
	self.AssetPropIndex	:= if(not le.truedid, '-1', attr.AssetPropIndex);
	self.AssetPropEverCount	:= if(not le.truedid, '-1', attr.PropOwnedHistoricalCount);
	self.AssetPropCurrentCount	:= if(not le.truedid, '-1', attr.PropOwnedCount);
	self.AssetPropCurrentTaxTotal	:= attr.AssetPropCurrentTaxTotal;
	self.AssetPropPurchaseCount12Month	:= attr.AssetPropPurchaseCount12Month;
	self.AssetPropPurchaseTimeOldest	:= attr.AssetPropPurchaseTimeOldest;
	self.AssetPropPurchaseTimeNewest	:= attr.AssetPropPurchaseTimeNewest;
	self.AssetPropNewestMortgageType	:= attr.AssetPropNewestMortgageType;													
	self.AssetPropEverSoldCount	:= attr.AssetPropEverSoldCount;
	self.AssetPropSoldCount12Month	:= attr.AssetPropSoldCount12Month;
	self.AssetPropSaleTimeOldest	:= attr.AssetPropSaleTimeOldest;
	self.AssetPropSaleTimeNewest	:= attr.AssetPropSaleTimeNewest;
	self.AssetPropNewestSalePrice	:= attr.AssetPropNewestSalePrice;
	self.AssetPropSalePurchaseRatio	:= attr.AssetPropSalePurchaseRatio;
	self.AssetPersonal	:= attr.assetPersonal;
	self.AssetPersonalCount	:= attr.AssetPersonalCount;
	self.PurchaseActivityIndex	:= attr.PurchaseActivityIndex;
	self.PurchaseActivityCount	:= attr.PurchaseActivityCount;
	self.PurchaseActivityDollarTotal	:= attr.PurchaseActivityDollarTotal;
	self.DerogSeverityIndex	:= attr.DerogSeverityIndex_v5;
	self.DerogCount	:= attr.DerogCount_v5;
	self.DerogCount12Month	:= attr.DerogCount12Month;
	self.DerogTimeNewest	:= attr.DerogTimeNewest;
	self.CriminalFelonyCount	:= if(not le.truedid, '-1', attr.felonyCount);
	self.CriminalFelonyCount12Month	:= if(not le.truedid, '-1', attr.FelonyCount12);
	self.CriminalFelonyTimeNewest	:= attr.CriminalFelonyTimeNewest;
	self.CriminalNonFelonyCount	:= attr.CriminalNonFelonyCount;
	self.CriminalNonFelonyCount12Month	:= attr.CriminalNonFelonyCount12Month;
	self.CriminalNonFelonyTimeNewest	:= attr.CriminalNonFelonyTimeNewest;
	self.EvictionCount	:= if(not le.truedid, '-1', attr.EvictionCount);
	self.EvictionCount12Month	:= if(not le.truedid, '-1', attr.EvictionCount12);
	self.EvictionTimeNewest	:= attr.EvictionAge_v5;
	self.LienJudgmentSeverityIndex	:= attr.LienJudgmentSeverityIndex;
	self.LienJudgmentCount	:= attr.LienJudgmentCount;
	self.LienJudgmentCount12Month	:= attr.LienJudgmentCount12Month;
	self.LienJudgmentSmallClaimsCount	:= attr.LienJudgmentSmallClaimsCount;
	self.LienJudgmentCourtCount	:= attr.LienJudgmentCourtCount;
	self.LienJudgmentTaxCount	:= attr.LienJudgmentTaxCount;
	self.LienJudgmentForeclosureCount	:= attr.LienJudgmentForeclosureCount;
	self.LienJudgmentOtherCount	:= attr.LienJudgmentOtherCount;
	self.LienJudgmentTimeNewest	:= attr.LienJudgmentTimeNewest;
	self.LienJudgmentDollarTotal	:= attr.LienJudgmentDollarTotal;
	self.BankruptcyCount 	:= if(not le.truedid, '-1', attr.BankruptcyCount);
	self.BankruptcyCount24Month	:= if(not le.truedid, '-1', attr.BankruptcyCount24);
	self.BankruptcyTimeNewest	:= attr.BankruptcyTimeNewest;
	self.BankruptcyChapter	:= attr.BankruptcyChapter;
	self.BankruptcyStatus	:= attr.BankruptcyStatus_v5;
	self.BankruptcyDismissed24Month	:= attr.BankruptcyDismissed24Month;
	self.ShortTermLoanRequest	:= attr.ShortTermLoanRequest;
	self.ShortTermLoanRequest12Month	:= attr.ShortTermLoanRequest12Month;
	self.ShortTermLoanRequest24Month	:= attr.ShortTermLoanRequest24Month;
	self.InquiryAuto12Month	:= attr.InquiryAuto12Month;
	self.InquiryBanking12Month	:= attr.InquiryBanking12Month;
	self.InquiryTelcom12Month	:= attr.InquiryTelcom12Month;
	self.InquiryNonShortTerm12Month	:= attr.InquiryNonShortTerm12Month;
	self.InquiryShortTerm12Month	:= attr.InquiryShortTerm12Month;
	self.InquiryCollections12Month	:= attr.InquiryCollections12Month;
	self.SSNSubjectCount	:= attr.SSNSubjectCount;
	self.SSNDeceased	:= attr.ssnDeceased;
	self.SSNDateLowIssued	:= attr.SSNDateLowIssued; 
	self.SSNProblems	:= attr.SSNProblems_v5;
	self.AddrOnFileCount	:= attr.AddrOnFileCount;
	self.AddrOnFileCorrectional	:= attr.AddrOnFileCorrectional;
	self.AddrOnFileCollege	:= attr.AddrOnFileCollege;
	self.AddrOnFileHighRisk	:= attr.AddrOnFileHighRisk;
	self.AddrInputTimeOldest	:= attr.AddrInputTimeOldest;
	self.AddrInputTimeNewest	:= attr.AddrInputTimeNewest;
	self.AddrInputLengthOfRes	:= attr.AddrInputLengthOfRes;
	self.AddrInputSubjectCount	:= attr.AddrInputSubjectCount;
	self.AddrInputMatchIndex	:= attr.AddrInputMatchIndex;
	self.AddrInputSubjectOwned	:= if(not le.truedid, '-1', attr.InputAddrApplicantOwned);
	self.AddrInputDeedMailing	:= if(not le.truedid, '-1', attr.InputAddrOccupantOwned);
	self.AddrInputOwnershipIndex	:= attr.AddrInputOwnershipIndex;
	self.AddrInputPhoneService	:= attr.AddrInputPhoneService;
	self.AddrInputPhoneCount	:= attr.AddrInputPhoneCount;
	self.AddrInputDwellType	:= attr.AddrInputDwellType;
	self.AddrInputDwellTypeIndex	:= attr.AddrInputDwellTypeIndex;
	self.AddrInputDelivery	:= attr.AddrInputDelivery;
	self.AddrInputTimeLastSale	:= attr.AddrInputTimeLastSale;
	self.AddrInputLastSalePrice	:= attr.AddrInputLastSalePrice;
	self.AddrInputTaxValue	:= attr.AddrInputTaxValue;
	self.AddrInputTaxYr	:= attr.InputAddrTaxYr;
	self.AddrInputTaxMarketValue	:= attr.AddrInputTaxMarketValue;
	self.AddrInputAVMValue	:= if(attr.AddrInputAVMValue='0', '-1', attr.AddrInputAVMValue);
	self.AddrInputAVMValue12Month	:= if(attr.AddrInputAVMValue12Month='0', '-1', attr.AddrInputAVMValue12Month);
	self.AddrInputAVMRatio12MonthPrior	:= if(attr.AddrInputAVMRatio12MonthPrior='0', '-1', attr.AddrInputAVMRatio12MonthPrior);
	self.AddrInputAVMValue60Month	:= if(attr.AddrInputAVMValue60Month='0', '-1', attr.AddrInputAVMValue60Month);
	self.AddrInputAVMRatio60MonthPrior	:= if(attr.AddrInputAVMRatio60MonthPrior='0', '-1', attr.AddrInputAVMRatio60MonthPrior);
	self.AddrInputCountyRatio	:= attr.InputAddrCountyIndex;
	self.AddrInputTractRatio	:= attr.InputAddrTractIndex;
	self.AddrInputBlockRatio	:= attr.InputAddrBlockIndex;
	self.AddrInputProblems	:= attr.AddrInputProblems;
	self.AddrCurrentTimeOldest	:= attr.AddrCurrentTimeOldest;
	self.AddrCurrentTimeNewest	:= attr.AddrCurrentTimeNewest;
	self.AddrCurrentLengthOfRes 	:= attr.AddrCurrentLengthOfRes;
	self.AddrCurrentSubjectOwned 	:= attr.AddrCurrentSubjectOwned;
	self.AddrCurrentDeedMailing	:= attr.AddrCurrentDeedMailing;
	self.AddrCurrentOwnershipIndex	:= attr.AddrCurrentOwnershipIndex;
	self.AddrCurrentPhoneService	:= attr.AddrCurrentPhoneService;
	self.AddrCurrentDwellType 	:= attr.AddrCurrentDwellType;
	self.AddrCurrentDwellTypeIndex	:= attr.AddrCurrentDwellTypeIndex;
	self.AddrCurrentTimeLastSale	:= attr.AddrCurrentTimeLastSale;
	self.AddrCurrentLastSalesPrice	:= attr.AddrCurrentLastSalesPrice;
	self.AddrCurrentTaxValue	:= attr.AddrCurrentTaxValue;
	self.AddrCurrentTaxYr	:= attr.AddrCurrentTaxYr;
	self.AddrCurrentTaxMarketValue	:= attr.AddrCurrentTaxMarketValue;
	self.AddrCurrentAVMValue	:= if(attr.AddrCurrentAVMValue='0', '-1', attr.AddrCurrentAVMValue);
	self.AddrCurrentAVMValue12Month	:= if(attr.AddrCurrentAVMValue12Month='0', '-1', attr.AddrCurrentAVMValue12Month);
	self.AddrCurrentAVMRatio12MonthPrior	:= if(attr.AddrCurrentAVMRatio12MonthPrior='0', '-1', attr.AddrCurrentAVMRatio12MonthPrior);
	self.AddrCurrentAVMValue60Month	:= if(attr.AddrCurrentAVMValue60Month='0', '-1', attr.AddrCurrentAVMValue60Month);
	self.AddrCurrentAVMRatio60MonthPrior	:= if(attr.AddrCurrentAVMRatio60MonthPrior='0', '-1', attr.AddrCurrentAVMRatio60MonthPrior);
	self.AddrCurrentCountyRatio	:= attr.AddrCurrentCountyRatio;
	self.AddrCurrentTractRatio	:= attr.AddrCurrentTractRatio;
	self.AddrCurrentBlockRatio	:= attr.AddrCurrentBlockRatio;
	self.AddrCurrentCorrectional	:= attr.AddrCurrentCorrectional;
	self.AddrPreviousTimeOldest	:= attr.AddrPreviousTimeOldest;
	self.AddrPreviousTimeNewest	:= attr.AddrPreviousTimeNewest;
	self.AddrPreviousLengthOfRes 	:= attr.AddrPreviousLengthOfRes;
	self.AddrPreviousSubjectOwned 	:= attr.AddrPreviousSubjectOwned;
	self.AddrPreviousOwnershipIndex	:= attr.AddrPreviousOwnershipIndex;
	self.AddrPreviousDwellType 	:= attr.AddrPreviousDwellType;
	self.AddrPreviousDwellTypeIndex	:= attr.AddrPreviousDwellTypeIndex;
	self.AddrPreviousCorrectional	:= attr.AddrPreviousCorrectional;
	self.AddrStabilityIndex	:= if(not le.truedid, '-1', attr.AddrStability);
	self.AddrChangeCount03Month	:= if(not le.truedid, '-1', attr.AddrChangeCount03); 
	self.AddrChangeCount06Month	:= if(not le.truedid, '-1', attr.AddrChangeCount06); 
	self.AddrChangeCount12Month	:= if(not le.truedid, '-1', attr.AddrChangeCount12); 
	self.AddrChangeCount24Month	:= if(not le.truedid, '-1', attr.AddrChangeCount24); 
	self.AddrChangeCount60Month	:= if(not le.truedid, '-1', attr.AddrChangeCount60); 
	self.AddrLastMoveTaxRatioDiff	:= attr.AddrLastMoveTaxRatioDiff;
	self.AddrLastMoveEconTrajectory	:= attr.AddrLastMoveEconTrajectory;
	self.AddrLastMoveEconTrajectoryIndex	:= attr.AddrLastMoveEconTrajectoryIndex;
	self.PhoneInputProblems	:= attr.PhoneInputProblems;
	self.PhoneInputSubjectCount	:= attr.PhoneInputSubjectCount;
	self.PhoneInputMobile 	:= attr.InputPhoneMobile;
	self.AlertRegulatoryCondition	:= '';  // this is set in riskview.search_function
	self := [];
end;

with_attributes_v5 := project(clam, map_attributes(left));

with_ability := riskview.getAbilityIndex(with_attributes_v5);
with_asset := riskview.getAssetIndex(with_ability);
with_stability := riskview.getStabilityIndex(with_asset);
with_willingness := riskview.getWillingnessIndex(with_stability);

with_attributes_after_noscore_applied := project(with_willingness,
		transform(riskview.layouts.attributes_internal_layout_noscore,
		no_score := left.confirmationSubjectFound='0';
		self.no_score := no_score;
		// attributes requirement 1.22 -> add noscore logic to set all DID based attributes to -1 when ConfirmationSubjectFound='0'
		self.SubjectRecordTimeOldest	 := if(no_score, '-1', left.SubjectRecordTimeOldest	);
		self.SubjectRecordTimeNewest	 := if(no_score, '-1', left.SubjectRecordTimeNewest	);
		self.SubjectNewestRecord12Month	 := if(no_score, '-1', left.SubjectNewestRecord12Month	);
		self.SubjectActivityIndex03Month	 := if(no_score, '-1', left.SubjectActivityIndex03Month	);
		self.SubjectActivityIndex06Month	 := if(no_score, '-1', left.SubjectActivityIndex06Month	);
		self.SubjectActivityIndex12Month	 := if(no_score, '-1', left.SubjectActivityIndex12Month	);
		self.SubjectAge	 := if(no_score, '-1', left.SubjectAge	);
		self.SubjectDeceased	 := if(no_score, '-1', left.SubjectDeceased	);
		self.SubjectSSNCount	 := if(no_score, '-1', left.SubjectSSNCount	);
		self.SubjectStabilityIndex	 := if(no_score, '-1', left.SubjectStabilityIndex	);
		self.SubjectStabilityPrimaryFactor	 := if(no_score, '-1', left.SubjectStabilityPrimaryFactor	);
		self.SubjectAbilityIndex	 := if(no_score, '-1', left.SubjectAbilityIndex	);
		self.SubjectAbilityPrimaryFactor	 := if(no_score, '-1', left.SubjectAbilityPrimaryFactor	);
		self.SubjectWillingnessIndex	 := if(no_score, '-1', left.SubjectWillingnessIndex	);
		self.SubjectWillingnessPrimaryFactor	 := if(no_score, '-1', left.SubjectWillingnessPrimaryFactor	);
		self.ConfirmationInputName	 := if(no_score, '-1', left.ConfirmationInputName	);
		self.ConfirmationInputDOB	 := if(no_score, '-1', left.ConfirmationInputDOB	);
		self.ConfirmationInputSSN	 := if(no_score, '-1', left.ConfirmationInputSSN	);
		self.ConfirmationInputAddress	 := if(no_score, '-1', left.ConfirmationInputAddress	);
		self.SourceNonDerogProfileIndex	 := if(no_score, '-1', left.SourceNonDerogProfileIndex	);
		self.SourceNonDerogCount	 := if(no_score, '-1', left.SourceNonDerogCount	);
		self.SourceNonDerogCount03Month	 := if(no_score, '-1', left.SourceNonDerogCount03Month	);
		self.SourceNonDerogCount06Month	 := if(no_score, '-1', left.SourceNonDerogCount06Month	);
		self.SourceNonDerogCount12Month	 := if(no_score, '-1', left.SourceNonDerogCount12Month	);
		self.SourceCredHeaderTimeOldest	 := if(no_score, '-1', left.SourceCredHeaderTimeOldest	);
		self.SourceCredHeaderTimeNewest	 := if(no_score, '-1', left.SourceCredHeaderTimeNewest	);
		self.SourceVoterRegistration	 := if(no_score, '-1', left.SourceVoterRegistration	);
		self.EducationAttendance	 := if(no_score, '-1', left.EducationAttendance	);
		self.EducationEvidence	 := if(no_score, '-1', left.EducationEvidence	);
		self.EducationProgramAttended	 := if(no_score, '-1', left.EducationProgramAttended	);
		self.EducationInstitutionPrivate	 := if(no_score, '-1', left.EducationInstitutionPrivate	);
		self.EducationInstitutionRating	 := if(no_score, '-1', left.EducationInstitutionRating	);
		self.ProfLicCount	 := if(no_score, '-1', left.ProfLicCount	);
		self.ProfLicTypeCategory	 := if(no_score, '-1', left.ProfLicTypeCategory	);
		self.BusinessAssociation	 := if(no_score, '-1', left.BusinessAssociation	);
		self.BusinessAssociationIndex	 := if(no_score, '-1', left.BusinessAssociationIndex	);
		self.BusinessAssociationTimeOldest	 := if(no_score, '-1', left.BusinessAssociationTimeOldest	);
		self.BusinessTitleLeadership	 := if(no_score, '-1', left.BusinessTitleLeadership	);
		self.AssetIndex	 := if(no_score, '-1', left.AssetIndex	);
		self.AssetIndexPrimaryFactor	 := if(no_score, '-1', left.AssetIndexPrimaryFactor	);
		self.AssetOwnership	 := if(no_score, '-1', left.AssetOwnership	);
		self.AssetProp	 := if(no_score, '-1', left.AssetProp	);
		self.AssetPropIndex	 := if(no_score, '-1', left.AssetPropIndex	);
		self.AssetPropEverCount	 := if(no_score, '-1', left.AssetPropEverCount	);
		self.AssetPropCurrentCount	 := if(no_score, '-1', left.AssetPropCurrentCount	);
		self.AssetPropCurrentTaxTotal	 := if(no_score, '-1', left.AssetPropCurrentTaxTotal	);
		self.AssetPropPurchaseCount12Month	 := if(no_score, '-1', left.AssetPropPurchaseCount12Month	);
		self.AssetPropPurchaseTimeOldest	 := if(no_score, '-1', left.AssetPropPurchaseTimeOldest	);
		self.AssetPropPurchaseTimeNewest	 := if(no_score, '-1', left.AssetPropPurchaseTimeNewest	);
		self.AssetPropNewestMortgageType	 := if(no_score, '-1', left.AssetPropNewestMortgageType	);
		self.AssetPropEverSoldCount	 := if(no_score, '-1', left.AssetPropEverSoldCount	);
		self.AssetPropSoldCount12Month	 := if(no_score, '-1', left.AssetPropSoldCount12Month	);
		self.AssetPropSaleTimeOldest	 := if(no_score, '-1', left.AssetPropSaleTimeOldest	);
		self.AssetPropSaleTimeNewest	 := if(no_score, '-1', left.AssetPropSaleTimeNewest	);
		self.AssetPropNewestSalePrice	 := if(no_score, '-1', left.AssetPropNewestSalePrice	);
		self.AssetPropSalePurchaseRatio	 := if(no_score, '-1', left.AssetPropSalePurchaseRatio	);
		self.AssetPersonal	 := if(no_score, '-1', left.AssetPersonal	);
		self.AssetPersonalCount	 := if(no_score, '-1', left.AssetPersonalCount	);
		self.PurchaseActivityIndex	 := if(no_score, '-1', left.PurchaseActivityIndex	);
		self.PurchaseActivityCount	 := if(no_score, '-1', left.PurchaseActivityCount	);
		self.PurchaseActivityDollarTotal	 := if(no_score, '-1', left.PurchaseActivityDollarTotal	);
		self.DerogSeverityIndex	 := if(no_score, '-1', left.DerogSeverityIndex	);
		self.DerogCount	 := if(no_score, '-1', left.DerogCount	);
		self.DerogCount12Month	 := if(no_score, '-1', left.DerogCount12Month	);
		self.DerogTimeNewest	 := if(no_score, '-1', left.DerogTimeNewest	);
		self.CriminalFelonyCount	 := if(no_score, '-1', left.CriminalFelonyCount	);
		self.CriminalFelonyCount12Month	 := if(no_score, '-1', left.CriminalFelonyCount12Month	);
		self.CriminalFelonyTimeNewest	 := if(no_score, '-1', left.CriminalFelonyTimeNewest	);
		self.CriminalNonFelonyCount	 := if(no_score, '-1', left.CriminalNonFelonyCount	);
		self.CriminalNonFelonyCount12Month	 := if(no_score, '-1', left.CriminalNonFelonyCount12Month	);
		self.CriminalNonFelonyTimeNewest	 := if(no_score, '-1', left.CriminalNonFelonyTimeNewest	);
		self.EvictionCount	 := if(no_score, '-1', left.EvictionCount	);
		self.EvictionCount12Month	 := if(no_score, '-1', left.EvictionCount12Month	);
		self.EvictionTimeNewest	 := if(no_score, '-1', left.EvictionTimeNewest	);
		self.LienJudgmentSeverityIndex	 := if(no_score, '-1', left.LienJudgmentSeverityIndex	);
		self.LienJudgmentCount	 := if(no_score, '-1', left.LienJudgmentCount	);
		self.LienJudgmentCount12Month	 := if(no_score, '-1', left.LienJudgmentCount12Month	);
		self.LienJudgmentSmallClaimsCount	 := if(no_score, '-1', left.LienJudgmentSmallClaimsCount	);
		self.LienJudgmentCourtCount	 := if(no_score, '-1', left.LienJudgmentCourtCount	);
		self.LienJudgmentTaxCount	 := if(no_score, '-1', left.LienJudgmentTaxCount	);
		self.LienJudgmentForeclosureCount	 := if(no_score, '-1', left.LienJudgmentForeclosureCount	);
		self.LienJudgmentOtherCount	 := if(no_score, '-1', left.LienJudgmentOtherCount	);
		self.LienJudgmentTimeNewest	 := if(no_score, '-1', left.LienJudgmentTimeNewest	);
		self.LienJudgmentDollarTotal	 := if(no_score, '-1', left.LienJudgmentDollarTotal	);
		self.BankruptcyCount 	 := if(no_score, '-1', left.BankruptcyCount 	);
		self.BankruptcyCount24Month	 := if(no_score, '-1', left.BankruptcyCount24Month	);
		self.BankruptcyTimeNewest	 := if(no_score, '-1', left.BankruptcyTimeNewest	);
		self.BankruptcyChapter	 := if(no_score, '-1', left.BankruptcyChapter	);
		self.BankruptcyStatus	 := if(no_score, '-1', left.BankruptcyStatus	);
		self.BankruptcyDismissed24Month	 := if(no_score, '-1', left.BankruptcyDismissed24Month	);
		self.ShortTermLoanRequest	 := if(no_score, '-1', left.ShortTermLoanRequest	);
		self.ShortTermLoanRequest12Month	 := if(no_score, '-1', left.ShortTermLoanRequest12Month	);
		self.ShortTermLoanRequest24Month	 := if(no_score, '-1', left.ShortTermLoanRequest24Month	);
		self.InquiryAuto12Month	 := if(no_score, '-1', left.InquiryAuto12Month	);
		self.InquiryBanking12Month	 := if(no_score, '-1', left.InquiryBanking12Month	);
		self.InquiryTelcom12Month	 := if(no_score, '-1', left.InquiryTelcom12Month	);
		self.InquiryNonShortTerm12Month	 := if(no_score, '-1', left.InquiryNonShortTerm12Month	);
		self.InquiryShortTerm12Month	 := if(no_score, '-1', left.InquiryShortTerm12Month	);
		self.InquiryCollections12Month	 := if(no_score, '-1', left.InquiryCollections12Month	);
		self.SSNSubjectCount	 := if(no_score, '-1', left.SSNSubjectCount	);
		self.SSNDeceased	 := if(no_score, '-1', left.SSNDeceased	);
		self.SSNDateLowIssued	 := if(no_score, '-1', left.SSNDateLowIssued	);
		self.SSNProblems	 := if(no_score, '-1', left.SSNProblems	);
		self.AddrOnFileCount	 := if(no_score, '-1', left.AddrOnFileCount	);
		self.AddrOnFileCorrectional	 := if(no_score, '-1', left.AddrOnFileCorrectional	);
		self.AddrOnFileCollege	 := if(no_score, '-1', left.AddrOnFileCollege	);
		self.AddrOnFileHighRisk	 := if(no_score, '-1', left.AddrOnFileHighRisk	);
		self.AddrInputTimeOldest	 := if(no_score, '-1', left.AddrInputTimeOldest	);
		self.AddrInputTimeNewest	 := if(no_score, '-1', left.AddrInputTimeNewest	);
		self.AddrInputLengthOfRes	 := if(no_score, '-1', left.AddrInputLengthOfRes	);
		self.AddrInputSubjectCount	 := if(no_score, '-1', left.AddrInputSubjectCount	);
		self.AddrInputMatchIndex	 := if(no_score, '-1', left.AddrInputMatchIndex	);
		self.AddrInputSubjectOwned	 := if(no_score, '-1', left.AddrInputSubjectOwned	);
		self.AddrInputDeedMailing	 := if(no_score, '-1', left.AddrInputDeedMailing	);
		self.AddrInputOwnershipIndex	 := if(no_score, '-1', left.AddrInputOwnershipIndex	);
		self.AddrInputPhoneService	 := if(no_score, '-1', left.AddrInputPhoneService	);
		self.AddrInputPhoneCount	 := if(no_score, '-1', left.AddrInputPhoneCount	);
		self.AddrInputDwellType	 := if(no_score, '-1', left.AddrInputDwellType	);
		self.AddrInputDwellTypeIndex	 := if(no_score, '-1', left.AddrInputDwellTypeIndex	);
		self.AddrInputDelivery	 := if(no_score, '-1', left.AddrInputDelivery	);
		self.AddrInputTimeLastSale	 := if(no_score, '-1', left.AddrInputTimeLastSale	);
		self.AddrInputLastSalePrice	 := if(no_score, '-1', left.AddrInputLastSalePrice	);
		self.AddrInputTaxValue	 := if(no_score, '-1', left.AddrInputTaxValue	);
		self.AddrInputTaxYr	 := if(no_score, '-1', left.AddrInputTaxYr	);
		self.AddrInputTaxMarketValue	 := if(no_score, '-1', left.AddrInputTaxMarketValue	);
		self.AddrInputAVMValue	 := if(no_score, '-1', left.AddrInputAVMValue	);
		self.AddrInputAVMValue12Month	 := if(no_score, '-1', left.AddrInputAVMValue12Month	);
		self.AddrInputAVMRatio12MonthPrior	 := if(no_score, '-1', left.AddrInputAVMRatio12MonthPrior	);
		self.AddrInputAVMValue60Month	 := if(no_score, '-1', left.AddrInputAVMValue60Month	);
		self.AddrInputAVMRatio60MonthPrior	 := if(no_score, '-1', left.AddrInputAVMRatio60MonthPrior	);
		self.AddrInputCountyRatio	 := if(no_score, '-1', left.AddrInputCountyRatio	);
		self.AddrInputTractRatio	 := if(no_score, '-1', left.AddrInputTractRatio	);
		self.AddrInputBlockRatio	 := if(no_score, '-1', left.AddrInputBlockRatio	);
		self.AddrInputProblems	 := if(no_score, '-1', left.AddrInputProblems	);
		self.AddrCurrentTimeOldest	 := if(no_score, '-1', left.AddrCurrentTimeOldest	);
		self.AddrCurrentTimeNewest	 := if(no_score, '-1', left.AddrCurrentTimeNewest	);
		self.AddrCurrentLengthOfRes 	 := if(no_score, '-1', left.AddrCurrentLengthOfRes 	);
		self.AddrCurrentSubjectOwned 	 := if(no_score, '-1', left.AddrCurrentSubjectOwned 	);
		self.AddrCurrentDeedMailing	 := if(no_score, '-1', left.AddrCurrentDeedMailing	);
		self.AddrCurrentOwnershipIndex	 := if(no_score, '-1', left.AddrCurrentOwnershipIndex	);
		self.AddrCurrentPhoneService	 := if(no_score, '-1', left.AddrCurrentPhoneService	);
		self.AddrCurrentDwellType 	 := if(no_score, '-1', left.AddrCurrentDwellType 	);
		self.AddrCurrentDwellTypeIndex	 := if(no_score, '-1', left.AddrCurrentDwellTypeIndex	);
		self.AddrCurrentTimeLastSale	 := if(no_score, '-1', left.AddrCurrentTimeLastSale	);
		self.AddrCurrentLastSalesPrice	 := if(no_score, '-1', left.AddrCurrentLastSalesPrice	);
		self.AddrCurrentTaxValue	 := if(no_score, '-1', left.AddrCurrentTaxValue	);
		self.AddrCurrentTaxYr	 := if(no_score, '-1', left.AddrCurrentTaxYr	);
		self.AddrCurrentTaxMarketValue	 := if(no_score, '-1', left.AddrCurrentTaxMarketValue	);
		self.AddrCurrentAVMValue	 := if(no_score, '-1', left.AddrCurrentAVMValue	);
		self.AddrCurrentAVMValue12Month	 := if(no_score, '-1', left.AddrCurrentAVMValue12Month	);
		self.AddrCurrentAVMRatio12MonthPrior	 := if(no_score, '-1', left.AddrCurrentAVMRatio12MonthPrior	);
		self.AddrCurrentAVMValue60Month	 := if(no_score, '-1', left.AddrCurrentAVMValue60Month	);
		self.AddrCurrentAVMRatio60MonthPrior	 := if(no_score, '-1', left.AddrCurrentAVMRatio60MonthPrior	);
		self.AddrCurrentCountyRatio	 := if(no_score, '-1', left.AddrCurrentCountyRatio	);
		self.AddrCurrentTractRatio	 := if(no_score, '-1', left.AddrCurrentTractRatio	);
		self.AddrCurrentBlockRatio	 := if(no_score, '-1', left.AddrCurrentBlockRatio	);
		self.AddrCurrentCorrectional	 := if(no_score, '-1', left.AddrCurrentCorrectional	);
		self.AddrPreviousTimeOldest	 := if(no_score, '-1', left.AddrPreviousTimeOldest	);
		self.AddrPreviousTimeNewest	 := if(no_score, '-1', left.AddrPreviousTimeNewest	);
		self.AddrPreviousLengthOfRes 	 := if(no_score, '-1', left.AddrPreviousLengthOfRes 	);
		self.AddrPreviousSubjectOwned 	 := if(no_score, '-1', left.AddrPreviousSubjectOwned 	);
		self.AddrPreviousOwnershipIndex	 := if(no_score, '-1', left.AddrPreviousOwnershipIndex	);
		self.AddrPreviousDwellType 	 := if(no_score, '-1', left.AddrPreviousDwellType 	);
		self.AddrPreviousDwellTypeIndex	 := if(no_score, '-1', left.AddrPreviousDwellTypeIndex	);
		self.AddrPreviousCorrectional	 := if(no_score, '-1', left.AddrPreviousCorrectional	);
		self.AddrStabilityIndex	 := if(no_score, '-1', left.AddrStabilityIndex	);
		self.AddrChangeCount03Month	 := if(no_score, '-1', left.AddrChangeCount03Month	);
		self.AddrChangeCount06Month	 := if(no_score, '-1', left.AddrChangeCount06Month	);
		self.AddrChangeCount12Month	 := if(no_score, '-1', left.AddrChangeCount12Month	);
		self.AddrChangeCount24Month	 := if(no_score, '-1', left.AddrChangeCount24Month	);
		self.AddrChangeCount60Month	 := if(no_score, '-1', left.AddrChangeCount60Month	);
		self.AddrLastMoveTaxRatioDiff	 := if(no_score, '-1', left.AddrLastMoveTaxRatioDiff	);
		self.AddrLastMoveEconTrajectory	 := if(no_score, '-1', left.AddrLastMoveEconTrajectory	);
		self.AddrLastMoveEconTrajectoryIndex	 := if(no_score, '-1', left.AddrLastMoveEconTrajectoryIndex	);
		self.PhoneInputProblems	 := if(no_score, '-1', left.PhoneInputProblems	);
		self.PhoneInputSubjectCount	 := if(no_score, '-1', left.PhoneInputSubjectCount	);
		self.PhoneInputMobile 	 := if(no_score, '-1', left.PhoneInputMobile 	);
		
		// if the attribute isn't DID based, let it return regardless of the no_score
		self := left;
		
		));

	
return with_attributes_after_noscore_applied;

end;