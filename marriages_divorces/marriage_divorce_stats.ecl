layout_marriage_divorces_in :=
record
   string5 vendor;
   string25 source_file;
   string8 process_date;
   string2 state_origin;
   string10 source_location_cd;
   string50 source_county;
   string50 source_city;
   string50 filing_number;
   string1 filing_type;
   string8 filing_dt;
   string10 party1_type;
   string70 party1_orig_name;
   string70 party1_orig_name_alias;
   string1 party1_name_fmt;
   string8 party1_dob;
   string9 party1_ssn;
   string3 party1_age;
   string10 party1_residence_cds;
   string2 party1_residence_state;
   string50 party1_residence_city;
   string9 party1_orig_zip;
   string50 party1_residence_county;
   string75 party1_residence_address1;
   string10 party1_status_cd;
   string50 party1_status;
   string2 party1_times_married;
   string10 party1_race_cd;
   string30 party1_race;
   string10 party2_type;
   string70 party2_orig_name;
   string70 party2_orig_name_alias;
   string1 party2_name_fmt;
   string8 party2_dob;
   string9 party2_ssn;
   string3 party2_age;
   string10 party2_residence_cds;
   string2 party2_residence_state;
   string50 party2_residence_city;
   string9 party2_orig_zip;
   string50 party2_residence_county;
   string75 party2_residence_address1;
   string10 party2_status_cd;
   string50 party2_status;
   string2 party2_times_married;
   string10 party2_race_cd;
   string30 party2_race;
   string2 number_children;
   string8 marriage_dt;
   string8 divorce_dt;
   string4 marriage_months_duration;
   string10 divorce_granted_to_cd;
   string30 divorce_granted_to;
   string10 divorce_grounds_cd;
   string50 divorce_grounds;
   string5 p1_title;
   string20 p1_fname;
   string20 p1_mname;
   string20 p1_lname;
   string5 p1_name_suffix;
   string3 p1_score_in;
   string5 p1a_title;
   string20 p1a_fname;
   string20 p1a_mname;
   string20 p1a_lname;
   string5 p1a_name_suffix;
   string3 p1a_score_in;
   string5 p2_title;
   string20 p2_fname;
   string20 p2_mname;
   string20 p2_lname;
   string5 p2_name_suffix;
   string3 p2_score_in;
   string5 p2a_title;
   string20 p2a_fname;
   string20 p2a_mname;
   string20 p2a_lname;
   string5 p2a_name_suffix;
   string3 p2a_score_in;
   string10 prim_range_1;
   string2 predir_1;
   string28 prim_name_1;
   string4 addr_suffix_1;
   string2 postdir_1;
   string10 unit_desig_1;
   string8 sec_range_1;
   string25 p_city_name_1;
   string25 v_city_name_1;
   string2 st_1;
   string5 zip_1;
   string4 zip4_1;
   string4 cart_1;
   string1 cr_sort_sz_1;
   string4 lot_1;
   string1 lot_order_1;
   string2 dpbc_1;
   string1 chk_digit_1;
   string2 rec_type_1;
   string2 ace_fips_st_1;
   string3 ace_fips_county_1;
   string10 geo_lat_1;
   string11 geo_long_1;
   string4 msa_1;
   string7 geo_blk_1;
   string1 geo_match_1;
   string4 err_stat_1;
   string10 prim_range_2;
   string2 predir_2;
   string28 prim_name_2;
   string4 addr_suffix_2;
   string2 postdir_2;
   string10 unit_desig_2;
   string8 sec_range_2;
   string25 p_city_name_2;
   string25 v_city_name_2;
   string2 st_2;
   string5 zip_2;
   string4 zip4_2;
   string4 cart_2;
   string1 cr_sort_sz_2;
   string4 lot_2;
   string1 lot_order_2;
   string2 dpbc_2;
   string1 chk_digit_2;
   string2 rec_type_2;
   string2 ace_fips_st_2;
   string3 ace_fips_county_2;
   string10 geo_lat_2;
   string11 geo_long_2;
   string4 msa_2;
   string7 geo_blk_2;
   string1 geo_match_2;
   string4 err_stat_2;
end;

outf := dataset('~thor_200::in::marriage_divorces_bobs_spray',
		   	layout_marriage_divorces_in,
			flat,
			unsorted
		   );


//output(outf);

d := distribute(outf,hash(vendor));

stat_rec :=  record
'marriage_divorces',
d.source_file,
d.state_origin,
d.vendor,
'00000000',
d.process_date;

total := count(group);
vendor_count := count(group, d.vendor <> '');
source_file_count := count(group, d.source_file <> '');
process_date_count := count(group, d.process_date <> '');
state_origin_count := count(group, d.state_origin <> '');
source_location_cd_count := count(group, d.source_location_cd <> '');
source_county_count := count(group, d.source_county <> '');
source_city_count := count(group, d.source_city <> '');
filing_number_count := count(group, d.filing_number <> '');
filing_type_count := count(group, d.filing_type <> '');
party1_type_count := count(group, d.party1_type <> '');
party1_orig_name_count := count(group, d.party1_orig_name <> '');
party1_orig_name_alias_count := count(group, d.party1_orig_name_alias <> '');
party1_name_fmt_count := count(group, d.party1_name_fmt <> '');
party1_dob_count := count(group, d.party1_dob <> '');
party1_ssn_count := count(group, d.party1_ssn <> '');
party1_age_count := count(group, d.party1_age <> '');
party1_residence_cds_count := count(group, d.party1_residence_cds <> '');
party1_residence_state_count := count(group, d.party1_residence_state <> '');
party1_residence_city_count := count(group, d.party1_residence_city <> '');
party1_orig_zip_count := count(group, d.party1_orig_zip <> '');
party1_residence_county_count := count(group, d.party1_residence_county <> '');
party1_residence_address1_count := count(group, d.party1_residence_address1 <> '');
party1_status_cd_count := count(group, d.party1_status_cd <> '');
party1_status_count := count(group, d.party1_status <> '');
party1_times_married_count := count(group, d.party1_times_married <> '');
party1_race_cd_count := count(group, d.party1_race_cd <> '');
party1_race_count := count(group, d.party1_race <> '');
party2_type_count := count(group, d.party2_type <> '');
party2_orig_name_count := count(group, d.party2_orig_name <> '');
party2_orig_name_alias_count := count(group, d.party2_orig_name_alias <> '');
party2_name_fmt_count := count(group, d.party2_name_fmt <> '');
party2_dob_count := count(group, d.party2_dob <> '');
party2_ssn_count := count(group, d.party2_ssn <> '');
party2_age_count := count(group, d.party2_age <> '');
party2_residence_cds_count := count(group, d.party2_residence_cds <> '');
party2_residence_state_count := count(group, d.party2_residence_state <> '');
party2_residence_city_count := count(group, d.party2_residence_city <> '');
party2_orig_zip_count := count(group, d.party2_orig_zip <> '');
party2_residence_county_count := count(group, d.party2_residence_county <> '');
party2_residence_address1_count := count(group, d.party2_residence_address1 <> '');
party2_status_cd_count := count(group, d.party2_status_cd <> '');
party2_status_count := count(group, d.party2_status <> '');
party2_times_married_count := count(group, d.party2_times_married <> '');
party2_race_cd_count := count(group, d.party2_race_cd <> '');
party2_race_count := count(group, d.party2_race <> '');
number_children_count := count(group, d.number_children <> '');
marriage_dt_count := count(group, d.marriage_dt <> '');
divorce_dt_count := count(group, d.divorce_dt <> '');
marriage_months_duration_count := count(group, d.marriage_months_duration <> '');
divorce_granted_to_cd_count := count(group, d.divorce_granted_to_cd <> '');
divorce_granted_to_count := count(group, d.divorce_granted_to <> '');
divorce_grounds_cd_count := count(group, d.divorce_grounds_cd <> '');
divorce_grounds_count := count(group, d.divorce_grounds <> '');

filing_dt_count := count(group, d.filing_dt <> '');
filing_dt_blank := count(group,d.filing_dt='');
filing_dt_less_than_1980 := count(group,d.filing_dt<>'' and d.filing_dt[1..3]<'198');
filing_dt_1980_through_1989 := count(group,d.filing_dt[1..3]='198');
filing_dt_1990_through_1999 := count(group,d.filing_dt[1..3]='199');
filing_dt_2000 := count(group,d.filing_dt[1..4]='2000');
filing_dt_2001 := count(group,d.filing_dt[1..4]='2001');
filing_dt_2002 := count(group,d.filing_dt[1..4]='2002');
filing_dt_2003 := count(group,d.filing_dt[1..4]='2003');
filing_dt_2004 := count(group,d.filing_dt[1..4]='2004');
filing_dt_200501 := count(group,d.filing_dt[1..6]='200501');
filing_dt_200502 := count(group,d.filing_dt[1..6]='200502');
filing_dt_200503 := count(group,d.filing_dt[1..6]='200503');
filing_dt_200504 := count(group,d.filing_dt[1..6]='200504');
filing_dt_200505 := count(group,d.filing_dt[1..6]='200505');
filing_dt_200506 := count(group,d.filing_dt[1..6]='200506');
filing_dt_200507 := count(group,d.filing_dt[1..6]='200507');
filing_dt_200508 := count(group,d.filing_dt[1..6]='200508');
filing_dt_200509 := count(group,d.filing_dt[1..6]='200509');
filing_dt_200510 := count(group,d.filing_dt[1..6]='200510');
filing_dt_200511 := count(group,d.filing_dt[1..6]='200511');
filing_dt_200512 := count(group,d.filing_dt[1..6]='200512');
filing_dt_greater_than_200512 := count(group,d.filing_dt[1..6]>'200512');
end;

stats := table(d,stat_rec,d.source_file,d.state_origin,d.vendor,d.process_date,few);

output(choosen(stats,1000));