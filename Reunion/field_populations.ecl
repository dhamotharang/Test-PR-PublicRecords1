
ds_m := reunion.file_reunion_main;
ds_r := reunion.file_reunion_relatives;
ds_a := reunion.file_reunion_old_addresses;
ds_d := reunion.file_reunion_deeds;
ds_t := reunion.file_reunion_tax;

r_m := record
 ds_m.record_type;
 integer total_group           := count(group);
 //integer has_record_type       := count(group,ds_m.record_tye<>'');
 integer has_adl               := count(group,(integer)ds_m.adl<>0);
 integer has_best_title        := count(group,ds_m.best_title<>'');
 integer has_best_fname        := count(group,ds_m.best_fname<>'');
 integer has_best_mname        := count(group,ds_m.best_mname<>'');
 integer has_best_lname        := count(group,ds_m.best_lname<>'');
 integer has_best_name_suffix  := count(group,ds_m.best_name_suffix<>'');
 integer has_best_street       := count(group,ds_m.best_street<>'');
 integer has_best_city         := count(group,ds_m.best_city<>'');
 integer has_best_st           := count(group,ds_m.best_st<>'');
 integer has_best_zip          := count(group,ds_m.best_zip<>''); 
 integer has_phone             := count(group,ds_m.phone<>''); 
 integer has_best_dob          := count(group,ds_m.best_dob<>'');
 integer has_date_of_death     := count(group,ds_m.date_of_death<>'');
 integer has_prof_lic_job_desc := count(group,ds_m.prof_lic_job_desc<>'');
end;

r_r := record
 ds_r.record_type;
 integer total_group              := count(group);
 //integer has_record_type          := count(group,ds_r.record_type:='R';
 integer has_main_adl             := count(group,(integer)ds_r.main_adl<>0);
 integer has_relative_adl         := count(group,(integer)ds_r.relative_adl<>0);
 integer has_relative_title       := count(group,ds_r.relative_title<>'');
 integer has_relative_fname       := count(group,ds_r.relative_fname<>'');
 integer has_relative_mname       := count(group,ds_r.relative_mname<>'');
 integer has_relative_lname       := count(group,ds_r.relative_lname<>'');
 integer has_relative_name_suffix := count(group,ds_r.relative_name_suffix<>'');
end;

r_a := record
 ds_a.record_type;
 integer total_group         := count(group);
 //string1  record_type:='A';
 integer has_main_adl        := count(group,ds_a.main_adl<>'');
 integer has_old_street      := count(group,ds_a.old_street<>'');
 integer has_old_city        := count(group,ds_a.old_city<>'');
 integer has_old_st          := count(group,ds_a.old_st<>'');
 integer has_old_zip         := count(group,ds_a.old_zip<>'');
 integer has_date_first_seen := count(group,ds_a.date_first_seen<>'');
 integer has_date_last_seen  := count(group,ds_a.date_last_seen<>'');
end;

r_d := record
 ds_d.record_type;
 integer total_group           := count(group);
 //string1   record_type:='D';
 integer has_main_adl          := count(group,(integer)ds_d.main_adl<>0);
 integer has_state             := count(group,ds_d.state<>'');
 integer has_county            := count(group,ds_d.county<>'');
 integer has_apn               := count(group,ds_d.apn<>'');
 integer has_property_street   := count(group,ds_d.property_street<>'');
 integer has_property_city     := count(group,ds_d.property_city<>'');
 integer has_property_st       := count(group,ds_d.property_st<>'');
 integer has_property_zip      := count(group,ds_d.property_zip<>'');
 integer has_owner_street      := count(group,ds_d.owner_street<>'');
 integer has_owner_city        := count(group,ds_d.owner_city<>'');
 integer has_owner_st          := count(group,ds_d.owner_st<>'');
 integer has_owner_zip         := count(group,ds_d.owner_zip<>'');
 integer has_owner1            := count(group,ds_d.owner1<>'');
 integer has_owner2            := count(group,ds_d.owner2<>'');
 integer has_seller1           := count(group,ds_d.seller1<>'');
 integer has_seller2           := count(group,ds_d.seller2<>'');
 integer has_document_type     := count(group,ds_d.document_type<>'');
 integer has_document_number   := count(group,ds_d.document_number<>'');
 integer has_recorder_book     := count(group,ds_d.recorder_book<>'');
 integer has_recorder_page     := count(group,ds_d.recorder_page<>'');
 integer has_recording_date    := count(group,ds_d.recording_date<>'');
 integer has_sale_date         := count(group,ds_d.sale_date<>'');
 integer has_sales_price       := count(group,ds_d.sales_price<>'');
 integer has_loan_amount       := count(group,ds_d.loan_amount<>'');
 integer has_interest_rate     := count(group,ds_d.interest_rate<>'');
 integer has_term              := count(group,ds_d.term<>'');
 integer has_term_ind          := count(group,ds_d.term_ind<>'');
 integer has_lender            := count(group,ds_d.lender<>'');
 integer has_rate_change       := count(group,ds_d.rate_change<>'');
 integer has_title_company     := count(group,ds_d.title_company<>'');
 integer has_type_financing    := count(group,ds_d.type_financing<>'');
 integer has_adjustable_index  := count(group,ds_d.adjustable_index<>'');
 integer has_change_index      := count(group,ds_d.change_index<>'');
 integer has_due_date          := count(group,ds_d.due_date<>'');
 integer has_lender_type       := count(group,ds_d.lender_type<>'');
 integer has_loan_type         := count(group,ds_d.loan_type<>'');
 integer has_property_use      := count(group,ds_d.property_use<>'');
 integer has_land_use          := count(group,ds_d.land_use<>'');
 integer has_lot_size          := count(group,ds_d.lot_size<>'');
 integer has_legal_description := count(group,ds_d.legal_description<>'');
end;

r_t := record
 ds_t.record_type;
 integer total_group                    := count(group);
 //string1	record_type:='T';
 integer has_main_adl	                := count(group,(integer)ds_t.main_adl<>0);
 integer has_state                      := count(group,ds_t.state<>'');
 integer has_county                     := count(group,ds_t.county<>'');
 integer has_apn	                    := count(group,ds_t.apn<>'');
 integer has_property_street            := count(group,ds_t.property_street<>'');
 integer has_property_city              := count(group,ds_t.property_city<>'');
 integer has_property_st                := count(group,ds_t.property_st<>'');
 integer has_property_zip               := count(group,ds_t.property_zip<>'');
 integer has_owner_street               := count(group,ds_t.owner_street<>'');
 integer has_owner_city                 := count(group,ds_t.owner_city<>'');
 integer has_owner_st                   := count(group,ds_t.owner_st<>'');
 integer has_owner_zip                  := count(group,ds_t.owner_zip<>'');
 integer has_owner1	                    := count(group,ds_t.owner1<>'');
 integer has_owner2	                    := count(group,ds_t.owner2<>'');
 integer has_tax_year	                := count(group,ds_t.tax_year<>'');
 integer has_tax_amount	                := count(group,ds_t.tax_amount<>'');
 integer has_total_assessed_value	    := count(group,ds_t.total_assessed_value<>'');
 integer has_assessed_improvement_value	:= count(group,ds_t.assessed_improvement_value<>'');
 integer has_assessed_land_value	    := count(group,ds_t.assessed_land_value<>'');
 integer has_assessment_year	        := count(group,ds_t.assessment_year<>'');
 integer has_total_market_value	        := count(group,ds_t.total_market_value<>'');
 integer has_market_improvement_value   := count(group,ds_t.market_improvement_value<>'');
 integer has_market_land_value	        := count(group,ds_t.market_land_value<>'');
 integer has_market_value_year	        := count(group,ds_t.market_value_year<>'');
 integer has_recorder_book	            := count(group,ds_t.recorder_book<>'');
 integer has_recorder_page	            := count(group,ds_t.recorder_page<>'');
 integer has_document_number	        := count(group,ds_t.document_number<>'');
 integer has_document_type	            := count(group,ds_t.document_type<>'');
 integer has_recording_date	            := count(group,ds_t.recording_date<>'');
 integer has_sale_date	                := count(group,ds_t.sale_date<>'');
 integer has_sale_price	                := count(group,ds_t.sale_price<>'');
 integer has_exemption	                := count(group,ds_t.exemption<>'');
 integer has_land_use	                := count(group,ds_t.land_use<>'');
 integer has_legal_description	        := count(group,ds_t.legal_description<>'');
 integer has_subdivision_name	        := count(group,ds_t.subdivision_name<>'');
 integer has_year_built	                := count(group,ds_t.year_built<>'');
 integer has_stories	                := count(group,ds_t.stories<>'');
 integer has_bedrooms	                := count(group,ds_t.bedrooms<>'');
 integer has_baths	                    := count(group,ds_t.baths<>'');
 integer has_total_rooms	            := count(group,ds_t.total_rooms<>'');
 integer has_fireplace_indicator        := count(group,ds_t.fireplace_indicator<>'');
 integer has_garage_type	            := count(group,ds_t.garage_type<>'');
 integer has_garage_size  	            := count(group,ds_t.garage_size<>'');
 integer has_pool_spa	                := count(group,ds_t.pool_spa<>'');
 integer has_style	                    := count(group,ds_t.style<>'');
 integer has_air_conditioning	        := count(group,ds_t.air_conditioning<>'');
 integer has_heating	                := count(group,ds_t.heating<>'');
 integer has_construction	            := count(group,ds_t.construction<>'');
 integer has_basement	                := count(group,ds_t.basement<>'');
 integer has_exterior_walls	            := count(group,ds_t.exterior_walls<>'');
 integer has_foundation	                := count(group,ds_t.foundation<>'');
 integer has_roof	                    := count(group,ds_t.roof<>'');
 integer has_elevator	                := count(group,ds_t.elevator<>'');
 integer has_property_lot_size	        := count(group,ds_t.property_lot_size<>'');
 integer has_building_area	            := count(group,ds_t.building_area<>'');
end;

t_m := output(table(ds_m,r_m,record_type,few),named('field_populations_main'));
t_r := output(table(ds_r,r_r,record_type,few),named('field_populations_relatives'));
t_a := output(table(ds_a,r_a,record_type,few),named('field_populations_old_addresses'));
t_d := output(table(ds_d,r_d,record_type,few),named('field_populations_deeds'));
t_t := output(table(ds_t,r_t,record_type,few),named('field_populations_tax'));

export field_populations := parallel(t_m,t_r,t_a,t_d,t_t);