fccfile := fcc.File_FCC_licenses_in;

// Count blank fields 
layout_fcc_slim := record
fccfile.license_type;
fccfile.file_number;
fccfile.callsign_of_license;
fccfile.radio_service_code;
fccfile.licensees_name;
fccfile.licensees_attention_line;
fccfile.DBA_name;
fccfile.licensees_street;
fccfile.licensees_city;
fccfile.licensees_state;
fccfile.licensees_zip;
fccfile.licensees_phone;
fccfile.date_application_received_at_FCC;
fccfile.date_license_issued;
fccfile.date_license_expires;
fccfile.date_of_last_change;
fccfile.type_of_last_change;
fccfile.latitude;
fccfile.longitude;
fccfile.transmitters_street;
fccfile.transmitters_city;
fccfile.transmitters_county;
fccfile.transmitters_state;
fccfile.transmitters_antenna_height;
fccfile.transmitters_height_above_avg_terra;
fccfile.transmitters_height_above_ground_le;
fccfile.power_of_this_frequency;
fccfile.frequency_Mhz;
fccfile.class_of_station;
fccfile.number_of_units_authorized_on_freq;
fccfile.effective_radiated_power;
fccfile.emissions_codes;
fccfile.frequency_coordination_number;
fccfile.paging_license_status;
fccfile.control_point_for_the_system;
fccfile.pending_or_granted;
fccfile.firm_preparing_application;
fccfile.contact_firms_street_address;
fccfile.contact_firms_city;
fccfile.contact_firms_state;
fccfile.contact_firms_zipcode;
fccfile.contact_firms_phone_number;
fccfile.contact_firms_fax_number;
fccfile.unique_key;
end;

fcc_slim := table(fccfile, layout_fcc_slim);

layout_fcc_stat := record
fcc_slim.license_type;
file_number_count := count(group, fcc_slim.file_number = '');
callsign_of_license_count := count(group, fcc_slim.callsign_of_license = '');
radio_service_code_count := count(group, fcc_slim.radio_service_code = '');
licensees_name_count := count(group, fcc_slim.licensees_name = '');
licensees_attention_line_count := count(group, fcc_slim.licensees_attention_line = '');
DBA_name_count := count(group, fcc_slim.DBA_name = '');
licensees_street_count := count(group, fcc_slim.licensees_street = '');
licensees_city_count := count(group, fcc_slim.licensees_city = '');
licensees_state_count := count(group, fcc_slim.licensees_state = '');
licensees_zip_count := count(group, fcc_slim.licensees_zip = '');
licensees_phone_count := count(group, fcc_slim.licensees_phone = '');
date_application_received_at_FCC_count := count(group, fcc_slim.date_application_received_at_FCC = '');
date_license_issued_count := count(group, fcc_slim.date_license_issued = '');
date_license_expires_count := count(group, fcc_slim.date_license_expires = '');
date_of_last_change_count := count(group, fcc_slim.date_of_last_change = '');
type_of_last_change_count := count(group, fcc_slim.type_of_last_change = '');
latitude_count := count(group, fcc_slim.latitude = '');
longitude_count := count(group, fcc_slim.longitude = '');
transmitters_street_count := count(group, fcc_slim.transmitters_street = '');
transmitters_city_count := count(group, fcc_slim.transmitters_city = '');
transmitters_county_count := count(group, fcc_slim.transmitters_county = '');
transmitters_state_count := count(group, fcc_slim.transmitters_state = '');
transmitters_antenna_height_count := count(group, fcc_slim.transmitters_antenna_height = '');
transmitters_height_above_avg_terra_count := count(group, fcc_slim.transmitters_height_above_avg_terra = '');
transmitters_height_above_ground_le_count := count(group, fcc_slim.transmitters_height_above_ground_le = '');
power_of_this_frequency_count := count(group, fcc_slim.power_of_this_frequency = '');
frequency_Mhz_count := count(group, fcc_slim.frequency_Mhz = '');
class_of_station_count := count(group, fcc_slim.class_of_station = '');
number_of_units_authorized_on_freq_count := count(group, fcc_slim.number_of_units_authorized_on_freq = '');
effective_radiated_power_count := count(group, fcc_slim.effective_radiated_power = '');
emissions_codes_count := count(group, fcc_slim.emissions_codes = '');
frequency_coordination_number_count := count(group, fcc_slim.frequency_coordination_number = '');
paging_license_status_count := count(group, fcc_slim.paging_license_status = '');
control_point_for_the_system_count := count(group, fcc_slim.control_point_for_the_system = '');
pending_or_granted_count := count(group, fcc_slim.pending_or_granted = '');
firm_preparing_application_count := count(group, fcc_slim.firm_preparing_application = '');
contact_firms_street_address_count := count(group, fcc_slim.contact_firms_street_address = '');
contact_firms_city_count := count(group, fcc_slim.contact_firms_city = '');
contact_firms_state_count := count(group, fcc_slim.contact_firms_state = '');
contact_firms_zipcode_count := count(group, fcc_slim.contact_firms_zipcode = '');
contact_firms_phone_number_count := count(group, fcc_slim.contact_firms_phone_number = '');
contact_firms_fax_number_count := count(group, fcc_slim.contact_firms_fax_number = '');
unique_key_count := count(group, fcc_slim.unique_key = '');
cnt := count(group);
end;

fcc_stats := table(fcc_slim, layout_fcc_stat, license_type, few);

count(fcc_stats);  // number of unique bdids
output(fcc_stats, all);
