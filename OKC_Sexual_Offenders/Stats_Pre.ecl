#workunit('name','Prerun Stats for Digs Sex Offenders')
import ut;

in_file := File_OKC_Sex_Offender_In;

Layout_out1 := record
	OKC_Sexual_Offenders.Layout_OKC_Fixed;
	//unsigned8 fpos;
end;

Layout_out1 transRegAddr(in_file l) := transform
	self.source_file := l.source;
	self.scrape_date := l.date_updated;
	self.orig_state := l.state_of_origin;
	self := l;
end;

digs := project(in_file, transRegAddr(left));

dslayout := RECORD
,maxLength(9999)
  string source_file;
  string scrape_date;
  string orig_state;
  string name_orig;
  string name_aka;
  string offender_status;
  string offender_category;
  string risk_level_code;
  string risk_description;
  string police_agency;
  string police_agency_contact_name;
  string police_agency_address_1;
  string police_agency_address_2;
  string police_agency_phone;
  string registration_type;
  string reg_date_1;
  string reg_date_1_type;
  string reg_date_2;
  string reg_date_2_type;
  string reg_date_3;
  string reg_date_3_type;
  string registration_address_1;
  string registration_address_2;
  string registration_address_3;
  string registration_address_4;
  string registration_address_5;
  string registration_county;
  string employer;
  string employer_address_1;
  string employer_address_2;
  string employer_address_3;
  string employer_address_4;
  string employer_address_5;
  string employer_county;
  string school;
  string school_address_1;
  string school_address_2;
  string school_address_3;
  string school_address_4;
  string school_address_5;
  string school_county;
  string offender_id;
  string doc_number;
  string sor_number;
  string st_id_number;
  string fbi_number;
  string ncic_number;
  string orig_ssn;
  string date_of_birth;
  string date_of_birth_aka;
  string age;
  string race;
  string ethnicity;
  string sex;
  string hair_color;
  string eye_color;
  string height;
  string weight;
  string skin_tone;
  string build_type;
  string scars_marks_tattoos;
  string shoe_size;
  string corrective_lense_flag;
  string conviction_jurisdiction_1;
  string conviction_date_1;
  string court_1;
  string court_case_number_1;
  string offense_date_1;
  string offense_code_or_statute_1;
  string offense_description_1;
  string offense_description_1_2;
  string victim_minor_1;
  string victim_age_1;
  string victim_gender_1;
  string victim_relationship_1;
  string sentence_description_1;
  string sentence_description_1_2;
  string conviction_jurisdiction_2;
  string conviction_date_2;
  string court_2;
  string court_case_number_2;
  string offense_date_2;
  string offense_code_or_statute_2;
  string offense_description_2;
  string offense_description_2_2;
  string victim_minor_2;
  string victim_age_2;
  string victim_gender_2;
  string victim_relationship_2;
  string sentence_description_2;
  string sentence_description_2_2;
  string conviction_jurisdiction_3;
  string conviction_date_3;
  string court_3;
  string court_case_number_3;
  string offense_date_3;
  string offense_code_or_statute_3;
  string offense_description_3;
  string offense_description_3_2;
  string victim_minor_3;
  string victim_age_3;
  string victim_gender_3;
  string victim_relationship_3;
  string sentence_description_3;
  string sentence_description_3_2;
  string conviction_jurisdiction_4;
  string conviction_date_4;
  string court_4;
  string court_case_number_4;
  string offense_date_4;
  string offense_code_or_statute_4;
  string offense_description_4;
  string offense_description_4_2;
  string victim_minor_4;
  string victim_age_4;
  string victim_gender_4;
  string victim_relationship_4;
  string sentence_description_4;
  string sentence_description_4_2;
  string conviction_jurisdiction_5;
  string conviction_date_5;
  string court_5;
  string court_case_number_5;
  string offense_date_5;
  string offense_code_or_statute_5;
  string offense_description_5;
  string offense_description_5_2;
  string victim_minor_5;
  string victim_age_5;
  string victim_gender_5;
  string victim_relationship_5;
  string sentence_description_5;
  string sentence_description_5_2;
  string addl_comments_1;
  string addl_comments_2;
  string orig_dl_number;
  string orig_dl_state;
  string orig_veh_year_1;
  string orig_veh_color_1;
  string orig_veh_make_model_1;
  string orig_veh_plate_1;
  string orig_veh_state_1;
  string orig_veh_year_2;
  string orig_veh_color_2;
  string orig_veh_make_model_2;
  string orig_veh_plate_2;
  string orig_veh_state_2;
  string image_link;
  string image_date;
 END;

/*ds_va := dataset(ut.foreign_prod+'~thor_200::in::okc_sex_off::va::superfile',dslayout,flat);

Layout_out1 standardForm(ds_va l):= transform
	self.date_added:='';
	self.intnet_email_address_1:='';
	self.intnet_email_address_2:='';
	self.intnet_email_address_3:='';
	self.intnet_email_address_4:='';
	self.intnet_email_address_5:='';
	self.intnet_instant_message_addr_1:='';
	self.intnet_instant_message_addr_2:='';
	self.intnet_instant_message_addr_3:='';
	self.intnet_instant_message_addr_4:='';
	self.intnet_instant_message_addr_5:='';
	self.intnet_user_name_1:='';
	self.intnet_user_name_1_url:='';
	self.intnet_user_name_2:='';
	self.intnet_user_name_2_url:='';
	self.intnet_user_name_3:='';
	self.intnet_user_name_3_url:='';
	self.intnet_user_name_4:='';
	self.intnet_user_name_4_url:='';
	self.intnet_user_name_5:='';
	self.intnet_user_name_5_url:='';
	self.registration_home_phone:='';
	self.registration_cell_phone:='';
	self.other_registration_address_1:='';
	self.other_registration_address_2:='';
	self.other_registration_address_3:='';
	self.other_registration_address_4:='';
	self.other_registration_address_5:='';
	self.other_registration_county:='';
	self.other_registration_phone:='';
	self.temp_lodge_address_1:='';
	self.temp_lodge_address_2:='';
	self.temp_lodge_address_3:='';
	self.temp_lodge_address_4:='';
	self.temp_lodge_address_5:='';
	self.temp_lodge_county:='';
	self.temp_lodge_phone:='';
	self.employer_phone:='';
	self.employer_comments:='';
	self.professional_licenses_1:='';
	self.professional_licenses_2:='';
	self.professional_licenses_3:='';
	self.professional_licenses_4:='';
	self.professional_licenses_5:='';
	self.school_phone:='';
	self.school_comments:='';
	self.dna:='';
	self.arrest_date_1:='';
	self.arrest_warrant_1:='';
	self.arrest_date_2:='';
	self.arrest_warrant_2:='';
	self.arrest_date_3:='';
	self.arrest_warrant_3:='';
	self.arrest_date_4:='';
	self.arrest_warrant_4:='';
	self.arrest_date_5:='';
	self.arrest_warrant_5:='';
	self.orig_dl_link:='';
	self.orig_dl_date:='';
	self.passport_type:='';
	self.passport_code:='';
	self.passport_number:='';
	self.passport_first_name:='';
	self.passport_given_name:='';
	self.passport_nationality:='';
	self.passport_dob:='';
	self.passport_place_of_birth:='';
	self.passport_sex:='';
	self.passport_issue_date:='';
	self.passport_authority:='';
	self.passport_expiration_date:='';
	self.passport_endorsement:='';
	self.passport_link:='';
	self.passport_date:='';
	self.orig_registration_number_1:='';
	self.orig_veh_location_1:='';
	self.orig_registration_number_2:='';
	self.orig_veh_location_2:='';
	self.orig_veh_year_3:='';
	self.orig_veh_color_3:='';
	self.orig_veh_make_model_3:='';
	self.orig_veh_plate_3:='';
	self.orig_registration_number_3:='';
	self.orig_veh_state_3:='';
	self.orig_veh_location_3:='';
	self.orig_veh_year_4:='';
	self.orig_veh_color_4:='';
	self.orig_veh_make_model_4:='';
	self.orig_veh_plate_4:='';
	self.orig_registration_number_4:='';
	self.orig_veh_state_4:='';
	self.orig_veh_location_4:='';
	self.orig_veh_year_5:='';
	self.orig_veh_color_5:='';
	self.orig_veh_make_model_5:='';
	self.orig_veh_plate_5:='';
	self.orig_registration_number_5:='';
	self.orig_veh_state_5:='';
	self.orig_veh_location_5:='';
	self.fingerprint_link:='';
	self.fingerprint_date:='';
	self.palmprint_link:='';
	self.palmprint_date:='';
	self := l;
end;

okc_va := project(ds_va, standardForm(left)); */

//ds_co := dataset(ut.foreign_prod+'~thor_200::in::okc_sex_off::co::superfile',dslayout,flat);
//okc_co := project(ds_co, standardForm(left));

okc := digs; //+ okc_va;// + okc_co;

Layout_okc_stat :=
record
    okc.orig_state;
    okc.source_file;
	integer4 total := count(group);
	integer4 date_added:= sum(group, if(okc.date_added<> '',1,0));
	integer4 scrape_date:= sum(group, if(okc.scrape_date<> '',1,0));
	integer4 orig_state_count:= sum(group, if(okc.orig_state<> '',1,0));
	integer4 name_orig:= sum(group, if(okc.name_orig<> '',1,0));
	integer4 name_aka:= sum(group, if(okc.name_aka<> '',1,0));
	integer4 intnet_email_address_1:= sum(group, if(okc.intnet_email_address_1<> '',1,0));
	integer4 intnet_email_address_2:= sum(group, if(okc.intnet_email_address_2<> '',1,0));
	integer4 intnet_email_address_3:= sum(group, if(okc.intnet_email_address_3<> '',1,0));
	integer4 intnet_email_address_4:= sum(group, if(okc.intnet_email_address_4<> '',1,0));
	integer4 intnet_email_address_5:= sum(group, if(okc.intnet_email_address_5<> '',1,0));
	integer4 intnet_instant_message_addr_1:= sum(group, if(okc.intnet_instant_message_addr_1<> '',1,0));
	integer4 intnet_instant_message_addr_2:= sum(group, if(okc.intnet_instant_message_addr_2<> '',1,0));
	integer4 intnet_instant_message_addr_3:= sum(group, if(okc.intnet_instant_message_addr_3<> '',1,0));
	integer4 intnet_instant_message_addr_4:= sum(group, if(okc.intnet_instant_message_addr_4<> '',1,0));
	integer4 intnet_instant_message_addr_5:= sum(group, if(okc.intnet_instant_message_addr_5<> '',1,0));
	integer4 intnet_user_name_1:= sum(group, if(okc.intnet_user_name_1<> '',1,0));
	integer4 intnet_user_name_1_url:= sum(group, if(okc.intnet_user_name_1_url<> '',1,0));
	integer4 intnet_user_name_2:= sum(group, if(okc.intnet_user_name_2<> '',1,0));
	integer4 intnet_user_name_2_url:= sum(group, if(okc.intnet_user_name_2_url<> '',1,0));
	integer4 intnet_user_name_3:= sum(group, if(okc.intnet_user_name_3<> '',1,0));
	integer4 intnet_user_name_3_url:= sum(group, if(okc.intnet_user_name_3_url<> '',1,0));
	integer4 intnet_user_name_4:= sum(group, if(okc.intnet_user_name_4<> '',1,0));
	integer4 intnet_user_name_4_url:= sum(group, if(okc.intnet_user_name_4_url<> '',1,0));
	integer4 intnet_user_name_5:= sum(group, if(okc.intnet_user_name_5<> '',1,0));
	integer4 intnet_user_name_5_url:= sum(group, if(okc.intnet_user_name_5_url<> '',1,0));
	integer4 offender_status:= sum(group, if(okc.offender_status<> '',1,0));
	integer4 offender_category:= sum(group, if(okc.offender_category<> '',1,0));
	integer4 risk_level_code:= sum(group, if(okc.risk_level_code<> '',1,0));
	integer4 risk_description:= sum(group, if(okc.risk_description<> '',1,0));
	integer4 police_agency:= sum(group, if(okc.police_agency<> '',1,0));
	integer4 police_agency_contact_name:= sum(group, if(okc.police_agency_contact_name<> '',1,0));
	integer4 police_agency_address_1:= sum(group, if(okc.police_agency_address_1<> '',1,0));
	integer4 police_agency_address_2:= sum(group, if(okc.police_agency_address_2<> '',1,0));
	integer4 police_agency_phone:= sum(group, if(okc.police_agency_phone<> '',1,0));
	integer4 registration_type:= sum(group, if(okc.registration_type<> '',1,0));
	integer4 reg_date_1:= sum(group, if(okc.reg_date_1<> '',1,0));
	integer4 reg_date_1_type:= sum(group, if(okc.reg_date_1_type<> '',1,0));
	integer4 reg_date_2:= sum(group, if(okc.reg_date_2<> '',1,0));
	integer4 reg_date_2_type:= sum(group, if(okc.reg_date_2_type<> '',1,0));
	integer4 reg_date_3:= sum(group, if(okc.reg_date_3<> '',1,0));
	integer4 reg_date_3_type:= sum(group, if(okc.reg_date_3_type<> '',1,0));
	integer4 registration_address_1:= sum(group, if(okc.registration_address_1<> '',1,0));
	integer4 registration_address_2:= sum(group, if(okc.registration_address_2<> '',1,0));
	integer4 registration_address_3:= sum(group, if(okc.registration_address_3<> '',1,0));
	integer4 registration_address_4:= sum(group, if(okc.registration_address_4<> '',1,0));
	integer4 registration_address_5:= sum(group, if(okc.registration_address_5<> '',1,0));
	integer4 registration_county:= sum(group, if(okc.registration_county<> '',1,0));
	integer4 registration_home_phone:= sum(group, if(okc.registration_home_phone<> '',1,0));
	integer4 registration_cell_phone:= sum(group, if(okc.registration_cell_phone<> '',1,0));
	integer4 other_registration_address_1:= sum(group, if(okc.other_registration_address_1<> '',1,0));
	integer4 other_registration_address_2:= sum(group, if(okc.other_registration_address_2<> '',1,0));
	integer4 other_registration_address_3:= sum(group, if(okc.other_registration_address_3<> '',1,0));
	integer4 other_registration_address_4:= sum(group, if(okc.other_registration_address_4<> '',1,0));
	integer4 other_registration_address_5:= sum(group, if(okc.other_registration_address_5<> '',1,0));
	integer4 other_registration_county:= sum(group, if(okc.other_registration_county<> '',1,0));
	integer4 other_registration_phone:= sum(group, if(okc.other_registration_phone<> '',1,0));
	integer4 temp_lodge_address_1:= sum(group, if(okc.temp_lodge_address_1<> '',1,0));
	integer4 temp_lodge_address_2:= sum(group, if(okc.temp_lodge_address_2<> '',1,0));
	integer4 temp_lodge_address_3:= sum(group, if(okc.temp_lodge_address_3<> '',1,0));
	integer4 temp_lodge_address_4:= sum(group, if(okc.temp_lodge_address_4<> '',1,0));
	integer4 temp_lodge_address_5:= sum(group, if(okc.temp_lodge_address_5<> '',1,0));
	integer4 temp_lodge_county:= sum(group, if(okc.temp_lodge_county<> '',1,0));
	integer4 temp_lodge_phone:= sum(group, if(okc.temp_lodge_phone<> '',1,0));
	integer4 employer:= sum(group, if(okc.employer<> '',1,0));
	integer4 employer_address_1:= sum(group, if(okc.employer_address_1<> '',1,0));
	integer4 employer_address_2:= sum(group, if(okc.employer_address_2<> '',1,0));
	integer4 employer_address_3:= sum(group, if(okc.employer_address_3<> '',1,0));
	integer4 employer_address_4:= sum(group, if(okc.employer_address_4<> '',1,0));
	integer4 employer_address_5:= sum(group, if(okc.employer_address_5<> '',1,0));
	integer4 employer_county:= sum(group, if(okc.employer_county<> '',1,0));
	integer4 employer_phone:= sum(group, if(okc.employer_phone<> '',1,0));
	integer4 employer_comments:= sum(group, if(okc.employer_comments<> '',1,0));
	integer4 professional_licenses_1:= sum(group, if(okc.professional_licenses_1<> '',1,0));
	integer4 professional_licenses_2:= sum(group, if(okc.professional_licenses_2<> '',1,0));
	integer4 professional_licenses_3:= sum(group, if(okc.professional_licenses_3<> '',1,0));
	integer4 professional_licenses_4:= sum(group, if(okc.professional_licenses_4<> '',1,0));
	integer4 professional_licenses_5:= sum(group, if(okc.professional_licenses_5<> '',1,0));
	integer4 school:= sum(group, if(okc.school<> '',1,0));
	integer4 school_address_1:= sum(group, if(okc.school_address_1<> '',1,0));
	integer4 school_address_2:= sum(group, if(okc.school_address_2<> '',1,0));
	integer4 school_address_3:= sum(group, if(okc.school_address_3<> '',1,0));
	integer4 school_address_4:= sum(group, if(okc.school_address_4<> '',1,0));
	integer4 school_address_5:= sum(group, if(okc.school_address_5<> '',1,0));
	integer4 school_county:= sum(group, if(okc.school_county<> '',1,0));
	integer4 school_phone:= sum(group, if(okc.school_phone<> '',1,0));
	integer4 school_comments:= sum(group, if(okc.school_comments<> '',1,0));
	integer4 offender_id:= sum(group, if(okc.offender_id<> '',1,0));
	integer4 doc_number:= sum(group, if(okc.doc_number<> '',1,0));
	integer4 sor_number:= sum(group, if(okc.sor_number<> '',1,0));
	integer4 st_id_number:= sum(group, if(okc.st_id_number<> '',1,0));
	integer4 fbi_number:= sum(group, if(okc.fbi_number<> '',1,0));
	integer4 ncic_number:= sum(group, if(okc.ncic_number<> '',1,0));
	integer4 orig_ssn:= sum(group, if(okc.orig_ssn<> '',1,0));
	integer4 date_of_birth:= sum(group, if(okc.date_of_birth<> '',1,0));
	integer4 date_of_birth_aka:= sum(group, if(okc.date_of_birth_aka<> '',1,0));
	integer4 age:= sum(group, if(okc.age<> '',1,0));
	integer4 dna:= sum(group, if(okc.dna<> '',1,0));
	integer4 race:= sum(group, if(okc.race<> '',1,0));
	integer4 ethnicity:= sum(group, if(okc.ethnicity<> '',1,0));
	integer4 sex:= sum(group, if(okc.sex<> '',1,0));
	integer4 hair_color:= sum(group, if(okc.hair_color<> '',1,0));
	integer4 eye_color:= sum(group, if(okc.eye_color<> '',1,0));
	integer4 height:= sum(group, if(okc.height<> '',1,0));
	integer4 weight:= sum(group, if(okc.weight<> '',1,0));
	integer4 skin_tone:= sum(group, if(okc.skin_tone<> '',1,0));
	integer4 build_type:= sum(group, if(okc.build_type<> '',1,0));
	integer4 scars_marks_tattoos:= sum(group, if(okc.scars_marks_tattoos<> '',1,0));
	integer4 shoe_size:= sum(group, if(okc.shoe_size<> '',1,0));
	integer4 corrective_lense_flag:= sum(group, if(okc.corrective_lense_flag<> '',1,0));
	integer4 arrest_date_1:= sum(group, if(okc.arrest_date_1<> '',1,0));
	integer4 arrest_warrant_1:= sum(group, if(okc.arrest_warrant_1<> '',1,0));
	integer4 conviction_jurisdiction_1:= sum(group, if(okc.conviction_jurisdiction_1<> '',1,0));
	integer4 conviction_date_1:= sum(group, if(okc.conviction_date_1<> '',1,0));
	integer4 court_1:= sum(group, if(okc.court_1<> '',1,0));
	integer4 court_case_number_1:= sum(group, if(okc.court_case_number_1<> '',1,0));
	integer4 offense_date_1:= sum(group, if(okc.offense_date_1<> '',1,0));
	integer4 offense_code_or_statute_1:= sum(group, if(okc.offense_code_or_statute_1<> '',1,0));
	integer4 offense_description_1:= sum(group, if(okc.offense_description_1<> '',1,0));
	integer4 offense_description_1_2:= sum(group, if(okc.offense_description_1_2<> '',1,0));
	integer4 victim_minor_1:= sum(group, if(okc.victim_minor_1<> '',1,0));
	integer4 victim_age_1:= sum(group, if(okc.victim_age_1<> '',1,0));
	integer4 victim_gender_1:= sum(group, if(okc.victim_gender_1<> '',1,0));
	integer4 victim_relationship_1:= sum(group, if(okc.victim_relationship_1<> '',1,0));
	integer4 sentence_description_1:= sum(group, if(okc.sentence_description_1<> '',1,0));
	integer4 sentence_description_1_2:= sum(group, if(okc.sentence_description_1_2<> '',1,0));
	integer4 arrest_date_2:= sum(group, if(okc.arrest_date_2<> '',1,0));
	integer4 arrest_warrant_2:= sum(group, if(okc.arrest_warrant_2<> '',1,0));
	integer4 conviction_jurisdiction_2:= sum(group, if(okc.conviction_jurisdiction_2<> '',1,0));
	integer4 conviction_date_2:= sum(group, if(okc.conviction_date_2<> '',1,0));
	integer4 court_2:= sum(group, if(okc.court_2<> '',1,0));
	integer4 court_case_number_2:= sum(group, if(okc.court_case_number_2<> '',1,0));
	integer4 offense_date_2:= sum(group, if(okc.offense_date_2<> '',1,0));
	integer4 offense_code_or_statute_2:= sum(group, if(okc.offense_code_or_statute_2<> '',1,0));
	integer4 offense_description_2:= sum(group, if(okc.offense_description_2<> '',1,0));
	integer4 offense_description_2_2:= sum(group, if(okc.offense_description_2_2<> '',1,0));
	integer4 victim_minor_2:= sum(group, if(okc.victim_minor_2<> '',1,0));
	integer4 victim_age_2:= sum(group, if(okc.victim_age_2<> '',1,0));
	integer4 victim_gender_2:= sum(group, if(okc.victim_gender_2<> '',1,0));
	integer4 victim_relationship_2:= sum(group, if(okc.victim_relationship_2<> '',1,0));
	integer4 sentence_description_2:= sum(group, if(okc.sentence_description_2<> '',1,0));
	integer4 sentence_description_2_2:= sum(group, if(okc.sentence_description_2_2<> '',1,0));
	integer4 arrest_date_3:= sum(group, if(okc.arrest_date_3<> '',1,0));
	integer4 arrest_warrant_3:= sum(group, if(okc.arrest_warrant_3<> '',1,0));
	integer4 conviction_jurisdiction_3:= sum(group, if(okc.conviction_jurisdiction_3<> '',1,0));
	integer4 conviction_date_3:= sum(group, if(okc.conviction_date_3<> '',1,0));
	integer4 court_3:= sum(group, if(okc.court_3<> '',1,0));
	integer4 court_case_number_3:= sum(group, if(okc.court_case_number_3<> '',1,0));
	integer4 offense_date_3:= sum(group, if(okc.offense_date_3<> '',1,0));
	integer4 offense_code_or_statute_3:= sum(group, if(okc.offense_code_or_statute_3<> '',1,0));
	integer4 offense_description_3:= sum(group, if(okc.offense_description_3<> '',1,0));
	integer4 offense_description_3_2:= sum(group, if(okc.offense_description_3_2<> '',1,0));
	integer4 victim_minor_3:= sum(group, if(okc.victim_minor_3<> '',1,0));
	integer4 victim_age_3:= sum(group, if(okc.victim_age_3<> '',1,0));
	integer4 victim_gender_3:= sum(group, if(okc.victim_gender_3<> '',1,0));
	integer4 victim_relationship_3:= sum(group, if(okc.victim_relationship_3<> '',1,0));
	integer4 sentence_description_3:= sum(group, if(okc.sentence_description_3<> '',1,0));
	integer4 sentence_description_3_2:= sum(group, if(okc.sentence_description_3_2<> '',1,0));
	integer4 arrest_date_4:= sum(group, if(okc.arrest_date_4<> '',1,0));
	integer4 arrest_warrant_4:= sum(group, if(okc.arrest_warrant_4<> '',1,0));
	integer4 conviction_jurisdiction_4:= sum(group, if(okc.conviction_jurisdiction_4<> '',1,0));
	integer4 conviction_date_4:= sum(group, if(okc.conviction_date_4<> '',1,0));
	integer4 court_4:= sum(group, if(okc.court_4<> '',1,0));
	integer4 court_case_number_4:= sum(group, if(okc.court_case_number_4<> '',1,0));
	integer4 offense_date_4:= sum(group, if(okc.offense_date_4<> '',1,0));
	integer4 offense_code_or_statute_4:= sum(group, if(okc.offense_code_or_statute_4<> '',1,0));
	integer4 offense_description_4:= sum(group, if(okc.offense_description_4<> '',1,0));
	integer4 offense_description_4_2:= sum(group, if(okc.offense_description_4_2<> '',1,0));
	integer4 victim_minor_4:= sum(group, if(okc.victim_minor_4<> '',1,0));
	integer4 victim_age_4:= sum(group, if(okc.victim_age_4<> '',1,0));
	integer4 victim_gender_4:= sum(group, if(okc.victim_gender_4<> '',1,0));
	integer4 victim_relationship_4:= sum(group, if(okc.victim_relationship_4<> '',1,0));
	integer4 sentence_description_4:= sum(group, if(okc.sentence_description_4<> '',1,0));
	integer4 sentence_description_4_2:= sum(group, if(okc.sentence_description_4_2<> '',1,0));
	integer4 arrest_date_5:= sum(group, if(okc.arrest_date_5<> '',1,0));
	integer4 arrest_warrant_5:= sum(group, if(okc.arrest_warrant_5<> '',1,0));
	integer4 conviction_jurisdiction_5:= sum(group, if(okc.conviction_jurisdiction_5<> '',1,0));
	integer4 conviction_date_5:= sum(group, if(okc.conviction_date_5<> '',1,0));
	integer4 court_5:= sum(group, if(okc.court_5<> '',1,0));
	integer4 court_case_number_5:= sum(group, if(okc.court_case_number_5<> '',1,0));
	integer4 offense_date_5:= sum(group, if(okc.offense_date_5<> '',1,0));
	integer4 offense_code_or_statute_5:= sum(group, if(okc.offense_code_or_statute_5<> '',1,0));
	integer4 offense_description_5:= sum(group, if(okc.offense_description_5<> '',1,0));
	integer4 offense_description_5_2:= sum(group, if(okc.offense_description_5_2<> '',1,0));
	integer4 victim_minor_5:= sum(group, if(okc.victim_minor_5<> '',1,0));
	integer4 victim_age_5:= sum(group, if(okc.victim_age_5<> '',1,0));
	integer4 victim_gender_5:= sum(group, if(okc.victim_gender_5<> '',1,0));
	integer4 victim_relationship_5:= sum(group, if(okc.victim_relationship_5<> '',1,0));
	integer4 sentence_description_5:= sum(group, if(okc.sentence_description_5<> '',1,0));
	integer4 sentence_description_5_2:= sum(group, if(okc.sentence_description_5_2<> '',1,0));
	integer4 addl_comments_1:= sum(group, if(okc.addl_comments_1<> '',1,0));
	integer4 addl_comments_2:= sum(group, if(okc.addl_comments_2<> '',1,0));
	integer4 orig_dl_number:= sum(group, if(okc.orig_dl_number<> '',1,0));
	integer4 orig_dl_state:= sum(group, if(okc.orig_dl_state<> '',1,0));
	integer4 orig_dl_link:= sum(group, if(okc.orig_dl_link<> '',1,0));
	integer4 orig_dl_date:= sum(group, if(okc.orig_dl_date<> '',1,0));
	integer4 passport_type:= sum(group, if(okc.passport_type<> '',1,0));
	integer4 passport_code:= sum(group, if(okc.passport_code<> '',1,0));
	integer4 passport_number:= sum(group, if(okc.passport_number<> '',1,0));
	integer4 passport_first_name:= sum(group, if(okc.passport_first_name<> '',1,0));
	integer4 passport_given_name:= sum(group, if(okc.passport_given_name<> '',1,0));
	integer4 passport_nationality:= sum(group, if(okc.passport_nationality<> '',1,0));
	integer4 passport_dob:= sum(group, if(okc.passport_dob<> '',1,0));
	integer4 passport_place_of_birth:= sum(group, if(okc.passport_place_of_birth<> '',1,0));
	integer4 passport_sex:= sum(group, if(okc.passport_sex<> '',1,0));
	integer4 passport_issue_date:= sum(group, if(okc.passport_issue_date<> '',1,0));
	integer4 passport_authority:= sum(group, if(okc.passport_authority<> '',1,0));
	integer4 passport_expiration_date:= sum(group, if(okc.passport_expiration_date<> '',1,0));
	integer4 passport_endorsement:= sum(group, if(okc.passport_endorsement<> '',1,0));
	integer4 passport_link:= sum(group, if(okc.passport_link<> '',1,0));
	integer4 passport_date:= sum(group, if(okc.passport_date<> '',1,0));
	integer4 orig_veh_year_1:= sum(group, if(okc.orig_veh_year_1<> '',1,0));
	integer4 orig_veh_color_1:= sum(group, if(okc.orig_veh_color_1<> '',1,0));
	integer4 orig_veh_make_model_1:= sum(group, if(okc.orig_veh_make_model_1<> '',1,0));
	integer4 orig_veh_plate_1:= sum(group, if(okc.orig_veh_plate_1<> '',1,0));
	integer4 orig_registration_number_1:= sum(group, if(okc.orig_registration_number_1<> '',1,0));
	integer4 orig_veh_state_1:= sum(group, if(okc.orig_veh_state_1<> '',1,0));
	integer4 orig_veh_location_1:= sum(group, if(okc.orig_veh_location_1<> '',1,0));
	integer4 orig_veh_year_2:= sum(group, if(okc.orig_veh_year_2<> '',1,0));
	integer4 orig_veh_color_2:= sum(group, if(okc.orig_veh_color_2<> '',1,0));
	integer4 orig_veh_make_model_2:= sum(group, if(okc.orig_veh_make_model_2<> '',1,0));
	integer4 orig_veh_plate_2:= sum(group, if(okc.orig_veh_plate_2<> '',1,0));
	integer4 orig_registration_number_2:= sum(group, if(okc.orig_registration_number_2<> '',1,0));
	integer4 orig_veh_state_2:= sum(group, if(okc.orig_veh_state_2<> '',1,0));
	integer4 orig_veh_location_2:= sum(group, if(okc.orig_veh_location_2<> '',1,0));
	integer4 orig_veh_year_3:= sum(group, if(okc.orig_veh_year_3<> '',1,0));
	integer4 orig_veh_color_3:= sum(group, if(okc.orig_veh_color_3<> '',1,0));
	integer4 orig_veh_make_model_3:= sum(group, if(okc.orig_veh_make_model_3<> '',1,0));
	integer4 orig_veh_plate_3:= sum(group, if(okc.orig_veh_plate_3<> '',1,0));
	integer4 orig_registration_number_3:= sum(group, if(okc.orig_registration_number_3<> '',1,0));
	integer4 orig_veh_state_3:= sum(group, if(okc.orig_veh_state_3<> '',1,0));
	integer4 orig_veh_location_3:= sum(group, if(okc.orig_veh_location_3<> '',1,0));
	integer4 orig_veh_year_4:= sum(group, if(okc.orig_veh_year_4<> '',1,0));
	integer4 orig_veh_color_4:= sum(group, if(okc.orig_veh_color_4<> '',1,0));
	integer4 orig_veh_make_model_4:= sum(group, if(okc.orig_veh_make_model_4<> '',1,0));
	integer4 orig_veh_plate_4:= sum(group, if(okc.orig_veh_plate_4<> '',1,0));
	integer4 orig_registration_number_4:= sum(group, if(okc.orig_registration_number_4<> '',1,0));
	integer4 orig_veh_state_4:= sum(group, if(okc.orig_veh_state_4<> '',1,0));
	integer4 orig_veh_location_4:= sum(group, if(okc.orig_veh_location_4<> '',1,0));
	integer4 orig_veh_year_5:= sum(group, if(okc.orig_veh_year_5<> '',1,0));
	integer4 orig_veh_color_5:= sum(group, if(okc.orig_veh_color_5<> '',1,0));
	integer4 orig_veh_make_model_5:= sum(group, if(okc.orig_veh_make_model_5<> '',1,0));
	integer4 orig_veh_plate_5:= sum(group, if(okc.orig_veh_plate_5<> '',1,0));
	integer4 orig_registration_number_5:= sum(group, if(okc.orig_registration_number_5<> '',1,0));
	integer4 orig_veh_state_5:= sum(group, if(okc.orig_veh_state_5<> '',1,0));
	integer4 orig_veh_location_5:= sum(group, if(okc.orig_veh_location_5<> '',1,0));
	integer4 fingerprint_link:= sum(group, if(okc.fingerprint_link<> '',1,0));
	integer4 fingerprint_date:= sum(group, if(okc.fingerprint_date<> '',1,0));
	integer4 palmprint_link:= sum(group, if(okc.palmprint_link<> '',1,0));
	integer4 palmprint_date:= sum(group, if(okc.palmprint_date<> '',1,0));
	integer4 image_link:= sum(group, if(okc.image_link<> '',1,0));
	integer4 image_date:= sum(group, if(okc.image_date<> '',1,0));
end;

okc_stat := table(okc, Layout_okc_stat, orig_state, source_file, few);
output_okc_stat := output(sort(okc_stat,orig_state, source_file), named('okc_field_population_stats'), all);

export Stats_Pre := output_okc_stat;
