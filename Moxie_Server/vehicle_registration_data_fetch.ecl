/*--SOAP--
<message name="vehicle_registration_state_origin_data_fetch">
  <part name="fpos" type="xsd:unsignedInt"/>
  <part name="max_count" type="xsd:integer"/>
  <part name="return_count" type="xsd:integer"/>
</message>
*/

// Generated by def2ecl.pl on Thu Jan 20 13:24:49 GMT 2005

export vehicle_registration_data_fetch := MACRO

// beginning of fill in values
payloadkey_filename := '~thor_data400::key::moxie.mv.fpos.data.key';
datasetlayout := RECORD
  VehLic.Layout_Vehreg_ToMike;
  unsigned integer8 fpos{virtual(fileposition)};
END;
// end of fill in values
#uniquename(fpos)
unsigned8 %fpos% := 0 : STORED('fpos');
INTEGER max_count_value := 10000 : STORED('max_count');
INTEGER return_count_value := 1000 : STORED('return_count');

#uniquename(f)
payloadkey := INDEX(dataset([],datasetlayout),{unsigned8 %f% := fpos},{datasetlayout},payloadkey_filename);

res := payloadkey(
            keyed(%f%=%fpos%)
);

lim_res := LIMIT(res,max_count_value,FAIL(11, doxie.ErrorCodes(11)),keyed);

// data fetch
#uniquename(seq)
DatasetLayout_Sequence :=
RECORD
	UNSIGNED6 %seq% := 1;
	lim_res;
END;
prj_res := TABLE(lim_res,DatasetLayout_Sequence);

output(prj_res)

ENDMACRO;
