EXPORT AsResults(infile) := FUNCTIONMACRO
IMPORT HCSE_SETC_V3_ZERO_MODEL,LUCI;
  Res(DATASET(RECORDOF(infile)) myfile) := MODULE(LUCI.Results)
  IMPORT iesp;
  SHARED RCToMessage(SET OF STRING5 rc) := FUNCTION
    d1 := DATASET(rc,{ STRING5 Code });
    iesp.ins_share_iss.t_InsuranceScoreMessage into(d1 le) := TRANSFORM
      SELF.MessageType := HCSE_SETC_V3_ZERO_MODEL.RCCodes(le.code).GroupType;
      SELF.Description := HCSE_SETC_V3_ZERO_MODEL.RCCodes(le.code).Description;
      SELF.Code := le.code;
    END;
    RETURN PROJECT(d1,into(LEFT));
  END;
    // Simple and quick
  EXPORT BaseF := HCSE_SETC_V3_ZERO_MODEL.AppendAll(myfile,do_Model1,ACCIDENTAGE,ACCIDENTCOUNT,ADDRMOSTRECENTCRIMEDIFF,ADDRMOSTRECENTDISTANCE,ADDRMOSTRECENTINCOMEDIFF,ADDRMOSTRECENTMOVEAGE,ADDRMOSTRECENTVALUEDIFF,ADDRRECENTECONTRAJECTORY,AGEOLDESTRECORD,AGE_IN_YEARS,AG_PRED_10K,AVGSTATECOST,BANKRUPTCYAGE,BP2,BPV2,BUSINESSINPUTADDRCOUNT,CORRELATIONRISKLEVEL,CURRADDRAGELASTSALE,CURRADDRAGEOLDESTRECORD,CURRADDRBURGLARYINDEX,CURRADDRBURGLARYINDEX_12,CURRADDRBURGLARYINDEX_24,CURRADDRCARTHEFTINDEX,CURRADDRCRIMEINDEX,CURRADDRLENOFRES,CURRADDRMEDIANINCOME,CURRADDRMEDIANVALUE,CURRADDRMURDERINDEX,DEROGAGE,DEROGCOUNT,DEROGSEVERITYINDEX,DIVADDRIDENTITYCOUNT,DIVADDRIDENTITYMSOURCECOUNT,DIVADDRSSNCOUNT,DIVADDRSSNMSOURCECOUNT,DIVSSNADDRMSOURCECOUNT,ESTIMATEDANNUALINCOME,ESTIMATEDANNUALINCOME_12,ESTIMATEDANNUALINCOME_24,FELONYAGE,FEMALE,INPUTADDRAGELASTSALE,INPUTADDRAGEOLDESTRECORD,INPUTADDRBURGLARYINDEX,INPUTADDRBUSINESSCOUNT,INPUTADDRCARTHEFTINDEX,INPUTADDRCRIMEINDEX,INPUTADDRERRORCODE,INPUTADDRLENOFRES,INPUTADDRMEDIANINCOME,INPUTADDRMEDIANVALUE,INPUTADDRMOBILITYINDEX,INPUTADDRMULTIFAMILYCOUNT,INPUTADDRMURDERINDEX,INPUTADDRPHONECOUNT,INPUTADDRSICCODE,INPUTADDRSINGLEFAMILYCOUNT,INPUTADDRTAXMARKETVALUE,INPUTADDRTAXVALUE,INPUTADDRVACANTPROPCOUNT,LASTNAMECHANGEAGE,LIENFILEDAGE,LIENRELEASEDAGE,P2,PHONEEDAAGENEWESTRECORD,PHONEEDAAGEOLDESTRECORD,PHONEOTHERAGENEWESTRECORD,PHONEOTHERAGEOLDESTRECORD,PREVADDRAGELASTSALE,PREVADDRAGENEWESTRECORD,PREVADDRAGEOLDESTRECORD,PREVADDRBURGLARYINDEX,PREVADDRCARTHEFTINDEX,PREVADDRCRIMEINDEX,PREVADDRLENOFRES,PREVADDRMEDIANINCOME,PREVADDRMEDIANVALUE,PREVADDRMURDERINDEX,PROPAGENEWESTPURCHASE,PROPAGEOLDESTPURCHASE,PROPTAXPERRELATIVE,PRSEARCHLOCATECOUNT,PRSEARCHLOCATECOUNT24,PRSEARCHOTHERCOUNT,PV2,P_ESTIMATEDHHINCOMEPERCAPITA,RELATIVESCOUNT,RELATIVESPROPOWNEDTAXTOTAL,SEARCHADDRSEARCHCOUNT,SEARCHSSNSEARCHCOUNT,SFDUADDRIDENTITIESCOUNT,SFDUADDRIDENTITIESCOUNT_12,SFDUADDRIDENTITIESCOUNT_24,SFDUADDRSSNCOUNT,SOURCEORDERAGELASTORDER,SOURCEORDERSOURCECOUNT,SSNADDRCOUNT,SSNHIGHISSUEAGE,SSNISSUESTATE,SSNLOWISSUEAGE,ST,SUBJECTADDRCOUNT,SUBJECTSSNCOUNT,V1_CRTRECBKRPTTIMENEWEST,V1_CRTRECCNT,V1_CRTRECFELONYTIMENEWEST,V1_CRTRECLIENJUDGCNT,V1_CRTRECLIENJUDGTIMENEWEST,V1_CRTRECMSDMEANCNT,V1_CRTRECMSDMEANTIMENEWEST,V1_CRTRECTIMENEWEST,V1_HHESTIMATEDINCOMERANGE,V1_LIFEEVTIMEFIRSTASSETPURCHASE,V1_LIFEEVTIMELASTASSETPURCHASE,V1_LIFEEVTIMELASTMOVE,V1_PROSPECTAGE,V1_PROSPECTESTIMATEDINCOMERANGE,V1_PROSPECTTIMELASTUPDATE,V1_PROSPECTTIMEONRECORD,V1_RAACRTRECEVICTIONMMBRCNT,V1_RAACRTRECLIENJUDGMMBRCNT,V1_RAACRTRECMMBRCNT,V1_RAACRTRECMSDMEANMMBRCNT,V1_RAAMMBRCNT,V1_RAAPROPOWNERAVMHIGHEST,V1_RAAPROPOWNERAVMMED,V1_RESINPUTBUSINESSCNT,VOTERREGISTRATIONRECORD);
    BaseLayout TrModel1(BaseF le) := TRANSFORM
      SELF.TransactionId := le.TransactionId;
      SELF.name := 'Model1';
      SELF.description := 'ZERO_SE_Cost_model';
      SELF.Score := (STRING)le.Model1_Score;
      SELF.Messages := RCToMessage(le.Model1_Reasons);
    END;
    Model1AsBase := PROJECT(BaseF(do_Model1),TrModel1(LEFT));
  EXPORT Base() := Model1AsBase;
    // With attributes
  EXPORT AttrF := HCSE_SETC_V3_ZERO_MODEL.AppendAll(myfile,do_Model1,ACCIDENTAGE,ACCIDENTCOUNT,ADDRMOSTRECENTCRIMEDIFF,ADDRMOSTRECENTDISTANCE,ADDRMOSTRECENTINCOMEDIFF,ADDRMOSTRECENTMOVEAGE,ADDRMOSTRECENTVALUEDIFF,ADDRRECENTECONTRAJECTORY,AGEOLDESTRECORD,AGE_IN_YEARS,AG_PRED_10K,AVGSTATECOST,BANKRUPTCYAGE,BP2,BPV2,BUSINESSINPUTADDRCOUNT,CORRELATIONRISKLEVEL,CURRADDRAGELASTSALE,CURRADDRAGEOLDESTRECORD,CURRADDRBURGLARYINDEX,CURRADDRBURGLARYINDEX_12,CURRADDRBURGLARYINDEX_24,CURRADDRCARTHEFTINDEX,CURRADDRCRIMEINDEX,CURRADDRLENOFRES,CURRADDRMEDIANINCOME,CURRADDRMEDIANVALUE,CURRADDRMURDERINDEX,DEROGAGE,DEROGCOUNT,DEROGSEVERITYINDEX,DIVADDRIDENTITYCOUNT,DIVADDRIDENTITYMSOURCECOUNT,DIVADDRSSNCOUNT,DIVADDRSSNMSOURCECOUNT,DIVSSNADDRMSOURCECOUNT,ESTIMATEDANNUALINCOME,ESTIMATEDANNUALINCOME_12,ESTIMATEDANNUALINCOME_24,FELONYAGE,FEMALE,INPUTADDRAGELASTSALE,INPUTADDRAGEOLDESTRECORD,INPUTADDRBURGLARYINDEX,INPUTADDRBUSINESSCOUNT,INPUTADDRCARTHEFTINDEX,INPUTADDRCRIMEINDEX,INPUTADDRERRORCODE,INPUTADDRLENOFRES,INPUTADDRMEDIANINCOME,INPUTADDRMEDIANVALUE,INPUTADDRMOBILITYINDEX,INPUTADDRMULTIFAMILYCOUNT,INPUTADDRMURDERINDEX,INPUTADDRPHONECOUNT,INPUTADDRSICCODE,INPUTADDRSINGLEFAMILYCOUNT,INPUTADDRTAXMARKETVALUE,INPUTADDRTAXVALUE,INPUTADDRVACANTPROPCOUNT,LASTNAMECHANGEAGE,LIENFILEDAGE,LIENRELEASEDAGE,P2,PHONEEDAAGENEWESTRECORD,PHONEEDAAGEOLDESTRECORD,PHONEOTHERAGENEWESTRECORD,PHONEOTHERAGEOLDESTRECORD,PREVADDRAGELASTSALE,PREVADDRAGENEWESTRECORD,PREVADDRAGEOLDESTRECORD,PREVADDRBURGLARYINDEX,PREVADDRCARTHEFTINDEX,PREVADDRCRIMEINDEX,PREVADDRLENOFRES,PREVADDRMEDIANINCOME,PREVADDRMEDIANVALUE,PREVADDRMURDERINDEX,PROPAGENEWESTPURCHASE,PROPAGEOLDESTPURCHASE,PROPTAXPERRELATIVE,PRSEARCHLOCATECOUNT,PRSEARCHLOCATECOUNT24,PRSEARCHOTHERCOUNT,PV2,P_ESTIMATEDHHINCOMEPERCAPITA,RELATIVESCOUNT,RELATIVESPROPOWNEDTAXTOTAL,SEARCHADDRSEARCHCOUNT,SEARCHSSNSEARCHCOUNT,SFDUADDRIDENTITIESCOUNT,SFDUADDRIDENTITIESCOUNT_12,SFDUADDRIDENTITIESCOUNT_24,SFDUADDRSSNCOUNT,SOURCEORDERAGELASTORDER,SOURCEORDERSOURCECOUNT,SSNADDRCOUNT,SSNHIGHISSUEAGE,SSNISSUESTATE,SSNLOWISSUEAGE,ST,SUBJECTADDRCOUNT,SUBJECTSSNCOUNT,V1_CRTRECBKRPTTIMENEWEST,V1_CRTRECCNT,V1_CRTRECFELONYTIMENEWEST,V1_CRTRECLIENJUDGCNT,V1_CRTRECLIENJUDGTIMENEWEST,V1_CRTRECMSDMEANCNT,V1_CRTRECMSDMEANTIMENEWEST,V1_CRTRECTIMENEWEST,V1_HHESTIMATEDINCOMERANGE,V1_LIFEEVTIMEFIRSTASSETPURCHASE,V1_LIFEEVTIMELASTASSETPURCHASE,V1_LIFEEVTIMELASTMOVE,V1_PROSPECTAGE,V1_PROSPECTESTIMATEDINCOMERANGE,V1_PROSPECTTIMELASTUPDATE,V1_PROSPECTTIMEONRECORD,V1_RAACRTRECEVICTIONMMBRCNT,V1_RAACRTRECLIENJUDGMMBRCNT,V1_RAACRTRECMMBRCNT,V1_RAACRTRECMSDMEANMMBRCNT,V1_RAAMMBRCNT,V1_RAAPROPOWNERAVMHIGHEST,V1_RAAPROPOWNERAVMMED,V1_RESINPUTBUSINESSCNT,VOTERREGISTRATIONRECORD);
    AttrLayout TrModel1(AttrF le) := TRANSFORM
      SELF.TransactionId := le.TransactionId;
      SELF.name := 'Model1';
      SELF.description := 'ZERO_SE_Cost_model';
      SELF.Score := (STRING)le.Model1_Score;
      SELF.Messages := RCToMessage(le.Model1_Reasons);
      SELF.Attributes := DATASET([
          {'PHONEOTHERAGEOLDESTRECORD',le.PHONEOTHERAGEOLDESTRECORD},
          {'PHONEEDAAGENEWESTRECORD',le.PHONEEDAAGENEWESTRECORD},
          {'RELATIVESPROPOWNEDTAXTOTAL',le.RELATIVESPROPOWNEDTAXTOTAL},
          {'INPUTADDRBUSINESSCOUNT',le.INPUTADDRBUSINESSCOUNT},
          {'V1_PROSPECTAGE',le.V1_PROSPECTAGE},
          {'V1_RAACRTRECEVICTIONMMBRCNT',le.V1_RAACRTRECEVICTIONMMBRCNT},
          {'SSNISSUESTATE',le.SSNISSUESTATE},
          {'DIVADDRIDENTITYCOUNT',le.DIVADDRIDENTITYCOUNT},
          {'ESTIMATEDANNUALINCOME_24',le.ESTIMATEDANNUALINCOME_24},
          {'LIENFILEDAGE',le.LIENFILEDAGE},
          {'PREVADDRAGENEWESTRECORD',le.PREVADDRAGENEWESTRECORD},
          {'SSNHIGHISSUEAGE',le.SSNHIGHISSUEAGE},
          {'V1_CRTRECCNT',le.V1_CRTRECCNT},
          {'DEROGCOUNT',le.DEROGCOUNT},
          {'PROPAGEOLDESTPURCHASE',le.PROPAGEOLDESTPURCHASE},
          {'PREVADDRMEDIANVALUE',le.PREVADDRMEDIANVALUE},
          {'INPUTADDRMOBILITYINDEX',le.INPUTADDRMOBILITYINDEX},
          {'DIVADDRIDENTITYMSOURCECOUNT',le.DIVADDRIDENTITYMSOURCECOUNT},
          {'SUBJECTSSNCOUNT',le.SUBJECTSSNCOUNT},
          {'SOURCEORDERSOURCECOUNT',le.SOURCEORDERSOURCECOUNT},
          {'BANKRUPTCYAGE',le.BANKRUPTCYAGE},
          {'VOTERREGISTRATIONRECORD',le.VOTERREGISTRATIONRECORD},
          {'CURRADDRCRIMEINDEX',le.CURRADDRCRIMEINDEX},
          {'PREVADDRAGEOLDESTRECORD',le.PREVADDRAGEOLDESTRECORD},
          {'V1_RAAMMBRCNT',le.V1_RAAMMBRCNT},
          {'ESTIMATEDANNUALINCOME',le.ESTIMATEDANNUALINCOME},
          {'PREVADDRCARTHEFTINDEX',le.PREVADDRCARTHEFTINDEX},
          {'SFDUADDRIDENTITIESCOUNT',le.SFDUADDRIDENTITIESCOUNT},
          {'ESTIMATEDANNUALINCOME_12',le.ESTIMATEDANNUALINCOME_12},
          {'FEMALE',le.FEMALE},
          {'ADDRMOSTRECENTVALUEDIFF',le.ADDRMOSTRECENTVALUEDIFF},
          {'V1_CRTRECMSDMEANTIMENEWEST',le.V1_CRTRECMSDMEANTIMENEWEST},
          {'SUBJECTADDRCOUNT',le.SUBJECTADDRCOUNT},
          {'INPUTADDRCARTHEFTINDEX',le.INPUTADDRCARTHEFTINDEX},
          {'PREVADDRAGELASTSALE',le.PREVADDRAGELASTSALE},
          {'BUSINESSINPUTADDRCOUNT',le.BUSINESSINPUTADDRCOUNT},
          {'LIENRELEASEDAGE',le.LIENRELEASEDAGE},
          {'PHONEOTHERAGENEWESTRECORD',le.PHONEOTHERAGENEWESTRECORD},
          {'CURRADDRAGEOLDESTRECORD',le.CURRADDRAGEOLDESTRECORD},
          {'SFDUADDRSSNCOUNT',le.SFDUADDRSSNCOUNT},
          {'AGE_IN_YEARS',le.AGE_IN_YEARS},
          {'CURRADDRBURGLARYINDEX',le.CURRADDRBURGLARYINDEX},
          {'V1_CRTRECLIENJUDGCNT',le.V1_CRTRECLIENJUDGCNT},
          {'V1_RAAPROPOWNERAVMHIGHEST',le.V1_RAAPROPOWNERAVMHIGHEST},
          {'SSNADDRCOUNT',le.SSNADDRCOUNT},
          {'P_ESTIMATEDHHINCOMEPERCAPITA',le.P_ESTIMATEDHHINCOMEPERCAPITA},
          {'PRSEARCHLOCATECOUNT',le.PRSEARCHLOCATECOUNT},
          {'CORRELATIONRISKLEVEL',le.CORRELATIONRISKLEVEL},
          {'V1_RAAPROPOWNERAVMMED',le.V1_RAAPROPOWNERAVMMED},
          {'DIVADDRSSNMSOURCECOUNT',le.DIVADDRSSNMSOURCECOUNT},
          {'AVGSTATECOST',le.AVGSTATECOST},
          {'V1_RESINPUTBUSINESSCNT',le.V1_RESINPUTBUSINESSCNT},
          {'CURRADDRLENOFRES',le.CURRADDRLENOFRES},
          {'ADDRMOSTRECENTINCOMEDIFF',le.ADDRMOSTRECENTINCOMEDIFF},
          {'ST',le.ST},
          {'V1_RAACRTRECMMBRCNT',le.V1_RAACRTRECMMBRCNT},
          {'V1_LIFEEVTIMELASTMOVE',le.V1_LIFEEVTIMELASTMOVE},
          {'PRSEARCHOTHERCOUNT',le.PRSEARCHOTHERCOUNT},
          {'CURRADDRMEDIANVALUE',le.CURRADDRMEDIANVALUE},
          {'SEARCHADDRSEARCHCOUNT',le.SEARCHADDRSEARCHCOUNT},
          {'INPUTADDRCRIMEINDEX',le.INPUTADDRCRIMEINDEX},
          {'INPUTADDRSICCODE',le.INPUTADDRSICCODE},
          {'V1_CRTRECLIENJUDGTIMENEWEST',le.V1_CRTRECLIENJUDGTIMENEWEST},
          {'V1_LIFEEVTIMELASTASSETPURCHASE',le.V1_LIFEEVTIMELASTASSETPURCHASE},
          {'V1_CRTRECTIMENEWEST',le.V1_CRTRECTIMENEWEST},
          {'PREVADDRLENOFRES',le.PREVADDRLENOFRES},
          {'BPV2',le.BPV2},
          {'DIVSSNADDRMSOURCECOUNT',le.DIVSSNADDRMSOURCECOUNT},
          {'AG_PRED_10K',le.AG_PRED_10K},
          {'CURRADDRMEDIANINCOME',le.CURRADDRMEDIANINCOME},
          {'ACCIDENTCOUNT',le.ACCIDENTCOUNT},
          {'CURRADDRMURDERINDEX',le.CURRADDRMURDERINDEX},
          {'SFDUADDRIDENTITIESCOUNT_12',le.SFDUADDRIDENTITIESCOUNT_12},
          {'SOURCEORDERAGELASTORDER',le.SOURCEORDERAGELASTORDER},
          {'SSNLOWISSUEAGE',le.SSNLOWISSUEAGE},
          {'INPUTADDRERRORCODE',le.INPUTADDRERRORCODE},
          {'INPUTADDRAGELASTSALE',le.INPUTADDRAGELASTSALE},
          {'ADDRMOSTRECENTDISTANCE',le.ADDRMOSTRECENTDISTANCE},
          {'INPUTADDRSINGLEFAMILYCOUNT',le.INPUTADDRSINGLEFAMILYCOUNT},
          {'BP2',le.BP2},
          {'V1_LIFEEVTIMEFIRSTASSETPURCHASE',le.V1_LIFEEVTIMEFIRSTASSETPURCHASE},
          {'PREVADDRBURGLARYINDEX',le.PREVADDRBURGLARYINDEX},
          {'ADDRMOSTRECENTCRIMEDIFF',le.ADDRMOSTRECENTCRIMEDIFF},
          {'V1_HHESTIMATEDINCOMERANGE',le.V1_HHESTIMATEDINCOMERANGE},
          {'INPUTADDRBURGLARYINDEX',le.INPUTADDRBURGLARYINDEX},
          {'INPUTADDRMEDIANVALUE',le.INPUTADDRMEDIANVALUE},
          {'CURRADDRAGELASTSALE',le.CURRADDRAGELASTSALE},
          {'V1_CRTRECBKRPTTIMENEWEST',le.V1_CRTRECBKRPTTIMENEWEST},
          {'V1_PROSPECTESTIMATEDINCOMERANGE',le.V1_PROSPECTESTIMATEDINCOMERANGE},
          {'INPUTADDRVACANTPROPCOUNT',le.INPUTADDRVACANTPROPCOUNT},
          {'ACCIDENTAGE',le.ACCIDENTAGE},
          {'INPUTADDRTAXMARKETVALUE',le.INPUTADDRTAXMARKETVALUE},
          {'RELATIVESCOUNT',le.RELATIVESCOUNT},
          {'V1_RAACRTRECMSDMEANMMBRCNT',le.V1_RAACRTRECMSDMEANMMBRCNT},
          {'INPUTADDRMEDIANINCOME',le.INPUTADDRMEDIANINCOME},
          {'CURRADDRBURGLARYINDEX_12',le.CURRADDRBURGLARYINDEX_12},
          {'INPUTADDRPHONECOUNT',le.INPUTADDRPHONECOUNT},
          {'DEROGSEVERITYINDEX',le.DEROGSEVERITYINDEX},
          {'PROPAGENEWESTPURCHASE',le.PROPAGENEWESTPURCHASE},
          {'ADDRMOSTRECENTMOVEAGE',le.ADDRMOSTRECENTMOVEAGE},
          {'PREVADDRMURDERINDEX',le.PREVADDRMURDERINDEX},
          {'INPUTADDRAGEOLDESTRECORD',le.INPUTADDRAGEOLDESTRECORD},
          {'V1_RAACRTRECLIENJUDGMMBRCNT',le.V1_RAACRTRECLIENJUDGMMBRCNT},
          {'DIVADDRSSNCOUNT',le.DIVADDRSSNCOUNT},
          {'CURRADDRCARTHEFTINDEX',le.CURRADDRCARTHEFTINDEX},
          {'PREVADDRCRIMEINDEX',le.PREVADDRCRIMEINDEX},
          {'INPUTADDRLENOFRES',le.INPUTADDRLENOFRES},
          {'PHONEEDAAGEOLDESTRECORD',le.PHONEEDAAGEOLDESTRECORD},
          {'V1_CRTRECMSDMEANCNT',le.V1_CRTRECMSDMEANCNT},
          {'INPUTADDRMURDERINDEX',le.INPUTADDRMURDERINDEX},
          {'CURRADDRBURGLARYINDEX_24',le.CURRADDRBURGLARYINDEX_24},
          {'V1_PROSPECTTIMEONRECORD',le.V1_PROSPECTTIMEONRECORD},
          {'P2',le.P2},
          {'SEARCHSSNSEARCHCOUNT',le.SEARCHSSNSEARCHCOUNT},
          {'V1_PROSPECTTIMELASTUPDATE',le.V1_PROSPECTTIMELASTUPDATE},
          {'V1_CRTRECFELONYTIMENEWEST',le.V1_CRTRECFELONYTIMENEWEST},
          {'SFDUADDRIDENTITIESCOUNT_24',le.SFDUADDRIDENTITIESCOUNT_24},
          {'PV2',le.PV2},
          {'PRSEARCHLOCATECOUNT24',le.PRSEARCHLOCATECOUNT24},
          {'DEROGAGE',le.DEROGAGE},
          {'INPUTADDRMULTIFAMILYCOUNT',le.INPUTADDRMULTIFAMILYCOUNT},
          {'AGEOLDESTRECORD',le.AGEOLDESTRECORD},
          {'PREVADDRMEDIANINCOME',le.PREVADDRMEDIANINCOME},
          {'FELONYAGE',le.FELONYAGE},
          {'ADDRRECENTECONTRAJECTORY',le.ADDRRECENTECONTRAJECTORY},
          {'PROPTAXPERRELATIVE',le.PROPTAXPERRELATIVE},
          {'INPUTADDRTAXVALUE',le.INPUTADDRTAXVALUE},
          {'LASTNAMECHANGEAGE',le.LASTNAMECHANGEAGE}],NVPair);
    END;
    Model1AsAttr := PROJECT(AttrF(do_Model1),TrModel1(LEFT));
  EXPORT Attr() := Model1AsAttr;
    // Validation
  EXPORT ValidationF := HCSE_SETC_V3_ZERO_MODEL.AppendAll_Debug(myfile,do_Model1,ACCIDENTAGE,ACCIDENTCOUNT,ADDRMOSTRECENTCRIMEDIFF,ADDRMOSTRECENTDISTANCE,ADDRMOSTRECENTINCOMEDIFF,ADDRMOSTRECENTMOVEAGE,ADDRMOSTRECENTVALUEDIFF,ADDRRECENTECONTRAJECTORY,AGEOLDESTRECORD,AGE_IN_YEARS,AG_PRED_10K,AVGSTATECOST,BANKRUPTCYAGE,BP2,BPV2,BUSINESSINPUTADDRCOUNT,CORRELATIONRISKLEVEL,CURRADDRAGELASTSALE,CURRADDRAGEOLDESTRECORD,CURRADDRBURGLARYINDEX,CURRADDRBURGLARYINDEX_12,CURRADDRBURGLARYINDEX_24,CURRADDRCARTHEFTINDEX,CURRADDRCRIMEINDEX,CURRADDRLENOFRES,CURRADDRMEDIANINCOME,CURRADDRMEDIANVALUE,CURRADDRMURDERINDEX,DEROGAGE,DEROGCOUNT,DEROGSEVERITYINDEX,DIVADDRIDENTITYCOUNT,DIVADDRIDENTITYMSOURCECOUNT,DIVADDRSSNCOUNT,DIVADDRSSNMSOURCECOUNT,DIVSSNADDRMSOURCECOUNT,ESTIMATEDANNUALINCOME,ESTIMATEDANNUALINCOME_12,ESTIMATEDANNUALINCOME_24,FELONYAGE,FEMALE,INPUTADDRAGELASTSALE,INPUTADDRAGEOLDESTRECORD,INPUTADDRBURGLARYINDEX,INPUTADDRBUSINESSCOUNT,INPUTADDRCARTHEFTINDEX,INPUTADDRCRIMEINDEX,INPUTADDRERRORCODE,INPUTADDRLENOFRES,INPUTADDRMEDIANINCOME,INPUTADDRMEDIANVALUE,INPUTADDRMOBILITYINDEX,INPUTADDRMULTIFAMILYCOUNT,INPUTADDRMURDERINDEX,INPUTADDRPHONECOUNT,INPUTADDRSICCODE,INPUTADDRSINGLEFAMILYCOUNT,INPUTADDRTAXMARKETVALUE,INPUTADDRTAXVALUE,INPUTADDRVACANTPROPCOUNT,LASTNAMECHANGEAGE,LIENFILEDAGE,LIENRELEASEDAGE,P2,PHONEEDAAGENEWESTRECORD,PHONEEDAAGEOLDESTRECORD,PHONEOTHERAGENEWESTRECORD,PHONEOTHERAGEOLDESTRECORD,PREVADDRAGELASTSALE,PREVADDRAGENEWESTRECORD,PREVADDRAGEOLDESTRECORD,PREVADDRBURGLARYINDEX,PREVADDRCARTHEFTINDEX,PREVADDRCRIMEINDEX,PREVADDRLENOFRES,PREVADDRMEDIANINCOME,PREVADDRMEDIANVALUE,PREVADDRMURDERINDEX,PROPAGENEWESTPURCHASE,PROPAGEOLDESTPURCHASE,PROPTAXPERRELATIVE,PRSEARCHLOCATECOUNT,PRSEARCHLOCATECOUNT24,PRSEARCHOTHERCOUNT,PV2,P_ESTIMATEDHHINCOMEPERCAPITA,RELATIVESCOUNT,RELATIVESPROPOWNEDTAXTOTAL,SEARCHADDRSEARCHCOUNT,SEARCHSSNSEARCHCOUNT,SFDUADDRIDENTITIESCOUNT,SFDUADDRIDENTITIESCOUNT_12,SFDUADDRIDENTITIESCOUNT_24,SFDUADDRSSNCOUNT,SOURCEORDERAGELASTORDER,SOURCEORDERSOURCECOUNT,SSNADDRCOUNT,SSNHIGHISSUEAGE,SSNISSUESTATE,SSNLOWISSUEAGE,ST,SUBJECTADDRCOUNT,SUBJECTSSNCOUNT,V1_CRTRECBKRPTTIMENEWEST,V1_CRTRECCNT,V1_CRTRECFELONYTIMENEWEST,V1_CRTRECLIENJUDGCNT,V1_CRTRECLIENJUDGTIMENEWEST,V1_CRTRECMSDMEANCNT,V1_CRTRECMSDMEANTIMENEWEST,V1_CRTRECTIMENEWEST,V1_HHESTIMATEDINCOMERANGE,V1_LIFEEVTIMEFIRSTASSETPURCHASE,V1_LIFEEVTIMELASTASSETPURCHASE,V1_LIFEEVTIMELASTMOVE,V1_PROSPECTAGE,V1_PROSPECTESTIMATEDINCOMERANGE,V1_PROSPECTTIMELASTUPDATE,V1_PROSPECTTIMEONRECORD,V1_RAACRTRECEVICTIONMMBRCNT,V1_RAACRTRECLIENJUDGMMBRCNT,V1_RAACRTRECMMBRCNT,V1_RAACRTRECMSDMEANMMBRCNT,V1_RAAMMBRCNT,V1_RAAPROPOWNERAVMHIGHEST,V1_RAAPROPOWNERAVMMED,V1_RESINPUTBUSINESSCNT,VOTERREGISTRATIONRECORD);
    ValidationLayout TrModel1(ValidationF le) := TRANSFORM
      SELF.TransactionId := le.TransactionId;
      SELF.name := 'Model1';
      SELF.description := 'ZERO_SE_Cost_model';
      SELF.Score := (STRING)le.Model1_Score;
      SELF.Messages := RCToMessage(le.Model1_Reasons);
      SELF.Attributes := DATASET([
          {'PHONEOTHERAGEOLDESTRECORD',le.PHONEOTHERAGEOLDESTRECORD},
          {'PHONEEDAAGENEWESTRECORD',le.PHONEEDAAGENEWESTRECORD},
          {'RELATIVESPROPOWNEDTAXTOTAL',le.RELATIVESPROPOWNEDTAXTOTAL},
          {'INPUTADDRBUSINESSCOUNT',le.INPUTADDRBUSINESSCOUNT},
          {'V1_PROSPECTAGE',le.V1_PROSPECTAGE},
          {'V1_RAACRTRECEVICTIONMMBRCNT',le.V1_RAACRTRECEVICTIONMMBRCNT},
          {'SSNISSUESTATE',le.SSNISSUESTATE},
          {'DIVADDRIDENTITYCOUNT',le.DIVADDRIDENTITYCOUNT},
          {'ESTIMATEDANNUALINCOME_24',le.ESTIMATEDANNUALINCOME_24},
          {'LIENFILEDAGE',le.LIENFILEDAGE},
          {'PREVADDRAGENEWESTRECORD',le.PREVADDRAGENEWESTRECORD},
          {'SSNHIGHISSUEAGE',le.SSNHIGHISSUEAGE},
          {'V1_CRTRECCNT',le.V1_CRTRECCNT},
          {'DEROGCOUNT',le.DEROGCOUNT},
          {'PROPAGEOLDESTPURCHASE',le.PROPAGEOLDESTPURCHASE},
          {'PREVADDRMEDIANVALUE',le.PREVADDRMEDIANVALUE},
          {'INPUTADDRMOBILITYINDEX',le.INPUTADDRMOBILITYINDEX},
          {'DIVADDRIDENTITYMSOURCECOUNT',le.DIVADDRIDENTITYMSOURCECOUNT},
          {'SUBJECTSSNCOUNT',le.SUBJECTSSNCOUNT},
          {'SOURCEORDERSOURCECOUNT',le.SOURCEORDERSOURCECOUNT},
          {'BANKRUPTCYAGE',le.BANKRUPTCYAGE},
          {'VOTERREGISTRATIONRECORD',le.VOTERREGISTRATIONRECORD},
          {'CURRADDRCRIMEINDEX',le.CURRADDRCRIMEINDEX},
          {'PREVADDRAGEOLDESTRECORD',le.PREVADDRAGEOLDESTRECORD},
          {'V1_RAAMMBRCNT',le.V1_RAAMMBRCNT},
          {'ESTIMATEDANNUALINCOME',le.ESTIMATEDANNUALINCOME},
          {'PREVADDRCARTHEFTINDEX',le.PREVADDRCARTHEFTINDEX},
          {'SFDUADDRIDENTITIESCOUNT',le.SFDUADDRIDENTITIESCOUNT},
          {'ESTIMATEDANNUALINCOME_12',le.ESTIMATEDANNUALINCOME_12},
          {'FEMALE',le.FEMALE},
          {'ADDRMOSTRECENTVALUEDIFF',le.ADDRMOSTRECENTVALUEDIFF},
          {'V1_CRTRECMSDMEANTIMENEWEST',le.V1_CRTRECMSDMEANTIMENEWEST},
          {'SUBJECTADDRCOUNT',le.SUBJECTADDRCOUNT},
          {'INPUTADDRCARTHEFTINDEX',le.INPUTADDRCARTHEFTINDEX},
          {'PREVADDRAGELASTSALE',le.PREVADDRAGELASTSALE},
          {'BUSINESSINPUTADDRCOUNT',le.BUSINESSINPUTADDRCOUNT},
          {'LIENRELEASEDAGE',le.LIENRELEASEDAGE},
          {'PHONEOTHERAGENEWESTRECORD',le.PHONEOTHERAGENEWESTRECORD},
          {'CURRADDRAGEOLDESTRECORD',le.CURRADDRAGEOLDESTRECORD},
          {'SFDUADDRSSNCOUNT',le.SFDUADDRSSNCOUNT},
          {'AGE_IN_YEARS',le.AGE_IN_YEARS},
          {'CURRADDRBURGLARYINDEX',le.CURRADDRBURGLARYINDEX},
          {'V1_CRTRECLIENJUDGCNT',le.V1_CRTRECLIENJUDGCNT},
          {'V1_RAAPROPOWNERAVMHIGHEST',le.V1_RAAPROPOWNERAVMHIGHEST},
          {'SSNADDRCOUNT',le.SSNADDRCOUNT},
          {'P_ESTIMATEDHHINCOMEPERCAPITA',le.P_ESTIMATEDHHINCOMEPERCAPITA},
          {'PRSEARCHLOCATECOUNT',le.PRSEARCHLOCATECOUNT},
          {'CORRELATIONRISKLEVEL',le.CORRELATIONRISKLEVEL},
          {'V1_RAAPROPOWNERAVMMED',le.V1_RAAPROPOWNERAVMMED},
          {'DIVADDRSSNMSOURCECOUNT',le.DIVADDRSSNMSOURCECOUNT},
          {'AVGSTATECOST',le.AVGSTATECOST},
          {'V1_RESINPUTBUSINESSCNT',le.V1_RESINPUTBUSINESSCNT},
          {'CURRADDRLENOFRES',le.CURRADDRLENOFRES},
          {'ADDRMOSTRECENTINCOMEDIFF',le.ADDRMOSTRECENTINCOMEDIFF},
          {'ST',le.ST},
          {'V1_RAACRTRECMMBRCNT',le.V1_RAACRTRECMMBRCNT},
          {'V1_LIFEEVTIMELASTMOVE',le.V1_LIFEEVTIMELASTMOVE},
          {'PRSEARCHOTHERCOUNT',le.PRSEARCHOTHERCOUNT},
          {'CURRADDRMEDIANVALUE',le.CURRADDRMEDIANVALUE},
          {'SEARCHADDRSEARCHCOUNT',le.SEARCHADDRSEARCHCOUNT},
          {'INPUTADDRCRIMEINDEX',le.INPUTADDRCRIMEINDEX},
          {'INPUTADDRSICCODE',le.INPUTADDRSICCODE},
          {'V1_CRTRECLIENJUDGTIMENEWEST',le.V1_CRTRECLIENJUDGTIMENEWEST},
          {'V1_LIFEEVTIMELASTASSETPURCHASE',le.V1_LIFEEVTIMELASTASSETPURCHASE},
          {'V1_CRTRECTIMENEWEST',le.V1_CRTRECTIMENEWEST},
          {'PREVADDRLENOFRES',le.PREVADDRLENOFRES},
          {'BPV2',le.BPV2},
          {'DIVSSNADDRMSOURCECOUNT',le.DIVSSNADDRMSOURCECOUNT},
          {'AG_PRED_10K',le.AG_PRED_10K},
          {'CURRADDRMEDIANINCOME',le.CURRADDRMEDIANINCOME},
          {'ACCIDENTCOUNT',le.ACCIDENTCOUNT},
          {'CURRADDRMURDERINDEX',le.CURRADDRMURDERINDEX},
          {'SFDUADDRIDENTITIESCOUNT_12',le.SFDUADDRIDENTITIESCOUNT_12},
          {'SOURCEORDERAGELASTORDER',le.SOURCEORDERAGELASTORDER},
          {'SSNLOWISSUEAGE',le.SSNLOWISSUEAGE},
          {'INPUTADDRERRORCODE',le.INPUTADDRERRORCODE},
          {'INPUTADDRAGELASTSALE',le.INPUTADDRAGELASTSALE},
          {'ADDRMOSTRECENTDISTANCE',le.ADDRMOSTRECENTDISTANCE},
          {'INPUTADDRSINGLEFAMILYCOUNT',le.INPUTADDRSINGLEFAMILYCOUNT},
          {'BP2',le.BP2},
          {'V1_LIFEEVTIMEFIRSTASSETPURCHASE',le.V1_LIFEEVTIMEFIRSTASSETPURCHASE},
          {'PREVADDRBURGLARYINDEX',le.PREVADDRBURGLARYINDEX},
          {'ADDRMOSTRECENTCRIMEDIFF',le.ADDRMOSTRECENTCRIMEDIFF},
          {'V1_HHESTIMATEDINCOMERANGE',le.V1_HHESTIMATEDINCOMERANGE},
          {'INPUTADDRBURGLARYINDEX',le.INPUTADDRBURGLARYINDEX},
          {'INPUTADDRMEDIANVALUE',le.INPUTADDRMEDIANVALUE},
          {'CURRADDRAGELASTSALE',le.CURRADDRAGELASTSALE},
          {'V1_CRTRECBKRPTTIMENEWEST',le.V1_CRTRECBKRPTTIMENEWEST},
          {'V1_PROSPECTESTIMATEDINCOMERANGE',le.V1_PROSPECTESTIMATEDINCOMERANGE},
          {'INPUTADDRVACANTPROPCOUNT',le.INPUTADDRVACANTPROPCOUNT},
          {'ACCIDENTAGE',le.ACCIDENTAGE},
          {'INPUTADDRTAXMARKETVALUE',le.INPUTADDRTAXMARKETVALUE},
          {'RELATIVESCOUNT',le.RELATIVESCOUNT},
          {'V1_RAACRTRECMSDMEANMMBRCNT',le.V1_RAACRTRECMSDMEANMMBRCNT},
          {'INPUTADDRMEDIANINCOME',le.INPUTADDRMEDIANINCOME},
          {'CURRADDRBURGLARYINDEX_12',le.CURRADDRBURGLARYINDEX_12},
          {'INPUTADDRPHONECOUNT',le.INPUTADDRPHONECOUNT},
          {'DEROGSEVERITYINDEX',le.DEROGSEVERITYINDEX},
          {'PROPAGENEWESTPURCHASE',le.PROPAGENEWESTPURCHASE},
          {'ADDRMOSTRECENTMOVEAGE',le.ADDRMOSTRECENTMOVEAGE},
          {'PREVADDRMURDERINDEX',le.PREVADDRMURDERINDEX},
          {'INPUTADDRAGEOLDESTRECORD',le.INPUTADDRAGEOLDESTRECORD},
          {'V1_RAACRTRECLIENJUDGMMBRCNT',le.V1_RAACRTRECLIENJUDGMMBRCNT},
          {'DIVADDRSSNCOUNT',le.DIVADDRSSNCOUNT},
          {'CURRADDRCARTHEFTINDEX',le.CURRADDRCARTHEFTINDEX},
          {'PREVADDRCRIMEINDEX',le.PREVADDRCRIMEINDEX},
          {'INPUTADDRLENOFRES',le.INPUTADDRLENOFRES},
          {'PHONEEDAAGEOLDESTRECORD',le.PHONEEDAAGEOLDESTRECORD},
          {'V1_CRTRECMSDMEANCNT',le.V1_CRTRECMSDMEANCNT},
          {'INPUTADDRMURDERINDEX',le.INPUTADDRMURDERINDEX},
          {'CURRADDRBURGLARYINDEX_24',le.CURRADDRBURGLARYINDEX_24},
          {'V1_PROSPECTTIMEONRECORD',le.V1_PROSPECTTIMEONRECORD},
          {'P2',le.P2},
          {'SEARCHSSNSEARCHCOUNT',le.SEARCHSSNSEARCHCOUNT},
          {'V1_PROSPECTTIMELASTUPDATE',le.V1_PROSPECTTIMELASTUPDATE},
          {'V1_CRTRECFELONYTIMENEWEST',le.V1_CRTRECFELONYTIMENEWEST},
          {'SFDUADDRIDENTITIESCOUNT_24',le.SFDUADDRIDENTITIESCOUNT_24},
          {'PV2',le.PV2},
          {'PRSEARCHLOCATECOUNT24',le.PRSEARCHLOCATECOUNT24},
          {'DEROGAGE',le.DEROGAGE},
          {'INPUTADDRMULTIFAMILYCOUNT',le.INPUTADDRMULTIFAMILYCOUNT},
          {'AGEOLDESTRECORD',le.AGEOLDESTRECORD},
          {'PREVADDRMEDIANINCOME',le.PREVADDRMEDIANINCOME},
          {'FELONYAGE',le.FELONYAGE},
          {'ADDRRECENTECONTRAJECTORY',le.ADDRRECENTECONTRAJECTORY},
          {'PROPTAXPERRELATIVE',le.PROPTAXPERRELATIVE},
          {'INPUTADDRTAXVALUE',le.INPUTADDRTAXVALUE},
          {'LASTNAMECHANGEAGE',le.LASTNAMECHANGEAGE}],NVPair);
      SELF.ScoreCard := 'Score1';
      SELF.score_date := StringLib.GetDateYYYYMMDD();
      SELF.raw_score := le.Model1_Score1_Score0;
      SELF.calc_temp_score := le.Model1_Score1_Score;
      SELF.INSUFFICIENT_INFO := FALSE; // Insufficient_Info* not found
      SELF.NO_HIT := FALSE; // No_Hit* not found
      SELF.reason_codes_base := DATASET([],RC_Contributions_Layout);
    END;
    Model1AsValidation := PROJECT(ValidationF(do_Model1),TrModel1(LEFT));
  EXPORT Validation() := Model1AsValidation;
// Now compute some statistics
  Accum := RECORD
    TotalProcessed := COUNT(GROUP);
    Model1_sc_Score1 := COUNT(GROUP,ValidationF.Model1_sc = 1);
  END;
  EXPORT StatsF := TABLE(ValidationF,Accum);
  EXPORT Stats() := DATASET([{'ADR Report','','','',0,0,0,'',0,0,'',0,0}
    ,{'Model1','ZERO_SE_Cost_model','Score1','',0,0,0,'',0,0,'',StatsF[1].Model1_sc_Score1,100*StatsF[1].Model1_sc_Score1/StatsF[1].TotalProcessed}
    ],LUCI.Results.StatsLayout);
  END;
  RETURN res(infile);
ENDMACRO;
