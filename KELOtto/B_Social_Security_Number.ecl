//HPCC Systems KEL Compiler Version 0.11.0
IMPORT KEL011 AS KEL;
IMPORT B_Customer_1,B_Event_1,B_Social_Security_Number_1,E_Address,E_Customer,E_Email,E_Event,E_Internet_Protocol,E_Person,E_Person_Event,E_Phone,E_Social_Security_Number FROM KELOtto;
IMPORT * FROM KEL011.Null;
EXPORT B_Social_Security_Number := MODULE
  SHARED VIRTUAL TYPEOF(B_Customer_1.__ENH_Customer_1) __ENH_Customer_1 := B_Customer_1.__ENH_Customer_1;
  SHARED VIRTUAL TYPEOF(B_Event_1.__ENH_Event_1) __ENH_Event_1 := B_Event_1.__ENH_Event_1;
  SHARED VIRTUAL TYPEOF(E_Person_Event.__Result) __E_Person_Event := E_Person_Event.__Result;
  SHARED VIRTUAL TYPEOF(B_Social_Security_Number_1.__ENH_Social_Security_Number_1) __ENH_Social_Security_Number_1 := B_Social_Security_Number_1.__ENH_Social_Security_Number_1;
  SHARED __EE263050 := __ENH_Social_Security_Number_1;
  SHARED __EE270487 := __ENH_Event_1;
  SHARED __EE270403 := __E_Person_Event;
  SHARED __EE271639 := __EE270403;
  SHARED __EE271652 := __EE271639(__NN(__EE271639.Social_) AND __NN(__EE271639.Transaction_));
  SHARED __ST266716_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Event.Source_Customers_Layout) Source_Customers_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.nkdate Event_Date_;
    KEL.typ.ndataset(E_Event.Event_Types_Layout) Event_Types_;
    KEL.typ.ndataset(E_Event.Hri_List_Layout) Hri_List_;
    KEL.typ.nint Age_;
    KEL.typ.int Deceased_Prior_To_Event_ := 0;
    KEL.typ.nint Deceased_To_Event_Year_Diff_;
    KEL.typ.int In_Customer_Population_ := 0;
    KEL.typ.int Kr_High_Risk_Address_Flag_ := 0;
    KEL.typ.int Kr_High_Risk_Identity_Flag_ := 0;
    KEL.typ.int Kr_Medium_Risk_Address_Flag_ := 0;
    KEL.typ.int Kr_Medium_Risk_Identity_Flag_ := 0;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer__1_;
    KEL.typ.ntyp(E_Person.Typ) Subject__1_;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) Social_;
    KEL.typ.ntyp(E_Phone.Typ) Phone_Number_;
    KEL.typ.ntyp(E_Email.Typ) Emailof_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Internet_Protocol.Typ) Ip_;
    KEL.typ.nkdate Event_Date__1_;
    KEL.typ.ntyp(E_Event.Typ) Transaction_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC271658(B_Event_1.__ST7975_Layout __EE270487, E_Person_Event.Layout __EE271652) := __EEQP(__EE271652.Transaction_,__EE270487.UID);
  __ST266716_Layout __JT271658(B_Event_1.__ST7975_Layout __l, E_Person_Event.Layout __r) := TRANSFORM
    SELF._r_Customer__1_ := __r._r_Customer_;
    SELF.Subject__1_ := __r.Subject_;
    SELF.Location__1_ := __r.Location_;
    SELF.Event_Date__1_ := __r.Event_Date_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE271659 := JOIN(__EE271652,__EE270487,__JC271658(RIGHT,LEFT),__JT271658(RIGHT,LEFT),INNER,HASH);
  SHARED __ST266185_Layout := RECORD
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) Social_;
    KEL.typ.ntyp(E_Phone.Typ) Phone_Number_;
    KEL.typ.ntyp(E_Email.Typ) Emailof_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Internet_Protocol.Typ) Ip_;
    KEL.typ.nkdate Event_Date_;
    KEL.typ.ntyp(E_Event.Typ) Transaction_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nint Age_;
    KEL.typ.int In_Customer_Population_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST266185_Layout __ND271706__Project(__ST266716_Layout __PP271660) := TRANSFORM
    SELF.UID := __PP271660.Social_;
    SELF._r_Customer_ := __PP271660._r_Customer__1_;
    SELF.Subject_ := __PP271660.Subject__1_;
    SELF.Location_ := __PP271660.Location__1_;
    SELF.Event_Date_ := __PP271660.Event_Date__1_;
    SELF.U_I_D__1_ := __PP271660.UID;
    SELF := __PP271660;
  END;
  SHARED __EE271759 := PROJECT(__EE271659,__ND271706__Project(LEFT));
  SHARED __ST266240_Layout := RECORD
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.nbool Exp1_;
    KEL.typ.nbool Exp2_;
    KEL.typ.nbool Exp3_;
    KEL.typ.nbool Exp4_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST266240_Layout __ND272540__Project(__ST266185_Layout __PP271760) := TRANSFORM
    SELF.Exp1_ := __OP2(__PP271760.Age_,<,__CN(2));
    SELF.Exp2_ := __AND(__OP2(__PP271760.Age_,<,__CN(2)),__CN(__PP271760.In_Customer_Population_ = 1));
    SELF.Exp3_ := __OP2(__PP271760.Age_,<,__CN(366));
    SELF.Exp4_ := __AND(__OP2(__PP271760.Age_,<,__CN(366)),__CN(__PP271760.In_Customer_Population_ = 1));
    SELF := __PP271760;
  END;
  SHARED __EE272557 := PROJECT(__EE271759,__ND272540__Project(LEFT));
  SHARED __ST266270_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE272592 := PROJECT(__CLEANANDDO(__EE272557,TABLE(__EE272557,{KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP,__T(__EE272557.Exp1_)),KEL.typ.int C_O_U_N_T___Exp1__1_ := COUNT(GROUP,__T(__EE272557.Exp2_)),KEL.typ.int C_O_U_N_T___Exp1__2_ := COUNT(GROUP,__T(__EE272557.Exp3_)),KEL.typ.int C_O_U_N_T___Exp1__3_ := COUNT(GROUP,__T(__EE272557.Exp4_)),UID},UID,MERGE)),__ST266270_Layout);
  SHARED __ST266836_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC272598(B_Social_Security_Number_1.__ST8297_Layout __EE263050, __ST266270_Layout __EE272592) := __EEQP(__EE263050.UID,__EE272592.UID);
  __ST266836_Layout __JT272598(B_Social_Security_Number_1.__ST8297_Layout __l, __ST266270_Layout __r) := TRANSFORM
    SELF.U_I_D__1_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE272641 := JOIN(__EE263050,__EE272592,__JC272598(LEFT,RIGHT),__JT272598(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE270410 := __EE270403(__NN(__EE270403.Social_));
  SHARED __EE271636 := __EE270410;
  SHARED __ST265716_Layout := RECORD
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE271892 := DEDUP(PROJECT(__EE271636,TRANSFORM(__ST265716_Layout,SELF.UID := LEFT.Social_,SELF := LEFT)),ALL);
  SHARED __ST265734_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE271905 := PROJECT(__CLEANANDDO(__EE271892,TABLE(__EE271892,{KEL.typ.int C_O_U_N_T___Person_Event_ := COUNT(GROUP),UID},UID,MERGE)),__ST265734_Layout);
  SHARED __ST267166_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__1_;
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__2_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC272647(__ST266836_Layout __EE272641, __ST265734_Layout __EE271905) := __EEQP(__EE272641.UID,__EE271905.UID);
  __ST267166_Layout __JT272647(__ST266836_Layout __l, __ST265734_Layout __r) := TRANSFORM
    SELF.U_I_D__2_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE272692 := JOIN(__EE272641,__EE271905,__JC272647(LEFT,RIGHT),__JT272647(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE270426 := __EE263050;
  SHARED __ST266648_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.nstr Hri_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __ST266648_Layout __JT270437(B_Social_Security_Number_1.__ST8297_Layout __l, E_Social_Security_Number.Hri_List_Layout __r) := TRANSFORM
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE270438 := NORMALIZE(__EE270426,__T(LEFT.Hri_List_),__JT270437(LEFT,RIGHT));
  SHARED __ST265323_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Hri_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE270460 := PROJECT(__EE270438,__ST265323_Layout);
  SHARED __ST265364_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nbool Exp1_;
    KEL.typ.nbool Exp2_;
    KEL.typ.nbool Exp3_;
    KEL.typ.nbool Exp4_;
    KEL.typ.nbool Exp5_;
    KEL.typ.nbool Exp6_;
    KEL.typ.nbool Exp7_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST265364_Layout __ND272696__Project(__ST265323_Layout __PP270282) := TRANSFORM
    SELF.Exp1_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('06'));
    SELF.Exp2_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('26'));
    SELF.Exp3_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('29'));
    SELF.Exp4_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('38'));
    SELF.Exp5_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('71'));
    SELF.Exp6_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('It'));
    SELF.Exp7_ := __FN2(KEL.Routines.Contains,__PP270282.Hri_,__CN('Mi'));
    SELF := __PP270282;
  END;
  SHARED __EE272718 := PROJECT(__EE270460,__ND272696__Project(LEFT));
  SHARED __ST265409_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Hri_List_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__1_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__2_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__3_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__4_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__5_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__6_ := 0;
    KEL.typ.nuid UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE272771 := PROJECT(__CLEANANDDO(__EE272718,TABLE(__EE272718,{KEL.typ.int C_O_U_N_T___Hri_List_ := COUNT(GROUP,__T(__EE272718.Exp1_)),KEL.typ.int C_O_U_N_T___Hri_List__1_ := COUNT(GROUP,__T(__EE272718.Exp2_)),KEL.typ.int C_O_U_N_T___Hri_List__2_ := COUNT(GROUP,__T(__EE272718.Exp3_)),KEL.typ.int C_O_U_N_T___Hri_List__3_ := COUNT(GROUP,__T(__EE272718.Exp4_)),KEL.typ.int C_O_U_N_T___Hri_List__4_ := COUNT(GROUP,__T(__EE272718.Exp5_)),KEL.typ.int C_O_U_N_T___Hri_List__5_ := COUNT(GROUP,__T(__EE272718.Exp6_)),KEL.typ.int C_O_U_N_T___Hri_List__6_ := COUNT(GROUP,__T(__EE272718.Exp7_)),UID},UID,MERGE)),__ST265409_Layout);
  SHARED __ST267495_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__1_;
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__2_;
    KEL.typ.int C_O_U_N_T___Hri_List_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__1_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__2_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__3_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__4_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__5_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__6_ := 0;
    KEL.typ.nuid U_I_D__3_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC272779(__ST267166_Layout __EE272692, __ST265409_Layout __EE272771) := __EEQP(__EE272692.UID,__EE272771.UID);
  __ST267495_Layout __JT272779(__ST267166_Layout __l, __ST265409_Layout __r) := TRANSFORM
    SELF.U_I_D__3_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE272832 := JOIN(__EE272692,__EE272771,__JC272779(LEFT,RIGHT),__JT272779(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __ST264639_Layout := RECORD
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.ntyp(E_Event.Typ) Transaction_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE270424 := DEDUP(PROJECT(__EE270410,TRANSFORM(__ST264639_Layout,SELF.UID := LEFT.Social_,SELF := LEFT)),ALL);
  SHARED __ST264657_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE270281 := PROJECT(__CLEANANDDO(__EE270424,TABLE(__EE270424,{KEL.typ.int C_O_U_N_T___Person_Event_ := COUNT(GROUP),UID},UID,MERGE)),__ST264657_Layout);
  SHARED __ST267855_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__1_;
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__2_;
    KEL.typ.int C_O_U_N_T___Hri_List_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__1_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__2_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__3_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__4_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__5_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__6_ := 0;
    KEL.typ.nuid U_I_D__3_;
    KEL.typ.int C_O_U_N_T___Person_Event__1_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__4_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC272838(__ST267495_Layout __EE272832, __ST264657_Layout __EE270281) := __EEQP(__EE272832.UID,__EE270281.UID);
  __ST267855_Layout __JT272838(__ST267495_Layout __l, __ST264657_Layout __r) := TRANSFORM
    SELF.C_O_U_N_T___Person_Event__1_ := __r.C_O_U_N_T___Person_Event_;
    SELF.U_I_D__4_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE272895 := JOIN(__EE272832,__EE270281,__JC272838(LEFT,RIGHT),__JT272838(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE263260 := __ENH_Customer_1;
  SHARED __EE271630 := __EE263260;
  SHARED __ST268216_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__1_;
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__2_;
    KEL.typ.int C_O_U_N_T___Hri_List_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__1_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__2_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__3_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__4_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__5_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__6_ := 0;
    KEL.typ.nuid U_I_D__3_;
    KEL.typ.int C_O_U_N_T___Person_Event__1_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__4_;
    KEL.typ.nuid U_I_D__5_;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nint Industry_Type_;
    KEL.typ.int Address_Count_ := 0;
    KEL.typ.int All_Address_Count_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count_ := 0;
    KEL.typ.int All_Deceased_Person_Count_ := 0;
    KEL.typ.int All_High_Frequency_Address_Count_ := 0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Address_Count_ := 0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC272901(__ST267855_Layout __EE272895, B_Customer_1.__ST7915_Layout __EE271630) := __EEQP(__EE272895._r_Customer_,__EE271630.UID);
  __ST268216_Layout __JT272901(__ST267855_Layout __l, B_Customer_1.__ST7915_Layout __r) := TRANSFORM
    SELF.U_I_D__5_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE272968 := JOIN(__EE272895,__EE271630,__JC272901(LEFT,RIGHT),__JT272901(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __ST268584_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__1_;
    KEL.typ.int C_O_U_N_T___Person_Event_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__2_;
    KEL.typ.int C_O_U_N_T___Hri_List_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__1_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__2_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__3_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__4_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__5_ := 0;
    KEL.typ.int C_O_U_N_T___Hri_List__6_ := 0;
    KEL.typ.nuid U_I_D__3_;
    KEL.typ.int C_O_U_N_T___Person_Event__1_ := 0;
    KEL.typ.ntyp(E_Social_Security_Number.Typ) U_I_D__4_;
    KEL.typ.nuid U_I_D__5_;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nint Industry_Type_;
    KEL.typ.int Address_Count_ := 0;
    KEL.typ.int All_Address_Count_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count_ := 0;
    KEL.typ.int All_Deceased_Person_Count_ := 0;
    KEL.typ.int All_High_Frequency_Address_Count_ := 0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Address_Count_ := 0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nuid U_I_D__6_;
    KEL.typ.nint Customer_Id__1_;
    KEL.typ.nint Industry_Type__1_;
    KEL.typ.int Address_Count__1_ := 0;
    KEL.typ.int All_Address_Count__1_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count__1_ := 0;
    KEL.typ.int All_Deceased_Person_Count__1_ := 0;
    KEL.typ.int All_High_Frequency_Address_Count__1_ := 0;
    KEL.typ.int All_Person_Count__1_ := 0;
    KEL.typ.int Deceased_Person_Count__1_ := 0;
    KEL.typ.int High_Frequency_Address_Count__1_ := 0;
    KEL.typ.int Person_Count__1_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC272974(__ST268216_Layout __EE272968, B_Customer_1.__ST7915_Layout __EE263260) := __EEQP(__EE272968._r_Customer_,__EE263260.UID);
  __ST268584_Layout __JT272974(__ST268216_Layout __l, B_Customer_1.__ST7915_Layout __r) := TRANSFORM
    SELF.U_I_D__6_ := __r.UID;
    SELF.Customer_Id__1_ := __r.Customer_Id_;
    SELF.Industry_Type__1_ := __r.Industry_Type_;
    SELF.Address_Count__1_ := __r.Address_Count_;
    SELF.All_Address_Count__1_ := __r.All_Address_Count_;
    SELF.All_Deceased_Matched_Person_Count__1_ := __r.All_Deceased_Matched_Person_Count_;
    SELF.All_Deceased_Person_Count__1_ := __r.All_Deceased_Person_Count_;
    SELF.All_High_Frequency_Address_Count__1_ := __r.All_High_Frequency_Address_Count_;
    SELF.All_Person_Count__1_ := __r.All_Person_Count_;
    SELF.Deceased_Person_Count__1_ := __r.Deceased_Person_Count_;
    SELF.High_Frequency_Address_Count__1_ := __r.High_Frequency_Address_Count_;
    SELF.Person_Count__1_ := __r.Person_Count_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE273075 := JOIN(__EE272968,__EE263260,__JC272974(LEFT,RIGHT),__JT272974(LEFT,RIGHT),LEFT OUTER,HASH);
  EXPORT __ST7741_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.ntyp(E_Customer.Typ) _r_Customer_;
    KEL.typ.ndataset(E_Social_Security_Number.Source_Customers_Layout) Source_Customers_;
    KEL.typ.nunk Ssn_;
    KEL.typ.nunk _v2__divssnidentitycountnew_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Middle_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nstr Deceased_Match_Code_;
    KEL.typ.nbool _isdeepdive_;
    KEL.typ.nstr _county__death_;
    KEL.typ.nstr Deceased_Ssn_;
    KEL.typ.nstr _state__death__flag_;
    KEL.typ.nstr _death__rec__src_;
    KEL.typ.nstr _state__death__id_;
    KEL.typ.ndataset(E_Social_Security_Number.Hri_List_Layout) Hri_List_;
    KEL.typ.int Cl_Active30_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active30_Identity_Count_Percentile_;
    KEL.typ.int Cl_Active7_Identity_Count_ := 0;
    KEL.typ.nint Cl_Active7_Identity_Count_Percentile_;
    KEL.typ.int Cl_Element_Count_ := 0;
    KEL.typ.int Cl_Event_Count_ := 0;
    KEL.typ.nint Cl_Event_Count_Percentile_;
    KEL.typ.int Cl_Identity_Count_ := 0;
    KEL.typ.nint Cl_Identity_Count_Percentile_;
    KEL.typ.nfloat Cl_Impact_Weight_;
    KEL.typ.int Cluster_Score_ := 0;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.int Entity_Type_ := 0;
    KEL.typ.int Event_Count_ := 0;
    KEL.typ.int Hri06_Flag_ := 0;
    KEL.typ.int Hri26_Flag_ := 0;
    KEL.typ.int Hri29_Flag_ := 0;
    KEL.typ.int Hri38_Flag_ := 0;
    KEL.typ.int Hri71_Flag_ := 0;
    KEL.typ.int Hri_It_Flag_ := 0;
    KEL.typ.int Hri_Mi_Flag_ := 0;
    KEL.typ.int Identity_Count_ := 0;
    KEL.typ.nint Industry_Type_;
    KEL.typ.nunk Label_;
    KEL.typ.nint Score_;
    KEL.typ.nint Source_Customer_Count_;
    KEL.typ.int Vl_Event1_All_Count_ := 0;
    KEL.typ.int Vl_Event1_Count_ := 0;
    KEL.typ.int Vl_Event30_Active_Flag_ := 0;
    KEL.typ.int Vl_Event30_All_Active_Flag_ := 0;
    KEL.typ.int Vl_Event30_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event30_Count_ := 0;
    KEL.typ.int Vl_Event365_All_Day_Count_ := 0;
    KEL.typ.int Vl_Event365_Count_ := 0;
    KEL.typ.int Vl_Event7_Active_Flag_ := 0;
    KEL.typ.int Vl_Event7_All_Active_Flag_ := 0;
    KEL.typ.int Vl_Event7_All_Count_ := 0;
    KEL.typ.int Vl_Event7_Count_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST7741_Layout __ND273080__Project(__ST268584_Layout __PP273076) := TRANSFORM
    SELF.Cl_Element_Count_ := 0;
    SELF.Cl_Impact_Weight_ := __OP2(__OP2(__OP2(__OP2(__PP273076.Cl_Identity_Count_Percentile_,*,__CN(0.3)),+,__OP2(__PP273076.Cl_Event_Count_Percentile_,*,__CN(0.3))),+,__OP2(__PP273076.Cl_Active30_Identity_Count_Percentile_,*,__CN(0.2))),+,__OP2(__PP273076.Cl_Active7_Identity_Count_Percentile_,*,__CN(0.2)));
    SELF.Cluster_Score_ := 0;
    SELF.Customer_Id_ := __PP273076.Customer_Id__1_;
    SELF.Entity_Context_Uid_ := __OP2(__CN('_15'),+,__PP273076.Ssn_);
    SELF.Entity_Type_ := 15;
    SELF.Event_Count_ := __PP273076.C_O_U_N_T___Person_Event__1_;
    SELF.Hri06_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List_),<>,__CN(0)))=>1,0);
    SELF.Hri26_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List__1_),<>,__CN(0)))=>1,0);
    SELF.Hri29_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List__2_),<>,__CN(0)))=>1,0);
    SELF.Hri38_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List__3_),<>,__CN(0)))=>1,0);
    SELF.Hri71_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List__4_),<>,__CN(0)))=>1,0);
    SELF.Hri_It_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List__5_),<>,__CN(0)))=>1,0);
    SELF.Hri_Mi_Flag_ := MAP(__T(__OP2(__CN(__PP273076.C_O_U_N_T___Hri_List__6_),<>,__CN(0)))=>1,0);
    SELF.Identity_Count_ := __PP273076.C_O_U_N_T___Person_Event_;
    SELF.Label_ := __PP273076.Ssn_;
    SELF.Score_ := __OP2(__PP273076.UID,%,__CN(100));
    SELF.Source_Customer_Count_ := KEL.Aggregates.CountN(__PP273076.Source_Customers_);
    SELF.Vl_Event1_All_Count_ := __PP273076.C_O_U_N_T___Exp1_;
    SELF.Vl_Event1_Count_ := __PP273076.C_O_U_N_T___Exp1__1_;
    SELF.Vl_Event30_Active_Flag_ := MAP(__PP273076.Vl_Event30_Count_ > 0=>1,0);
    SELF.Vl_Event30_All_Active_Flag_ := MAP(__PP273076.Vl_Event30_All_Day_Count_ > 0=>1,0);
    SELF.Vl_Event365_All_Day_Count_ := __PP273076.C_O_U_N_T___Exp1__2_;
    SELF.Vl_Event365_Count_ := __PP273076.C_O_U_N_T___Exp1__3_;
    SELF.Vl_Event7_Active_Flag_ := MAP(__PP273076.Vl_Event7_Count_ > 0=>1,0);
    SELF.Vl_Event7_All_Active_Flag_ := MAP(__PP273076.Vl_Event7_All_Count_ > 0=>1,0);
    SELF := __PP273076;
  END;
  EXPORT __ENH_Social_Security_Number := PROJECT(__EE273075,__ND273080__Project(LEFT)) : PERSIST('~temp::KEL::KELOtto::Social_Security_Number::Annotated',EXPIRE(30));
  SHARED __EE342667 := __ENH_Social_Security_Number;
  SHARED IDX_Social_Security_Number_UID_Layout := RECORD
    KEL.typ.uid UID;
    __EE342667._r_Customer_;
    __EE342667.Source_Customers_;
    __EE342667.Ssn_;
    __EE342667._v2__divssnidentitycountnew_;
    __EE342667.Deceased_Date_;
    __EE342667.Deceased_Date_Of_Birth_;
    __EE342667.Deceased_First_;
    __EE342667.Deceased_Middle_;
    __EE342667.Deceased_Last_;
    __EE342667.Deceased_Match_Code_;
    __EE342667._isdeepdive_;
    __EE342667._county__death_;
    __EE342667.Deceased_Ssn_;
    __EE342667._state__death__flag_;
    __EE342667._death__rec__src_;
    __EE342667._state__death__id_;
    __EE342667.Hri_List_;
    __EE342667.Customer_Id_;
    __EE342667.Industry_Type_;
    __EE342667.Source_Customer_Count_;
    __EE342667.Entity_Context_Uid_;
    __EE342667.Entity_Type_;
    __EE342667.Label_;
    __EE342667.Identity_Count_;
    __EE342667.Event_Count_;
    __EE342667.Hri06_Flag_;
    __EE342667.Hri26_Flag_;
    __EE342667.Hri29_Flag_;
    __EE342667.Hri38_Flag_;
    __EE342667.Hri71_Flag_;
    __EE342667.Hri_It_Flag_;
    __EE342667.Hri_Mi_Flag_;
    __EE342667.Vl_Event1_All_Count_;
    __EE342667.Vl_Event7_All_Count_;
    __EE342667.Vl_Event30_All_Day_Count_;
    __EE342667.Vl_Event365_All_Day_Count_;
    __EE342667.Vl_Event7_All_Active_Flag_;
    __EE342667.Vl_Event30_All_Active_Flag_;
    __EE342667.Vl_Event1_Count_;
    __EE342667.Vl_Event7_Count_;
    __EE342667.Vl_Event30_Count_;
    __EE342667.Vl_Event365_Count_;
    __EE342667.Vl_Event7_Active_Flag_;
    __EE342667.Vl_Event30_Active_Flag_;
    __EE342667.Cl_Identity_Count_;
    __EE342667.Cl_Active7_Identity_Count_;
    __EE342667.Cl_Active30_Identity_Count_;
    __EE342667.Cl_Element_Count_;
    __EE342667.Cl_Event_Count_;
    __EE342667.Cl_Identity_Count_Percentile_;
    __EE342667.Cl_Event_Count_Percentile_;
    __EE342667.Cl_Active30_Identity_Count_Percentile_;
    __EE342667.Cl_Active7_Identity_Count_Percentile_;
    __EE342667.Cl_Impact_Weight_;
    __EE342667.Score_;
    __EE342667.Cluster_Score_;
    __EE342667.Date_First_Seen_;
    __EE342667.Date_Last_Seen_;
    __EE342667.__RecordCount;
  END;
  SHARED IDX_Social_Security_Number_UID_Projected := PROJECT(__EE342667,TRANSFORM(IDX_Social_Security_Number_UID_Layout,SELF.UID:=__T(LEFT.UID),SELF:=LEFT));
  EXPORT IDX_Social_Security_Number_UID := INDEX(IDX_Social_Security_Number_UID_Projected,{UID},{IDX_Social_Security_Number_UID_Projected},'~key::KEL::KELOtto::Social_Security_Number::UID');
  EXPORT IDX_Social_Security_Number_UID_Build := BUILD(IDX_Social_Security_Number_UID,OVERWRITE);
  EXPORT __ST342669_Layout := RECORDOF(IDX_Social_Security_Number_UID);
  EXPORT IDX_Social_Security_Number_UID_Wrapped := PROJECT(IDX_Social_Security_Number_UID,TRANSFORM(__ST7741_Layout,SELF.UID := __CN(LEFT.UID),SELF:=LEFT));
  EXPORT BuildAll := PARALLEL(IDX_Social_Security_Number_UID_Build);
END;
