//HPCC Systems KEL Compiler Version 0.11.0
IMPORT KEL011 AS KEL;
IMPORT B_Customer_Person,B_Customer_Person_Person,B_Person,B_Person_1,E_Customer,E_Customer_Person,E_Customer_Person_Person,E_Person FROM KELOtto;
IMPORT * FROM KEL011.Null;
EXPORT RQ__show_Customer_Person_Links := MODULE
  SHARED __EE102933 := PROJECT(B_Customer_Person.IDX_Customer_Person_Source_Customer__Wrapped,E_Customer_Person.Layout);
  SHARED __EE102935 := B_Person.IDX_Person_UID_Wrapped;
  SHARED __ST100509_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.nuid UID;
    KEL.typ.nint Lex_Id_;
    KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
    KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nint Associated_Ssn_Count_;
    KEL.typ.nint Date_Of_Birth_Match_Level_;
    KEL.typ.nint Stolen_Identity_Index_;
    KEL.typ.nint Synthetic_Identity_Index_;
    KEL.typ.nint Manipulated_Identity_Index_;
    KEL.typ.nint Vulnerable_Victim_Index_;
    KEL.typ.nint Friendlyfraud_Index_;
    KEL.typ.nint Suspicious_Activity_Index_;
    B_Person_1.__NS17101_Layout Best_Full_Name_;
    KEL.typ.int Deceased_ := 0;
    KEL.typ.int Deceased_Dob_Match_ := 0;
    KEL.typ.int Deceased_Match_ := 0;
    KEL.typ.str Deceased_Match_Description_ := '';
    KEL.typ.int Deceased_Name_Match_ := 0;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Label_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC102944(E_Customer_Person.Layout __EE102933, B_Person.__ST2096_Layout __EE102935) := __EEQP(__EE102933.Subject_,__EE102935.UID);
  __ST100509_Layout __JT102944(E_Customer_Person.Layout __l, B_Person.__ST2096_Layout __r) := TRANSFORM
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE102945 := JOIN(__EE102933,__EE102935,__JC102944(LEFT,RIGHT),__JT102944(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __ST99469_Layout := RECORD
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST99473_Layout := RECORD
    KEL.typ.ndataset(__ST99469_Layout) Customer_Person_Person_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST99477_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Label_;
    KEL.typ.ndataset(__ST99473_Layout) Exp1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST99477_Layout __ND104946__Project(__ST100509_Layout __PP102244) := TRANSFORM
    __EE104170 := __EE102935;
    __EE102324 := B_Customer_Person_Person.IDX_Customer_Person_Person_From_Person__Wrapped;
    __EE103588 := __EE102324(__NN(__EE102324.To_Person_) AND __NN(__EE102324.From_Person_));
    __EE104173 := __EE102935;
    __ST99738_Layout := RECORD
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) From_Person_;
      KEL.typ.ntyp(E_Person.Typ) To_Person_;
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC104193(E_Customer_Person_Person.Layout __EE103588, B_Person.__ST2096_Layout __EE104173) := __EEQP(__EE103588.To_Person_,__EE104173.UID);
    __ST99738_Layout __JT104193(E_Customer_Person_Person.Layout __l, B_Person.__ST2096_Layout __r) := TRANSFORM
      SELF := __l;
      SELF := __r;
    END;
    __EE104194 := JOIN(__EE103588,__EE104173,__JC104193(LEFT,RIGHT),__JT104193(LEFT,RIGHT),INNER,HASH);
    __ST99815_Layout := RECORD
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) From_Person_;
      KEL.typ.ntyp(E_Person.Typ) To_Person_;
      KEL.typ.nuid U_I_D__1_;
      KEL.typ.nint Lex_Id__1_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth__1_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name__1_;
      KEL.typ.nkdate Deceased_Date__1_;
      KEL.typ.nkdate Deceased_Date_Of_Birth__1_;
      KEL.typ.nstr Deceased_First__1_;
      KEL.typ.nstr Deceased_Last__1_;
      KEL.typ.nint Associated_Ssn_Count__1_;
      KEL.typ.nint Date_Of_Birth_Match_Level__1_;
      KEL.typ.nint Stolen_Identity_Index__1_;
      KEL.typ.nint Synthetic_Identity_Index__1_;
      KEL.typ.nint Manipulated_Identity_Index__1_;
      KEL.typ.nint Vulnerable_Victim_Index__1_;
      KEL.typ.nint Friendlyfraud_Index__1_;
      KEL.typ.nint Suspicious_Activity_Index__1_;
      B_Person_1.__NS17101_Layout Best_Full_Name__1_;
      KEL.typ.int Deceased__1_ := 0;
      KEL.typ.int Deceased_Dob_Match__1_ := 0;
      KEL.typ.int Deceased_Match__1_ := 0;
      KEL.typ.str Deceased_Match_Description__1_ := '';
      KEL.typ.int Deceased_Name_Match__1_ := 0;
      KEL.typ.nunk Entity_Context_Uid__1_;
      KEL.typ.nstr Label__1_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC104244(B_Person.__ST2096_Layout __EE104170, __ST99738_Layout __EE104194) := __EEQP(__EE104194.From_Person_,__EE104170.UID);
    __ST99815_Layout __JT104244(B_Person.__ST2096_Layout __l, __ST99738_Layout __r) := TRANSFORM
      SELF.U_I_D__1_ := __r.UID;
      SELF.Lex_Id__1_ := __r.Lex_Id_;
      SELF.Reported_Date_Of_Birth__1_ := __r.Reported_Date_Of_Birth_;
      SELF.Full_Name__1_ := __r.Full_Name_;
      SELF.Deceased_Date__1_ := __r.Deceased_Date_;
      SELF.Deceased_Date_Of_Birth__1_ := __r.Deceased_Date_Of_Birth_;
      SELF.Deceased_First__1_ := __r.Deceased_First_;
      SELF.Deceased_Last__1_ := __r.Deceased_Last_;
      SELF.Associated_Ssn_Count__1_ := __r.Associated_Ssn_Count_;
      SELF.Date_Of_Birth_Match_Level__1_ := __r.Date_Of_Birth_Match_Level_;
      SELF.Stolen_Identity_Index__1_ := __r.Stolen_Identity_Index_;
      SELF.Synthetic_Identity_Index__1_ := __r.Synthetic_Identity_Index_;
      SELF.Manipulated_Identity_Index__1_ := __r.Manipulated_Identity_Index_;
      SELF.Vulnerable_Victim_Index__1_ := __r.Vulnerable_Victim_Index_;
      SELF.Friendlyfraud_Index__1_ := __r.Friendlyfraud_Index_;
      SELF.Suspicious_Activity_Index__1_ := __r.Suspicious_Activity_Index_;
      SELF.Best_Full_Name__1_ := __r.Best_Full_Name_;
      SELF.Deceased__1_ := __r.Deceased_;
      SELF.Deceased_Dob_Match__1_ := __r.Deceased_Dob_Match_;
      SELF.Deceased_Match__1_ := __r.Deceased_Match_;
      SELF.Deceased_Match_Description__1_ := __r.Deceased_Match_Description_;
      SELF.Deceased_Name_Match__1_ := __r.Deceased_Name_Match_;
      SELF.Entity_Context_Uid__1_ := __r.Entity_Context_Uid_;
      SELF.Label__1_ := __r.Label_;
      SELF := __l;
      SELF := __r;
    END;
    __EE104245 := JOIN(__EE104194,__EE104170,__JC104244(RIGHT,LEFT),__JT104244(RIGHT,LEFT),INNER,HASH);
    __EE104382 := __EE104245(__T(__OP2(__EE104245.Lex_Id_,<,__EE104245.Lex_Id__1_)));
    __EE104176 := __EE102935;
    __ST99998_Layout := RECORD
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) From_Person_;
      KEL.typ.ntyp(E_Person.Typ) To_Person_;
      KEL.typ.nuid U_I_D__1_;
      KEL.typ.nint Lex_Id__1_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth__1_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name__1_;
      KEL.typ.nkdate Deceased_Date__1_;
      KEL.typ.nkdate Deceased_Date_Of_Birth__1_;
      KEL.typ.nstr Deceased_First__1_;
      KEL.typ.nstr Deceased_Last__1_;
      KEL.typ.nint Associated_Ssn_Count__1_;
      KEL.typ.nint Date_Of_Birth_Match_Level__1_;
      KEL.typ.nint Stolen_Identity_Index__1_;
      KEL.typ.nint Synthetic_Identity_Index__1_;
      KEL.typ.nint Manipulated_Identity_Index__1_;
      KEL.typ.nint Vulnerable_Victim_Index__1_;
      KEL.typ.nint Friendlyfraud_Index__1_;
      KEL.typ.nint Suspicious_Activity_Index__1_;
      B_Person_1.__NS17101_Layout Best_Full_Name__1_;
      KEL.typ.int Deceased__1_ := 0;
      KEL.typ.int Deceased_Dob_Match__1_ := 0;
      KEL.typ.int Deceased_Match__1_ := 0;
      KEL.typ.str Deceased_Match_Description__1_ := '';
      KEL.typ.int Deceased_Name_Match__1_ := 0;
      KEL.typ.nunk Entity_Context_Uid__1_;
      KEL.typ.nstr Label__1_;
      KEL.typ.nuid U_I_D__2_;
      KEL.typ.nint Lex_Id__2_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth__2_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name__2_;
      KEL.typ.nkdate Deceased_Date__2_;
      KEL.typ.nkdate Deceased_Date_Of_Birth__2_;
      KEL.typ.nstr Deceased_First__2_;
      KEL.typ.nstr Deceased_Last__2_;
      KEL.typ.nint Associated_Ssn_Count__2_;
      KEL.typ.nint Date_Of_Birth_Match_Level__2_;
      KEL.typ.nint Stolen_Identity_Index__2_;
      KEL.typ.nint Synthetic_Identity_Index__2_;
      KEL.typ.nint Manipulated_Identity_Index__2_;
      KEL.typ.nint Vulnerable_Victim_Index__2_;
      KEL.typ.nint Friendlyfraud_Index__2_;
      KEL.typ.nint Suspicious_Activity_Index__2_;
      B_Person_1.__NS17101_Layout Best_Full_Name__2_;
      KEL.typ.int Deceased__2_ := 0;
      KEL.typ.int Deceased_Dob_Match__2_ := 0;
      KEL.typ.int Deceased_Match__2_ := 0;
      KEL.typ.str Deceased_Match_Description__2_ := '';
      KEL.typ.int Deceased_Name_Match__2_ := 0;
      KEL.typ.nunk Entity_Context_Uid__2_;
      KEL.typ.nstr Label__2_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC104391(__ST99815_Layout __EE104382, B_Person.__ST2096_Layout __EE104176) := __EEQP(__EE104382.To_Person_,__EE104176.UID);
    __ST99998_Layout __JT104391(__ST99815_Layout __l, B_Person.__ST2096_Layout __r) := TRANSFORM
      SELF.U_I_D__2_ := __r.UID;
      SELF.Lex_Id__2_ := __r.Lex_Id_;
      SELF.Reported_Date_Of_Birth__2_ := __r.Reported_Date_Of_Birth_;
      SELF.Full_Name__2_ := __r.Full_Name_;
      SELF.Deceased_Date__2_ := __r.Deceased_Date_;
      SELF.Deceased_Date_Of_Birth__2_ := __r.Deceased_Date_Of_Birth_;
      SELF.Deceased_First__2_ := __r.Deceased_First_;
      SELF.Deceased_Last__2_ := __r.Deceased_Last_;
      SELF.Associated_Ssn_Count__2_ := __r.Associated_Ssn_Count_;
      SELF.Date_Of_Birth_Match_Level__2_ := __r.Date_Of_Birth_Match_Level_;
      SELF.Stolen_Identity_Index__2_ := __r.Stolen_Identity_Index_;
      SELF.Synthetic_Identity_Index__2_ := __r.Synthetic_Identity_Index_;
      SELF.Manipulated_Identity_Index__2_ := __r.Manipulated_Identity_Index_;
      SELF.Vulnerable_Victim_Index__2_ := __r.Vulnerable_Victim_Index_;
      SELF.Friendlyfraud_Index__2_ := __r.Friendlyfraud_Index_;
      SELF.Suspicious_Activity_Index__2_ := __r.Suspicious_Activity_Index_;
      SELF.Best_Full_Name__2_ := __r.Best_Full_Name_;
      SELF.Deceased__2_ := __r.Deceased_;
      SELF.Deceased_Dob_Match__2_ := __r.Deceased_Dob_Match_;
      SELF.Deceased_Match__2_ := __r.Deceased_Match_;
      SELF.Deceased_Match_Description__2_ := __r.Deceased_Match_Description_;
      SELF.Deceased_Name_Match__2_ := __r.Deceased_Name_Match_;
      SELF.Entity_Context_Uid__2_ := __r.Entity_Context_Uid_;
      SELF.Label__2_ := __r.Label_;
      SELF := __l;
      SELF := __r;
    END;
    __EE104392 := JOIN(__EE104382,__EE104176,__JC104391(LEFT,RIGHT),__JT104391(LEFT,RIGHT),LEFT OUTER,HASH);
    __ST100335_Layout := RECORD
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) Subject_;
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.ndataset(__ST99998_Layout) Person_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC104761(__ST100509_Layout __EE102945, __ST99998_Layout __EE104392) := __T(__AND(__AND(__OP2(__EE104392.Source_Customer_,=,__PP102244.Source_Customer_),__EEQ(__PP102244.Subject_,__EE104392.From_Person_)),__CN(__NN(__PP102244.Subject_))));
    __ST100335_Layout __Join__ST100335_Layout(__ST100509_Layout __r, DATASET(__ST99998_Layout) __recs) := TRANSFORM
      SELF := __r;
      SELF.Person_ := __CN(__recs);
    END;
    __EE104922 := DENORMALIZE(__PP102244,__EE104392,__JC104761(LEFT,RIGHT),GROUP,__Join__ST100335_Layout(LEFT,ROWS(RIGHT)));
    __ST99473_Layout __ND104940__Project(__ST100335_Layout __PP104927) := TRANSFORM
      __EE104925 := __PP104927.Person_;
      SELF.Customer_Person_Person_ := __BN(PROJECT(TABLE(PROJECT(__T(__EE104925),TRANSFORM(__ST99469_Layout,SELF.Entity_Context_Uid_ := LEFT.Entity_Context_Uid__2_,SELF := LEFT))(__NN(Entity_Context_Uid_)),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Entity_Context_Uid_},Entity_Context_Uid_,MERGE),__ST99469_Layout),__NL(__EE104925));
      SELF := __PP104927;
    END;
    __ST99473_Layout __ND104940__Rollup(__ST99473_Layout __r, DATASET(__ST99473_Layout) __recs) := TRANSFORM
      __recs_Customer_Person_Person_ := NORMALIZE(__recs,__T(LEFT.Customer_Person_Person_),TRANSFORM(__ST99469_Layout,SELF:=RIGHT));
      __recs_Customer_Person_Person__allnull := NOT EXISTS(__recs(__NN(Customer_Person_Person_)));
      SELF.Customer_Person_Person_ := __BN(PROJECT(TABLE(__recs_Customer_Person_Person_,{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Entity_Context_Uid_},Entity_Context_Uid_),__ST99469_Layout),__recs_Customer_Person_Person__allnull);
      SELF.__RecordCount := SUM(__recs,__RecordCount);
      SELF.Date_First_Seen_ := KEL.era.SimpleRoll(__recs,Date_First_Seen_,MIN,TRUE);
      SELF.Date_Last_Seen_ := KEL.era.SimpleRoll(__recs,Date_Last_Seen_,MAX,FALSE);
      SELF := __r;
    END;
    SELF.Exp1_ := __FILTER(__CN(ROLLUP(GROUP(KEL.Routines.SortAndAppendFilteredChildren(PROJECT(__EE104922,__ND104940__Project(LEFT)),'Customer_Person_Person_','customer_person_person_','clean','__recordcount,date_first_seen_,date_last_seen_'),Customer_Person_Person_Clean,ALL),GROUP,__ND104940__Rollup(ROW(LEFT,__ST99473_Layout), PROJECT(ROWS(LEFT),__ST99473_Layout)))),__NN(Customer_Person_Person_));
    SELF := __PP102244;
  END;
  SHARED __ST99473_Layout __ND105501__Rollup(__ST99473_Layout __r, DATASET(__ST99473_Layout) __recs) := TRANSFORM
    __recs_Customer_Person_Person_ := NORMALIZE(__recs,__T(LEFT.Customer_Person_Person_),TRANSFORM(__ST99469_Layout,SELF:=RIGHT));
    __recs_Customer_Person_Person__allnull := NOT EXISTS(__recs(__NN(Customer_Person_Person_)));
    SELF.Customer_Person_Person_ := __BN(PROJECT(TABLE(__recs_Customer_Person_Person_,{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Entity_Context_Uid_},Entity_Context_Uid_),__ST99469_Layout),__recs_Customer_Person_Person__allnull);
    SELF.__RecordCount := SUM(__recs,__RecordCount);
    SELF.Date_First_Seen_ := KEL.era.SimpleRoll(__recs,Date_First_Seen_,MIN,TRUE);
    SELF.Date_Last_Seen_ := KEL.era.SimpleRoll(__recs,Date_Last_Seen_,MAX,FALSE);
    SELF := __r;
  END;
  SHARED __ST99477_Layout __ND104946__Rollup(__ST99477_Layout __r, DATASET(__ST99477_Layout) __recs) := TRANSFORM
    __recs_Exp1_ := NORMALIZE(__recs,__T(LEFT.Exp1_),TRANSFORM(__ST99473_Layout,SELF:=RIGHT));
    __recs_Exp1__allnull := NOT EXISTS(__recs(__NN(Exp1_)));
    SELF.Exp1_ := __BN(ROLLUP(GROUP(KEL.Routines.SortAndAppendFilteredChildren(__recs_Exp1_,'Customer_Person_Person_','customer_person_person_','clean','__recordcount,date_first_seen_,date_last_seen_'),Customer_Person_Person_Clean,ALL),GROUP,__ND105501__Rollup(ROW(LEFT,__ST99473_Layout), PROJECT(ROWS(LEFT),__ST99473_Layout))),__recs_Exp1__allnull);
    SELF.__RecordCount := SUM(__recs,__RecordCount);
    SELF.Date_First_Seen_ := KEL.era.SimpleRoll(__recs,Date_First_Seen_,MIN,TRUE);
    SELF.Date_Last_Seen_ := KEL.era.SimpleRoll(__recs,Date_Last_Seen_,MAX,FALSE);
    SELF := __r;
  END;
  EXPORT Res0 := __UNWRAP(ROLLUP(GROUP(KEL.Routines.SortAndAppendFilteredChildren(PROJECT(__EE102945,__ND104946__Project(LEFT)),'Exp1_,Exp1_.Customer_Person_Person_','exp1_','clean','__recordcount,date_first_seen_,date_last_seen_'),Source_Customer_,Entity_Context_Uid_,Label_,Exp1_Clean,ALL),GROUP,__ND104946__Rollup(ROW(LEFT,__ST99477_Layout), PROJECT(ROWS(LEFT),__ST99477_Layout))));
END;
