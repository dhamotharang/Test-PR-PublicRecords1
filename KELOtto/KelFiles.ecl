EXPORT KelFiles := MODULE
  //Cluster                               
  EXPORT FullCluster := KELOtto.FullGraph;
  
  //Stats
  EXPORT EntityStats := KELOtto.macPivotOttoOutput(KELOtto.Q__show_Customer_Person.Res0, 'industry_type_,customer_id_,entity_context_uid_', 'deceased_ssn_,_nas__summary_,_nap__summary_,_subjectssncount_,_dobmatchlevel_,_ssnfoundforlexid_,_addresspobox_,_addresscmra_,_cvicustomscore_,subject_ssn_count_,date_of_birth_match_level_,stolen_identity_index_,synthetic_identity_index_,manipulated_identity_index_,vulnerable_victim_index_,friendlyfraud_index_,suspicious_activity_index_,all_death_prior_to_all_events_,all_deceased_event_count_,all_deceased_event_percent_,all_high_risk_death_prior_to_all_events_,all_max_deceased_to_event_diff_,death_prior_to_all_events_,deceased_,deceased_dob_match_,deceased_event_count_,deceased_event_percent_,deceased_match_,deceased_match_description_,deceased_name_match_,entity_type_,high_risk_death_prior_to_all_events_,in_customer_population_,max_deceased_to_event_diff_,no_lex_id_,' + 
                        'Nas9_Flag_,Nap3_Flag_,Cl_Death_Prior_To_All_Events_Identity_Count_,Cl_High_Risk_Death_Prior_To_All_Events_Identity_Count_,Cl_Event_Count_,Cl_Identity_Count_,Cl_Full_Identity_Count_,Cl_Nas9_Identity_Count_,Cl_Nap3_Identity_Count_,Cl_Address_Count_,Cl_Identity_Event_Avg_');
  
  EXPORT CustomerStats := KELOtto.Q__show_Customer.Res0;
  EXPORT PersonStats := KELOtto.SlimDataSet(KELOtto.Q__show_Customer_Person.Res0, 'uid','_r_customer_,lex_id_,deceased_date_,deceased_date_of_birth_,deceased_first_,deceased_middle_,deceased_last_,deceased_match_code_,_isdeepdive_,_county__death_,deceased_ssn_,_state__death__flag_,_death__rec__src_,_state__death__id_,_verfirst_,_verlast_,_veraddr_,_vercity_,_verstate_,_verzip_,_verzip4_,_verssn_,_verdob_,_verhphone_,_verify__addr_,_verify__dob_,_valid__ssn_,_nas__summary_,_nap__summary_,_cvi_,_hri__1_,_hri__desc__1_,_hri__2_,_hri__desc__2_,_hri__3_,_hri__desc__3_,_hri__4_,_hri__desc__4_,_hri__5_,_hri__desc__5_,_hri__6_,_hri__desc__6_,_additional__fname__1_,_additional__lname__1_,_additional__lname__date__last__1_,_additional__fname__2_,_additional__lname__2_,_additional__lname__date__last__2_,_additional__fname__3_,_additional__lname__3_,_additional__lname__date__last__3_,_subjectssncount_,_dobmatchlevel_,_hri__7_,_hri__desc__7_,_hri__8_,_hri__desc__8_,_hri__9_,_hri__desc__9_,_hri__10_,_hri__desc__10_,_hri__11_,_hri__desc__11_,_hri__12_,_hri__desc__12_,_hri__13_,_hri__desc__13_,_hri__14_,_hri__desc__14_,_hri__15_,_hri__desc__15_,_hri__16_,_hri__desc__16_,_hri__17_,_hri__desc__17_,_hri__18_,_hri__desc__18_,_hri__19_,_hri__desc__19_,_hri__20_,_hri__desc__20_,_ssnfoundforlexid_,_addresspobox_,_addresscmra_,_cvicustomscore_,subject_ssn_count_,date_of_birth_match_level_,stolen_identity_index_,synthetic_identity_index_,manipulated_identity_index_,vulnerable_victim_index_,friendlyfraud_index_,suspicious_activity_index_,_v2__sourcerisklevel_,_v2__assocsuspicousidentitiescount_,_v2__assoccreditbureauonlycount_,_v2__validationaddrproblems_,_v2__validationipproblems_,_v2__ipstate_,_v2__ipcountry_,_v2__ipcontinent_,_v2__inputaddrageoldest_,_v2__inputaddrdwelltype_,_v2__divssnidentitycountnew_,all_death_prior_to_all_events_,all_deceased_event_percent_,all_high_risk_death_prior_to_all_events_,all_max_deceased_to_event_diff_,cl_address_count_,cl_death_prior_to_all_events_identity_count_,cl_event_count_,cl_full_identity_count_,cl_high_risk_death_prior_to_all_events_identity_count_,cl_high_risk_pattern1_flag_,cl_high_risk_pattern2_flag_,cl_high_risk_pattern3_flag_,cl_high_risk_pattern4_flag_,cl_high_risk_pattern5_flag_,cl_identity_count_,cl_identity_event_avg_,cl_nap3_identity_count_,cl_nas9_identity_count_,cluster_score_,customer_id_,death_prior_to_all_events_,deceased_,deceased_dob_match_,deceased_event_count_,deceased_event_percent_,deceased_match_,deceased_match_description_,deceased_name_match_,entity_context_uid_,entity_type_,high_risk_death_prior_to_all_events_,in_customer_population_,industry_type_,label_,max_deceased_to_event_diff_,no_lex_id_,other_customer_person_customer_count_,score_,source_customer_count_,nap3_flag_,nas9_flag_');

  // Associations
  EXPORT PersonAssociationsStats := JOIN(KELOtto.AddressPersonAssociations.PersonAddressMatchStats, PersonStats, LEFT.fdn_ind_type_gc_id_inclusion = RIGHT._r_customer_ AND LEFT.ToPersonEntityContextUid=RIGHT.entity_context_uid_, TRANSFORM({RECORDOF(LEFT), STRING ToPersonLabel, RIGHT.customer_id_, RIGHT.industry_type_}, SELF.ToPersonLabel := RIGHT.Label_, SELF := LEFT, SELF := RIGHT), KEEP(1), HASH);
  EXPORT PersonAssociationsDetails := KELOtto.AddressPersonAssociations.PersonAddressMatches;
  
  //ScoreBreakdown
  EXPORT ScoreBreakdown := KELOtto.MacScoreBreakdown(KELOtto.Q__show_Customer_Person.Res0);
  
  //Details
  EXPORT CustomerAddress := KELOtto.Q__show_Customer_Address.Res0;
  EXPORT PersonEvents := KELOtto.Q__show_Customer_Person_Event.Res0;
END;