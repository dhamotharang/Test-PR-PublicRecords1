//HPCC Systems KEL Compiler Version 0.11.0
IMPORT KEL011 AS KEL;
IMPORT B_Address_1,B_Customer_1,B_Customer_Address_1,B_Customer_Address_Person_1,B_Customer_Person_1,B_Person_1,B_Person_2,E_Address,E_Customer,E_Customer_Address,E_Person FROM KELOtto;
IMPORT * FROM KEL011.Null;
EXPORT B_Customer_Address := MODULE
  SHARED VIRTUAL TYPEOF(B_Address_1.__ENH_Address_1) __ENH_Address_1 := B_Address_1.__ENH_Address_1;
  SHARED VIRTUAL TYPEOF(B_Customer_1.__ENH_Customer_1) __ENH_Customer_1 := B_Customer_1.__ENH_Customer_1;
  SHARED VIRTUAL TYPEOF(B_Customer_Address_1.__ENH_Customer_Address_1) __ENH_Customer_Address_1 := B_Customer_Address_1.__ENH_Customer_Address_1;
  SHARED VIRTUAL TYPEOF(B_Customer_Address_Person_1.__ENH_Customer_Address_Person_1) __ENH_Customer_Address_Person_1 := B_Customer_Address_Person_1.__ENH_Customer_Address_Person_1;
  SHARED VIRTUAL TYPEOF(B_Customer_Person_1.__ENH_Customer_Person_1) __ENH_Customer_Person_1 := B_Customer_Person_1.__ENH_Customer_Person_1;
  SHARED VIRTUAL TYPEOF(B_Person_1.__ENH_Person_1) __ENH_Person_1 := B_Person_1.__ENH_Person_1;
  SHARED __EE67593 := __ENH_Customer_Address_1;
  SHARED __EE67874 := __ENH_Customer_Person_1;
  SHARED __EE72494 := __EE67874(__NN(__EE67874.Subject_) AND __NN(__EE67874.Source_Customer_));
  SHARED __EE68898 := __EE67593;
  SHARED __EE72793 := __EE68898(__NN(__EE68898.Location_) AND __NN(__EE68898.Source_Customer_));
  SHARED __EE67688 := __ENH_Customer_Address_Person_1;
  SHARED __EE74029 := __EE67688;
  SHARED __EE74071 := __EE74029(__NN(__EE74029.Subject_) AND __NN(__EE74029.Location_));
  SHARED __ST74951_Layout := RECORD
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE74955 := DEDUP(PROJECT(__EE74071,__ST74951_Layout),ALL);
  SHARED __ST74963_Layout := RECORD
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE74967 := PROJECT(__EE74955,TRANSFORM(__ST74963_Layout,SELF.Location__1_ := LEFT.Location_,SELF := LEFT));
  SHARED __ST74991_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76528(B_Customer_Address_1.__ST3328_Layout __EE72793, __ST74963_Layout __EE74967) := __EEQP(__EE72793.Location_,__EE74967.Location__1_);
  __ST74991_Layout __JT76528(B_Customer_Address_1.__ST3328_Layout __l, __ST74963_Layout __r) := TRANSFORM
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76529 := JOIN(__EE72793,__EE74967,__JC76528(LEFT,RIGHT),__JT76528(LEFT,RIGHT),INNER,HASH);
  SHARED __ST69443_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.int All_Death_Prior_To_All_Events_ := 0;
    KEL.typ.nfloat All_Deceased_Event_Percent_;
    KEL.typ.nint All_Max_Deceased_To_Event_Diff_;
    KEL.typ.int Customer_Person_Customer_Count_ := 0;
    KEL.typ.int Death_Prior_To_All_Events_ := 0;
    KEL.typ.nfloat Deceased_Event_Percent_;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_ := 0;
    KEL.typ.nint Max_Deceased_To_Event_Diff_;
    KEL.typ.nint Score_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.ntyp(E_Person.Typ) Subject__1_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76544(B_Customer_Person_1.__ST3363_Layout __EE72494, __ST74991_Layout __EE76529) := __NNEQ(__EE72494.Source_Customer_,__EE76529.Source_Customer_) AND __EEQP(__EE76529.Subject_,__EE72494.Subject_) AND __T(__AND(__OP2(__EE72494.Source_Customer_,=,__EE76529.Source_Customer_),__EEQ(__EE76529.Subject_,__EE72494.Subject_)));
  __ST69443_Layout __JT76544(B_Customer_Person_1.__ST3363_Layout __l, __ST74991_Layout __r) := TRANSFORM
    SELF.Source_Customer__1_ := __r.Source_Customer_;
    SELF.Subject__1_ := __r.Subject_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76545 := JOIN(__EE76529,__EE72494,__JC76544(RIGHT,LEFT),__JT76544(RIGHT,LEFT),INNER,HASH);
  SHARED __ST68943_Layout := RECORD
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.nint Score_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE76567 := PROJECT(__EE76545,TRANSFORM(__ST68943_Layout,SELF.Source_Customer_ := LEFT.Source_Customer__1_,SELF := LEFT));
  SHARED __ST68966_Layout := RECORD
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.nint Score_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE76585 := PROJECT(__EE76567,__ST68966_Layout);
  SHARED __ST68985_Layout := RECORD
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE76606 := PROJECT(__CLEANANDDO(__EE76585,TABLE(__EE76585,{KEL.Aggregates.MaxNG(__EE76585.Score_) M_A_X___Score_,Location_,Source_Customer_},Location_,Source_Customer_,MERGE)),__ST68985_Layout);
  SHARED __ST69641_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76621(B_Customer_Address_1.__ST3328_Layout __EE67593, __ST68985_Layout __EE76606) := __EEQP(__EE67593.Source_Customer_,__EE76606.Source_Customer_) AND __EEQP(__EE67593.Location_,__EE76606.Location_);
  __ST69641_Layout __JT76621(B_Customer_Address_1.__ST3328_Layout __l, __ST68985_Layout __r) := TRANSFORM
    SELF.Location__1_ := __r.Location_;
    SELF.Source_Customer__1_ := __r.Source_Customer_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76622 := JOIN(__EE67593,__EE76606,__JC76621(LEFT,RIGHT),__JT76621(LEFT,RIGHT),LEFT OUTER,MANY LOOKUP);
  SHARED __EE76624 := __EE76585;
  SHARED __ST68677_Layout := RECORD
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  __ST68677_WeightLayout := {KEL.typ.int M_E_D_I_A_N___Score_};
  __ST68677_WeightLayout __ST68677_WeightCalc(KEL.Aggregates.RankedFieldN __r) := TRANSFORM
    SELF.M_E_D_I_A_N___Score_ := IF(__r.number = 1,KEL.Aggregates.NTileWeight(2,1,__r.size,__r.pos),0);
  END;
  __ST68677_Layout __ST68677_Normalize(__ST68677_Layout __r) := TRANSFORM
    SELF.M_E_D_I_A_N___Score_ := __OP2(__r.M_E_D_I_A_N___Score_,/,__CN(2));
    SELF := __r;
  END;
  __RK76631 := KEL.Aggregates.RankingGroupedSmall2(__EE76624,'Score_','Location_,Source_Customer_',__ST68677_WeightLayout,__ST68677_Layout,__ST68677_WeightCalc,__ST68677_Normalize,TRUE,FALSE,FALSE);
  SHARED __EE76645 := __RK76631;
  SHARED __ST69820_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__2_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__2_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76660(__ST69641_Layout __EE76622, __ST68677_Layout __EE76645) := __EEQP(__EE76622.Location_,__EE76645.Location_) AND __EEQP(__EE76622.Source_Customer_,__EE76645.Source_Customer_);
  __ST69820_Layout __JT76660(__ST69641_Layout __l, __ST68677_Layout __r) := TRANSFORM
    SELF.Location__2_ := __r.Location_;
    SELF.Source_Customer__2_ := __r.Source_Customer_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76661 := JOIN(__EE76622,__EE76645,__JC76660(LEFT,RIGHT),__JT76660(LEFT,RIGHT),LEFT OUTER,MANY LOOKUP);
  SHARED __EE73322 := __EE67688(__NN(__EE67688.Subject_) AND __NN(__EE67688.Location_) AND __NN(__EE67688.Associated_Customer_) AND __NN(__EE67688.Location_));
  SHARED __EE67719 := __ENH_Person_1;
  SHARED __EE68475 := __EE67719(__EE67719.Deceased_ = 1);
  __JC73334(B_Customer_Address_Person_1.__ST3349_Layout __EE73322, B_Person_1.__ST3504_Layout __EE68475) := __EEQP(__EE73322.Subject_,__EE68475.UID);
  SHARED __EE73335 := JOIN(__EE73322,__EE68475,__JC73334(LEFT,RIGHT),TRANSFORM(B_Customer_Address_Person_1.__ST3349_Layout,SELF:=LEFT),HASH,KEEP(1));
  SHARED __EE74056 := __EE72793;
  SHARED __ST75507_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST75507_Layout __ND76666__Project(B_Customer_Address_1.__ST3328_Layout __PP76662) := TRANSFORM
    SELF.Source_Customer__1_ := __PP76662.Source_Customer_;
    SELF.Location__1_ := __PP76662.Location_;
    SELF := __PP76662;
  END;
  SHARED __EE76715 := PROJECT(__EE74056,__ND76666__Project(LEFT));
  SHARED __ST75537_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Customer.Typ) Associated_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.nint Event_Count_;
    KEL.typ.nint High_Risk_Death_Prior_To_All_Events_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76736(B_Customer_Address_Person_1.__ST3349_Layout __EE73335, __ST75507_Layout __EE76715) := __NNEQ(__EE73335.Location_,__EE76715.Location__1_) AND __NNEQ(__EE73335.Associated_Customer_,__EE76715.Source_Customer__1_) AND __EEQP(__EE76715.Location__1_,__EE73335.Location_) AND __T(__AND(__OP2(__EE73335.Location_,=,__EE76715.Location__1_),__AND(__OP2(__EE73335.Associated_Customer_,=,__EE76715.Source_Customer__1_),__EEQ(__EE76715.Location__1_,__EE73335.Location_))));
  __ST75537_Layout __JT76736(B_Customer_Address_Person_1.__ST3349_Layout __l, __ST75507_Layout __r) := TRANSFORM
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76737 := JOIN(__EE76715,__EE73335,__JC76736(RIGHT,LEFT),__JT76736(RIGHT,LEFT),INNER,HASH);
  SHARED __ST68371_Layout := RECORD
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST68371_Layout __ND76742__Project(__ST75537_Layout __PP76738) := TRANSFORM
    SELF.Location_ := __PP76738.Location__1_;
    SELF.Source_Customer_ := __PP76738.Source_Customer__1_;
    SELF := __PP76738;
  END;
  SHARED __EE76755 := DEDUP(PROJECT(__EE76737,__ND76742__Project(LEFT)),ALL);
  SHARED __ST68395_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := 0;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE76774 := PROJECT(__CLEANANDDO(__EE76755,TABLE(__EE76755,{KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := COUNT(GROUP),Location_,Source_Customer_},Location_,Source_Customer_,MERGE)),__ST68395_Layout);
  SHARED __ST69995_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__2_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__2_;
    KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := 0;
    KEL.typ.ntyp(E_Address.Typ) Location__3_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__3_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76789(__ST69820_Layout __EE76661, __ST68395_Layout __EE76774) := __EEQP(__EE76661.Location_,__EE76774.Location_) AND __EEQP(__EE76661.Source_Customer_,__EE76774.Source_Customer_);
  __ST69995_Layout __JT76789(__ST69820_Layout __l, __ST68395_Layout __r) := TRANSFORM
    SELF.Location__3_ := __r.Location_;
    SELF.Source_Customer__3_ := __r.Source_Customer_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76790 := JOIN(__EE76661,__EE76774,__JC76789(LEFT,RIGHT),__JT76789(LEFT,RIGHT),LEFT OUTER,MANY LOOKUP);
  SHARED __EE67986 := __ENH_Customer_1;
  SHARED __EE74023 := __EE67986;
  SHARED __ST70166_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__2_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__2_;
    KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := 0;
    KEL.typ.ntyp(E_Address.Typ) Location__3_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__3_;
    KEL.typ.nuid UID;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nint Industry_Type_;
    KEL.typ.nint Fdn_File_Info_Id_;
    KEL.typ.int Address_Count_ := 0;
    KEL.typ.int All_Customer_Person_Count_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count_ := 0;
    KEL.typ.int Customer_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count__1_ := 0;
    KEL.typ.int High_Frequency_Address_Count_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76799(__ST69995_Layout __EE76790, B_Customer_1.__ST3312_Layout __EE74023) := __EEQP(__EE76790.Source_Customer_,__EE74023.UID);
  __ST70166_Layout __JT76799(__ST69995_Layout __l, B_Customer_1.__ST3312_Layout __r) := TRANSFORM
    SELF.Deceased_Person_Count__1_ := __r.Deceased_Person_Count_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76800 := JOIN(__EE76790,__EE74023,__JC76799(LEFT,RIGHT),__JT76799(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE67660 := __ENH_Address_1;
  SHARED __EE74020 := __EE67660;
  SHARED __ST70342_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__2_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__2_;
    KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := 0;
    KEL.typ.ntyp(E_Address.Typ) Location__3_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__3_;
    KEL.typ.nuid UID;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nint Industry_Type_;
    KEL.typ.nint Fdn_File_Info_Id_;
    KEL.typ.int Address_Count_ := 0;
    KEL.typ.int All_Customer_Person_Count_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count_ := 0;
    KEL.typ.int Customer_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count__1_ := 0;
    KEL.typ.int High_Frequency_Address_Count_ := 0;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.nint Z_I_P_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.nbool _is_Additional_;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Full_Address_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76809(__ST70166_Layout __EE76800, B_Address_1.__ST3274_Layout __EE74020) := __EEQP(__EE76800.Location_,__EE74020.UID);
  __ST70342_Layout __JT76809(__ST70166_Layout __l, B_Address_1.__ST3274_Layout __r) := TRANSFORM
    SELF.U_I_D__1_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76810 := JOIN(__EE76800,__EE74020,__JC76809(LEFT,RIGHT),__JT76809(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __ST70545_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__2_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__2_;
    KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := 0;
    KEL.typ.ntyp(E_Address.Typ) Location__3_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__3_;
    KEL.typ.nuid UID;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nint Industry_Type_;
    KEL.typ.nint Fdn_File_Info_Id_;
    KEL.typ.int Address_Count_ := 0;
    KEL.typ.int All_Customer_Person_Count_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count_ := 0;
    KEL.typ.int Customer_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count__1_ := 0;
    KEL.typ.int High_Frequency_Address_Count_ := 0;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.nint Z_I_P_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.nbool _is_Additional_;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Full_Address_;
    KEL.typ.nuid U_I_D__2_;
    KEL.typ.nint Customer_Id__1_;
    KEL.typ.nint Industry_Type__1_;
    KEL.typ.nint Fdn_File_Info_Id__1_;
    KEL.typ.int Address_Count__1_ := 0;
    KEL.typ.int All_Customer_Person_Count__1_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count__1_ := 0;
    KEL.typ.int Customer_Person_Count__1_ := 0;
    KEL.typ.int Deceased_Person_Count__2_ := 0;
    KEL.typ.int High_Frequency_Address_Count__1_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76819(__ST70342_Layout __EE76810, B_Customer_1.__ST3312_Layout __EE67986) := __EEQP(__EE76810.Source_Customer_,__EE67986.UID);
  __ST70545_Layout __JT76819(__ST70342_Layout __l, B_Customer_1.__ST3312_Layout __r) := TRANSFORM
    SELF.U_I_D__2_ := __r.UID;
    SELF.Customer_Id__1_ := __r.Customer_Id_;
    SELF.Industry_Type__1_ := __r.Industry_Type_;
    SELF.Fdn_File_Info_Id__1_ := __r.Fdn_File_Info_Id_;
    SELF.Address_Count__1_ := __r.Address_Count_;
    SELF.All_Customer_Person_Count__1_ := __r.All_Customer_Person_Count_;
    SELF.All_Deceased_Matched_Person_Count__1_ := __r.All_Deceased_Matched_Person_Count_;
    SELF.Customer_Person_Count__1_ := __r.Customer_Person_Count_;
    SELF.Deceased_Person_Count__2_ := __r.Deceased_Person_Count_;
    SELF.High_Frequency_Address_Count__1_ := __r.High_Frequency_Address_Count_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76820 := JOIN(__EE76810,__EE67986,__JC76819(LEFT,RIGHT),__JT76819(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __ST70773_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint M_A_X___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__1_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__1_;
    KEL.typ.nint M_E_D_I_A_N___Score_;
    KEL.typ.ntyp(E_Address.Typ) Location__2_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__2_;
    KEL.typ.int C_O_U_N_T___Customer_Address_Person_ := 0;
    KEL.typ.ntyp(E_Address.Typ) Location__3_;
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer__3_;
    KEL.typ.nuid UID;
    KEL.typ.nint Customer_Id_;
    KEL.typ.nint Industry_Type_;
    KEL.typ.nint Fdn_File_Info_Id_;
    KEL.typ.int Address_Count_ := 0;
    KEL.typ.int All_Customer_Person_Count_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count_ := 0;
    KEL.typ.int Customer_Person_Count_ := 0;
    KEL.typ.int Deceased_Person_Count__1_ := 0;
    KEL.typ.int High_Frequency_Address_Count_ := 0;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.nint Z_I_P_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.nbool _is_Additional_;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Full_Address_;
    KEL.typ.nuid U_I_D__2_;
    KEL.typ.nint Customer_Id__1_;
    KEL.typ.nint Industry_Type__1_;
    KEL.typ.nint Fdn_File_Info_Id__1_;
    KEL.typ.int Address_Count__1_ := 0;
    KEL.typ.int All_Customer_Person_Count__1_ := 0;
    KEL.typ.int All_Deceased_Matched_Person_Count__1_ := 0;
    KEL.typ.int Customer_Person_Count__1_ := 0;
    KEL.typ.int Deceased_Person_Count__2_ := 0;
    KEL.typ.int High_Frequency_Address_Count__1_ := 0;
    KEL.typ.nuid U_I_D__3_;
    KEL.typ.nstr Primary_Range__1_;
    KEL.typ.nstr Predirectional__1_;
    KEL.typ.nstr Primary_Name__1_;
    KEL.typ.nstr Suffix__1_;
    KEL.typ.nstr Postdirectional__1_;
    KEL.typ.nstr Unit_Designation__1_;
    KEL.typ.nstr Secondary_Range__1_;
    KEL.typ.nstr Postal_City__1_;
    KEL.typ.nstr Vanity_City__1_;
    KEL.typ.nstr State__1_;
    KEL.typ.nint Z_I_P__1_;
    KEL.typ.nint Z_I_P4__1_;
    KEL.typ.nstr Carrier_Route_Number__1_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P__1_;
    KEL.typ.nint Line_Of_Travel__1_;
    KEL.typ.nstr Line_Of_Travel_Order__1_;
    KEL.typ.nint Delivery_Point_Barcode__1_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit__1_;
    KEL.typ.nstr Type_Code__1_;
    KEL.typ.nint County__1_;
    KEL.typ.nfloat Latitude__1_;
    KEL.typ.nfloat Longitude__1_;
    KEL.typ.nint Metropolitan_Statistical_Area__1_;
    KEL.typ.nint Geo_Block__1_;
    KEL.typ.nstr Geo_Match__1_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code__1_;
    KEL.typ.nbool _is_Additional__1_;
    KEL.typ.nunk Entity_Context_Uid__1_;
    KEL.typ.nstr Full_Address__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC76829(__ST70545_Layout __EE76820, B_Address_1.__ST3274_Layout __EE67660) := __EEQP(__EE76820.Location_,__EE67660.UID);
  __ST70773_Layout __JT76829(__ST70545_Layout __l, B_Address_1.__ST3274_Layout __r) := TRANSFORM
    SELF.U_I_D__3_ := __r.UID;
    SELF.Primary_Range__1_ := __r.Primary_Range_;
    SELF.Predirectional__1_ := __r.Predirectional_;
    SELF.Primary_Name__1_ := __r.Primary_Name_;
    SELF.Suffix__1_ := __r.Suffix_;
    SELF.Postdirectional__1_ := __r.Postdirectional_;
    SELF.Unit_Designation__1_ := __r.Unit_Designation_;
    SELF.Secondary_Range__1_ := __r.Secondary_Range_;
    SELF.Postal_City__1_ := __r.Postal_City_;
    SELF.Vanity_City__1_ := __r.Vanity_City_;
    SELF.State__1_ := __r.State_;
    SELF.Z_I_P__1_ := __r.Z_I_P_;
    SELF.Z_I_P4__1_ := __r.Z_I_P4_;
    SELF.Carrier_Route_Number__1_ := __r.Carrier_Route_Number_;
    SELF.Carrier_Route_Sortation_At_Z_I_P__1_ := __r.Carrier_Route_Sortation_At_Z_I_P_;
    SELF.Line_Of_Travel__1_ := __r.Line_Of_Travel_;
    SELF.Line_Of_Travel_Order__1_ := __r.Line_Of_Travel_Order_;
    SELF.Delivery_Point_Barcode__1_ := __r.Delivery_Point_Barcode_;
    SELF.Delivery_Point_Barcode_Check_Digit__1_ := __r.Delivery_Point_Barcode_Check_Digit_;
    SELF.Type_Code__1_ := __r.Type_Code_;
    SELF.County__1_ := __r.County_;
    SELF.Latitude__1_ := __r.Latitude_;
    SELF.Longitude__1_ := __r.Longitude_;
    SELF.Metropolitan_Statistical_Area__1_ := __r.Metropolitan_Statistical_Area_;
    SELF.Geo_Block__1_ := __r.Geo_Block_;
    SELF.Geo_Match__1_ := __r.Geo_Match_;
    SELF.A_C_E_Cleaner_Error_Code__1_ := __r.A_C_E_Cleaner_Error_Code_;
    SELF._is_Additional__1_ := __r._is_Additional_;
    SELF.Entity_Context_Uid__1_ := __r.Entity_Context_Uid_;
    SELF.Full_Address__1_ := __r.Full_Address_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE76830 := JOIN(__EE76820,__EE67660,__JC76829(LEFT,RIGHT),__JT76829(LEFT,RIGHT),LEFT OUTER,HASH);
  EXPORT __ST2868_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Address.Typ) Location_;
    KEL.typ.nunk Address_Entity_Context_Uid_;
    KEL.typ.int All_Deceased_Match_Person_Count_ := 0;
    KEL.typ.float All_Deceased_Match_Person_Percent_ := 0.0;
    KEL.typ.int All_Deceased_Person_Count_ := 0;
    KEL.typ.float All_Deceased_Person_Percent_ := 0.0;
    KEL.typ.int All_High_Frequency_Flag_ := 0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.int All_High_Risk_Death_Prior_To_All_Events_Person_Percent_Flag_ := 0;
    KEL.typ.int All_Person_Count_ := 0;
    KEL.typ.nint Cluster_Score_;
    KEL.typ.nint Customer_Id_;
    KEL.typ.int Deceased_Match_Person_Count_ := 0;
    KEL.typ.float Deceased_Match_Person_Percent_ := 0.0;
    KEL.typ.int Deceased_Person_Count_ := 0;
    KEL.typ.float Deceased_Person_Percent_ := 0.0;
    KEL.typ.nstr Full_Address_;
    KEL.typ.int High_Frequency_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Percent_Flag_ := 0;
    KEL.typ.int High_Risk_Death_Prior_To_All_Events_Person_Count_ := 0;
    KEL.typ.float High_Risk_Death_Prior_To_All_Events_Person_Percent_ := 0.0;
    KEL.typ.nint Industry_Type_;
    KEL.typ.int Person_Count_ := 0;
    KEL.typ.nint Score_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST2868_Layout __ND76396__Project(__ST70773_Layout __PP76230) := TRANSFORM
    SELF.Address_Entity_Context_Uid_ := __PP76230.Entity_Context_Uid__1_;
    SELF.All_Deceased_Match_Person_Percent_ := __PP76230.All_Deceased_Match_Person_Count_ / __PP76230.All_Person_Count_;
    SELF.All_Deceased_Person_Count_ := __PP76230.C_O_U_N_T___Customer_Address_Person_;
    SELF.All_Deceased_Person_Percent_ := __PP76230.Deceased_Person_Count_ / __PP76230.Person_Count_;
    SELF.All_High_Frequency_Flag_ := MAP(__PP76230.All_Person_Count_ >= 20=>1,0);
    SELF.All_High_Risk_Death_Prior_To_All_Events_Person_Percent_Flag_ := MAP(__PP76230.All_High_Risk_Death_Prior_To_All_Events_Person_Percent_ > 0.1=>1,0);
    SELF.Cluster_Score_ := __PP76230.M_E_D_I_A_N___Score_;
    SELF.Customer_Id_ := __PP76230.Customer_Id__1_;
    SELF.Deceased_Match_Person_Percent_ := __PP76230.Deceased_Match_Person_Count_ / __PP76230.Person_Count_;
    SELF.Deceased_Person_Percent_ := __PP76230.Deceased_Person_Count_ / __PP76230.Person_Count_;
    SELF.High_Risk_Death_Prior_To_All_Events_Percent_Flag_ := MAP(__PP76230.High_Risk_Death_Prior_To_All_Events_Person_Percent_ > 0.1=>1,0);
    SELF.Score_ := __PP76230.M_A_X___Score_;
    SELF := __PP76230;
  END;
  EXPORT __ENH_Customer_Address := PROJECT(__EE76830,__ND76396__Project(LEFT)) : PERSIST('~temp::KEL::KELOtto::Customer_Address::Annotated',EXPIRE(30));
  SHARED __EE627444 := __ENH_Customer_Address;
  SHARED __IDX_Customer_Address_Location__Filtered := __EE627444(__NN(__EE627444.Location_));
  SHARED IDX_Customer_Address_Location__Layout := RECORD
    E_Address.Typ Location_;
    __IDX_Customer_Address_Location__Filtered.Source_Customer_;
    __IDX_Customer_Address_Location__Filtered.Industry_Type_;
    __IDX_Customer_Address_Location__Filtered.Customer_Id_;
    __IDX_Customer_Address_Location__Filtered.Address_Entity_Context_Uid_;
    __IDX_Customer_Address_Location__Filtered.Full_Address_;
    __IDX_Customer_Address_Location__Filtered.Person_Count_;
    __IDX_Customer_Address_Location__Filtered.High_Frequency_Flag_;
    __IDX_Customer_Address_Location__Filtered.All_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.All_High_Frequency_Flag_;
    __IDX_Customer_Address_Location__Filtered.Deceased_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.Deceased_Person_Percent_;
    __IDX_Customer_Address_Location__Filtered.All_Deceased_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.All_Deceased_Person_Percent_;
    __IDX_Customer_Address_Location__Filtered.Deceased_Match_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.Deceased_Match_Person_Percent_;
    __IDX_Customer_Address_Location__Filtered.All_Deceased_Match_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.All_Deceased_Match_Person_Percent_;
    __IDX_Customer_Address_Location__Filtered.High_Risk_Death_Prior_To_All_Events_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.High_Risk_Death_Prior_To_All_Events_Person_Percent_;
    __IDX_Customer_Address_Location__Filtered.High_Risk_Death_Prior_To_All_Events_Percent_Flag_;
    __IDX_Customer_Address_Location__Filtered.All_High_Risk_Death_Prior_To_All_Events_Person_Count_;
    __IDX_Customer_Address_Location__Filtered.All_High_Risk_Death_Prior_To_All_Events_Person_Percent_;
    __IDX_Customer_Address_Location__Filtered.All_High_Risk_Death_Prior_To_All_Events_Person_Percent_Flag_;
    __IDX_Customer_Address_Location__Filtered.Score_;
    __IDX_Customer_Address_Location__Filtered.Cluster_Score_;
    __IDX_Customer_Address_Location__Filtered.Date_First_Seen_;
    __IDX_Customer_Address_Location__Filtered.Date_Last_Seen_;
    __IDX_Customer_Address_Location__Filtered.__RecordCount;
  END;
  SHARED IDX_Customer_Address_Location__Projected := PROJECT(__IDX_Customer_Address_Location__Filtered,TRANSFORM(IDX_Customer_Address_Location__Layout,SELF.Location_:=__T(LEFT.Location_),SELF:=LEFT));
  EXPORT IDX_Customer_Address_Location_ := INDEX(IDX_Customer_Address_Location__Projected,{Location_},{IDX_Customer_Address_Location__Projected},'~key::KEL::KELOtto::Customer_Address::Location_');
  EXPORT IDX_Customer_Address_Location__Build := BUILD(IDX_Customer_Address_Location_,OVERWRITE);
  EXPORT __ST627446_Layout := RECORDOF(IDX_Customer_Address_Location_);
  EXPORT IDX_Customer_Address_Location__Wrapped := PROJECT(IDX_Customer_Address_Location_,TRANSFORM(__ST2868_Layout,SELF.Location_ := __CN(LEFT.Location_),SELF:=LEFT));
  EXPORT BuildAll := PARALLEL(IDX_Customer_Address_Location__Build);
END;
