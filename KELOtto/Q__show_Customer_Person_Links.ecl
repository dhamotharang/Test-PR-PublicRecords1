//HPCC Systems KEL Compiler Version 0.11.0
IMPORT KEL011 AS KEL;
IMPORT B_Person,B_Person_1,E_Customer,E_Customer_Person,E_Customer_Person_Person,E_Person FROM KELOtto;
IMPORT * FROM KEL011.Null;
EXPORT Q__show_Customer_Person_Links := MODULE
  SHARED TYPEOF(E_Customer_Person.__Result) __E_Customer_Person := E_Customer_Person.__Result;
  SHARED TYPEOF(E_Customer_Person_Person.__Result) __E_Customer_Person_Person := E_Customer_Person_Person.__Result;
  SHARED TYPEOF(B_Person.__ENH_Person) __ENH_Person := B_Person.__ENH_Person;
  SHARED __EE95964 := __E_Customer_Person;
  SHARED __EE95966 := __ENH_Person;
  SHARED __ST95076_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.ntyp(E_Person.Typ) Subject_;
    KEL.typ.nuid UID;
    KEL.typ.nint Lex_Id_;
    KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
    KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
    KEL.typ.nkdate Deceased_Date_;
    KEL.typ.nkdate Deceased_Date_Of_Birth_;
    KEL.typ.nstr Deceased_First_;
    KEL.typ.nstr Deceased_Last_;
    KEL.typ.nint Associated_Ssn_Count_;
    KEL.typ.nint Date_Of_Birth_Match_Level_;
    KEL.typ.nint Stolen_Identity_Index_;
    KEL.typ.nint Synthetic_Identity_Index_;
    KEL.typ.nint Manipulated_Identity_Index_;
    KEL.typ.nint Vulnerable_Victim_Index_;
    KEL.typ.nint Friendlyfraud_Index_;
    KEL.typ.nint Suspicious_Activity_Index_;
    B_Person_1.__NS17101_Layout Best_Full_Name_;
    KEL.typ.int Deceased_ := 0;
    KEL.typ.int Deceased_Dob_Match_ := 0;
    KEL.typ.int Deceased_Match_ := 0;
    KEL.typ.str Deceased_Match_Description_ := '';
    KEL.typ.int Deceased_Name_Match_ := 0;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Label_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC95975(E_Customer_Person.Layout __EE95964, B_Person.__ST2096_Layout __EE95966) := __EEQP(__EE95964.Subject_,__EE95966.UID);
  __ST95076_Layout __JT95975(E_Customer_Person.Layout __l, B_Person.__ST2096_Layout __r) := TRANSFORM
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE95976 := JOIN(__EE95964,__EE95966,__JC95975(LEFT,RIGHT),__JT95975(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __ST1815_Layout := RECORD
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST1819_Layout := RECORD
    KEL.typ.ndataset(__ST1815_Layout) Customer_Person_Person_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST1823_Layout := RECORD
    KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
    KEL.typ.nunk Entity_Context_Uid_;
    KEL.typ.nstr Label_;
    KEL.typ.ndataset(__ST1819_Layout) Exp1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST1823_Layout __ND97395__Project(__ST95076_Layout __PP95340) := TRANSFORM
    __EE96625 := __EE95966;
    __EE95057 := __E_Customer_Person_Person;
    __EE95996 := __EE95057(__NN(__EE95057.To_Person_) AND __NN(__EE95057.From_Person_));
    __EE96622 := __EE95966;
    __ST94305_Layout := RECORD
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) From_Person_;
      KEL.typ.ntyp(E_Person.Typ) To_Person_;
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC96642(E_Customer_Person_Person.Layout __EE95996, B_Person.__ST2096_Layout __EE96622) := __EEQP(__EE95996.To_Person_,__EE96622.UID);
    __ST94305_Layout __JT96642(E_Customer_Person_Person.Layout __l, B_Person.__ST2096_Layout __r) := TRANSFORM
      SELF := __l;
      SELF := __r;
    END;
    __EE96643 := JOIN(__EE95996,__EE96622,__JC96642(LEFT,RIGHT),__JT96642(LEFT,RIGHT),INNER,HASH);
    __ST94382_Layout := RECORD
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) From_Person_;
      KEL.typ.ntyp(E_Person.Typ) To_Person_;
      KEL.typ.nuid U_I_D__1_;
      KEL.typ.nint Lex_Id__1_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth__1_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name__1_;
      KEL.typ.nkdate Deceased_Date__1_;
      KEL.typ.nkdate Deceased_Date_Of_Birth__1_;
      KEL.typ.nstr Deceased_First__1_;
      KEL.typ.nstr Deceased_Last__1_;
      KEL.typ.nint Associated_Ssn_Count__1_;
      KEL.typ.nint Date_Of_Birth_Match_Level__1_;
      KEL.typ.nint Stolen_Identity_Index__1_;
      KEL.typ.nint Synthetic_Identity_Index__1_;
      KEL.typ.nint Manipulated_Identity_Index__1_;
      KEL.typ.nint Vulnerable_Victim_Index__1_;
      KEL.typ.nint Friendlyfraud_Index__1_;
      KEL.typ.nint Suspicious_Activity_Index__1_;
      B_Person_1.__NS17101_Layout Best_Full_Name__1_;
      KEL.typ.int Deceased__1_ := 0;
      KEL.typ.int Deceased_Dob_Match__1_ := 0;
      KEL.typ.int Deceased_Match__1_ := 0;
      KEL.typ.str Deceased_Match_Description__1_ := '';
      KEL.typ.int Deceased_Name_Match__1_ := 0;
      KEL.typ.nunk Entity_Context_Uid__1_;
      KEL.typ.nstr Label__1_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC96693(B_Person.__ST2096_Layout __EE96625, __ST94305_Layout __EE96643) := __EEQP(__EE96643.From_Person_,__EE96625.UID);
    __ST94382_Layout __JT96693(B_Person.__ST2096_Layout __l, __ST94305_Layout __r) := TRANSFORM
      SELF.U_I_D__1_ := __r.UID;
      SELF.Lex_Id__1_ := __r.Lex_Id_;
      SELF.Reported_Date_Of_Birth__1_ := __r.Reported_Date_Of_Birth_;
      SELF.Full_Name__1_ := __r.Full_Name_;
      SELF.Deceased_Date__1_ := __r.Deceased_Date_;
      SELF.Deceased_Date_Of_Birth__1_ := __r.Deceased_Date_Of_Birth_;
      SELF.Deceased_First__1_ := __r.Deceased_First_;
      SELF.Deceased_Last__1_ := __r.Deceased_Last_;
      SELF.Associated_Ssn_Count__1_ := __r.Associated_Ssn_Count_;
      SELF.Date_Of_Birth_Match_Level__1_ := __r.Date_Of_Birth_Match_Level_;
      SELF.Stolen_Identity_Index__1_ := __r.Stolen_Identity_Index_;
      SELF.Synthetic_Identity_Index__1_ := __r.Synthetic_Identity_Index_;
      SELF.Manipulated_Identity_Index__1_ := __r.Manipulated_Identity_Index_;
      SELF.Vulnerable_Victim_Index__1_ := __r.Vulnerable_Victim_Index_;
      SELF.Friendlyfraud_Index__1_ := __r.Friendlyfraud_Index_;
      SELF.Suspicious_Activity_Index__1_ := __r.Suspicious_Activity_Index_;
      SELF.Best_Full_Name__1_ := __r.Best_Full_Name_;
      SELF.Deceased__1_ := __r.Deceased_;
      SELF.Deceased_Dob_Match__1_ := __r.Deceased_Dob_Match_;
      SELF.Deceased_Match__1_ := __r.Deceased_Match_;
      SELF.Deceased_Match_Description__1_ := __r.Deceased_Match_Description_;
      SELF.Deceased_Name_Match__1_ := __r.Deceased_Name_Match_;
      SELF.Entity_Context_Uid__1_ := __r.Entity_Context_Uid_;
      SELF.Label__1_ := __r.Label_;
      SELF := __l;
      SELF := __r;
    END;
    __EE96694 := JOIN(__EE96643,__EE96625,__JC96693(RIGHT,LEFT),__JT96693(RIGHT,LEFT),INNER,HASH);
    __EE96831 := __EE96694(__T(__OP2(__EE96694.Lex_Id_,<,__EE96694.Lex_Id__1_)));
    __EE96619 := __EE95966;
    __ST94565_Layout := RECORD
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) From_Person_;
      KEL.typ.ntyp(E_Person.Typ) To_Person_;
      KEL.typ.nuid U_I_D__1_;
      KEL.typ.nint Lex_Id__1_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth__1_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name__1_;
      KEL.typ.nkdate Deceased_Date__1_;
      KEL.typ.nkdate Deceased_Date_Of_Birth__1_;
      KEL.typ.nstr Deceased_First__1_;
      KEL.typ.nstr Deceased_Last__1_;
      KEL.typ.nint Associated_Ssn_Count__1_;
      KEL.typ.nint Date_Of_Birth_Match_Level__1_;
      KEL.typ.nint Stolen_Identity_Index__1_;
      KEL.typ.nint Synthetic_Identity_Index__1_;
      KEL.typ.nint Manipulated_Identity_Index__1_;
      KEL.typ.nint Vulnerable_Victim_Index__1_;
      KEL.typ.nint Friendlyfraud_Index__1_;
      KEL.typ.nint Suspicious_Activity_Index__1_;
      B_Person_1.__NS17101_Layout Best_Full_Name__1_;
      KEL.typ.int Deceased__1_ := 0;
      KEL.typ.int Deceased_Dob_Match__1_ := 0;
      KEL.typ.int Deceased_Match__1_ := 0;
      KEL.typ.str Deceased_Match_Description__1_ := '';
      KEL.typ.int Deceased_Name_Match__1_ := 0;
      KEL.typ.nunk Entity_Context_Uid__1_;
      KEL.typ.nstr Label__1_;
      KEL.typ.nuid U_I_D__2_;
      KEL.typ.nint Lex_Id__2_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth__2_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name__2_;
      KEL.typ.nkdate Deceased_Date__2_;
      KEL.typ.nkdate Deceased_Date_Of_Birth__2_;
      KEL.typ.nstr Deceased_First__2_;
      KEL.typ.nstr Deceased_Last__2_;
      KEL.typ.nint Associated_Ssn_Count__2_;
      KEL.typ.nint Date_Of_Birth_Match_Level__2_;
      KEL.typ.nint Stolen_Identity_Index__2_;
      KEL.typ.nint Synthetic_Identity_Index__2_;
      KEL.typ.nint Manipulated_Identity_Index__2_;
      KEL.typ.nint Vulnerable_Victim_Index__2_;
      KEL.typ.nint Friendlyfraud_Index__2_;
      KEL.typ.nint Suspicious_Activity_Index__2_;
      B_Person_1.__NS17101_Layout Best_Full_Name__2_;
      KEL.typ.int Deceased__2_ := 0;
      KEL.typ.int Deceased_Dob_Match__2_ := 0;
      KEL.typ.int Deceased_Match__2_ := 0;
      KEL.typ.str Deceased_Match_Description__2_ := '';
      KEL.typ.int Deceased_Name_Match__2_ := 0;
      KEL.typ.nunk Entity_Context_Uid__2_;
      KEL.typ.nstr Label__2_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC96840(__ST94382_Layout __EE96831, B_Person.__ST2096_Layout __EE96619) := __EEQP(__EE96831.To_Person_,__EE96619.UID);
    __ST94565_Layout __JT96840(__ST94382_Layout __l, B_Person.__ST2096_Layout __r) := TRANSFORM
      SELF.U_I_D__2_ := __r.UID;
      SELF.Lex_Id__2_ := __r.Lex_Id_;
      SELF.Reported_Date_Of_Birth__2_ := __r.Reported_Date_Of_Birth_;
      SELF.Full_Name__2_ := __r.Full_Name_;
      SELF.Deceased_Date__2_ := __r.Deceased_Date_;
      SELF.Deceased_Date_Of_Birth__2_ := __r.Deceased_Date_Of_Birth_;
      SELF.Deceased_First__2_ := __r.Deceased_First_;
      SELF.Deceased_Last__2_ := __r.Deceased_Last_;
      SELF.Associated_Ssn_Count__2_ := __r.Associated_Ssn_Count_;
      SELF.Date_Of_Birth_Match_Level__2_ := __r.Date_Of_Birth_Match_Level_;
      SELF.Stolen_Identity_Index__2_ := __r.Stolen_Identity_Index_;
      SELF.Synthetic_Identity_Index__2_ := __r.Synthetic_Identity_Index_;
      SELF.Manipulated_Identity_Index__2_ := __r.Manipulated_Identity_Index_;
      SELF.Vulnerable_Victim_Index__2_ := __r.Vulnerable_Victim_Index_;
      SELF.Friendlyfraud_Index__2_ := __r.Friendlyfraud_Index_;
      SELF.Suspicious_Activity_Index__2_ := __r.Suspicious_Activity_Index_;
      SELF.Best_Full_Name__2_ := __r.Best_Full_Name_;
      SELF.Deceased__2_ := __r.Deceased_;
      SELF.Deceased_Dob_Match__2_ := __r.Deceased_Dob_Match_;
      SELF.Deceased_Match__2_ := __r.Deceased_Match_;
      SELF.Deceased_Match_Description__2_ := __r.Deceased_Match_Description_;
      SELF.Deceased_Name_Match__2_ := __r.Deceased_Name_Match_;
      SELF.Entity_Context_Uid__2_ := __r.Entity_Context_Uid_;
      SELF.Label__2_ := __r.Label_;
      SELF := __l;
      SELF := __r;
    END;
    __EE96841 := JOIN(__EE96831,__EE96619,__JC96840(LEFT,RIGHT),__JT96840(LEFT,RIGHT),LEFT OUTER,HASH);
    __ST94902_Layout := RECORD
      KEL.typ.ntyp(E_Customer.Typ) Source_Customer_;
      KEL.typ.ntyp(E_Person.Typ) Subject_;
      KEL.typ.nuid UID;
      KEL.typ.nint Lex_Id_;
      KEL.typ.ndataset(E_Person.Reported_Date_Of_Birth_Layout) Reported_Date_Of_Birth_;
      KEL.typ.ndataset(E_Person.Full_Name_Layout) Full_Name_;
      KEL.typ.nkdate Deceased_Date_;
      KEL.typ.nkdate Deceased_Date_Of_Birth_;
      KEL.typ.nstr Deceased_First_;
      KEL.typ.nstr Deceased_Last_;
      KEL.typ.nint Associated_Ssn_Count_;
      KEL.typ.nint Date_Of_Birth_Match_Level_;
      KEL.typ.nint Stolen_Identity_Index_;
      KEL.typ.nint Synthetic_Identity_Index_;
      KEL.typ.nint Manipulated_Identity_Index_;
      KEL.typ.nint Vulnerable_Victim_Index_;
      KEL.typ.nint Friendlyfraud_Index_;
      KEL.typ.nint Suspicious_Activity_Index_;
      B_Person_1.__NS17101_Layout Best_Full_Name_;
      KEL.typ.int Deceased_ := 0;
      KEL.typ.int Deceased_Dob_Match_ := 0;
      KEL.typ.int Deceased_Match_ := 0;
      KEL.typ.str Deceased_Match_Description_ := '';
      KEL.typ.int Deceased_Name_Match_ := 0;
      KEL.typ.nunk Entity_Context_Uid_;
      KEL.typ.nstr Label_;
      KEL.typ.ndataset(__ST94565_Layout) Person_;
      KEL.typ.epoch Date_First_Seen_ := 0;
      KEL.typ.epoch Date_Last_Seen_ := 0;
      KEL.typ.int __RecordCount := 0;
    END;
    __JC97210(__ST95076_Layout __EE95976, __ST94565_Layout __EE96841) := __T(__AND(__AND(__OP2(__EE96841.Source_Customer_,=,__PP95340.Source_Customer_),__EEQ(__PP95340.Subject_,__EE96841.From_Person_)),__CN(__NN(__PP95340.Subject_))));
    __ST94902_Layout __Join__ST94902_Layout(__ST95076_Layout __r, DATASET(__ST94565_Layout) __recs) := TRANSFORM
      SELF := __r;
      SELF.Person_ := __CN(__recs);
    END;
    __EE97371 := DENORMALIZE(__PP95340,__EE96841,__JC97210(LEFT,RIGHT),GROUP,__Join__ST94902_Layout(LEFT,ROWS(RIGHT)));
    __ST1819_Layout __ND97389__Project(__ST94902_Layout __PP97376) := TRANSFORM
      __EE97374 := __PP97376.Person_;
      SELF.Customer_Person_Person_ := __BN(PROJECT(TABLE(PROJECT(__T(__EE97374),TRANSFORM(__ST1815_Layout,SELF.Entity_Context_Uid_ := LEFT.Entity_Context_Uid__2_,SELF := LEFT))(__NN(Entity_Context_Uid_)),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Entity_Context_Uid_},Entity_Context_Uid_,MERGE),__ST1815_Layout),__NL(__EE97374));
      SELF := __PP97376;
    END;
    __ST1819_Layout __ND97389__Rollup(__ST1819_Layout __r, DATASET(__ST1819_Layout) __recs) := TRANSFORM
      __recs_Customer_Person_Person_ := NORMALIZE(__recs,__T(LEFT.Customer_Person_Person_),TRANSFORM(__ST1815_Layout,SELF:=RIGHT));
      __recs_Customer_Person_Person__allnull := NOT EXISTS(__recs(__NN(Customer_Person_Person_)));
      SELF.Customer_Person_Person_ := __BN(PROJECT(TABLE(__recs_Customer_Person_Person_,{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Entity_Context_Uid_},Entity_Context_Uid_),__ST1815_Layout),__recs_Customer_Person_Person__allnull);
      SELF.__RecordCount := SUM(__recs,__RecordCount);
      SELF.Date_First_Seen_ := KEL.era.SimpleRoll(__recs,Date_First_Seen_,MIN,TRUE);
      SELF.Date_Last_Seen_ := KEL.era.SimpleRoll(__recs,Date_Last_Seen_,MAX,FALSE);
      SELF := __r;
    END;
    SELF.Exp1_ := __FILTER(__CN(ROLLUP(GROUP(KEL.Routines.SortAndAppendFilteredChildren(PROJECT(__EE97371,__ND97389__Project(LEFT)),'Customer_Person_Person_','customer_person_person_','clean','__recordcount,date_first_seen_,date_last_seen_'),Customer_Person_Person_Clean,ALL),GROUP,__ND97389__Rollup(ROW(LEFT,__ST1819_Layout), PROJECT(ROWS(LEFT),__ST1819_Layout)))),__NN(Customer_Person_Person_));
    SELF := __PP95340;
  END;
  SHARED __ST1819_Layout __ND97947__Rollup(__ST1819_Layout __r, DATASET(__ST1819_Layout) __recs) := TRANSFORM
    __recs_Customer_Person_Person_ := NORMALIZE(__recs,__T(LEFT.Customer_Person_Person_),TRANSFORM(__ST1815_Layout,SELF:=RIGHT));
    __recs_Customer_Person_Person__allnull := NOT EXISTS(__recs(__NN(Customer_Person_Person_)));
    SELF.Customer_Person_Person_ := __BN(PROJECT(TABLE(__recs_Customer_Person_Person_,{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Entity_Context_Uid_},Entity_Context_Uid_),__ST1815_Layout),__recs_Customer_Person_Person__allnull);
    SELF.__RecordCount := SUM(__recs,__RecordCount);
    SELF.Date_First_Seen_ := KEL.era.SimpleRoll(__recs,Date_First_Seen_,MIN,TRUE);
    SELF.Date_Last_Seen_ := KEL.era.SimpleRoll(__recs,Date_Last_Seen_,MAX,FALSE);
    SELF := __r;
  END;
  SHARED __ST1823_Layout __ND97395__Rollup(__ST1823_Layout __r, DATASET(__ST1823_Layout) __recs) := TRANSFORM
    __recs_Exp1_ := NORMALIZE(__recs,__T(LEFT.Exp1_),TRANSFORM(__ST1819_Layout,SELF:=RIGHT));
    __recs_Exp1__allnull := NOT EXISTS(__recs(__NN(Exp1_)));
    SELF.Exp1_ := __BN(ROLLUP(GROUP(KEL.Routines.SortAndAppendFilteredChildren(__recs_Exp1_,'Customer_Person_Person_','customer_person_person_','clean','__recordcount,date_first_seen_,date_last_seen_'),Customer_Person_Person_Clean,ALL),GROUP,__ND97947__Rollup(ROW(LEFT,__ST1819_Layout), PROJECT(ROWS(LEFT),__ST1819_Layout))),__recs_Exp1__allnull);
    SELF.__RecordCount := SUM(__recs,__RecordCount);
    SELF.Date_First_Seen_ := KEL.era.SimpleRoll(__recs,Date_First_Seen_,MIN,TRUE);
    SELF.Date_Last_Seen_ := KEL.era.SimpleRoll(__recs,Date_Last_Seen_,MAX,FALSE);
    SELF := __r;
  END;
  EXPORT Res0 := __UNWRAP(ROLLUP(GROUP(KEL.Routines.SortAndAppendFilteredChildren(PROJECT(__EE95976,__ND97395__Project(LEFT)),'Exp1_,Exp1_.Customer_Person_Person_','exp1_','clean','__recordcount,date_first_seen_,date_last_seen_'),Source_Customer_,Entity_Context_Uid_,Label_,Exp1_Clean,ALL),GROUP,__ND97395__Rollup(ROW(LEFT,__ST1823_Layout), PROJECT(ROWS(LEFT),__ST1823_Layout))));
END;
