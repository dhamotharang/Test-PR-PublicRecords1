#workunit('name','Lead Integrity Attributes');
#option ('hthorMemoryLimit', 1000);

IMPORT Models, iESP, Risk_Indicators, RiskWise, UT;
/* ********************************************************************
 *                               OPTIONS                              *
 **********************************************************************
 * recordsToRun: Number of records to run through the service. Set to *
 *    0 to run all.                                                   *
 * threads: Number of parallel threads to run. Set to 1 - 30.         *
 * roxieIP: IP Address of the non-FCRA roxie.                         *
 **********************************************************************/
recordsToRun := 0;
eyeball := 50;

threads := 30;

roxieIP := RiskWise.shortcuts.prod_batch_neutral; // Production
// roxieIP := RiskWise.shortcuts.staging_neutral_roxieIP; // Staging/Cert

inputFile := '~jpyon::in::compass_1190_bus_shell_in_in';
outputFile := '~tfuerstenberg::out::Lead_Integ_Attrib_';

// Versions Available: 1, 3 and 4
version := 4;

// new internal fields for debugging, set to false so they are excluded from the layout by default
include_internal_extras := true;

// Boca Shell Version
bocaShellVersion := 4;

// Set to TRUE to run the ADL Based Boca Shell, FALSE to skip it
runADL := TRUE;

// Universally Set the History Date for ALL records. Set to 0 to use the History Date located on each record of the input file
histDateYYYYMM := 0;

/* **************************************
 *         MAIN SCRIPT CODE             *
 ****************************************/
prii_layout := RECORD
	STRING AccountNumber;
	STRING FirstName;
	STRING MiddleName;
	STRING LastName;
	STRING StreetAddress;
	STRING City;
	STRING State;
	STRING Zip;
	STRING HomePhone;
	STRING SSN;
	STRING DateOfBirth;
	STRING WorkPhone;
	STRING income;  
	STRING DLNumber;
	STRING DLState;
	STRING BALANCE; 
	STRING CHARGEOFFD;  
	STRING FormerName;
	STRING EMAIL;  
	STRING COMPANY;
	INTEGER historydateyyyymm;
	unsigned did := 0;
END;

f_all := DATASET(inputFile, prii_layout, CSV(QUOTE('"')));
f := IF(recordsToRun = 0, f_all, CHOOSEN(f_all, recordsToRun));
OUTPUT(CHOOSEN(f, eyeball), NAMED('customer_file'));

// Run the ADL based bocashell with that history date to append the SSN if it's missing
layout_soap_boca := RECORD
	STRING old_account_number;
	STRING AccountNumber;
	STRING FirstName;
	STRING MiddleName;
	STRING LastName;
	STRING NameSuffix;
	STRING StreetAddress;
	STRING City;
	STRING State;
	STRING Zip;
	STRING Country;
	STRING SSN;
	STRING DateOfBirth;
	STRING Age;
	STRING DLNumber;
	STRING DLState;
	STRING Email;
	STRING IPAddress;
	STRING HomePhone;
	STRING WorkPhone;
	STRING EmployerName;
	STRING FormerName;
	INTEGER GLBPurpose;
	INTEGER DPPAPurpose;
	STRING DataRestrictionMask;	
	INTEGER Version;
	INTEGER HistoryDateYYYYMM;
	BOOLEAN ADL_Based_Shell;
	
	unsigned did;
	string wuid;
	string jobowner;
END;

layout_soap_boca transform_input_boca(f le, INTEGER c) := TRANSFORM
	SELF.old_account_number := le.accountnumber;
	SELF.Accountnumber := (STRING)c;	
	SELF.DPPAPurpose := 0;
	SELF.GLBPurpose := 5;
	SELF.adl_based_shell := true;
	SELF.DataRestrictionMask := '0000000000000000000000000';  // to allow use of both Equifax and Experian, this is the default value for all legacy scoring products
	SELF.HistoryDateYYYYMM := IF(histDateYYYYMM=0,(Integer) le.historydateyyyymm[1..6], histDateYYYYMM);
	SELF.Version := bocaShellVersion;
	SELF := le;
	
	self.wuid := thorlib.wuid();
	self.jobowner := thorlib.jobowner();

	SELF := [];
END;

p_f := PROJECT(f, transform_input_boca(LEFT, COUNTER));
OUTPUT(CHOOSEN(p_f, eyeball), NAMED('original_input'));
OUTPUT(COUNT(p_f(ssn<>'')), NAMED('records_with_ssn_originally'));

shell_input := DISTRIBUTE(p_f(ssn=''), RANDOM());

xlayout := RECORD
	risk_indicators.Layout_Boca_Shell;
	STRING errorcode;
END;

xlayout myFail(shell_input le) := TRANSFORM
	SELF.errorcode := FAILCODE + FAILMESSAGE;
	SELF.seq := (UNSIGNED)le.AccountNumber;
	SELF := le;
	SELF := [];
END;

adlappendshell := SOAPCALL(shell_input, roxieIP,
				'Risk_Indicators.Boca_Shell', {shell_input}, 
				DATASET(xlayout),
				RETRY(5), TIMEOUT(500), 
				//RETRY(5), TIMEOUT(500), LITERAL,
				PARALLEL(threads), onFail(myFail(LEFT)));

appended_ssns := JOIN(shell_input, adlappendshell, (UNSIGNED)LEFT.accountnumber=RIGHT.seq,
					TRANSFORM(layout_soap_boca, SELF.ssn := RIGHT.shell_input.ssn, SELF := LEFT));

// version 4 attributes append best ssn internally if not present, so it should not run the adl shell
LeadIntegrity_input_temp := IF(runADL and version < 4, appended_ssns + p_f(ssn<>''), p_f);  // add back the records that already had the SSN on the customer file if TRUE, skip if FALSE

layout_soap := RECORD
	DATASET(iesp.leadintegrity.t_LeadIntegrityRequest) LeadIntegrityRequest;
	unsigned DID;
	UNSIGNED3 HistoryDateYYYYMM;
	string old_account_number;
	string wuid;
	string jobowner;
END;

layout_soap transform_input_request( LeadIntegrity_input_temp le) := TRANSFORM
	u := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.share.t_User, SELF.AccountNumber := le.accountnumber; SELF.DLPurpose := '0'; SELF.GLBPurpose := '5'; SELF.DataRestrictionMask := '000000000000'; SELF := []));
	o := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.leadintegrity.t_LeadIntegrityOptions, SELF.AttributesVersionRequest := (STRING)VERSION; SELF := []));
	
	n := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.share.t_Name, SELF.First := le.FirstName; SELF.Middle := le.MiddleName; SELF.Last := le.LastName; SELF := []));
	a := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.share.t_Address, SELF.StreetAddress1 := le.StreetAddress; SELF.City := le.City; SELF.State := le.State; SELF.Zip5 := le.Zip; SELF := []));
	d := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.share.t_Date, SELF.Year := (INTEGER)le.DateOfBirth[1..4]; SELF.Month := (INTEGER)le.DateOfBirth[5..6]; SELF.Day := (INTEGER)le.DateOfBirth[7..8]; SELF := []));
	s := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.leadintegrity.t_LeadIntegritySearchBy, SELF.Seq := le.AccountNumber; 
																																											SELF.Name := n[1]; 
																																											SELF.Address := a[1]; 
																																											SELF.DOB := d[1]; 
																																											SELF.SSN := le.SSN; 
																																											SELF.HomePhone := le.HomePhone; 
																																											SELF.WorkPhone := le.WorkPhone;
																																											SELF.DriverLicenseNumber := le.DLNumber;
																																											SELF.DriverLicenseState := le.DLState;
																																											SELF := []));
	r := PROJECT(ut.ds_oneRecord, TRANSFORM(iesp.leadintegrity.t_LeadIntegrityRequest, SELF.User := u[1]; SELF.Options := o[1]; SELF.SearchBy := s[1]; SELF := []));
	SELF.LeadIntegrityRequest := r[1];
	self.did := le.did;
	SELF.HistoryDateYYYYMM := IF(histDateYYYYMM=0, le.historydateyyyymm, histDateYYYYMM);
	self.old_account_number := le.old_account_number;
	self.wuid := thorlib.wuid();
	self.jobowner := thorlib.jobowner();
	SELF := [];
END;

LeadIntegrity_input := DISTRIBUTE(PROJECT(LeadIntegrity_input_temp, transform_input_request(LEFT)), RANDOM());

OUTPUT(CHOOSEN(LeadIntegrity_input, eyeball), NAMED('LeadIntegrity_input'));  
OUTPUT(COUNT(LeadIntegrity_input (LeadIntegrityRequest[1].SearchBy.SSN <> '')), NAMED('records_with_ssn_after_appending_it')); // double check that this one has ssns


// Now run the LeadIntegrity attributes
LeadIntegrityoutput := RECORD
	unsigned6 did;
	iesp.leadintegrity.t_LeadIntegrityResponse;
	STRING errorcode;
END;

LeadIntegrityoutput myFail2(LeadIntegrity_input le) := TRANSFORM
	SELF.errorcode := FAILCODE + FAILMESSAGE;
	SELF := le;
	SELF := [];
END;

LeadIntegrity_attributes := SOAPCALL(LeadIntegrity_input, roxieIP,
				'Models.LeadIntegrity_Service', {LeadIntegrity_input}, 
				DATASET(LeadIntegrityoutput),
        RETRY(5), TIMEOUT(500),
       // XPATH('Models.LeadIntegrity_ServiceResponse/Results/Result/Dataset[@name=\'Results\']/Row'),
				PARALLEL(threads), onFail(myFail2(LEFT)));
				
OUTPUT(CHOOSEN(LeadIntegrity_attributes(errorcode=''), eyeball), NAMED('LeadIntegrity_results'));
OUTPUT(CHOOSEN(LeadIntegrity_attributes(errorcode<>''), eyeball), NAMED('LeadIntegrity_errors'));

#if(version=4)
	layout_slimmed := record
		STRING20 seq;
		STRING30 AccountNumber;
		string4 AgeOldestRecord;
		string4 AgeNewestRecord;
		string1 RecentUpdate;
		string3 SrcsConfirmIDAddrCount;
		string1 CreditBureauRecord;
		string2 VerificationFailure;
		string2 SSNNotFound;
		string2 SSNFoundOther;
		string1 VerifiedName;
		string2 VerifiedSSN;
		string2 VerifiedPhone;
		string2 VerifiedAddress;
		string2 VerifiedDOB;
		string3 AgeRiskIndicator;
		string3 SubjectSSNCount;
		string3 SubjectAddrCount;
		string3 SubjectPhoneCount;
		string3 SubjectSSNRecentCount;
		string3 SubjectAddrRecentCount;
		string3 SubjectPhoneRecentCount;
		string3 SSNIdentitiesCount;
		string3 SSNAddrCount;
		string3 SSNIdentitiesRecentCount;
		string3 SSNAddrRecentCount;
		string3 InputAddrPhoneCount;
		string3 InputAddrPhoneRecentCount;
		string3 PhoneIdentitiesCount;
		string3 PhoneIdentitiesRecentCount;
		string2 PhoneOther;
		string3 SSNLastNameCount;
		string3 SubjectLastNameCount;
		string4 LastNameChangeAge;
		string3 LastNameChangeCount01;
		string3 LastNameChangeCount03;
		string3 LastNameChangeCount06;
		string3 LastNameChangeCount12;
		string3 LastNameChangeCount24;
		string3 LastNameChangeCount60;
		string3 SFDUAddrIdentitiesCount;
		string3 SFDUAddrSSNCount;
		string3 SSNAgeDeceased;
		string2 SSNRecent;
		string3 SSNLowIssueAge;
		string3 SSNHighIssueAge;
		string2 SSNIssueState;
		string2 SSNNonUS;
		string2 SSN3Years;
		string2 SSNAfter5;
		string2 SSNProblems;
		string3 RelativesCount;
		string3 RelativesBankruptcyCount;
		string3 RelativesFelonyCount;
		string3 RelativesPropOwnedCount;
		string10 RelativesPropOwnedTaxTotal;
		string2 RelativesDistanceClosest;
		string3 InputAddrAgeOldestRecord;
		string3 InputAddrAgeNewestRecord;
		string2 InputAddrHistoricalMatch;
		string3 InputAddrLenOfRes;
		string2 InputAddrDwellType;
		string2 InputAddrDelivery;
		string2 InputAddrApplicantOwned;
		string2 InputAddrFamilyOwned;
		string2 InputAddrOccupantOwned;
		string3 InputAddrAgeLastSale;
		string10 InputAddrLastSalesPrice;
		string2 InputAddrMortgageType;
		string2 InputAddrNotPrimaryRes;
		string2 InputAddrActivePhoneList;
		string10 InputAddrTaxValue;
		string4 InputAddrTaxYr;
		string10 InputAddrTaxMarketValue;
		string10 InputAddrAVMValue;
		string10 InputAddrAVMValue12;
		string10 InputAddrAVMValue60;
		string5 InputAddrCountyIndex;
		string5 InputAddrTractIndex;
		string5 InputAddrBlockIndex;
		string10 InputAddrMedianIncome;
		string10 InputAddrMedianValue;
		string3 InputAddrMurderIndex;
		string3 InputAddrCarTheftIndex;
		string3 InputAddrBurglaryIndex;
		string3 InputAddrCrimeIndex;
		string3 InputAddrMobilityIndex;
		string3 InputAddrVacantPropCount;
		string3 InputAddrBusinessCount;
		string3 InputAddrSingleFamilyCount;
		string3 InputAddrMultiFamilyCount;
		string3 CurrAddrAgeOldestRecord;
		string3 CurrAddrAgeNewestRecord;
		string3 CurrAddrLenOfRes;
		string2 CurrAddrDwellType;
		string2 CurrAddrApplicantOwned;
		string2 CurrAddrFamilyOwned;
		string2 CurrAddrOccupantOwned;
		string3 CurrAddrAgeLastSale;
		string10 CurrAddrLastSalesPrice;
		string2 CurrAddrMortgageType;
		string2 CurrAddrActivePhoneList;
		string10 CurrAddrTaxValue;
		string4 CurrAddrTaxYr;
		string10 CurrAddrTaxMarketValue;
		string10 CurrAddrAVMValue;
		string10 CurrAddrAVMValue12;
		string10 CurrAddrAVMValue60;
		string5 CurrAddrCountyIndex;
		string5 CurrAddrTractIndex;
		string5 CurrAddrBlockIndex;
		string10 CurrAddrMedianIncome;
		string10 CurrAddrMedianValue;
		string3 CurrAddrMurderIndex;
		string3 CurrAddrCarTheftIndex;
		string3 CurrAddrBurglaryIndex;
		string3 CurrAddrCrimeIndex;
		string3 PrevAddrAgeOldestRecord;
		string3 PrevAddrAgeNewestRecord;
		string3 PrevAddrLenOfRes;
		string2 PrevAddrDwellType;
		string2 PrevAddrApplicantOwned;
		string2 PrevAddrFamilyOwned;
		string2 PrevAddrOccupantOwned;
		string3 PrevAddrAgeLastSale;
		string10 PrevAddrLastSalesPrice;
		string10 PrevAddrTaxValue;
		string4 PrevAddrTaxYr;
		string10 PrevAddrTaxMarketValue;
		string10 PrevAddrAVMValue;
		string5 PrevAddrCountyIndex;
		string5 PrevAddrTractIndex;
		string5 PrevAddrBlockIndex;
		string10 PrevAddrMedianIncome;
		string10 PrevAddrMedianValue;
		string3 PrevAddrMurderIndex;
		string3 PrevAddrCarTheftIndex;
		string3 PrevAddrBurglaryIndex;
		string3 PrevAddrCrimeIndex;
		string4 AddrMostRecentDistance;
		string2 AddrMostRecentStateDiff;
		string11 AddrMostRecentTaxDiff;
		string3 AddrMostRecentMoveAge;
		string11 AddrMostRecentIncomeDiff;
		string11 AddrMostRecentValueDIff;
		string4 AddrMostRecentCrimeDiff;
		string2 AddrRecentEconTrajectory;
		string2 AddrRecentEconTrajectoryIndex;
		string1 EducationAttendedCollege;
		string2 EducationProgram2Yr;
		string2 EducationProgram4Yr;
		string2 EducationProgramGraduate;
		string2 EducationInstitutionPrivate;
		string2 EducationInstitutionRating;
		string2 EducationFieldofStudyType;
		string1 AddrStability;
		string2 StatusMostRecent;
		string2 StatusPrevious;
		string2 StatusNextPrevious;
		string3 AddrChangeCount01;
		string3 AddrChangeCount03;
		string3 AddrChangeCount06;
		string3 AddrChangeCount12;
		string3 AddrChangeCount24;
		string3 AddrChangeCount60;
		string10 EstimatedAnnualIncome;
		string1 AssetOwner;
		string1 PropertyOwner;
		string3 PropOwnedCount;
		string10 PropOwnedTaxTotal;
		string3 PropOwnedHistoricalCount;
		string3 PropAgeOldestPurchase;
		string3 PropAgeNewestPurchase;
		string3 PropAgeNewestSale;
		string10 PropNewestSalePrice;
		string4 PropNewestSalePurchaseIndex;
		string3 PropPurchasedCount01;
		string3 PropPurchasedCount03;
		string3 PropPurchasedCount06;
		string3 PropPurchasedCount12;
		string3 PropPurchasedCount24;
		string3 PropPurchasedCount60;
		string3 PropSoldCount01;
		string3 PropSoldCount03;
		string3 PropSoldCount06;
		string3 PropSoldCount12;
		string3 PropSoldCount24;
		string3 PropSoldCount60;
		string1 WatercraftOwner;
		string3 WatercraftCount;
		string3 WatercraftCount01;
		string3 WatercraftCount03;
		string3 WatercraftCount06;
		string3 WatercraftCount12;
		string3 WatercraftCount24;
		string3 WatercraftCount60;
		string1 AircraftOwner;
		string3 AircraftCount;
		string3 AircraftCount01;
		string3 AircraftCount03;
		string3 AircraftCount06;
		string3 AircraftCount12;
		string3 AircraftCount24;
		string3 AircraftCount60;
		string2 WealthIndex;
		string2 BusinessActiveAssociation;
		string2 BusinessInactiveAssociation;
		string3 BusinessAssociationAge;
		string100 BusinessTitle;
		string3 BusinessInputAddrCount;
		string2 DerogSeverityIndex;
		string3 DerogCount;
		string3 DerogRecentCount;
		string3 DerogAge;
		string3 FelonyCount;
		string3 FelonyAge;
		string3 FelonyCount01;
		string3 FelonyCount03;
		string3 FelonyCount06;
		string3 FelonyCount12;
		string3 FelonyCount24;
		string3 FelonyCount60;
		string3 ArrestCount;
		string3 ArrestAge;
		string3 ArrestCount01;
		string3 ArrestCount03;
		string3 ArrestCount06;
		string3 ArrestCount12;
		string3 ArrestCount24;
		string3 ArrestCount60;
		string3 LienCount;
		string3 LienFiledCount;
		string10 LienFiledTotal;
		string3 LienFiledAge;
		string3 LienFiledCount01;
		string3 LienFiledCount03;
		string3 LienFiledCount06;
		string3 LienFiledCount12;
		string3 LienFiledCount24;
		string3 LienFiledCount60;
		string3 LienReleasedCount;
		string10 LienReleasedTotal;
		string3 LienReleasedAge;
		string3 LienReleasedCount01;
		string3 LienReleasedCount03;
		string3 LienReleasedCount06;
		string3 LienReleasedCount12;
		string3 LienReleasedCount24;
		string3 LienReleasedCount60;
		string3 BankruptcyCount;
		string3 BankruptcyAge;
		string2 BankruptcyType;
		string35 BankruptcyStatus;
		string3 BankruptcyCount01;
		string3 BankruptcyCount03;
		string3 BankruptcyCount06;
		string3 BankruptcyCount12;
		string3 BankruptcyCount24;
		string3 BankruptcyCount60;
		string3 EvictionCount;
		string3 EvictionAge;
		string3 EvictionCount01;
		string3 EvictionCount03;
		string3 EvictionCount06;
		string3 EvictionCount12;
		string3 EvictionCount24;
		string3 EvictionCount60;
		string3 AccidentCount;
		string3 AccidentAge;
		string2 RecentActivityIndex;
		string3 NonDerogCount;
		string3 NonDerogCount01;
		string3 NonDerogCount03;
		string3 NonDerogCount06;
		string3 NonDerogCount12;
		string3 NonDerogCount24;
		string3 NonDerogCount60;
		string1 VoterRegistrationRecord;
		string3 ProfLicCount;
		string3 ProfLicAge;
		string2 ProfLicTypeCategory;
		string2 ProfLicExpired;
		string3 ProfLicCount01;
		string3 ProfLicCount03;
		string3 ProfLicCount06;
		string3 ProfLicCount12;
		string3 ProfLicCount24;
		string3 ProfLicCount60;
		string3 PRSearchLocateCount;
		string3 PRSearchLocateCount01;
		string3 PRSearchLocateCount03;
		string3 PRSearchLocateCount06;
		string3 PRSearchLocateCount12;
		string3 PRSearchLocateCount24;
		string3 PRSearchPersonalFinanceCount;
		string3 PRSearchPersonalFinanceCount01;
		string3 PRSearchPersonalFinanceCount03;
		string3 PRSearchPersonalFinanceCount06;
		string3 PRSearchPersonalFinanceCount12;
		string3 PRSearchPersonalFinanceCount24;
		string3 PRSearchOtherCount;
		string3 PRSearchOtherCount01;
		string3 PRSearchOtherCount03;
		string3 PRSearchOtherCount06;
		string3 PRSearchOtherCount12;
		string3 PRSearchOtherCount24;
		string3 PRSearchIdentitySSNs;
		string3 PRSearchIdentityAddrs;
		string3 PRSearchIdentityPhones;
		string3 PRSearchSSNIdentities;
		string3 PRSearchAddrIdentities;
		string3 PRSearchPhoneIdentities;
		string3 SubPrimeOfferRequestCount;
		string3 SubPrimeOfferRequestCount01;
		string3 SubPrimeOfferRequestCount03;
		string3 SubPrimeOfferRequestCount06;
		string3 SubPrimeOfferRequestCount12;
		string3 SubPrimeOfferRequestCount24;
		string3 SubPrimeOfferRequestCount60;
		string2 InputPhoneMobile;
		string2 InputPhoneType;
		string2 InputPhoneServiceType;
		string2 InputAreaCodeChange;
		string3 PhoneEDAAgeOldestRecord;
		string3 PhoneEDAAgeNewestRecord;
		string3 PhoneOtherAgeOldestRecord;
		string3 PhoneOtherAgeNewestRecord;
		string2 InputPhoneHighRisk;
		string2 InputPhoneProblems;
		string2 OnlineDirectory;
		string4 InputAddrSICCode;
		string2 InputAddrValidation;
		string5 InputAddrErrorCode;
		string2 InputAddrHighRisk;
		string2 CurrAddrCorrectional;
		string2 PrevAddrCorrectional;
		string2 HistoricalAddrCorrectional;
		string2 InputAddrProblems;
		string1 DoNotMail;
		// 4.1 Attributes (Part of 4.0)
		STRING2 IdentityRiskLevel := '';
		STRING2 IDVerRiskLevel := '';
		STRING3 IDVerAddressAssocCount := '';
		STRING2 IDVerSSNCreditBureauCount := '';
		STRING2 IDVerSSNCreditBureauDelete := '';
		STRING2 SourceRiskLevel := '';
		STRING1 SourceWatchList := '';
		STRING1 SourceOrderActivity := '';
		STRING3 SourceOrderSourceCount := '';
		STRING3 SourceOrderAgeLastOrder := '';
		STRING2 VariationRiskLevel := '';
		STRING3 VariationIdentityCount := '';
		STRING3 VariationMSourcesSSNCount := '';
		STRING3 VariationMSourcesSSNUnrelCount := '';
		STRING3 VariationDOBCount := '';
		STRING3 VariationDOBCountNew := '';
		STRING2 SearchVelocityRiskLevel := '';
		STRING3 SearchUnverifiedSSNCountYear := '';
		STRING3 SearchUnverifiedAddrCountYear := '';
		STRING3 SearchUnverifiedDOBCountYear := '';
		STRING3 SearchUnverifiedPhoneCountYear := '';
		STRING2 AssocRiskLevel := '';
		STRING3 AssocSuspicousIdentitiesCount := '';
		STRING3 AssocCreditBureauOnlyCount := '';
		STRING3 AssocCreditBureauOnlyCountNew := '';
		STRING3 AssocCreditBureauOnlyCountMonth := '';
		STRING3 AssocHighRiskTopologyCount := '';
		STRING1 ValidationRiskLevel := '';
		STRING1 CorrelationRiskLevel := '';
		STRING1 DivRiskLevel := '';
		STRING3 DivSSNIdentityMSourceCount := '';
		STRING3 DivSSNIdentityMSourceUrelCount := '';
		STRING3 DivSSNLNameCountNew := '';
		STRING3 DivSSNAddrMSourceCount := '';
		STRING3 DivAddrIdentityCount := '';
		STRING3 DivAddrIdentityCountNew := '';
		STRING3 DivAddrIdentityMSourceCount := '';
		STRING3 DivAddrSuspIdentityCountNew := '';
		STRING3 DivAddrSSNCount := '';
		STRING3 DivAddrSSNCountNew := '';
		STRING3 DivAddrSSNMSourceCount := '';
		STRING3 DivSearchAddrSuspIdentityCount := '';
		STRING1 SearchComponentRiskLevel := '';
		STRING3 SearchSSNSearchCount := '';
		STRING3 SearchAddrSearchCount := '';
		STRING3 SearchPhoneSearchCount := '';
		STRING1 ComponentCharRiskLevel := '';
		
		#if(include_internal_extras)
			RiskProcessing.layout_internal_extras;
		#end
	end;

	layout_slimmed slim_v4( LeadIntegrity_attributes le ) := TRANSFORM
		self.accountnumber := ''; // original account number not available here...
		SELF.seq := le.Result.InputEcho.Seq; // ...so hang onto the seq

		self.AgeOldestRecord                      := le.Result.Attributes[1].Value;
		self.AgeNewestRecord                      := le.Result.Attributes[2].Value;
		self.RecentUpdate                         := le.Result.Attributes[3].Value;
		self.SrcsConfirmIDAddrCount               := le.Result.Attributes[4].Value;
		self.CreditBureauRecord                   := le.Result.Attributes[5].Value;
		self.VerificationFailure                  := le.Result.Attributes[6].Value;
		self.SSNNotFound                          := le.Result.Attributes[7].Value;
		self.SSNFoundOther                        := le.Result.Attributes[8].Value;
		self.VerifiedName                         := le.Result.Attributes[9].Value;
		self.VerifiedSSN                          := le.Result.Attributes[10].Value;
		self.VerifiedPhone                        := le.Result.Attributes[11].Value;
		self.VerifiedAddress                      := le.Result.Attributes[12].Value;
		self.VerifiedDOB                          := le.Result.Attributes[13].Value;
		self.AgeRiskIndicator                     := le.Result.Attributes[14].Value;
		self.SubjectSSNCount                      := le.Result.Attributes[15].Value;
		self.SubjectAddrCount                     := le.Result.Attributes[16].Value;
		self.SubjectPhoneCount                    := le.Result.Attributes[17].Value;
		self.SubjectSSNRecentCount                := le.Result.Attributes[18].Value;
		self.SubjectAddrRecentCount               := le.Result.Attributes[19].Value;
		self.SubjectPhoneRecentCount              := le.Result.Attributes[20].Value;
		self.SSNIdentitiesCount                   := le.Result.Attributes[21].Value;
		self.SSNAddrCount                         := le.Result.Attributes[22].Value;
		self.SSNIdentitiesRecentCount             := le.Result.Attributes[23].Value;
		self.SSNAddrRecentCount                   := le.Result.Attributes[24].Value;
		self.InputAddrPhoneCount                  := le.Result.Attributes[25].Value;
		self.InputAddrPhoneRecentCount            := le.Result.Attributes[26].Value;
		self.PhoneIdentitiesCount                 := le.Result.Attributes[27].Value;
		self.PhoneIdentitiesRecentCount           := le.Result.Attributes[28].Value;
		self.PhoneOther                           := le.Result.Attributes[29].Value;
		self.SSNLastNameCount                     := le.Result.Attributes[30].Value;
		self.SubjectLastNameCount                 := le.Result.Attributes[31].Value;
		self.LastNameChangeAge                    := le.Result.Attributes[32].Value;
		self.LastNameChangeCount01                := le.Result.Attributes[33].Value;
		self.LastNameChangeCount03                := le.Result.Attributes[34].Value;
		self.LastNameChangeCount06                := le.Result.Attributes[35].Value;
		self.LastNameChangeCount12                := le.Result.Attributes[36].Value;
		self.LastNameChangeCount24                := le.Result.Attributes[37].Value;
		self.LastNameChangeCount60                := le.Result.Attributes[38].Value;
		self.SFDUAddrIdentitiesCount              := le.Result.Attributes[39].Value;
		self.SFDUAddrSSNCount                     := le.Result.Attributes[40].Value;
		self.SSNAgeDeceased                       := le.Result.Attributes[41].Value;
		self.SSNRecent                            := le.Result.Attributes[42].Value;
		self.SSNLowIssueAge                       := le.Result.Attributes[43].Value;
		self.SSNHighIssueAge                      := le.Result.Attributes[44].Value;
		self.SSNIssueState                        := le.Result.Attributes[45].Value;
		self.SSNNonUS                             := le.Result.Attributes[46].Value;
		self.SSN3Years                            := le.Result.Attributes[47].Value;
		self.SSNAfter5                            := le.Result.Attributes[48].Value;
		self.SSNProblems                          := le.Result.Attributes[49].Value;
		self.RelativesCount                       := le.Result.Attributes[50].Value;
		self.RelativesBankruptcyCount             := le.Result.Attributes[51].Value;
		self.RelativesFelonyCount                 := le.Result.Attributes[52].Value;
		self.RelativesPropOwnedCount              := le.Result.Attributes[53].Value;
		self.RelativesPropOwnedTaxTotal           := le.Result.Attributes[54].Value;
		self.RelativesDistanceClosest             := le.Result.Attributes[55].Value;
		self.InputAddrAgeOldestRecord             := le.Result.Attributes[56].Value;
		self.InputAddrAgeNewestRecord             := le.Result.Attributes[57].Value;
		self.InputAddrHistoricalMatch             := le.Result.Attributes[58].Value;
		self.InputAddrLenOfRes                    := le.Result.Attributes[59].Value;
		self.InputAddrDwellType                   := le.Result.Attributes[60].Value;
		self.InputAddrDelivery                    := le.Result.Attributes[61].Value;
		self.InputAddrApplicantOwned              := le.Result.Attributes[62].Value;
		self.InputAddrFamilyOwned                 := le.Result.Attributes[63].Value;
		self.InputAddrOccupantOwned               := le.Result.Attributes[64].Value;
		self.InputAddrAgeLastSale                 := le.Result.Attributes[65].Value;
		self.InputAddrLastSalesPrice              := le.Result.Attributes[66].Value;
		self.InputAddrMortgageType                := le.Result.Attributes[67].Value;
		self.InputAddrNotPrimaryRes               := le.Result.Attributes[68].Value;
		self.InputAddrActivePhoneList             := le.Result.Attributes[69].Value;
		self.InputAddrTaxValue                    := le.Result.Attributes[70].Value;
		self.InputAddrTaxYr                       := le.Result.Attributes[71].Value;
		self.InputAddrTaxMarketValue              := le.Result.Attributes[72].Value;
		self.InputAddrAVMValue                    := le.Result.Attributes[73].Value;
		self.InputAddrAVMValue12                  := le.Result.Attributes[74].Value;
		self.InputAddrAVMValue60                  := le.Result.Attributes[75].Value;
		self.InputAddrCountyIndex                 := le.Result.Attributes[76].Value;
		self.InputAddrTractIndex                  := le.Result.Attributes[77].Value;
		self.InputAddrBlockIndex                  := le.Result.Attributes[78].Value;
		self.InputAddrMedianIncome                := le.Result.Attributes[79].Value;
		self.InputAddrMedianValue                 := le.Result.Attributes[80].Value;
		self.InputAddrMurderIndex                 := le.Result.Attributes[81].Value;
		self.InputAddrCarTheftIndex               := le.Result.Attributes[82].Value;
		self.InputAddrBurglaryIndex               := le.Result.Attributes[83].Value;
		self.InputAddrCrimeIndex                  := le.Result.Attributes[84].Value;
		self.InputAddrMobilityIndex               := le.Result.Attributes[85].Value;
		self.InputAddrVacantPropCount             := le.Result.Attributes[86].Value;
		self.InputAddrBusinessCount               := le.Result.Attributes[87].Value;
		self.InputAddrSingleFamilyCount           := le.Result.Attributes[88].Value;
		self.InputAddrMultiFamilyCount            := le.Result.Attributes[89].Value;
		self.CurrAddrAgeOldestRecord              := le.Result.Attributes[90].Value;
		self.CurrAddrAgeNewestRecord              := le.Result.Attributes[91].Value;
		self.CurrAddrLenOfRes                     := le.Result.Attributes[92].Value;
		self.CurrAddrDwellType                    := le.Result.Attributes[93].Value;
		self.CurrAddrApplicantOwned               := le.Result.Attributes[94].Value;
		self.CurrAddrFamilyOwned                  := le.Result.Attributes[95].Value;
		self.CurrAddrOccupantOwned                := le.Result.Attributes[96].Value;
		self.CurrAddrAgeLastSale                  := le.Result.Attributes[97].Value;
		self.CurrAddrLastSalesPrice               := le.Result.Attributes[98].Value;
		self.CurrAddrMortgageType                 := le.Result.Attributes[99].Value;
		self.CurrAddrActivePhoneList              := le.Result.Attributes[100].Value;
		self.CurrAddrTaxValue                     := le.Result.Attributes[101].Value;
		self.CurrAddrTaxYr                        := le.Result.Attributes[102].Value;
		self.CurrAddrTaxMarketValue               := le.Result.Attributes[103].Value;
		self.CurrAddrAVMValue                     := le.Result.Attributes[104].Value;
		self.CurrAddrAVMValue12                   := le.Result.Attributes[105].Value;
		self.CurrAddrAVMValue60                   := le.Result.Attributes[106].Value;
		self.CurrAddrCountyIndex                  := le.Result.Attributes[107].Value;
		self.CurrAddrTractIndex                   := le.Result.Attributes[108].Value;
		self.CurrAddrBlockIndex                   := le.Result.Attributes[109].Value;
		self.CurrAddrMedianIncome                 := le.Result.Attributes[110].Value;
		self.CurrAddrMedianValue                  := le.Result.Attributes[111].Value;
		self.CurrAddrMurderIndex                  := le.Result.Attributes[112].Value;
		self.CurrAddrCarTheftIndex                := le.Result.Attributes[113].Value;
		self.CurrAddrBurglaryIndex                := le.Result.Attributes[114].Value;
		self.CurrAddrCrimeIndex                   := le.Result.Attributes[115].Value;
		self.PrevAddrAgeOldestRecord              := le.Result.Attributes[116].Value;
		self.PrevAddrAgeNewestRecord              := le.Result.Attributes[117].Value;
		self.PrevAddrLenOfRes                     := le.Result.Attributes[118].Value;
		self.PrevAddrDwellType                    := le.Result.Attributes[119].Value;
		self.PrevAddrApplicantOwned               := le.Result.Attributes[120].Value;
		self.PrevAddrFamilyOwned                  := le.Result.Attributes[121].Value;
		self.PrevAddrOccupantOwned                := le.Result.Attributes[122].Value;
		self.PrevAddrAgeLastSale                  := le.Result.Attributes[123].Value;
		self.PrevAddrLastSalesPrice               := le.Result.Attributes[124].Value;
		self.PrevAddrTaxValue                     := le.Result.Attributes[125].Value;
		self.PrevAddrTaxYr                        := le.Result.Attributes[126].Value;
		self.PrevAddrTaxMarketValue               := le.Result.Attributes[127].Value;
		self.PrevAddrAVMValue                     := le.Result.Attributes[128].Value;
		self.PrevAddrCountyIndex                  := le.Result.Attributes[129].Value;
		self.PrevAddrTractIndex                   := le.Result.Attributes[130].Value;
		self.PrevAddrBlockIndex                   := le.Result.Attributes[131].Value;
		self.PrevAddrMedianIncome                 := le.Result.Attributes[132].Value;
		self.PrevAddrMedianValue                  := le.Result.Attributes[133].Value;
		self.PrevAddrMurderIndex                  := le.Result.Attributes[134].Value;
		self.PrevAddrCarTheftIndex                := le.Result.Attributes[135].Value;
		self.PrevAddrBurglaryIndex                := le.Result.Attributes[136].Value;
		self.PrevAddrCrimeIndex                   := le.Result.Attributes[137].Value;
		self.AddrMostRecentDistance               := le.Result.Attributes[138].Value;
		self.AddrMostRecentStateDiff              := le.Result.Attributes[139].Value;
		self.AddrMostRecentTaxDiff                := le.Result.Attributes[140].Value;
		self.AddrMostRecentMoveAge                := le.Result.Attributes[141].Value;
		self.AddrMostRecentIncomeDiff             := le.Result.Attributes[142].Value;
		self.AddrMostRecentValueDIff              := le.Result.Attributes[143].Value;
		self.AddrMostRecentCrimeDiff              := le.Result.Attributes[144].Value;
		self.AddrRecentEconTrajectory             := le.Result.Attributes[145].Value;
		self.AddrRecentEconTrajectoryIndex        := le.Result.Attributes[146].Value;
		self.EducationAttendedCollege             := le.Result.Attributes[147].Value;
		self.EducationProgram2Yr                  := le.Result.Attributes[148].Value;
		self.EducationProgram4Yr                  := le.Result.Attributes[149].Value;
		self.EducationProgramGraduate             := le.Result.Attributes[150].Value;
		self.EducationInstitutionPrivate          := le.Result.Attributes[151].Value;
		self.EducationInstitutionRating           := le.Result.Attributes[152].Value;
		self.EducationFieldofStudyType            := le.Result.Attributes[153].Value;
		self.AddrStability                        := le.Result.Attributes[154].Value;
		self.StatusMostRecent                     := le.Result.Attributes[155].Value;
		self.StatusPrevious                       := le.Result.Attributes[156].Value;
		self.StatusNextPrevious                   := le.Result.Attributes[157].Value;
		self.AddrChangeCount01                    := le.Result.Attributes[158].Value;
		self.AddrChangeCount03                    := le.Result.Attributes[159].Value;
		self.AddrChangeCount06                    := le.Result.Attributes[160].Value;
		self.AddrChangeCount12                    := le.Result.Attributes[161].Value;
		self.AddrChangeCount24                    := le.Result.Attributes[162].Value;
		self.AddrChangeCount60                    := le.Result.Attributes[163].Value;
		self.EstimatedAnnualIncome                := le.Result.Attributes[164].Value;
		self.AssetOwner                           := le.Result.Attributes[165].Value;
		self.PropertyOwner                        := le.Result.Attributes[166].Value;
		self.PropOwnedCount                       := le.Result.Attributes[167].Value;
		self.PropOwnedTaxTotal                    := le.Result.Attributes[168].Value;
		self.PropOwnedHistoricalCount             := le.Result.Attributes[169].Value;
		self.PropAgeOldestPurchase                := le.Result.Attributes[170].Value;
		self.PropAgeNewestPurchase                := le.Result.Attributes[171].Value;
		self.PropAgeNewestSale                    := le.Result.Attributes[172].Value;
		self.PropNewestSalePrice                  := le.Result.Attributes[173].Value;
		self.PropNewestSalePurchaseIndex          := le.Result.Attributes[174].Value;
		self.PropPurchasedCount01                 := le.Result.Attributes[175].Value;
		self.PropPurchasedCount03                 := le.Result.Attributes[176].Value;
		self.PropPurchasedCount06                 := le.Result.Attributes[177].Value;
		self.PropPurchasedCount12                 := le.Result.Attributes[178].Value;
		self.PropPurchasedCount24                 := le.Result.Attributes[179].Value;
		self.PropPurchasedCount60                 := le.Result.Attributes[180].Value;
		self.PropSoldCount01                      := le.Result.Attributes[181].Value;
		self.PropSoldCount03                      := le.Result.Attributes[182].Value;
		self.PropSoldCount06                      := le.Result.Attributes[183].Value;
		self.PropSoldCount12                      := le.Result.Attributes[184].Value;
		self.PropSoldCount24                      := le.Result.Attributes[185].Value;
		self.PropSoldCount60                      := le.Result.Attributes[186].Value;
		self.WatercraftOwner                      := le.Result.Attributes[187].Value;
		self.WatercraftCount                      := le.Result.Attributes[188].Value;
		self.WatercraftCount01                    := le.Result.Attributes[189].Value;
		self.WatercraftCount03                    := le.Result.Attributes[190].Value;
		self.WatercraftCount06                    := le.Result.Attributes[191].Value;
		self.WatercraftCount12                    := le.Result.Attributes[192].Value;
		self.WatercraftCount24                    := le.Result.Attributes[193].Value;
		self.WatercraftCount60                    := le.Result.Attributes[194].Value;
		self.AircraftOwner                        := le.Result.Attributes[195].Value;
		self.AircraftCount                        := le.Result.Attributes[196].Value;
		self.AircraftCount01                      := le.Result.Attributes[197].Value;
		self.AircraftCount03                      := le.Result.Attributes[198].Value;
		self.AircraftCount06                      := le.Result.Attributes[199].Value;
		self.AircraftCount12                      := le.Result.Attributes[200].Value;
		self.AircraftCount24                      := le.Result.Attributes[201].Value;
		self.AircraftCount60                      := le.Result.Attributes[202].Value;
		self.WealthIndex                          := le.Result.Attributes[203].Value;
		self.BusinessActiveAssociation            := le.Result.Attributes[204].Value;
		self.BusinessInactiveAssociation          := le.Result.Attributes[205].Value;
		self.BusinessAssociationAge               := le.Result.Attributes[206].Value;
		self.BusinessTitle                        := le.Result.Attributes[207].Value;
		self.BusinessInputAddrCount               := le.Result.Attributes[208].Value;
		self.DerogSeverityIndex                   := le.Result.Attributes[209].Value;
		self.DerogCount                           := le.Result.Attributes[210].Value;
		self.DerogRecentCount                     := le.Result.Attributes[211].Value;
		self.DerogAge                             := le.Result.Attributes[212].Value;
		self.FelonyCount                          := le.Result.Attributes[213].Value;
		self.FelonyAge                            := le.Result.Attributes[214].Value;
		self.FelonyCount01                        := le.Result.Attributes[215].Value;
		self.FelonyCount03                        := le.Result.Attributes[216].Value;
		self.FelonyCount06                        := le.Result.Attributes[217].Value;
		self.FelonyCount12                        := le.Result.Attributes[218].Value;
		self.FelonyCount24                        := le.Result.Attributes[219].Value;
		self.FelonyCount60                        := le.Result.Attributes[220].Value;
		self.ArrestCount                          := le.Result.Attributes[221].Value;
		self.ArrestAge                            := le.Result.Attributes[222].Value;
		self.ArrestCount01                        := le.Result.Attributes[223].Value;
		self.ArrestCount03                        := le.Result.Attributes[224].Value;
		self.ArrestCount06                        := le.Result.Attributes[225].Value;
		self.ArrestCount12                        := le.Result.Attributes[226].Value;
		self.ArrestCount24                        := le.Result.Attributes[227].Value;
		self.ArrestCount60                        := le.Result.Attributes[228].Value;
		self.LienCount                            := le.Result.Attributes[229].Value;
		self.LienFiledCount                       := le.Result.Attributes[230].Value;
		self.LienFiledTotal                       := le.Result.Attributes[231].Value;
		self.LienFiledAge                         := le.Result.Attributes[232].Value;
		self.LienFiledCount01                     := le.Result.Attributes[233].Value;
		self.LienFiledCount03                     := le.Result.Attributes[234].Value;
		self.LienFiledCount06                     := le.Result.Attributes[235].Value;
		self.LienFiledCount12                     := le.Result.Attributes[236].Value;
		self.LienFiledCount24                     := le.Result.Attributes[237].Value;
		self.LienFiledCount60                     := le.Result.Attributes[238].Value;
		self.LienReleasedCount                    := le.Result.Attributes[239].Value;
		self.LienReleasedTotal                    := le.Result.Attributes[240].Value;
		self.LienReleasedAge                      := le.Result.Attributes[241].Value;
		self.LienReleasedCount01                  := le.Result.Attributes[242].Value;
		self.LienReleasedCount03                  := le.Result.Attributes[243].Value;
		self.LienReleasedCount06                  := le.Result.Attributes[244].Value;
		self.LienReleasedCount12                  := le.Result.Attributes[245].Value;
		self.LienReleasedCount24                  := le.Result.Attributes[246].Value;
		self.LienReleasedCount60                  := le.Result.Attributes[247].Value;
		self.BankruptcyCount                      := le.Result.Attributes[248].Value;
		self.BankruptcyAge                        := le.Result.Attributes[249].Value;
		self.BankruptcyType                       := le.Result.Attributes[250].Value;
		self.BankruptcyStatus                     := le.Result.Attributes[251].Value;
		self.BankruptcyCount01                    := le.Result.Attributes[252].Value;
		self.BankruptcyCount03                    := le.Result.Attributes[253].Value;
		self.BankruptcyCount06                    := le.Result.Attributes[254].Value;
		self.BankruptcyCount12                    := le.Result.Attributes[255].Value;
		self.BankruptcyCount24                    := le.Result.Attributes[256].Value;
		self.BankruptcyCount60                    := le.Result.Attributes[257].Value;
		self.EvictionCount                        := le.Result.Attributes[258].Value;
		self.EvictionAge                          := le.Result.Attributes[259].Value;
		self.EvictionCount01                      := le.Result.Attributes[260].Value;
		self.EvictionCount03                      := le.Result.Attributes[261].Value;
		self.EvictionCount06                      := le.Result.Attributes[262].Value;
		self.EvictionCount12                      := le.Result.Attributes[263].Value;
		self.EvictionCount24                      := le.Result.Attributes[264].Value;
		self.EvictionCount60                      := le.Result.Attributes[265].Value;
		self.AccidentCount                        := le.Result.Attributes[266].Value;
		self.AccidentAge                          := le.Result.Attributes[267].Value;
		self.RecentActivityIndex                  := le.Result.Attributes[268].Value;
		self.NonDerogCount                        := le.Result.Attributes[269].Value;
		self.NonDerogCount01                      := le.Result.Attributes[270].Value;
		self.NonDerogCount03                      := le.Result.Attributes[271].Value;
		self.NonDerogCount06                      := le.Result.Attributes[272].Value;
		self.NonDerogCount12                      := le.Result.Attributes[273].Value;
		self.NonDerogCount24                      := le.Result.Attributes[274].Value;
		self.NonDerogCount60                      := le.Result.Attributes[275].Value;
		self.VoterRegistrationRecord              := le.Result.Attributes[276].Value;
		self.ProfLicCount                         := le.Result.Attributes[277].Value;
		self.ProfLicAge                           := le.Result.Attributes[278].Value;
		self.ProfLicTypeCategory                  := le.Result.Attributes[279].Value;
		self.ProfLicExpired                       := le.Result.Attributes[280].Value;
		self.ProfLicCount01                       := le.Result.Attributes[281].Value;
		self.ProfLicCount03                       := le.Result.Attributes[282].Value;
		self.ProfLicCount06                       := le.Result.Attributes[283].Value;
		self.ProfLicCount12                       := le.Result.Attributes[284].Value;
		self.ProfLicCount24                       := le.Result.Attributes[285].Value;
		self.ProfLicCount60                       := le.Result.Attributes[286].Value;
		self.PRSearchLocateCount                  := le.Result.Attributes[287].Value;
		self.PRSearchLocateCount01                := le.Result.Attributes[288].Value;
		self.PRSearchLocateCount03                := le.Result.Attributes[289].Value;
		self.PRSearchLocateCount06                := le.Result.Attributes[290].Value;
		self.PRSearchLocateCount12                := le.Result.Attributes[291].Value;
		self.PRSearchLocateCount24                := le.Result.Attributes[292].Value;
		self.PRSearchPersonalFinanceCount         := le.Result.Attributes[293].Value;
		self.PRSearchPersonalFinanceCount01       := le.Result.Attributes[294].Value;
		self.PRSearchPersonalFinanceCount03       := le.Result.Attributes[295].Value;
		self.PRSearchPersonalFinanceCount06       := le.Result.Attributes[296].Value;
		self.PRSearchPersonalFinanceCount12       := le.Result.Attributes[297].Value;
		self.PRSearchPersonalFinanceCount24       := le.Result.Attributes[298].Value;
		self.PRSearchOtherCount                   := le.Result.Attributes[299].Value;
		self.PRSearchOtherCount01                 := le.Result.Attributes[300].Value;
		self.PRSearchOtherCount03                 := le.Result.Attributes[301].Value;
		self.PRSearchOtherCount06                 := le.Result.Attributes[302].Value;
		self.PRSearchOtherCount12                 := le.Result.Attributes[303].Value;
		self.PRSearchOtherCount24                 := le.Result.Attributes[304].Value;
		self.PRSearchIdentitySSNs                 := le.Result.Attributes[305].Value;
		self.PRSearchIdentityAddrs                := le.Result.Attributes[306].Value;
		self.PRSearchIdentityPhones               := le.Result.Attributes[307].Value;
		self.PRSearchSSNIdentities                := le.Result.Attributes[308].Value;
		self.PRSearchAddrIdentities               := le.Result.Attributes[309].Value;
		self.PRSearchPhoneIdentities              := le.Result.Attributes[310].Value;
		self.SubPrimeOfferRequestCount            := le.Result.Attributes[311].Value;
		self.SubPrimeOfferRequestCount01          := le.Result.Attributes[312].Value;
		self.SubPrimeOfferRequestCount03          := le.Result.Attributes[313].Value;
		self.SubPrimeOfferRequestCount06          := le.Result.Attributes[314].Value;
		self.SubPrimeOfferRequestCount12          := le.Result.Attributes[315].Value;
		self.SubPrimeOfferRequestCount24          := le.Result.Attributes[316].Value;
		self.SubPrimeOfferRequestCount60          := le.Result.Attributes[317].Value;
		self.InputPhoneMobile                     := le.Result.Attributes[318].Value;
		self.InputPhoneType                       := le.Result.Attributes[319].Value;
		self.InputPhoneServiceType                := le.Result.Attributes[320].Value;
		self.InputAreaCodeChange                  := le.Result.Attributes[321].Value;
		self.PhoneEDAAgeOldestRecord              := le.Result.Attributes[322].Value;
		self.PhoneEDAAgeNewestRecord              := le.Result.Attributes[323].Value;
		self.PhoneOtherAgeOldestRecord            := le.Result.Attributes[324].Value;
		self.PhoneOtherAgeNewestRecord            := le.Result.Attributes[325].Value;
		self.InputPhoneHighRisk                   := le.Result.Attributes[326].Value;
		self.InputPhoneProblems                   := le.Result.Attributes[327].Value;
		self.OnlineDirectory                      := le.Result.Attributes[328].Value;
		self.InputAddrSICCode                     := le.Result.Attributes[329].Value;
		self.InputAddrValidation                  := le.Result.Attributes[330].Value;
		self.InputAddrErrorCode                   := le.Result.Attributes[331].Value;
		self.InputAddrHighRisk                    := le.Result.Attributes[332].Value;
		self.CurrAddrCorrectional                 := le.Result.Attributes[333].Value;
		self.PrevAddrCorrectional                 := le.Result.Attributes[334].Value;
		self.HistoricalAddrCorrectional           := le.Result.Attributes[335].Value;
		self.InputAddrProblems                    := le.Result.Attributes[336].Value;
		self.DoNotMail                            := le.Result.Attributes[337].Value;
		// 4.1 Attributes (Part of 4.0)
		SELF.IdentityRiskLevel                    := le.Result.Attributes[338].Value;
		SELF.IDVerRiskLevel                       := le.Result.Attributes[339].Value;
		SELF.IDVerAddressAssocCount 							:= le.Result.Attributes[340].Value;
		SELF.IDVerSSNCreditBureauCount 						:= le.Result.Attributes[341].Value;
		SELF.IDVerSSNCreditBureauDelete 					:= le.Result.Attributes[342].Value;
		SELF.SourceRiskLevel 											:= le.Result.Attributes[343].Value;
		SELF.SourceWatchList 											:= le.Result.Attributes[344].Value;
		SELF.SourceOrderActivity 									:= '0'; // hard coded because ibehavior can't be used anymore
		SELF.SourceOrderSourceCount 							:= '0'; // hard coded because ibehavior can't be used anymore
		SELF.SourceOrderAgeLastOrder 							:= '-1'; // hard coded because ibehavior can't be used anymore
		SELF.VariationRiskLevel 									:= le.Result.Attributes[348].Value;
		SELF.VariationIdentityCount 							:= le.Result.Attributes[349].Value;
		SELF.VariationMSourcesSSNCount 						:= le.Result.Attributes[350].Value;
		SELF.VariationMSourcesSSNUnrelCount 			:= le.Result.Attributes[351].Value;
		SELF.VariationDOBCount 										:= le.Result.Attributes[352].Value;
		SELF.VariationDOBCountNew 								:= le.Result.Attributes[353].Value;
		SELF.SearchVelocityRiskLevel 							:= le.Result.Attributes[354].Value;
		SELF.SearchUnverifiedSSNCountYear 				:= le.Result.Attributes[355].Value;
		SELF.SearchUnverifiedAddrCountYear 				:= le.Result.Attributes[356].Value;
		SELF.SearchUnverifiedDOBCountYear 				:= le.Result.Attributes[357].Value;
		SELF.SearchUnverifiedPhoneCountYear 			:= le.Result.Attributes[358].Value;
		SELF.AssocRiskLevel 											:= le.Result.Attributes[359].Value;
		SELF.AssocSuspicousIdentitiesCount 				:= le.Result.Attributes[360].Value;
		SELF.AssocCreditBureauOnlyCount 					:= le.Result.Attributes[361].Value;
		SELF.AssocCreditBureauOnlyCountNew 				:= le.Result.Attributes[362].Value;
		SELF.AssocCreditBureauOnlyCountMonth 			:= le.Result.Attributes[363].Value;
		SELF.AssocHighRiskTopologyCount 					:= le.Result.Attributes[364].Value;
		SELF.ValidationRiskLevel 									:= le.Result.Attributes[365].Value;
		SELF.CorrelationRiskLevel 								:= le.Result.Attributes[366].Value;
		SELF.DivRiskLevel 												:= le.Result.Attributes[367].Value;
		SELF.DivSSNIdentityMSourceCount 					:= le.Result.Attributes[368].Value;
		SELF.DivSSNIdentityMSourceUrelCount 			:= le.Result.Attributes[369].Value;
		SELF.DivSSNLNameCountNew 									:= le.Result.Attributes[370].Value;
		SELF.DivSSNAddrMSourceCount 							:= le.Result.Attributes[371].Value;
		SELF.DivAddrIdentityCount 								:= le.Result.Attributes[372].Value;
		SELF.DivAddrIdentityCountNew 							:= le.Result.Attributes[373].Value;
		SELF.DivAddrIdentityMSourceCount 					:= le.Result.Attributes[374].Value;
		SELF.DivAddrSuspIdentityCountNew 					:= le.Result.Attributes[375].Value;
		SELF.DivAddrSSNCount 											:= le.Result.Attributes[376].Value;
		SELF.DivAddrSSNCountNew 									:= le.Result.Attributes[377].Value;
		SELF.DivAddrSSNMSourceCount 							:= le.Result.Attributes[378].Value;
		SELF.DivSearchAddrSuspIdentityCount 			:= le.Result.Attributes[379].Value;
		SELF.SearchComponentRiskLevel 						:= le.Result.Attributes[380].Value;
		SELF.SearchSSNSearchCount 								:= le.Result.Attributes[381].Value;
		SELF.SearchAddrSearchCount 								:= le.Result.Attributes[382].Value;
		SELF.SearchPhoneSearchCount 							:= le.Result.Attributes[383].Value;
		SELF.ComponentCharRiskLevel 							:= le.Result.Attributes[384].Value;
		#if(include_internal_extras)
			self.DID := le.did; 
			self := [];
		#end;
	END;
	slim_attr := project( LeadIntegrity_attributes, slim_v4(left) );
	
	final := JOIN(LeadIntegrity_input, slim_attr, LEFT.LeadIntegrityRequest[1].SearchBy.Seq=RIGHT.seq,
		TRANSFORM(layout_slimmed,
			SELF.AccountNumber := LEFT.Old_Account_Number;
			#if(include_internal_extras)
				self.DID := right.did; 
				self.historydate := (string)left.HistoryDateYYYYMM;
				self.FNamePop := left.leadintegrityrequest[1].searchby.name.first <> '';
				self.LNamePop := left.leadintegrityrequest[1].searchby.name.last <> '';
				self.AddrPop := left.leadintegrityrequest[1].searchby.address.streetaddress1 <> '';
				self.SSNLength := (string)(length(trim(left.leadintegrityrequest[1].searchby.ssn))) ;
				self.DOBPop := left.leadintegrityrequest[1].searchby.dob.year <> 0;
				self.EmailPop := false; // not used in lead integrity
				self.IPAddrPop := false; // not used in lead integrity
				self.HPhnPop := left.leadintegrityrequest[1].searchby.homephone <> '';
			#end;
			self := right
		),
		keep(1)
	);

#elseif(version=3)
	layout_slimmed := RECORD
		STRING20 seq;
		STRING30 AccountNumber;

		STRING4  AgeOldestRecord;
		STRING4  AgeNewestRecord;	
		STRING1  RecentUpdate;
		STRING2  SrcsConfirmIDAddrCount;
		STRING1  CreditBureauRecord;
		STRING2  InvalidSSN;
		STRING2  InvalidAddr;
		STRING2  InvalidPhone;
		STRING2  VerificationFailure;
		STRING2  SSNNotFound;
		STRING2  SSNFoundOther;
		STRING1  VerifiedName;
		STRING2  VerifiedSSN;
		STRING2  VerifiedPhone;
		STRING2  VerifiedPhoneFullName;
		STRING2  VerifiedPhoneLastName;
		STRING2  VerifiedAddress;
		STRING2  VerifiedDOB;
		STRING3  AgeRiskIndicator;
		STRING3  SubjectSSNCount;
		STRING3  SubjectAddrCount;
		STRING3  SubjectPhoneCount;
		STRING3  SubjectSSNRecentCount;
		STRING3  SubjectAddrRecentCount;
		STRING3  SubjectPhoneRecentCount;
		STRING3  SSNIdentitiesCount;
		STRING3  SSNAddrCount;
		STRING3  SSNIdentitiesRecentCount;
		STRING3  SSNAddrRecentCount;
		STRING3  InputAddrIdentitiesCount;
		STRING3  InputAddrSSNCount;
		STRING3  InputAddrPhoneCount;
		STRING3  InputAddrIdentitiesRecentCount;
		STRING3  InputAddrSSNRecentCount;
		STRING3  InputAddrPhoneRecentCount;
		STRING3  PhoneIdentitiesCount;
		STRING3  PhoneIdentitiesRecentCount;
		STRING2  PhoneOther;
		STRING3  SSNLastNameCount;
		STRING3  SubjectLastNameCount;
		STRING4  LastNameChangeAge;
		STRING3  LastNameChangeCount01;
		STRING3  LastNameChangeCount03;
		STRING3  LastNameChangeCount06;
		STRING3  LastNameChangeCount12;
		STRING3  LastNameChangeCount24;
		STRING3  LastNameChangeCount36;
		STRING3  LastNameChangeCount60;
		STRING3  SFDUAddrIdentitiesCount;
		STRING3  SFDUAddrSSNCount;
		STRING2  SSNDeceased;
		STRING8  SSNDateDeceased;
		STRING2  SSNIssued;
		STRING2  SSNRecent;
		STRING8  SSNLowIssueDate;
		STRING8  SSNHighIssueDate;
		STRING2  SSNIssueState;
		STRING2  SSNNonUS;
		STRING2  SSNIssuedPriorDOB;
		STRING2  SSN3Years;
		STRING2  SSNAfter5;
		STRING3  SSNProblems;
		STRING3  RelativesCount;
		STRING3  RelativesBankruptcyCount;
		STRING3  RelativesFelonyCount;
		STRING3  RelativesPropOwnedCount;
		STRING13 RelativesPropOwnedTaxTotal;
		STRING2  RelativesDistanceClosest;
		STRING4  InputAddrAgeOldestRecord;
		STRING4  InputAddrAgeNewestRecord;
		STRING3  InputAddrLenOfRes;
		STRING2  InputAddrDwellType;
		STRING2  InputAddrLandUseCode;
		STRING2  InputAddrApplicantOwned;
		STRING2  InputAddrFamilyOwned;
		STRING2  InputAddrOccupantOwned;
		STRING4  InputAddrAgeLastSale;
		STRING10 InputAddrLastSalesPrice;
		STRING2  InputAddrNotPrimaryRes;
		STRING2  InputAddrActivePhoneList;
		STRING10 InputAddrActivePhoneNumber;
		STRING10 InputAddrTaxValue;
		STRING4  InputAddrTaxYr;
		STRING10 InputAddrTaxMarketValue;
		STRING10 InputAddrAVMTax;
		STRING10 InputAddrAVMSalesPrice;
		STRING10 InputAddrAVMHedonic;
		STRING10 InputAddrAVMValue;
		STRING2  InputAddrAVMConfidence;
		STRING5  InputAddrCountyIndex;
		STRING5  InputAddrTractIndex;
		STRING5  InputAddrBlockIndex;
		STRING10 InputAddrMedianIncome;
		STRING10 InputAddrMedianValue;
		STRING3  InputAddrMurderIndex;
		STRING3  InputAddrCarTheftIndex;
		STRING3  InputAddrBurglaryIndex;
		STRING3  InputAddrCrimeIndex;
		STRING4  CurrAddrAgeOldestRecord;
		STRING4  CurrAddrAgeNewestRecord;
		STRING3  CurrAddrLenOfRes;
		STRING2  CurrAddrDwellType;
		STRING2  CurrAddrLandUseCode;
		STRING2  CurrAddrApplicantOwned;
		STRING2  CurrAddrFamilyOwned;
		STRING2  CurrAddrOccupantOwned;
		STRING4  CurrAddrAgeLastSale;
		STRING10 CurrAddrLastSalesPrice;
		STRING2  CurrAddrActivePhoneList;
		STRING10 CurrAddrActivePhoneNumber;
		STRING10 CurrAddrTaxValue;
		STRING4  CurrAddrTaxYr;
		STRING10 CurrAddrTaxMarketValue;
		STRING10 CurrAddrAVMTax;
		STRING10 CurrAddrAVMSalesPrice;
		STRING10 CurrAddrAVMHedonic;
		STRING10 CurrAddrAVMValue;
		STRING2  CurrAddrAVMConfidence;
		STRING5  CurrAddrCountyIndex;
		STRING5  CurrAddrTractIndex;
		STRING5  CurrAddrBlockIndex;
		STRING10 CurrAddrMedianIncome;
		STRING10 CurrAddrMedianValue;
		STRING3  CurrAddrMurderIndex;
		STRING3  CurrAddrCarTheftIndex;
		STRING3  CurrAddrBurglaryIndex;
		STRING3  CurrAddrCrimeIndex;
		STRING4  PrevAddrAgeOldestRecord;
		STRING4  PrevAddrAgeNewestRecord;
		STRING3  PrevAddrLenOfRes;
		STRING2  PrevAddrDwellType;
		STRING2  PrevAddrLandUseCode;
		STRING2  PrevAddrApplicantOwned;
		STRING2  PrevAddrFamilyOwned;
		STRING2  PrevAddrOccupantOwned;
		STRING4  PrevAddrAgeLastSale;
		STRING10 PrevAddrLastSalesPrice;
		STRING2  PrevAddrActivePhoneList;
		STRING10 PrevAddrActivePhoneNumber;
		STRING10 PrevAddrTaxValue;
		STRING4  PrevAddrTaxYr;
		STRING10 PrevAddrTaxMarketValue;
		STRING10 PrevAddrAVMTax;
		STRING10 PrevAddrAVMSalesPrice;
		STRING10 PrevAddrAVMHedonic;
		STRING10 PrevAddrAVMValue;
		STRING2  PrevAddrAVMConfidence;
		STRING5  PrevAddrCountyIndex;
		STRING5  PrevAddrTractIndex;
		STRING5  PrevAddrBlockIndex;
		STRING10 PrevAddrMedianIncome;
		STRING10 PrevAddrMedianValue;
		STRING3  PrevAddrMurderIndex;
		STRING3  PrevAddrCarTheftIndex;
		STRING3  PrevAddrBurglaryIndex;
		STRING3  PrevAddrCrimeIndex;
		STRING2  InputCurrAddrMatch;
		STRING4  InputCurrAddrDistance;
		STRING2  InputCurrAddrStateDiff;
		STRING10 InputCurrAddrTaxDiff;
		STRING11 InputCurrAddrIncomeDiff;
		STRING11 InputCurrAddrValueDiff;
		STRING4  InputCurrAddrCrimeDiff;
		STRING2  InputCurrEconTrajectory;
		STRING2  InputPrevAddrMatch;
		STRING4  CurrPrevAddrDistance;
		STRING2  CurrPrevAddrStateDiff;
		STRING10 CurrPrevAddrTaxDiff;
		STRING11 CurrPrevAddrIncomeDiff;
		STRING11 CurrPrevAddrValueDiff;
		STRING4  CurrPrevAddrCrimeDiff;
		STRING2  PrevCurrEconTrajectory;
		STRING1  EducationAttendedCollege;
		STRING2  EducationProgram2Yr;
		STRING2  EducationProgram4Yr;
		STRING2  EducationProgramGraduate;
		STRING2  EducationInstitutionPrivate;
		STRING2  EducationInstitutionRating;
		STRING2  EducationFieldofStudyType;
		STRING1  AddrStability;
		STRING2  StatusMostRecent;
		STRING2  StatusPrevious;
		STRING2  StatusNextPrevious;
		STRING3  AddrChangeCount01;
		STRING3  AddrChangeCount03;
		STRING3  AddrChangeCount06;
		STRING3  AddrChangeCount12;
		STRING3  AddrChangeCount24;
		STRING3  AddrChangeCount36;
		STRING3  AddrChangeCount60;
		STRING6  PredictedAnnualIncome;
		STRING3  PropOwnedCount;
		STRING13 PropOwnedTaxTotal;
		STRING3  PropOwnedHistoricalCount;
		STRING3  PropAgeOldestPurchase;
		STRING3  PropAgeNewestPurchase;
		STRING3  PropAgeNewestSale;
		STRING4  PropNewestSalePurchaseIndex;
		STRING3  PropPurchasedCount01;
		STRING3  PropPurchasedCount03;
		STRING3  PropPurchasedCount06;
		STRING3  PropPurchasedCount12;
		STRING3  PropPurchasedCount24;
		STRING3  PropPurchasedCount36;
		STRING3  PropPurchasedCount60;
		STRING3  PropSoldCount01;
		STRING3  PropSoldCount03;
		STRING3  PropSoldCount06;
		STRING3  PropSoldCount12;
		STRING3  PropSoldCount24;
		STRING3  PropSoldCount36;
		STRING3  PropSoldCount60;
		STRING3  WatercraftCount;
		STRING3  WatercraftCount01;
		STRING3  WatercraftCount03;
		STRING3  WatercraftCount06;
		STRING3  WatercraftCount12;
		STRING3  WatercraftCount24;
		STRING3  WatercraftCount36;
		STRING3  WatercraftCount60;
		STRING3  AircraftCount;
		STRING3  AircraftCount01;
		STRING3  AircraftCount03;
		STRING3  AircraftCount06;
		STRING3  AircraftCount12;
		STRING3  AircraftCount24;
		STRING3  AircraftCount36;
		STRING3  AircraftCount60;
		STRING1  WealthIndex;
		STRING3  SubPrimeSolicitedCount;
		STRING3  SubPrimeSolicitedCount01;
		STRING3  SubPrimeSolicitedCount03;
		STRING3  SubPrimeSolicitedCount06;
		STRING3  SubPrimeSolicitedCount12;
		STRING3  SubPrimeSolicitedCount24;
		STRING3  SubPrimeSolicitedCount36;
		STRING3  SubPrimeSolicitedCount60;
		STRING2  DerogSeverityIndex;
		STRING3  DerogCount;
		STRING4  DerogAge;
		STRING3  FelonyCount;
		STRING4  FelonyAge;
		STRING3  FelonyCount01;
		STRING3  FelonyCount03;
		STRING3  FelonyCount06;
		STRING3  FelonyCount12;
		STRING3  FelonyCount24;
		STRING3  FelonyCount36;
		STRING3  FelonyCount60;
		STRING3  ArrestCount;
		STRING4  ArrestAge;
		STRING3  ArrestCount01;
		STRING3  ArrestCount03;
		STRING3  ArrestCount06;
		STRING3  ArrestCount12;
		STRING3  ArrestCount24;
		STRING3  ArrestCount36;
		STRING3  ArrestCount60;
		STRING3  LienCount;
		STRING3  LienFiledCount;
		STRING4  LienFiledAge;
		STRING3  LienFiledCount01;
		STRING3  LienFiledCount03;
		STRING3  LienFiledCount06;
		STRING3  LienFiledCount12;
		STRING3  LienFiledCount24;
		STRING3  LienFiledCount36;
		STRING3  LienFiledCount60;
		STRING3  LienReleasedCount;
		STRING4  LienReleasedAge;
		STRING3  LienReleasedCount01;
		STRING3  LienReleasedCount03;
		STRING3  LienReleasedCount06;
		STRING3  LienReleasedCount12;
		STRING3  LienReleasedCount24;
		STRING3  LienReleasedCount36;
		STRING3  LienReleasedCount60;
		STRING3  BankruptcyCount;
		STRING4  BankruptcyAge;
		STRING2  BankruptcyType;
		STRING35 BankruptcyStatus;
		STRING3  BankruptcyCount01;
		STRING3  BankruptcyCount03;
		STRING3  BankruptcyCount06;
		STRING3  BankruptcyCount12;
		STRING3  BankruptcyCount24;
		STRING3  BankruptcyCount36;
		STRING3  BankruptcyCount60;
		STRING3  EvictionCount;
		STRING4  EvictionAge;
		STRING3  EvictionCount01;
		STRING3  EvictionCount03;
		STRING3  EvictionCount06;
		STRING3  EvictionCount12;
		STRING3  EvictionCount24;
		STRING3  EvictionCount36;
		STRING3  EvictionCount60;
		STRING3  NonDerogCount;
		STRING3  NonDerogCount01;
		STRING3  NonDerogCount03;
		STRING3  NonDerogCount06;
		STRING3  NonDerogCount12;
		STRING3  NonDerogCount24;
		STRING3  NonDerogCount36;
		STRING3  NonDerogCount60;
		STRING3  ProfLicCount;
		STRING4  ProfLicAge;
		STRING2  ProfLicTypeCategory;
		STRING8  ProfLicExpireDate;
		STRING3  ProfLicCount01;
		STRING3  ProfLicCount03;
		STRING3  ProfLicCount06;
		STRING3  ProfLicCount12;
		STRING3  ProfLicCount24;
		STRING3  ProfLicCount36;
		STRING3  ProfLicCount60;
		STRING3  ProfLicExpireCount01;
		STRING3  ProfLicExpireCount03;
		STRING3  ProfLicExpireCount06;
		STRING3  ProfLicExpireCount12;
		STRING3  ProfLicExpireCount24;
		STRING3  ProfLicExpireCount36;
		STRING3  ProfLicExpireCount60;
		STRING3  PRSearchCollectionCount;
		STRING3  PRSearchCollectionCount01;
		STRING3  PRSearchCollectionCount03;
		STRING3  PRSearchCollectionCount06;
		STRING3  PRSearchCollectionCount12;
		STRING3  PRSearchCollectionCount24;
		STRING3  PRSearchCollectionCount36;
		STRING3  PRSearchCollectionCount60;
		STRING3  PRSearchIDVFraudCount;
		STRING3  PRSearchIDVFraudCount01;
		STRING3  PRSearchIDVFraudCount03;
		STRING3  PRSearchIDVFraudCount06;
		STRING3  PRSearchIDVFraudCount12;
		STRING3  PRSearchIDVFraudCount24;
		STRING3  PRSearchIDVFraudCount36;
		STRING3  PRSearchIDVFraudCount60;
		STRING3  PRSearchOtherCount;
		STRING3  PRSearchOtherCount01;
		STRING3  PRSearchOtherCount03;
		STRING3  PRSearchOtherCount06;
		STRING3  PRSearchOtherCount12;
		STRING3  PRSearchOtherCount24;
		STRING3  PRSearchOtherCount36;
		STRING3  PRSearchOtherCount60;
		STRING2  InputPhoneStatus;
		STRING2  InputPhonePager;
		STRING2  InputPhoneMobile;
		STRING2  InputPhoneType;
		STRING2  InputPhoneServiceType;
		STRING2  InputAreaCodeChange;
		STRING4  PhoneEDAAgeOldestRecord;
		STRING4  PhoneEDAAgeNewestRecord;
		STRING4  PhoneOtherAgeOldestRecord;
		STRING4  PhoneOtherAgeNewestRecord;
		STRING2  InvalidPhoneZip;
		STRING4  InputPhoneAddrDist;
		STRING6  InputAddrSICCode;
		STRING2  InputAddrValidation;
		STRING5  InputAddrErrorCode;
		STRING2  InputAddrHighRisk;
		STRING2  InputPhoneHighRisk;
		STRING2  InputAddrPrison;
		STRING2  CurrAddrPrison;
		STRING2  PrevAddrPrison;
		STRING2  HistoricalAddrPrison;
		STRING2  InputZipPOBox;
		STRING2  InputZipCorpMil;
		STRING1  DoNotMail;
		#if(include_internal_extras)
			RiskProcessing.layout_internal_extras;
		#end
	END;
	layout_slimmed slim_v3( LeadIntegrity_input le, LeadIntegrity_attributes ri ) := TRANSFORM
		SELF.AccountNumber                            := le.old_account_number;
		SELF.seq                                      := le.LeadIntegrityRequest[1].SearchBy.Seq;

		SELF.AgeOldestRecord                          := ri.Result.Attributes[1].value;
		SELF.AgeNewestRecord                          := ri.Result.Attributes[2].value;
		SELF.RecentUpdate                             := ri.Result.Attributes[3].value;
		SELF.SrcsConfirmIDAddrCount                   := ri.Result.Attributes[4].value;
		SELF.CreditBureauRecord                       := ri.Result.Attributes[5].value;
		SELF.InvalidSSN                               := ri.Result.Attributes[6].value;
		SELF.InvalidAddr                              := ri.Result.Attributes[7].value;
		SELF.InvalidPhone                             := ri.Result.Attributes[8].value;
		SELF.VerificationFailure                      := ri.Result.Attributes[9].value;
		SELF.SSNNotFound                              := ri.Result.Attributes[10].value;
		SELF.SSNFoundOther                            := ri.Result.Attributes[11].value;
		SELF.VerifiedName                             := ri.Result.Attributes[12].value;
		SELF.VerifiedSSN                              := ri.Result.Attributes[13].value;
		SELF.VerifiedPhone                            := ri.Result.Attributes[14].value;
		SELF.VerifiedPhoneFullName                    := ri.Result.Attributes[15].value;
		SELF.VerifiedPhoneLastName                    := ri.Result.Attributes[16].value;
		SELF.VerifiedAddress                          := ri.Result.Attributes[17].value;
		SELF.VerifiedDOB                              := ri.Result.Attributes[18].value;
		SELF.AgeRiskIndicator                         := ri.Result.Attributes[19].value;
		SELF.SubjectSSNCount                          := ri.Result.Attributes[20].value;
		SELF.SubjectAddrCount                         := ri.Result.Attributes[21].value;
		SELF.SubjectPhoneCount                        := ri.Result.Attributes[22].value;
		SELF.SubjectSSNRecentCount                    := ri.Result.Attributes[23].value;
		SELF.SubjectAddrRecentCount                   := ri.Result.Attributes[24].value;
		SELF.SubjectPhoneRecentCount                  := ri.Result.Attributes[25].value;
		SELF.SSNIdentitiesCount                       := ri.Result.Attributes[26].value;
		SELF.SSNAddrCount                             := ri.Result.Attributes[27].value;
		SELF.SSNIdentitiesRecentCount                 := ri.Result.Attributes[28].value;
		SELF.SSNAddrRecentCount                       := ri.Result.Attributes[29].value;
		SELF.InputAddrIdentitiesCount                 := ri.Result.Attributes[30].value;
		SELF.InputAddrSSNCount                        := ri.Result.Attributes[31].value;
		SELF.InputAddrPhoneCount                      := ri.Result.Attributes[32].value;
		SELF.InputAddrIdentitiesRecentCount           := ri.Result.Attributes[33].value;
		SELF.InputAddrSSNRecentCount                  := ri.Result.Attributes[34].value;
		SELF.InputAddrPhoneRecentCount                := ri.Result.Attributes[35].value;
		SELF.PhoneIdentitiesCount                     := ri.Result.Attributes[36].value;
		SELF.PhoneIdentitiesRecentCount               := ri.Result.Attributes[37].value;
		SELF.PhoneOther                               := ri.Result.Attributes[38].value;
		SELF.SSNLastNameCount                         := ri.Result.Attributes[39].value;
		SELF.SubjectLastNameCount                     := ri.Result.Attributes[40].value;
		SELF.LastNameChangeAge                        := ri.Result.Attributes[41].value;
		SELF.LastNameChangeCount01                    := ri.Result.Attributes[42].value;
		SELF.LastNameChangeCount03                    := ri.Result.Attributes[43].value;
		SELF.LastNameChangeCount06                    := ri.Result.Attributes[44].value;
		SELF.LastNameChangeCount12                    := ri.Result.Attributes[45].value;
		SELF.LastNameChangeCount24                    := ri.Result.Attributes[46].value;
		SELF.LastNameChangeCount36                    := ri.Result.Attributes[47].value;
		SELF.LastNameChangeCount60                    := ri.Result.Attributes[48].value;
		SELF.SFDUAddrIdentitiesCount                  := ri.Result.Attributes[49].value;
		SELF.SFDUAddrSSNCount                         := ri.Result.Attributes[50].value;
		SELF.SSNDeceased                              := ri.Result.Attributes[51].value;
		SELF.SSNDateDeceased                          := ri.Result.Attributes[52].value;
		SELF.SSNIssued                                := ri.Result.Attributes[53].value;
		SELF.SSNRecent                                := ri.Result.Attributes[54].value;
		SELF.SSNLowIssueDate                          := ri.Result.Attributes[55].value;
		SELF.SSNHighIssueDate                         := ri.Result.Attributes[56].value;
		SELF.SSNIssueState                            := ri.Result.Attributes[57].value;
		SELF.SSNNonUS                                 := ri.Result.Attributes[58].value;
		SELF.SSNIssuedPriorDOB                        := ri.Result.Attributes[59].value;
		SELF.SSN3Years                                := ri.Result.Attributes[60].value;
		SELF.SSNAfter5                                := ri.Result.Attributes[61].value;
		SELF.SSNProblems                              := ri.Result.Attributes[62].value;
		SELF.RelativesCount                           := ri.Result.Attributes[63].value;
		SELF.RelativesBankruptcyCount                 := ri.Result.Attributes[64].value;
		SELF.RelativesFelonyCount                     := ri.Result.Attributes[65].value;
		SELF.RelativesPropOwnedCount                  := ri.Result.Attributes[66].value;
		SELF.RelativesPropOwnedTaxTotal               := ri.Result.Attributes[67].value;
		SELF.RelativesDistanceClosest                 := ri.Result.Attributes[68].value;
		SELF.InputAddrAgeOldestRecord                 := ri.Result.Attributes[69].value;
		SELF.InputAddrAgeNewestRecord                 := ri.Result.Attributes[70].value;
		SELF.InputAddrLenOfRes                        := ri.Result.Attributes[71].value;
		SELF.InputAddrDwellType                       := ri.Result.Attributes[72].value;
		SELF.InputAddrLandUseCode                     := ri.Result.Attributes[73].value;
		SELF.InputAddrApplicantOwned                  := ri.Result.Attributes[74].value;
		SELF.InputAddrFamilyOwned                     := ri.Result.Attributes[75].value;
		SELF.InputAddrOccupantOwned                   := ri.Result.Attributes[76].value;
		SELF.InputAddrAgeLastSale                     := ri.Result.Attributes[77].value;
		SELF.InputAddrLastSalesPrice                  := ri.Result.Attributes[78].value;
		SELF.InputAddrNotPrimaryRes                   := ri.Result.Attributes[79].value;
		SELF.InputAddrActivePhoneList                 := ri.Result.Attributes[80].value;
		SELF.InputAddrActivePhoneNumber               := ri.Result.Attributes[81].value;
		SELF.InputAddrTaxValue                        := ri.Result.Attributes[82].value;
		SELF.InputAddrTaxYr                           := ri.Result.Attributes[83].value;
		SELF.InputAddrTaxMarketValue                  := ri.Result.Attributes[84].value;
		SELF.InputAddrAVMTax                          := ri.Result.Attributes[85].value;
		SELF.InputAddrAVMSalesPrice                   := ri.Result.Attributes[86].value;
		SELF.InputAddrAVMHedonic                      := ri.Result.Attributes[87].value;
		SELF.InputAddrAVMValue                        := ri.Result.Attributes[88].value;
		SELF.InputAddrAVMConfidence                   := ri.Result.Attributes[89].value;
		SELF.InputAddrCountyIndex                     := ri.Result.Attributes[90].value;
		SELF.InputAddrTractIndex                      := ri.Result.Attributes[91].value;
		SELF.InputAddrBlockIndex                      := ri.Result.Attributes[92].value;
		SELF.InputAddrMedianIncome                    := ri.Result.Attributes[93].value;
		SELF.InputAddrMedianValue                     := ri.Result.Attributes[94].value;
		SELF.InputAddrMurderIndex                     := ri.Result.Attributes[95].value;
		SELF.InputAddrCarTheftIndex                   := ri.Result.Attributes[96].value;
		SELF.InputAddrBurglaryIndex                   := ri.Result.Attributes[97].value;
		SELF.InputAddrCrimeIndex                      := ri.Result.Attributes[98].value;
		SELF.CurrAddrAgeOldestRecord                  := ri.Result.Attributes[99].value;
		SELF.CurrAddrAgeNewestRecord                  := ri.Result.Attributes[100].value;
		SELF.CurrAddrLenOfRes                         := ri.Result.Attributes[101].value;
		SELF.CurrAddrDwellType                        := ri.Result.Attributes[102].value;
		SELF.CurrAddrLandUseCode                      := ri.Result.Attributes[103].value;
		SELF.CurrAddrApplicantOwned                   := ri.Result.Attributes[104].value;
		SELF.CurrAddrFamilyOwned                      := ri.Result.Attributes[105].value;
		SELF.CurrAddrOccupantOwned                    := ri.Result.Attributes[106].value;
		SELF.CurrAddrAgeLastSale                      := ri.Result.Attributes[107].value;
		SELF.CurrAddrLastSalesPrice                   := ri.Result.Attributes[108].value;
		SELF.CurrAddrActivePhoneList                  := ri.Result.Attributes[109].value;
		SELF.CurrAddrActivePhoneNumber                := ri.Result.Attributes[110].value;
		SELF.CurrAddrTaxValue                         := ri.Result.Attributes[111].value;
		SELF.CurrAddrTaxYr                            := ri.Result.Attributes[112].value;
		SELF.CurrAddrTaxMarketValue                   := ri.Result.Attributes[113].value;
		SELF.CurrAddrAVMTax                           := ri.Result.Attributes[114].value;
		SELF.CurrAddrAVMSalesPrice                    := ri.Result.Attributes[115].value;
		SELF.CurrAddrAVMHedonic                       := ri.Result.Attributes[116].value;
		SELF.CurrAddrAVMValue                         := ri.Result.Attributes[117].value;
		SELF.CurrAddrAVMConfidence                    := ri.Result.Attributes[118].value;
		SELF.CurrAddrCountyIndex                      := ri.Result.Attributes[119].value;
		SELF.CurrAddrTractIndex                       := ri.Result.Attributes[120].value;
		SELF.CurrAddrBlockIndex                       := ri.Result.Attributes[121].value;
		SELF.CurrAddrMedianIncome                     := ri.Result.Attributes[122].value;
		SELF.CurrAddrMedianValue                      := ri.Result.Attributes[123].value;
		SELF.CurrAddrMurderIndex                      := ri.Result.Attributes[124].value;
		SELF.CurrAddrCarTheftIndex                    := ri.Result.Attributes[125].value;
		SELF.CurrAddrBurglaryIndex                    := ri.Result.Attributes[126].value;
		SELF.CurrAddrCrimeIndex                       := ri.Result.Attributes[127].value;
		SELF.PrevAddrAgeOldestRecord                  := ri.Result.Attributes[128].value;
		SELF.PrevAddrAgeNewestRecord                  := ri.Result.Attributes[129].value;
		SELF.PrevAddrLenOfRes                         := ri.Result.Attributes[130].value;
		SELF.PrevAddrDwellType                        := ri.Result.Attributes[131].value;
		SELF.PrevAddrLandUseCode                      := ri.Result.Attributes[132].value;
		SELF.PrevAddrApplicantOwned                   := ri.Result.Attributes[133].value;
		SELF.PrevAddrFamilyOwned                      := ri.Result.Attributes[134].value;
		SELF.PrevAddrOccupantOwned                    := ri.Result.Attributes[135].value;
		SELF.PrevAddrAgeLastSale                      := ri.Result.Attributes[136].value;
		SELF.PrevAddrLastSalesPrice                   := ri.Result.Attributes[137].value;
		SELF.PrevAddrActivePhoneList                  := ri.Result.Attributes[138].value;
		SELF.PrevAddrActivePhoneNumber                := ri.Result.Attributes[139].value;
		SELF.PrevAddrTaxValue                         := ri.Result.Attributes[140].value;
		SELF.PrevAddrTaxYr                            := ri.Result.Attributes[141].value;
		SELF.PrevAddrTaxMarketValue                   := ri.Result.Attributes[142].value;
		SELF.PrevAddrAVMTax                           := ri.Result.Attributes[143].value;
		SELF.PrevAddrAVMSalesPrice                    := ri.Result.Attributes[144].value;
		SELF.PrevAddrAVMHedonic                       := ri.Result.Attributes[145].value;
		SELF.PrevAddrAVMValue                         := ri.Result.Attributes[146].value;
		SELF.PrevAddrAVMConfidence                    := ri.Result.Attributes[147].value;
		SELF.PrevAddrCountyIndex                      := ri.Result.Attributes[148].value;
		SELF.PrevAddrTractIndex                       := ri.Result.Attributes[149].value;
		SELF.PrevAddrBlockIndex                       := ri.Result.Attributes[150].value;
		SELF.PrevAddrMedianIncome                     := ri.Result.Attributes[151].value;
		SELF.PrevAddrMedianValue                      := ri.Result.Attributes[152].value;
		SELF.PrevAddrMurderIndex                      := ri.Result.Attributes[153].value;
		SELF.PrevAddrCarTheftIndex                    := ri.Result.Attributes[154].value;
		SELF.PrevAddrBurglaryIndex                    := ri.Result.Attributes[155].value;
		SELF.PrevAddrCrimeIndex                       := ri.Result.Attributes[156].value;
		SELF.InputCurrAddrMatch                       := ri.Result.Attributes[157].value;
		SELF.InputCurrAddrDistance                    := ri.Result.Attributes[158].value;
		SELF.InputCurrAddrStateDiff                   := ri.Result.Attributes[159].value;
		SELF.InputCurrAddrTaxDiff                     := ri.Result.Attributes[160].value;
		SELF.InputCurrAddrIncomeDiff                  := ri.Result.Attributes[161].value;
		SELF.InputCurrAddrValueDiff                   := ri.Result.Attributes[162].value;
		SELF.InputCurrAddrCrimeDiff                   := ri.Result.Attributes[163].value;
		SELF.InputCurrEconTrajectory                  := ri.Result.Attributes[164].value;
		SELF.InputPrevAddrMatch                       := ri.Result.Attributes[165].value;
		SELF.CurrPrevAddrDistance                     := ri.Result.Attributes[166].value;
		SELF.CurrPrevAddrStateDiff                    := ri.Result.Attributes[167].value;
		SELF.CurrPrevAddrTaxDiff                      := ri.Result.Attributes[168].value;
		SELF.CurrPrevAddrIncomeDiff                   := ri.Result.Attributes[169].value;
		SELF.CurrPrevAddrValueDiff                    := ri.Result.Attributes[170].value;
		SELF.CurrPrevAddrCrimeDiff                    := ri.Result.Attributes[171].value;
		SELF.PrevCurrEconTrajectory                   := ri.Result.Attributes[172].value;
		SELF.EducationAttendedCollege                 := ri.Result.Attributes[173].value;
		SELF.EducationProgram2Yr                      := ri.Result.Attributes[174].value;
		SELF.EducationProgram4Yr                      := ri.Result.Attributes[175].value;
		SELF.EducationProgramGraduate                 := ri.Result.Attributes[176].value;
		SELF.EducationInstitutionPrivate              := ri.Result.Attributes[177].value;
		SELF.EducationInstitutionRating               := ri.Result.Attributes[178].value;
		SELF.EducationFieldofStudyType                := ri.Result.Attributes[179].value;
		SELF.AddrStability                            := ri.Result.Attributes[180].value;
		SELF.StatusMostRecent                         := ri.Result.Attributes[181].value;
		SELF.StatusPrevious                           := ri.Result.Attributes[182].value;
		SELF.StatusNextPrevious                       := ri.Result.Attributes[183].value;
		SELF.AddrChangeCount01                        := ri.Result.Attributes[184].value;
		SELF.AddrChangeCount03                        := ri.Result.Attributes[185].value;
		SELF.AddrChangeCount06                        := ri.Result.Attributes[186].value;
		SELF.AddrChangeCount12                        := ri.Result.Attributes[187].value;
		SELF.AddrChangeCount24                        := ri.Result.Attributes[188].value;
		SELF.AddrChangeCount36                        := ri.Result.Attributes[189].value;
		SELF.AddrChangeCount60                        := ri.Result.Attributes[190].value;
		SELF.PredictedAnnualIncome                    := ri.Result.Attributes[191].value;
		SELF.PropOwnedCount                           := ri.Result.Attributes[192].value;
		SELF.PropOwnedTaxTotal                        := ri.Result.Attributes[193].value;
		SELF.PropOwnedHistoricalCount                 := ri.Result.Attributes[194].value;
		SELF.PropAgeOldestPurchase                    := ri.Result.Attributes[195].value;
		SELF.PropAgeNewestPurchase                    := ri.Result.Attributes[196].value;
		SELF.PropAgeNewestSale                        := ri.Result.Attributes[197].value;
		SELF.PropNewestSalePurchaseIndex              := ri.Result.Attributes[198].value;
		SELF.PropPurchasedCount01                     := ri.Result.Attributes[199].value;
		SELF.PropPurchasedCount03                     := ri.Result.Attributes[200].value;
		SELF.PropPurchasedCount06                     := ri.Result.Attributes[201].value;
		SELF.PropPurchasedCount12                     := ri.Result.Attributes[202].value;
		SELF.PropPurchasedCount24                     := ri.Result.Attributes[203].value;
		SELF.PropPurchasedCount36                     := ri.Result.Attributes[204].value;
		SELF.PropPurchasedCount60                     := ri.Result.Attributes[205].value;
		SELF.PropSoldCount01                          := ri.Result.Attributes[206].value;
		SELF.PropSoldCount03                          := ri.Result.Attributes[207].value;
		SELF.PropSoldCount06                          := ri.Result.Attributes[208].value;
		SELF.PropSoldCount12                          := ri.Result.Attributes[209].value;
		SELF.PropSoldCount24                          := ri.Result.Attributes[210].value;
		SELF.PropSoldCount36                          := ri.Result.Attributes[211].value;
		SELF.PropSoldCount60                          := ri.Result.Attributes[212].value;
		SELF.WatercraftCount                          := ri.Result.Attributes[213].value;
		SELF.WatercraftCount01                        := ri.Result.Attributes[214].value;
		SELF.WatercraftCount03                        := ri.Result.Attributes[215].value;
		SELF.WatercraftCount06                        := ri.Result.Attributes[216].value;
		SELF.WatercraftCount12                        := ri.Result.Attributes[217].value;
		SELF.WatercraftCount24                        := ri.Result.Attributes[218].value;
		SELF.WatercraftCount36                        := ri.Result.Attributes[219].value;
		SELF.WatercraftCount60                        := ri.Result.Attributes[220].value;
		SELF.AircraftCount                            := ri.Result.Attributes[221].value;
		SELF.AircraftCount01                          := ri.Result.Attributes[222].value;
		SELF.AircraftCount03                          := ri.Result.Attributes[223].value;
		SELF.AircraftCount06                          := ri.Result.Attributes[224].value;
		SELF.AircraftCount12                          := ri.Result.Attributes[225].value;
		SELF.AircraftCount24                          := ri.Result.Attributes[226].value;
		SELF.AircraftCount36                          := ri.Result.Attributes[227].value;
		SELF.AircraftCount60                          := ri.Result.Attributes[228].value;
		SELF.WealthIndex                              := ri.Result.Attributes[229].value;
		SELF.SubPrimeSolicitedCount                   := ri.Result.Attributes[230].value;
		SELF.SubPrimeSolicitedCount01                 := ri.Result.Attributes[231].value;
		SELF.SubPrimeSolicitedCount03                 := ri.Result.Attributes[232].value;
		SELF.SubPrimeSolicitedCount06                 := ri.Result.Attributes[233].value;
		SELF.SubPrimeSolicitedCount12                 := ri.Result.Attributes[234].value;
		SELF.SubPrimeSolicitedCount24                 := ri.Result.Attributes[235].value;
		SELF.SubPrimeSolicitedCount36                 := ri.Result.Attributes[236].value;
		SELF.SubPrimeSolicitedCount60                 := ri.Result.Attributes[237].value;
		SELF.DerogSeverityIndex                       := ri.Result.Attributes[238].value;
		SELF.DerogCount                               := ri.Result.Attributes[239].value;
		SELF.DerogAge                                 := ri.Result.Attributes[240].value;
		SELF.FelonyCount                              := ri.Result.Attributes[241].value;
		SELF.FelonyAge                                := ri.Result.Attributes[242].value;
		SELF.FelonyCount01                            := ri.Result.Attributes[243].value;
		SELF.FelonyCount03                            := ri.Result.Attributes[244].value;
		SELF.FelonyCount06                            := ri.Result.Attributes[245].value;
		SELF.FelonyCount12                            := ri.Result.Attributes[246].value;
		SELF.FelonyCount24                            := ri.Result.Attributes[247].value;
		SELF.FelonyCount36                            := ri.Result.Attributes[248].value;
		SELF.FelonyCount60                            := ri.Result.Attributes[249].value;
		SELF.ArrestCount                              := ri.Result.Attributes[250].value;
		SELF.ArrestAge                                := ri.Result.Attributes[251].value;
		SELF.ArrestCount01                            := ri.Result.Attributes[252].value;
		SELF.ArrestCount03                            := ri.Result.Attributes[253].value;
		SELF.ArrestCount06                            := ri.Result.Attributes[254].value;
		SELF.ArrestCount12                            := ri.Result.Attributes[255].value;
		SELF.ArrestCount24                            := ri.Result.Attributes[256].value;
		SELF.ArrestCount36                            := ri.Result.Attributes[257].value;
		SELF.ArrestCount60                            := ri.Result.Attributes[258].value;
		SELF.LienCount                                := ri.Result.Attributes[259].value;
		SELF.LienFiledCount                           := ri.Result.Attributes[260].value;
		SELF.LienFiledAge                             := ri.Result.Attributes[261].value;
		SELF.LienFiledCount01                         := ri.Result.Attributes[262].value;
		SELF.LienFiledCount03                         := ri.Result.Attributes[263].value;
		SELF.LienFiledCount06                         := ri.Result.Attributes[264].value;
		SELF.LienFiledCount12                         := ri.Result.Attributes[265].value;
		SELF.LienFiledCount24                         := ri.Result.Attributes[266].value;
		SELF.LienFiledCount36                         := ri.Result.Attributes[267].value;
		SELF.LienFiledCount60                         := ri.Result.Attributes[268].value;
		SELF.LienReleasedCount                        := ri.Result.Attributes[269].value;
		SELF.LienReleasedAge                          := ri.Result.Attributes[270].value;
		SELF.LienReleasedCount01                      := ri.Result.Attributes[271].value;
		SELF.LienReleasedCount03                      := ri.Result.Attributes[272].value;
		SELF.LienReleasedCount06                      := ri.Result.Attributes[273].value;
		SELF.LienReleasedCount12                      := ri.Result.Attributes[274].value;
		SELF.LienReleasedCount24                      := ri.Result.Attributes[275].value;
		SELF.LienReleasedCount36                      := ri.Result.Attributes[276].value;
		SELF.LienReleasedCount60                      := ri.Result.Attributes[277].value;
		SELF.BankruptcyCount                          := ri.Result.Attributes[278].value;
		SELF.BankruptcyAge                            := ri.Result.Attributes[279].value;
		SELF.BankruptcyType                           := ri.Result.Attributes[280].value;
		SELF.BankruptcyStatus                         := ri.Result.Attributes[281].value;
		SELF.BankruptcyCount01                        := ri.Result.Attributes[282].value;
		SELF.BankruptcyCount03                        := ri.Result.Attributes[283].value;
		SELF.BankruptcyCount06                        := ri.Result.Attributes[284].value;
		SELF.BankruptcyCount12                        := ri.Result.Attributes[285].value;
		SELF.BankruptcyCount24                        := ri.Result.Attributes[286].value;
		SELF.BankruptcyCount36                        := ri.Result.Attributes[287].value;
		SELF.BankruptcyCount60                        := ri.Result.Attributes[288].value;
		SELF.EvictionCount                            := ri.Result.Attributes[289].value;
		SELF.EvictionAge                              := ri.Result.Attributes[290].value;
		SELF.EvictionCount01                          := ri.Result.Attributes[291].value;
		SELF.EvictionCount03                          := ri.Result.Attributes[292].value;
		SELF.EvictionCount06                          := ri.Result.Attributes[293].value;
		SELF.EvictionCount12                          := ri.Result.Attributes[294].value;
		SELF.EvictionCount24                          := ri.Result.Attributes[295].value;
		SELF.EvictionCount36                          := ri.Result.Attributes[296].value;
		SELF.EvictionCount60                          := ri.Result.Attributes[297].value;
		SELF.NonDerogCount                            := ri.Result.Attributes[298].value;
		SELF.NonDerogCount01                          := ri.Result.Attributes[299].value;
		SELF.NonDerogCount03                          := ri.Result.Attributes[300].value;
		SELF.NonDerogCount06                          := ri.Result.Attributes[301].value;
		SELF.NonDerogCount12                          := ri.Result.Attributes[302].value;
		SELF.NonDerogCount24                          := ri.Result.Attributes[303].value;
		SELF.NonDerogCount36                          := ri.Result.Attributes[304].value;
		SELF.NonDerogCount60                          := ri.Result.Attributes[305].value;
		SELF.ProfLicCount                             := ri.Result.Attributes[306].value;
		SELF.ProfLicAge                               := ri.Result.Attributes[307].value;
		SELF.ProfLicTypeCategory                      := ri.Result.Attributes[308].value;
		SELF.ProfLicExpireDate                        := ri.Result.Attributes[309].value;
		SELF.ProfLicCount01                           := ri.Result.Attributes[310].value;
		SELF.ProfLicCount03                           := ri.Result.Attributes[311].value;
		SELF.ProfLicCount06                           := ri.Result.Attributes[312].value;
		SELF.ProfLicCount12                           := ri.Result.Attributes[313].value;
		SELF.ProfLicCount24                           := ri.Result.Attributes[314].value;
		SELF.ProfLicCount36                           := ri.Result.Attributes[315].value;
		SELF.ProfLicCount60                           := ri.Result.Attributes[316].value;
		SELF.ProfLicExpireCount01                     := ri.Result.Attributes[317].value;
		SELF.ProfLicExpireCount03                     := ri.Result.Attributes[318].value;
		SELF.ProfLicExpireCount06                     := ri.Result.Attributes[319].value;
		SELF.ProfLicExpireCount12                     := ri.Result.Attributes[320].value;
		SELF.ProfLicExpireCount24                     := ri.Result.Attributes[321].value;
		SELF.ProfLicExpireCount36                     := ri.Result.Attributes[322].value;
		SELF.ProfLicExpireCount60                     := ri.Result.Attributes[323].value;
		SELF.PRSearchCollectionCount                  := ri.Result.Attributes[324].value;
		SELF.PRSearchCollectionCount01                := ri.Result.Attributes[325].value;
		SELF.PRSearchCollectionCount03                := ri.Result.Attributes[326].value;
		SELF.PRSearchCollectionCount06                := ri.Result.Attributes[327].value;
		SELF.PRSearchCollectionCount12                := ri.Result.Attributes[328].value;
		SELF.PRSearchCollectionCount24                := ri.Result.Attributes[329].value;
		SELF.PRSearchCollectionCount36                := ri.Result.Attributes[330].value;
		SELF.PRSearchCollectionCount60                := ri.Result.Attributes[331].value;
		SELF.PRSearchIDVFraudCount                    := ri.Result.Attributes[332].value;
		SELF.PRSearchIDVFraudCount01                  := ri.Result.Attributes[333].value;
		SELF.PRSearchIDVFraudCount03                  := ri.Result.Attributes[334].value;
		SELF.PRSearchIDVFraudCount06                  := ri.Result.Attributes[335].value;
		SELF.PRSearchIDVFraudCount12                  := ri.Result.Attributes[336].value;
		SELF.PRSearchIDVFraudCount24                  := ri.Result.Attributes[337].value;
		SELF.PRSearchIDVFraudCount36                  := ri.Result.Attributes[338].value;
		SELF.PRSearchIDVFraudCount60                  := ri.Result.Attributes[339].value;
		SELF.PRSearchOtherCount                       := ri.Result.Attributes[340].value;
		SELF.PRSearchOtherCount01                     := ri.Result.Attributes[341].value;
		SELF.PRSearchOtherCount03                     := ri.Result.Attributes[342].value;
		SELF.PRSearchOtherCount06                     := ri.Result.Attributes[343].value;
		SELF.PRSearchOtherCount12                     := ri.Result.Attributes[344].value;
		SELF.PRSearchOtherCount24                     := ri.Result.Attributes[345].value;
		SELF.PRSearchOtherCount36                     := ri.Result.Attributes[346].value;
		SELF.PRSearchOtherCount60                     := ri.Result.Attributes[347].value;
		SELF.InputPhoneStatus                         := ri.Result.Attributes[348].value;
		SELF.InputPhonePager                          := ri.Result.Attributes[349].value;
		SELF.InputPhoneMobile                         := ri.Result.Attributes[350].value;
		SELF.InputPhoneType                           := ri.Result.Attributes[351].value;
		SELF.InputPhoneServiceType                    := ri.Result.Attributes[352].value;
		SELF.InputAreaCodeChange                      := ri.Result.Attributes[353].value;
		SELF.PhoneEDAAgeOldestRecord                  := ri.Result.Attributes[354].value;
		SELF.PhoneEDAAgeNewestRecord                  := ri.Result.Attributes[355].value;
		SELF.PhoneOtherAgeOldestRecord                := ri.Result.Attributes[356].value;
		SELF.PhoneOtherAgeNewestRecord                := ri.Result.Attributes[357].value;
		SELF.InvalidPhoneZip                          := ri.Result.Attributes[358].value;
		SELF.InputPhoneAddrDist                       := ri.Result.Attributes[359].value;
		SELF.InputAddrSICCode                         := ri.Result.Attributes[360].value;
		SELF.InputAddrValidation                      := ri.Result.Attributes[361].value;
		SELF.InputAddrErrorCode                       := ri.Result.Attributes[362].value;
		SELF.InputAddrHighRisk                        := ri.Result.Attributes[363].value;
		SELF.InputPhoneHighRisk                       := ri.Result.Attributes[364].value;
		SELF.InputAddrPrison                          := ri.Result.Attributes[365].value;
		SELF.CurrAddrPrison                           := ri.Result.Attributes[366].value;
		SELF.PrevAddrPrison                           := ri.Result.Attributes[367].value;
		SELF.HistoricalAddrPrison                     := ri.Result.Attributes[368].value;
		SELF.InputZipPOBox                            := ri.Result.Attributes[369].value;
		SELF.InputZipCorpMil                          := ri.Result.Attributes[370].value;
		SELF.DoNotMail                                := ri.Result.Attributes[371].value;
		#if(include_internal_extras)
			self.DID := ri.did; 
			self.historydate := (string)le.HistoryDateYYYYMM;
			self.FNamePop := le.leadintegrityrequest[1].searchby.name.first <> '';
			self.LNamePop := le.leadintegrityrequest[1].searchby.name.last <> '';
			self.AddrPop := le.leadintegrityrequest[1].searchby.address.streetaddress1 <> '';
			self.SSNLength := (string)(length(trim(le.leadintegrityrequest[1].searchby.ssn))) ;
			self.DOBPop := le.leadintegrityrequest[1].searchby.dob.year <> 0;
			self.EmailPop := false; // not used in lead integrity
			self.IPAddrPop := false; // not used in lead integrity
			self.HPhnPop := le.leadintegrityrequest[1].searchby.homephone <> '';
		#end;
		SELF                                          := ri;
		SELF                                          := [];
	END;


	final := JOIN(LeadIntegrity_input, LeadIntegrity_attributes, LEFT.LeadIntegrityRequest[1].SearchBy.Seq=RIGHT.Result.InputEcho.Seq, slim_v3(left,right) );

#else
	// v1
	final_layout := RECORD
		models.layouts.layout_LeadIntegrity_attributes_batch_v1;
		#if(include_internal_extras)
			RiskProcessing.layout_internal_extras;
		#end
		STRING errorcode;
	END;
	
	final_layout slim_v1( LeadIntegrity_input le, LeadIntegrity_attributes ri ) := TRANSFORM
		SELF.AcctNo                                    := le.old_Account_Number;
		// SELF.AcctNo                                    := le.LeadIntegrityRequest[1].User.AccountNumber;
		SELF.seq                                       := le.LeadIntegrityRequest[1].SearchBy.Seq;

		SELF.SubjectFirstSeen                          := ri.Result.Attributes[1].value;
		SELF.DateLastUpdate                            := ri.Result.Attributes[2].value;
		SELF.RecentUpdate                              := ri.Result.Attributes[3].value;
		SELF.NumSrcsConfirmIDAddr                      := ri.Result.Attributes[4].value;
		SELF.PhoneFullNameMatch                        := ri.Result.Attributes[5].value;
		SELF.PhoneLastNameMatch                        := ri.Result.Attributes[6].value;
		SELF.AgeRiskIndicator                          := ri.Result.Attributes[7].value;
		SELF.InvalidSSN                                := ri.Result.Attributes[8].value;
		SELF.InvalidPhone                              := ri.Result.Attributes[9].value;
		SELF.InvalidAddr                               := ri.Result.Attributes[10].value;
		SELF.NoVerifyNameAddrPhoneSSN                  := ri.Result.Attributes[11].value;
		SELF.SSNDeceased                               := ri.Result.Attributes[12].value;
		SELF.DateSSNDeceased                           := ri.Result.Attributes[13].value;
		SELF.SSNIssued                                 := ri.Result.Attributes[14].value;
		SELF.RecentSSN                                 := ri.Result.Attributes[15].value;
		SELF.LowIssueDate                              := ri.Result.Attributes[16].value;
		SELF.HighIssueDate                             := ri.Result.Attributes[17].value;
		SELF.SSNIssueState                             := ri.Result.Attributes[18].value;
		SELF.NonUSssn                                  := ri.Result.Attributes[19].value;
		SELF.SSN3Years                                 := ri.Result.Attributes[20].value;
		SELF.SSNAfter5                                 := ri.Result.Attributes[21].value;
		SELF.SSNProbs                                  := ri.Result.Attributes[22].value;
		SELF.SSNNotFound                               := ri.Result.Attributes[23].value;
		SELF.SSNFoundOther                             := ri.Result.Attributes[24].value;
		SELF.SSNIssuedPrior                            := ri.Result.Attributes[25].value;
		SELF.PhoneOther                                := ri.Result.Attributes[26].value;
		SELF.SSNPerID                                  := ri.Result.Attributes[27].value;
		SELF.AddrPerID                                 := ri.Result.Attributes[28].value;
		SELF.PhonePerID                                := ri.Result.Attributes[29].value;;
		SELF.IDPerSSN                                  := ri.Result.Attributes[30].value;
		SELF.AddrPerSSN                                := ri.Result.Attributes[31].value;
		SELF.IDPerAddr                                 := ri.Result.Attributes[32].value;
		SELF.SSNPerAddr                                := ri.Result.Attributes[33].value;
		SELF.PhonePerAddr                              := ri.Result.Attributes[34].value;
		SELF.IDPerPhone                                := ri.Result.Attributes[35].value;
		SELF.SSNPerID6                                 := ri.Result.Attributes[36].value;
		SELF.AddrPerID6                                := ri.Result.Attributes[37].value;
		SELF.PhonePerID6                               := ri.Result.Attributes[38].value;
		SELF.IDPerSSN6                                 := ri.Result.Attributes[39].value;
		SELF.AddrPerSSN6                               := ri.Result.Attributes[40].value;
		SELF.IDPerAddr6                                := ri.Result.Attributes[41].value;
		SELF.SSNPerAddr6                               := ri.Result.Attributes[42].value;
		SELF.PhonePerAddr6                             := ri.Result.Attributes[43].value;
		SELF.IDPerPhone6                               := ri.Result.Attributes[44].value;
		SELF.LastNamePerSSN                            := ri.Result.Attributes[45].value;
		SELF.LastNamePerID                             := ri.Result.Attributes[46].value;
		SELF.TimeSinceLastName                         := ri.Result.Attributes[47].value;
		SELF.LastNames30                               := ri.Result.Attributes[48].value;
		SELF.LastNames90                               := ri.Result.Attributes[49].value;
		SELF.LastNames180                              := ri.Result.Attributes[50].value;
		SELF.LastNames12                               := ri.Result.Attributes[51].value;
		SELF.LastNames24                               := ri.Result.Attributes[52].value;
		SELF.LastNames36                               := ri.Result.Attributes[53].value;
		SELF.LastNames60                               := ri.Result.Attributes[54].value;
		SELF.IDPerSFDUAddr                             := ri.Result.Attributes[55].value;
		SELF.SSNPerSFDUAddr                            := ri.Result.Attributes[56].value;
		SELF.TimeSinceInputAddrFirstSeen               := ri.Result.Attributes[57].value;
		SELF.TimeSinceInputAddrLastSeen                := ri.Result.Attributes[58].value;
		SELF.InputAddrLenOfRes                         := ri.Result.Attributes[59].value;
		SELF.InputAddrDwellType                        := ri.Result.Attributes[60].value;
		SELF.InputAddrLandUseCode                      := ri.Result.Attributes[61].value;
		SELF.InputAddrAssessedValue                    := ri.Result.Attributes[62].value;
		SELF.InputAddrTaxAssessedYr                    := ri.Result.Attributes[63].value;
		SELF.InputAddrApplicantOwned                   := ri.Result.Attributes[64].value;
		SELF.InputAddrFamilyOwned                      := ri.Result.Attributes[65].value;
		SELF.InputAddrOccupantOwned                    := ri.Result.Attributes[66].value;
		SELF.InputAddrLastSalesDate                    := ri.Result.Attributes[67].value;
		SELF.InputAddrLastSalesAmount                  := ri.Result.Attributes[68].value;
		SELF.InputAddrNotPrimaryRes                    := ri.Result.Attributes[69].value;
		SELF.InputAddrActivePhoneList                  := ri.Result.Attributes[70].value;
		SELF.InputAddrActivePhoneNumber                := ri.Result.Attributes[71].value;
		SELF.InputAddrMedianIncome                     := ri.Result.Attributes[72].value;
		SELF.InputAddrMedianHomeVal                    := ri.Result.Attributes[73].value;
		SELF.InputAddrMurderIndex                      := ri.Result.Attributes[74].value;
		SELF.InputAddrCarTheftIndex                    := ri.Result.Attributes[75].value;
		SELF.InputAddrBurglaryIndex                    := ri.Result.Attributes[76].value;
		SELF.InputAddrCrimeIndex                       := ri.Result.Attributes[77].value;
		SELF.InputAddrAssessMarket                     := ri.Result.Attributes[78].value;
		SELF.InputAddrTaxAssessVal                     := ri.Result.Attributes[79].value;
		SELF.InputAddrPriceIndVal                      := ri.Result.Attributes[80].value;
		SELF.InputAddrHedVal                           := ri.Result.Attributes[81].value;
		SELF.InputAddrAutoVal                          := ri.Result.Attributes[82].value;
		SELF.InputAddrConfScore                        := ri.Result.Attributes[83].value;
		SELF.InputAddrCountyIndex                      := ri.Result.Attributes[84].value;
		SELF.InputAddrTractIndex                       := ri.Result.Attributes[85].value;
		SELF.InputAddrBlockIndex                       := ri.Result.Attributes[86].value;
		SELF.TimeSinceCurrAddrFirstSeen                := ri.Result.Attributes[87].value;
		SELF.TimeSinceCurrAddrLastSeen                 := ri.Result.Attributes[88].value;
		SELF.CurrAddrLenOfRes                          := ri.Result.Attributes[89].value;
		SELF.CurrAddrDwellType                         := ri.Result.Attributes[90].value;
		SELF.CurrAddrLandUseCode                       := ri.Result.Attributes[91].value;
		SELF.CurrAddrAssessedValue                     := ri.Result.Attributes[92].value;
		SELF.CurrAddrTaxAssessedYr                     := ri.Result.Attributes[93].value;
		SELF.CurrAddrApplicantOwned                    := ri.Result.Attributes[94].value;
		SELF.CurrAddrFamilyOwned                       := ri.Result.Attributes[95].value;
		SELF.CurrAddrOccupantOwned                     := ri.Result.Attributes[96].value;
		SELF.CurrAddrLastSalesDate                     := ri.Result.Attributes[97].value;
		SELF.CurrAddrLastSalesAmount                   := ri.Result.Attributes[98].value;
		SELF.CurrAddrNotPrimaryRes                     := ri.Result.Attributes[99].value;
		SELF.CurrAddrActivePhoneList                   := ri.Result.Attributes[100].value;
		SELF.CurrAddrActivePhoneNumber                 := ri.Result.Attributes[101].value;
		SELF.CurrAddrMedianIncome                      := ri.Result.Attributes[102].value;
		SELF.CurrAddrMedianHomeVal                     := ri.Result.Attributes[103].value;
		SELF.CurrAddrMurderIndex                       := ri.Result.Attributes[104].value;
		SELF.CurrAddrCarTheftIndex                     := ri.Result.Attributes[105].value;
		SELF.CurrAddrBurglaryIndex                     := ri.Result.Attributes[106].value;
		SELF.CurrAddrCrimeIndex                        := ri.Result.Attributes[107].value;
		SELF.CurrAddrAssessMarket                      := ri.Result.Attributes[108].value;
		SELF.CurrAddrTaxAssessVal                      := ri.Result.Attributes[109].value;
		SELF.CurrAddrPriceIndVal                       := ri.Result.Attributes[110].value;
		SELF.CurrAddrHedVal                            := ri.Result.Attributes[111].value;
		SELF.CurrAddrAutoVal                           := ri.Result.Attributes[112].value;
		SELF.CurrAddrConfScore                         := ri.Result.Attributes[113].value;
		SELF.CurrAddrCountyIndex                       := ri.Result.Attributes[114].value;
		SELF.CurrAddrTractIndex                        := ri.Result.Attributes[115].value;
		SELF.CurrAddrBlockIndex                        := ri.Result.Attributes[116].value;
		SELF.TimeSincePrevAddrFirstSeen                := ri.Result.Attributes[117].value;
		SELF.TimeSincePrevAddrLastSeen                 := ri.Result.Attributes[118].value;
		SELF.PrevAddrLenOfRes                          := ri.Result.Attributes[119].value;
		SELF.PrevAddrDwellType                         := ri.Result.Attributes[120].value;
		SELF.PrevAddrLandUseCode                       := ri.Result.Attributes[121].value;
		SELF.PrevAddrAssessedValue                     := ri.Result.Attributes[122].value;
		SELF.PrevAddrTaxAssessedYr                     := ri.Result.Attributes[123].value;
		SELF.PrevAddrApplicantOwned                    := ri.Result.Attributes[124].value;
		SELF.PrevAddrFamilyOwned                       := ri.Result.Attributes[125].value;
		SELF.PrevAddrOccupantOwned                     := ri.Result.Attributes[126].value;
		SELF.PrevAddrLastSalesDate                     := ri.Result.Attributes[127].value;
		SELF.PrevAddrLastSalesAmount                   := ri.Result.Attributes[128].value;
		SELF.PrevAddrNotPrimaryRes                     := ri.Result.Attributes[129].value;
		SELF.PrevAddrActivePhoneList                   := ri.Result.Attributes[130].value;
		SELF.PrevAddrActivePhoneNumber                 := ri.Result.Attributes[131].value;
		SELF.PrevAddrMedianIncome                      := ri.Result.Attributes[132].value;
		SELF.PrevAddrMedianHomeVal                     := ri.Result.Attributes[133].value;
		SELF.PrevAddrMurderIndex                       := ri.Result.Attributes[134].value;
		SELF.PrevAddrCarTheftIndex                     := ri.Result.Attributes[135].value;
		SELF.PrevAddrBurglaryIndex                     := ri.Result.Attributes[136].value;
		SELF.PrevAddrCrimeIndex                        := ri.Result.Attributes[137].value;
		SELF.PrevAddrAssessMarket                      := ri.Result.Attributes[138].value;
		SELF.PrevAddrTaxAssessVal                      := ri.Result.Attributes[139].value;
		SELF.PrevAddrPriceIndVal                       := ri.Result.Attributes[140].value;
		SELF.PrevAddrHedVal                            := ri.Result.Attributes[141].value;
		SELF.PrevAddrAutoVal                           := ri.Result.Attributes[142].value;
		SELF.PrevAddrConfScore                         := ri.Result.Attributes[143].value;
		SELF.PrevAddrCountyIndex                       := ri.Result.Attributes[144].value;
		SELF.PrevAddrTractIndex                        := ri.Result.Attributes[145].value;
		SELF.PrevAddrBlockIndex                        := ri.Result.Attributes[146].value;
		SELF.InputAddrCurrAddrMatch                    := ri.Result.Attributes[147].value;
		SELF.InputAddrCurrAddrDistance                 := ri.Result.Attributes[148].value;
		SELF.InputAddrCurrAddrStateDiff                := ri.Result.Attributes[149].value;
		SELF.InputAddrCurrAddrAssessedDiff             := ri.Result.Attributes[150].value;
		SELF.InputAddrCurrAddrIncomeDiff               := ri.Result.Attributes[151].value;
		SELF.InputAddrCurrAddrHomeValDiff              := ri.Result.Attributes[152].value;
		SELF.InputAddrCurrAddrCrimeDiff                := ri.Result.Attributes[153].value;
		SELF.EconomicTrajectory                        := ri.Result.Attributes[154].value;
		SELF.InputAddrPrevAddrMatch                    := ri.Result.Attributes[155].value;
		SELF.CurrAddrPrevAddrDistance                  := ri.Result.Attributes[156].value;
		SELF.CurrAddrPrevAddrStateDiff                 := ri.Result.Attributes[157].value;
		SELF.CurrAddrPrevAddrAssessedDiff              := ri.Result.Attributes[158].value;
		SELF.CurrAddrPrevAddrIncomeDiff                := ri.Result.Attributes[159].value;
		SELF.CurrAddrPrevAddrHomeValDiff               := ri.Result.Attributes[160].value;
		SELF.CurrAddrPrevAddrCrimeDiff                 := ri.Result.Attributes[161].value;
		SELF.EconomicTrajectory2                       := ri.Result.Attributes[162].value;
		SELF.AddrStability                             := ri.Result.Attributes[163].value;
		SELF.StatusMostRecent                          := ri.Result.Attributes[164].value;
		SELF.StatusPrevious                            := ri.Result.Attributes[165].value;
		SELF.StatusNextPrevious                        := ri.Result.Attributes[166].value;
		SELF.TimeSincePrevAddrDateFirstSeen            := ri.Result.Attributes[167].value;
		SELF.TimeSinceNextPrevDateFirstSeen            := ri.Result.Attributes[168].value;
		SELF.AddrChanges30                             := ri.Result.Attributes[169].value;
		SELF.AddrChanges90                             := ri.Result.Attributes[170].value;
		SELF.AddrChanges180                            := ri.Result.Attributes[171].value;
		SELF.AddrChanges12                             := ri.Result.Attributes[172].value;
		SELF.AddrChanges24                             := ri.Result.Attributes[173].value;
		SELF.AddrChanges36                             := ri.Result.Attributes[174].value;
		SELF.AddrChanges60                             := ri.Result.Attributes[175].value;
		SELF.PropertyOwnedTotal                        := ri.Result.Attributes[176].value;
		SELF.PropertyOwnedAssessedTotal                := ri.Result.Attributes[177].value;
		SELF.PropertyHistoricallyOwned                 := ri.Result.Attributes[178].value;
		SELF.DateFirstPurchase                         := ri.Result.Attributes[179].value;
		SELF.DateMostRecentPurchase                    := ri.Result.Attributes[180].value;
		SELF.DateMostRecentSale                        := ri.Result.Attributes[181].value;
		SELF.PropPurchased30                           := ri.Result.Attributes[182].value;
		SELF.PropPurchased90                           := ri.Result.Attributes[183].value;
		SELF.PropPurchased180                          := ri.Result.Attributes[184].value;
		SELF.PropPurchased12                           := ri.Result.Attributes[185].value;
		SELF.PropPurchased24                           := ri.Result.Attributes[186].value;
		SELF.PropPurchased36                           := ri.Result.Attributes[187].value;
		SELF.PropPurchased60                           := ri.Result.Attributes[188].value;
		SELF.PropSold30                                := ri.Result.Attributes[189].value;
		SELF.PropSold90                                := ri.Result.Attributes[190].value;
		SELF.PropSold180                               := ri.Result.Attributes[191].value;
		SELF.PropSold12                                := ri.Result.Attributes[192].value;
		SELF.PropSold24                                := ri.Result.Attributes[193].value;
		SELF.PropSold36                                := ri.Result.Attributes[194].value;
		SELF.PropSold60                                := ri.Result.Attributes[195].value;
		SELF.NumWatercraft                             := ri.Result.Attributes[196].value;
		SELF.NumWatercraft30                           := ri.Result.Attributes[197].value;
		SELF.NumWatercraft90                           := ri.Result.Attributes[198].value;
		SELF.NumWatercraft180                          := ri.Result.Attributes[199].value;
		SELF.NumWatercraft12                           := ri.Result.Attributes[200].value;
		SELF.NumWatercraft24                           := ri.Result.Attributes[201].value;
		SELF.NumWatercraft36                           := ri.Result.Attributes[202].value;
		SELF.NumWatercraft60                           := ri.Result.Attributes[203].value;
		SELF.NumAircraft                               := ri.Result.Attributes[204].value;
		SELF.NumAircraft30                             := ri.Result.Attributes[205].value;
		SELF.NumAircraft90                             := ri.Result.Attributes[206].value;
		SELF.NumAircraft180                            := ri.Result.Attributes[207].value;
		SELF.NumAircraft12                             := ri.Result.Attributes[208].value;
		SELF.NumAircraft24                             := ri.Result.Attributes[209].value;
		SELF.NumAircraft36                             := ri.Result.Attributes[210].value;
		SELF.NumAircraft60                             := ri.Result.Attributes[211].value;
		SELF.WealthIndex                               := ri.Result.Attributes[212].value;
		SELF.TotalNumberDerogs                         := ri.Result.Attributes[213].value;
		SELF.DateLastDerog                             := ri.Result.Attributes[214].value;
		SELF.NumFelonies                               := ri.Result.Attributes[215].value;
		SELF.DateLastConviction                        := ri.Result.Attributes[216].value;
		SELF.NumFelonies30                             := ri.Result.Attributes[217].value;
		SELF.NumFelonies90                             := ri.Result.Attributes[218].value;
		SELF.NumFelonies180                            := ri.Result.Attributes[219].value;
		SELF.NumFelonies12                             := ri.Result.Attributes[220].value;
		SELF.NumFelonies24                             := ri.Result.Attributes[221].value;
		SELF.NumFelonies36                             := ri.Result.Attributes[222].value;
		SELF.NumFelonies60                             := ri.Result.Attributes[223].value;
		SELF.NumArrests                                := ri.Result.Attributes[224].value;
		SELF.DateLastArrest                            := ri.Result.Attributes[225].value;
		SELF.NumArrests30                              := ri.Result.Attributes[226].value;
		SELF.NumArrests90                              := ri.Result.Attributes[227].value;
		SELF.NumArrests180                             := ri.Result.Attributes[228].value;
		SELF.NumArrests12                              := ri.Result.Attributes[229].value;
		SELF.NumArrests24                              := ri.Result.Attributes[230].value;
		SELF.NumArrests36                              := ri.Result.Attributes[231].value;
		SELF.NumArrests60                              := ri.Result.Attributes[232].value;
		SELF.LiensCount                                := ri.Result.Attributes[233].value;
		SELF.LiensUnreleasedCount                      := ri.Result.Attributes[234].value;
		SELF.MostRecentUnrelDate                       := ri.Result.Attributes[235].value;
		SELF.LiensUnreleasedCount30                    := ri.Result.Attributes[236].value;
		SELF.LiensUnreleasedCount90                    := ri.Result.Attributes[237].value;
		SELF.LiensUnreleasedCount180                   := ri.Result.Attributes[238].value;
		SELF.LiensUnreleasedCount12                    := ri.Result.Attributes[239].value;
		SELF.LiensUnreleasedCount24                    := ri.Result.Attributes[240].value;
		SELF.LiensUnreleasedCount36                    := ri.Result.Attributes[241].value;
		SELF.LiensUnreleasedCount60                    := ri.Result.Attributes[242].value;
		SELF.LiensReleasedCount                        := ri.Result.Attributes[243].value;
		SELF.MostRecentReleasedDate                    := ri.Result.Attributes[244].value;
		SELF.LiensReleasedCount30                      := ri.Result.Attributes[245].value;
		SELF.LiensReleasedCount90                      := ri.Result.Attributes[246].value;
		SELF.LiensReleasedCount180                     := ri.Result.Attributes[247].value;
		SELF.LiensReleasedCount12                      := ri.Result.Attributes[248].value;
		SELF.LiensReleasedCount24                      := ri.Result.Attributes[249].value;
		SELF.LiensReleasedCount36                      := ri.Result.Attributes[250].value;
		SELF.LiensReleasedCount60                      := ri.Result.Attributes[251].value;
		SELF.BankruptCount                             := ri.Result.Attributes[252].value;
		SELF.MostRecentBankruptDate                    := ri.Result.Attributes[253].value;
		SELF.MostRecentBankruptType                    := ri.Result.Attributes[254].value;
		SELF.MostRecentBankruptStatus                  := ri.Result.Attributes[255].value;
		SELF.BankruptCount30                           := ri.Result.Attributes[256].value;
		SELF.BankruptCount90                           := ri.Result.Attributes[257].value;
		SELF.BankruptCount180                          := ri.Result.Attributes[258].value;
		SELF.BankruptCount12                           := ri.Result.Attributes[259].value;
		SELF.BankruptCount24                           := ri.Result.Attributes[260].value;
		SELF.BankruptCount36                           := ri.Result.Attributes[261].value;
		SELF.BankruptCount60                           := ri.Result.Attributes[262].value;
		SELF.EvictionCount                             := ri.Result.Attributes[263].value;
		SELF.MostRecentEvictionDate                    := ri.Result.Attributes[264].value;
		SELF.EvictionCount30                           := ri.Result.Attributes[265].value;
		SELF.EvictionCount90                           := ri.Result.Attributes[266].value;
		SELF.EvictionCount180                          := ri.Result.Attributes[267].value;
		SELF.EvictionCount12                           := ri.Result.Attributes[268].value;
		SELF.EvictionCount24                           := ri.Result.Attributes[269].value;
		SELF.EvictionCount36                           := ri.Result.Attributes[270].value;
		SELF.EvictionCount60                           := ri.Result.Attributes[271].value;
		SELF.NonDerogSrcCount                          := ri.Result.Attributes[272].value;
		SELF.NonDerogSrcCount30                        := ri.Result.Attributes[273].value;
		SELF.NonDerogSrcCount90                        := ri.Result.Attributes[274].value;
		SELF.NonDerogSrcCount180                       := ri.Result.Attributes[275].value;
		SELF.NonDerogSrcCount12                        := ri.Result.Attributes[276].value;
		SELF.NonDerogSrcCount24                        := ri.Result.Attributes[277].value;
		SELF.NonDerogSrcCount36                        := ri.Result.Attributes[278].value;
		SELF.NonDerogSrcCount60                        := ri.Result.Attributes[279].value;
		SELF.ProfLicCount                              := ri.Result.Attributes[280].value;
		SELF.MostRecentProfLicDate                     := ri.Result.Attributes[281].value;
		SELF.MostRecentProfLicExpireDate               := ri.Result.Attributes[282].value;
		SELF.ProfLicCount30                            := ri.Result.Attributes[283].value;
		SELF.ProfLicCount90                            := ri.Result.Attributes[284].value;
		SELF.ProfLicCount180                           := ri.Result.Attributes[285].value;
		SELF.ProfLicCount12                            := ri.Result.Attributes[286].value;
		SELF.ProfLicCount24                            := ri.Result.Attributes[287].value;
		SELF.ProfLicCount36                            := ri.Result.Attributes[288].value;
		SELF.ProfLicCount60                            := ri.Result.Attributes[289].value;
		SELF.ProfLicExpireCount30                      := ri.Result.Attributes[290].value;
		SELF.ProfLicExpireCount90                      := ri.Result.Attributes[291].value;
		SELF.ProfLicExpireCount180                     := ri.Result.Attributes[292].value;
		SELF.ProfLicExpireCount12                      := ri.Result.Attributes[293].value;
		SELF.ProfLicExpireCount24                      := ri.Result.Attributes[294].value;
		SELF.ProfLicExpireCount36                      := ri.Result.Attributes[295].value;
		SELF.ProfLicExpireCount60                      := ri.Result.Attributes[296].value;
		SELF.InputAddrHighRisk                         := ri.Result.Attributes[297].value;
		SELF.InputPhoneHighRisk                        := ri.Result.Attributes[298].value;
		SELF.SIC                                       := ri.Result.Attributes[299].value;
		SELF.InputAddrPrison                           := ri.Result.Attributes[300].value;
		SELF.InputZipPOBox                             := ri.Result.Attributes[301].value;
		SELF.InputZipCorpMil                           := ri.Result.Attributes[302].value;
		SELF.InputPhoneStatus                          := ri.Result.Attributes[303].value;
		SELF.InputPhonePager                           := ri.Result.Attributes[304].value;
		SELF.InputPhoneMobile                          := ri.Result.Attributes[305].value;
		SELF.TimeSinceSubjectPhoneFirstSeen            := ri.Result.Attributes[306].value;
		SELF.TimeSinceSubjectPhoneLastSeen             := ri.Result.Attributes[307].value;
		SELF.InvalidPhoneZip                           := ri.Result.Attributes[308].value;
		SELF.InputPhoneAddrDist                        := ri.Result.Attributes[309].value;
		SELF.PhoneType                                 := ri.Result.Attributes[310].value;
		SELF.ServiceType                               := ri.Result.Attributes[311].value;
		SELF.AreaCodeChange                            := ri.Result.Attributes[312].value;
		SELF.AddrVal                                   := ri.Result.Attributes[313].value;
		SELF.AddrValErrorCode                          := ri.Result.Attributes[314].value;
		SELF.DoNotMail                                 := ri.Result.Attributes[315].value;

		#if(include_internal_extras)
			self.DID := ri.did; 
			self.historydate := (string)le.HistoryDateYYYYMM;
			self.FNamePop := le.leadintegrityrequest[1].searchby.name.first <> '';
			self.LNamePop := le.leadintegrityrequest[1].searchby.name.last <> '';
			self.AddrPop := le.leadintegrityrequest[1].searchby.address.streetaddress1 <> '';
			self.SSNLength := (string)(length(trim(le.leadintegrityrequest[1].searchby.ssn))) ;
			self.DOBPop := le.leadintegrityrequest[1].searchby.dob.year <> 0;
			self.EmailPop := false; // not used in lead integrity
			self.IPAddrPop := false; // not used in lead integrity
			self.HPhnPop := le.leadintegrityrequest[1].searchby.homephone <> '';
		#end;
	
		SELF                                           := ri;
		SELF                                           := [];
	END;


	final := JOIN(LeadIntegrity_input, LeadIntegrity_attributes, LEFT.LeadIntegrityRequest[1].SearchBy.Seq = RIGHT.Result.InputEcho.Seq, slim_v1(left,right) );
#end

OUTPUT(CHOOSEN(final, eyeball), NAMED('Final_Results'));
output(final,, outputFile, CSV(HEADING(single), QUOTE('"')), OVERWRITE);

