EXPORT proc_buildbase(string filedate) := function
#option('multiplePersistInstances',FALSE);

infile_question := Avenger.file_in.question;
infile_transaction := Avenger.file_in.transaction;
infile_quiz := Avenger.file_in.quiz;
infile_assertion := Avenger.file_in.assertion;
infile_factranking := Avenger.file_in.factranking;

verid_question    := avenger.fn_mapping_question(infile_question);
verid_transaction := avenger.fn_mapping_transaction(infile_transaction);
verid_factranking := avenger.fn_mapping_factranking(infile_factranking);

verid_question tjoin_quest_tran(verid_question le, verid_transaction ri)  := transform


self.tran_id := if(le.TRAN_ID <> '', le.TRAN_ID, ri.TRAN_ID);
self.Selected_LexID := if(ri.Selected_LexID <> '', ri.Selected_LexID, le.Selected_LexID);
self.Cust_Account  := le.Cust_Account;
self.Auth_Score	:= 	le.Auth_Score;
self.Auth_RequiredScore	:= 	le.Auth_RequiredScore	;
self.Auth_Outcome	:= 	le.Auth_Outcome	;
self.Auth_Pass	:= 	le.Auth_Pass	;
self.Auth_Fail	:= 	le.Auth_Fail	;
self.Auth_OptOut	:= 	le.Auth_OptOut	;
self.Auth_UnableToGengerate	:= 	le.Auth_UnableToGengerate	;
self.Auth_Error	:= 	le.Auth_Error	;
self.Auth_Quiz_Expired	:= 	le.Auth_Quiz_Expired	;
self.Question_Set_ID	:=	le.Question_Set_ID	;
self.Question_ID	:=	le.Question_ID	;
self.Question_Time_Creation	:=	le.Question_Time_Creation;
self.Question_Time_Start	:=	le.Question_Time_Start	;
self.Question_Time_End	:=	le.Question_Time_End	;
self.Question_Subset_Number	:=	le.Question_Subset_Number	;
self.Question_Type	:=	le.Question_Type	;
self.Question_Set_Type	:=	le.Question_Set_Type	;
self.Question_Tier_Type	:=	le.Question_Tier_Type	;
self.Question_Style_Type	:=	le.Question_Style_Type	;
self.Question_Category	:=	le.Question_Category	;
self.Question_Presentation_Position	:=	le.Question_Presentation_Position	;
self.Question_Presentation_Weight	:=	le.Question_Presentation_Weight	;
self.Question_Contribution_Weight	:=	le.Question_Contribution_Weight	;
self.Question_Data_Source	:=	le.Question_Data_Source    	;
self.Question_Language_Type	:=	le.Question_Language_Type	;
self.Question_Answer_Grade  	:=	le.Question_Answer_Grade	;
self.Question_Answer_Grade_OutcomeType	:=	le.Question_Answer_Grade_OutcomeType	;
self.Question_Answers_NumSelected	:=	le.Question_Answers_NumSelected	;
self.Question_Answers_NumCorrect	:=	le.Question_Answers_NumCorrect	;
self.Question_Answers_NoneOfAboveSelected	:=	le.Question_Answers_NoneOfAboveSelected	;
self.Question_Raw_Question	:=	le.Question_Raw_Question	;
self.Question_Raw_CorrectAnswer	:=	le.Question_Raw_CorrectAnswer	;
self.Question_Raw_UserAnswer	:=	le.Question_Raw_UserAnswer  	;
self.Quiz_Outcome_Grade   := le.Quiz_Outcome_Grade;
self.Quiz_Outcome_Grade_1 := le.Quiz_Outcome_Grade_1;
self.Quiz_Outcome_Grade_2  := le.Quiz_Outcome_Grade_2;
self.Quiz_Status_Passfail  := le.Quiz_Status_Passfail;
self.Quiz_Status_Timeout  := le.Quiz_Status_Timeout;

self.Cust_AgentName	:= ri.Cust_AgentName;
self.Cust_Business_Name	 := ri.Cust_Business_Name;
self.Cust_Business_FEIN	 := ri.Cust_Business_FEIN;
self.Cust_Business_TaxID	:= ri.Cust_Business_TaxID;
self.Cust_AliasName	:= ri.Cust_AliasName;
self.Cust_Contact_Type	:= ri.Cust_Contact_Type;
self.Cust_Purchase_Amt	:= ri.Cust_Purchase_Amt;
self.Cust_IPAddress	 := ri.Cust_IPAddress;
self.Tran_Date	:= 	ri.tran_date;
self.Tran_Final_Status	:= 	ri.Tran_Final_Status	;
self.Tran_Finalization_Date	:= 	ri.Tran_Finalization_Date	;
self.Tran_Finalization_Time	:= 	ri.Tran_Finalization_Time	;
self.Tran_Fail_ReasonCode	:= 	ri.Tran_Fail_ReasonCode  	;
self.Tran_Process_Type	:= 	ri.Tran_Process_Type	;
self.Tran_Venue_Type	:= 	ri.Tran_Venue_Type	;
self.Tran_Venue_API_ReqType	:= 	ri.Tran_Venue_API_ReqType	;
self.Tran_Venue_BatchID	:= 	ri.Tran_Venue_BatchID	;
self.Tran_Source_Type	:= 	ri.Tran_Source_Type	;
self.Tran_LN_ServerName	:= 	ri.Tran_LN_ServerName	;
self.Tran_SourceIP	:= 	ri.Tran_SourceIP	;
self.Tran_Unique_IdentityID	:= 	ri.Tran_Unique_IdentityID	;
self.Tran_TaskLevel_Orig	:= 	ri.Tran_TaskLevel_Orig	;
self.Tran_TaskLevel_Final	:= 	ri.Tran_TaskLevel_Final	;
self.Tran_Query_Check	:= 	ri.Tran_Query_Check	;
self.Tran_CustomerID_Hashed	:= 	ri.Tran_CustomerID_Hashed	;
self.Tran_SequenceNumber	:= 	ri.Tran_SequenceNumber	;
self.Tran_Record_Update_Time	:= 	ri.Tran_Record_Update_Time;
self.Tran_Determinator_Time	:= 	ri.Tran_Determinator_Time	;
self.Tran_Agent_Risk_AssesType	:= 	ri.Tran_Agent_Risk_AssesType	;
self.Input_LexID	:= ri.Input_LexID;
self.Input_Name_First	:= ri.Input_Name_First	;
self.Input_Name_Last	:= 	ri.Input_Name_Last ;
self.Input_Name_Prefix	:= 	ri.Input_Name_Prefix;
self.Input_Name_Middle	:= 	ri.Input_Name_Middle	;
self.Input_Name_Suffix	:= 	ri.Input_Name_Suffix;
self.Input_DOB	:= ri.Input_DOB;
self.Input_Phone	:= 	ri.Input_Phone	;
self.Input_DL_Number	:= 	ri.Input_DL_Number	;
self.Input_DL_State	:= 	ri.Input_DL_State	;
self.Input_Street	:= 	ri.Input_Street	;
self.Input_City	:= 	ri.Input_City ;
self.Input_State	:= 	ri.Input_State	;
self.Input_Zip	:= 	ri.Input_Zip	;
self.Input_Country	:= 	ri.Input_Country	;
self.Input_SSN	:= 	ri.Input_SSN	;
self.Input_SSN_Type_Length	:= 	ri.Input_SSN_Type_Length	;
self.Input_SSN_Encrypted	:= 	ri.Input_SSN_Encrypted	;
self.Identity_Unique_Count	:= 	ri.Identity_Unique_Count	;
self.Identity_Located	:= 	ri.Identity_Located	;
self.Identity_Located_Status	:= 	ri.Identity_Located_Status	;
self.Identity_NotLocated	:= 	ri.Identity_NotLocated	;
self.Identity_NotLocated_Status	:= 	ri.Identity_NotLocated_Status	;
self.Discovery_Identity_BestScore	:= 	ri.Discovery_Identity_BestScore	;
self.Discovery_Identity_MaxScore	:= 	ri.Discovery_Identity_MaxScore	;
self.Discovery_Identity_PassThreshold	:= 	ri.Discovery_Identity_PassThreshold	;
self.Product_IID_Used	:=	ri.Product_IID_Used	;
self.Product_IID_CVI	:=	ri.Product_IID_CVI	;
self.Product_IID_NAS	:=	ri.Product_IID_NAS	;
self.Product_IID_NAP	:=	ri.Product_IID_NAP	;
self.Product_IID_RiskIndicators	:=	ri.Product_IID_RiskIndicators	;
self.Product_IID_FP_Used	:=	ri.Product_IID_FP_Used	;
self.Product_IID_FP_Score	:=	ri.Product_IID_FP_Score	;
self.Product_IID_FP_RiskIndicators	:= ri.Product_IID_FP_RiskIndicators	;
self.Product_IID_FP_RiskIndices	:=	ri.Product_IID_FP_RiskIndices	;
self.Product_IID_RedFlag_RiskIndicators	:=	ri.Product_IID_RedFlag_RiskIndicators	;
self.Product_FlexID_Used	:=	ri.Product_FlexID_Used	;
self.Product_OFAC_StatusType	:=	ri.Product_OFAC_StatusType	;
self.Cust_Fraud_Type_Prov	:=	ri.Cust_Fraud_Type_Prov	;
self.Cust_Fraud_Status	:=	ri.Cust_Fraud_Status	;
self.Cust_Fraud_Status_Date	:=	ri.Cust_Fraud_Status_Date	;
self.Cust_Reference_ID	:=	ri.Cust_Reference_ID	;
self.Auth_LexID_Returned := ri.Auth_LexID_Returned;
self.Auth_Unique_ID := ri.Auth_Unique_ID;
self.Tran_Day := ri.Tran_Day;
self := le;
self := ri;

end;


verid_question_transaction_comb := join(distribute(verid_question, hash(tran_id)),
distribute(verid_transaction, hash(tran_id)),left.tran_id = right.tran_id, tjoin_quest_tran(left, right), full outer, local);

verid_question_transaction_comb tjoin_factranking(verid_question_transaction_comb le, verid_factranking ri) := transform

self.tran_id := if(le.TRAN_ID <> '', le.TRAN_ID, ri.FactRank_TransactionID);

self.Cust_Account  := le.Cust_Account;
self.Auth_Score	:= 	le.Auth_Score;
self.Auth_RequiredScore	:= 	le.Auth_RequiredScore	;
self.Auth_Outcome	:= 	le.Auth_Outcome	;
self.Auth_Pass	:= 	le.Auth_Pass	;
self.Auth_Fail	:= 	le.Auth_Fail	;
self.Auth_OptOut	:= 	le.Auth_OptOut	;
self.Auth_UnableToGengerate	:= 	le.Auth_UnableToGengerate	;
self.Auth_Error	:= 	le.Auth_Error	;
self.Auth_Quiz_Expired	:= 	le.Auth_Quiz_Expired	;
self.Question_Set_ID	:=	le.Question_Set_ID	;
self.Question_ID	:=	le.Question_ID	;
self.Question_Time_Creation	:=	le.Question_Time_Creation;
self.Question_Time_Start	:=	le.Question_Time_Start	;
self.Question_Time_End	:=	le.Question_Time_End	;
self.Question_Subset_Number	:=	le.Question_Subset_Number	;
self.Question_Type	:=	le.Question_Type	;
self.Question_Set_Type	:=	le.Question_Set_Type	;
self.Question_Tier_Type	:=	le.Question_Tier_Type	;
self.Question_Style_Type	:=	le.Question_Style_Type	;
self.Question_Category	:=	le.Question_Category	;
self.Question_Presentation_Position	:=	le.Question_Presentation_Position	;
self.Question_Presentation_Weight	:=	le.Question_Presentation_Weight	;
self.Question_Contribution_Weight	:=	le.Question_Contribution_Weight	;
self.Question_Data_Source	:=	le.Question_Data_Source    	;
self.Question_Language_Type	:=	le.Question_Language_Type	;
self.Question_Answer_Grade  	:=	le.Question_Answer_Grade	;
self.Question_Answer_Grade_OutcomeType	:=	le.Question_Answer_Grade_OutcomeType	;
self.Question_Answers_NumSelected	:=	le.Question_Answers_NumSelected	;
self.Question_Answers_NumCorrect	:=	le.Question_Answers_NumCorrect	;
self.Question_Answers_NoneOfAboveSelected	:=	le.Question_Answers_NoneOfAboveSelected	;
self.Question_Raw_Question	:=	le.Question_Raw_Question	;
self.Question_Raw_CorrectAnswer	:=	le.Question_Raw_CorrectAnswer	;
self.Question_Raw_UserAnswer	:=	le.Question_Raw_UserAnswer  	;
self.Quiz_Outcome_Grade   := le.Quiz_Outcome_Grade;
self.Quiz_Outcome_Grade_1 := le.Quiz_Outcome_Grade_1;
self.Quiz_Outcome_Grade_2  := le.Quiz_Outcome_Grade_2;
self.Selected_LexID  := le.Selected_LexID;
self.Quiz_Status_Passfail  := le.Quiz_Status_Passfail;
self.Quiz_Status_Timeout  := le.Quiz_Status_Timeout;

self.Cust_AgentName	:= le.Cust_AgentName;
self.Cust_Business_Name	 := le.Cust_Business_Name;
self.Cust_Business_FEIN	 := le.Cust_Business_FEIN;
self.Cust_Business_TaxID	:= le.Cust_Business_TaxID;
self.Cust_AliasName	:= le.Cust_AliasName;
self.Cust_Contact_Type	:= le.Cust_Contact_Type;
self.Cust_Purchase_Amt	:= le.Cust_Purchase_Amt;
self.Cust_IPAddress	 := le.Cust_IPAddress;
self.Tran_Date	:= 	le.tran_date;
self.Tran_Final_Status	:= 	le.Tran_Final_Status	;
self.Tran_Finalization_Date	:= 	le.Tran_Finalization_Date	;
self.Tran_Finalization_Time	:= 	le.Tran_Finalization_Time	;
self.Tran_Fail_ReasonCode	:= 	le.Tran_Fail_ReasonCode  	;
self.Tran_Process_Type	:= 	le.Tran_Process_Type	;
self.Tran_Venue_Type	:= 	le.Tran_Venue_Type	;
self.Tran_Venue_API_ReqType	:= 	le.Tran_Venue_API_ReqType	;
self.Tran_Venue_BatchID	:= 	le.Tran_Venue_BatchID	;
self.Tran_Source_Type	:= 	le.Tran_Source_Type	;
self.Tran_LN_ServerName	:= 	le.Tran_LN_ServerName	;
self.Tran_SourceIP	:= 	le.Tran_SourceIP	;
self.Tran_Unique_IdentityID	:= 	le.Tran_Unique_IdentityID	;
self.Tran_TaskLevel_Orig	:= 	le.Tran_TaskLevel_Orig	;
self.Tran_TaskLevel_Final	:= 	le.Tran_TaskLevel_Final	;
self.Tran_Query_Check	:= 	le.Tran_Query_Check	;
self.Tran_CustomerID_Hashed	:= 	le.Tran_CustomerID_Hashed	;
self.Tran_SequenceNumber	:= 	le.Tran_SequenceNumber	;
self.Tran_Record_Update_Time	:= 	le.Tran_Record_Update_Time;
self.Tran_Determinator_Time	:= 	le.Tran_Determinator_Time	;
self.Tran_Agent_Risk_AssesType	:= 	le.Tran_Agent_Risk_AssesType	;
self.Input_LexID	:= le.Input_LexID;
self.Input_Name_First	:= le.Input_Name_First	;
self.Input_Name_Last	:= 	le.Input_Name_Last ;
self.Input_Name_Prefix	:= 	le.Input_Name_Prefix;
self.Input_Name_Middle	:= 	le.Input_Name_Middle	;
self.Input_Name_Suffix	:= 	le.Input_Name_Suffix;
self.Input_DOB	:= le.Input_DOB;
self.Input_Phone	:= 	le.Input_Phone	;
self.Input_DL_Number	:= 	le.Input_DL_Number	;
self.Input_DL_State	:= 	le.Input_DL_State	;
self.Input_Street	:= 	le.Input_Street	;
self.Input_City	:= 	le.Input_City ;
self.Input_State	:= 	le.Input_State	;
self.Input_Zip	:= 	le.Input_Zip	;
self.Input_Country	:= 	le.Input_Country	;
self.Input_SSN	:= 	le.Input_SSN	;
self.Input_SSN_Type_Length	:= 	le.Input_SSN_Type_Length	;
self.Input_SSN_Encrypted	:= 	le.Input_SSN_Encrypted	;
self.Identity_Unique_Count	:= 	le.Identity_Unique_Count	;
self.Identity_Located	:= 	le.Identity_Located	;
self.Identity_Located_Status	:= 	le.Identity_Located_Status	;
self.Identity_NotLocated	:= 	le.Identity_NotLocated	;
self.Identity_NotLocated_Status	:= 	le.Identity_NotLocated_Status	;
self.Discovery_Identity_BestScore	:= 	le.Discovery_Identity_BestScore	;
self.Discovery_Identity_MaxScore	:= 	le.Discovery_Identity_MaxScore	;
self.Discovery_Identity_PassThreshold	:= 	le.Discovery_Identity_PassThreshold	;
self.Product_IID_Used	:=	le.Product_IID_Used	;
self.Product_IID_CVI	:=	le.Product_IID_CVI	;
self.Product_IID_NAS	:=	le.Product_IID_NAS	;
self.Product_IID_NAP	:=	le.Product_IID_NAP	;
self.Product_IID_RiskIndicators	:=	le.Product_IID_RiskIndicators	;
self.Product_IID_FP_Used	:=	le.Product_IID_FP_Used	;
self.Product_IID_FP_Score	:=	le.Product_IID_FP_Score	;
self.Product_IID_FP_RiskIndicators	:= le.Product_IID_FP_RiskIndicators	;
self.Product_IID_FP_RiskIndices	:=	le.Product_IID_FP_RiskIndices	;
self.Product_IID_RedFlag_RiskIndicators	:=	le.Product_IID_RedFlag_RiskIndicators	;
self.Product_FlexID_Used	:=	le.Product_FlexID_Used	;
self.Product_OFAC_StatusType	:=	le.Product_OFAC_StatusType	;
self.Cust_Fraud_Type_Prov	:=	le.Cust_Fraud_Type_Prov	;
self.Cust_Fraud_Status	:=	le.Cust_Fraud_Status	;
self.Cust_Fraud_Status_Date	:=	le.Cust_Fraud_Status_Date	;
self.Cust_Reference_ID	:=	le.Cust_Reference_ID	;
self.Auth_LexID_Returned := le.Auth_LexID_Returned;
self.Auth_Unique_ID := le.Auth_Unique_ID;
self.Tran_Day := le.Tran_Day;

self.FactRank_TransactionID	:=	ri.FactRank_TransactionID             	;
self.FactRank_Grade	:=	ri.FactRank_Grade                      	;
self.FactRank_ID	:=	ri.FactRank_ID	;
self.FactRank_ClientID	:=	ri.FactRank_ClientID               	;
self.FactRank_Quiz_Date_Created	:=	ri.FactRank_Quiz_Date_Created                	;
self.FactRank_Quiz_Date_LastUpdated	:=	ri.FactRank_Quiz_Date_LastUpdated         	;
self.FactRank_Data_Source	:=	ri.FactRank_Data_Source            	;
self.FactRank_Question_Set_ID	:=	ri.FactRank_Question_Set_ID            	;
self.FactRank_Question_ID	:=	ri.FactRank_Question_ID                	;
self.FactRank_Question_Type	:=	ri.FactRank_Question_Type              	;
self.FactRank_Question_Outcome	:=	ri.FactRank_Question_Outcome             	;
self.FactRank_Question_Pres_Position	:=	ri.FactRank_Question_Pres_Position      	;
self.FactRank_Question_Presented_Flag	:=	ri.FactRank_Question_Presented_Flag              	;
self.FactRank_Fraud_Marking	:=	ri.FactRank_Fraud_Marking              	;
self.FactRank_Raw_Question	:=	ri.FactRank_Raw_Question              	;
self.FactRank_Raw_CorrectAnswer 	:=	ri.FactRank_Raw_CorrectAnswer             	;
self.FactRank_Raw_CorrectAnswer_Position	:=	ri.FactRank_Raw_CorrectAnswer_Position       	;
self.FactRank_Fake	:=	ri.FactRank_Fake                       	;
self.FactRank_Type_1	:=	ri.FactRank_Type_1                	;
self.FactRank_Value_1	:=	ri.FactRank_Value_1                     	;
self.FactRank_Description_1	:=	ri.FactRank_Description_1               	;
self.FactRank_Raw_Answer_1	:=	ri.FactRank_Raw_Answer_1                    	;
self.FactRank_Type_2	:=	ri.FactRank_Type_2                	;
self.FactRank_Value_2	:=	ri.FactRank_Value_2                     	;
self.FactRank_Description_2	:=	ri.FactRank_Description_2               	;
self.FactRank_Raw_Answer_2	:=	ri.FactRank_Raw_Answer_2                    	;
self.FactRank_Type_3	:=	ri.FactRank_Type_3                	;
self.FactRank_Value_3	:=	ri.FactRank_Value_3                     	;
self.FactRank_Description_3	:=	ri.FactRank_Description_3               	;
self.FactRank_Raw_Answer_3	:=	ri.FactRank_Raw_Answer_3                    	;
self.FactRank_Type_4	:=	ri.FactRank_Type_4                	;
self.FactRank_Value_4	:=	ri.FactRank_Value_4                     	;
self.FactRank_Description_4	:=	ri.FactRank_Description_4               	;
self.FactRank_Raw_Answer_4	:=	ri.FactRank_Raw_Answer_4                    	;
self.FactRank_Type_5	:=	ri.FactRank_Raw_Answer_4                	;
self.FactRank_Value_5	:=	ri.FactRank_Value_5                     	;
self.FactRank_Description_5	:=	ri.FactRank_Description_5               	;
self.FactRank_Raw_Answer_5	:=	ri.FactRank_Raw_Answer_5                    	;
self.FactRank_Type_6	:=	ri.FactRank_Type_6                	;
self.FactRank_Value_6	:=	ri.FactRank_Value_6                     	;
self.FactRank_Description_6	:=	ri.FactRank_Description_6               	;
self.FactRank_Raw_Answer_6	:=	ri.FactRank_Raw_Answer_6                    	;
self.FactRank_Type_7	:=	ri.FactRank_Type_7                	;
self.FactRank_Value_7	:=	ri.FactRank_Value_7                     	;
self.FactRank_Description_7	:=	ri.FactRank_Description_7               	;
self.FactRank_Raw_Answer_7	:=	ri.FactRank_Raw_Answer_7                    	;
self.FactRank_Type_8	:=	ri.FactRank_Type_8                	;
self.FactRank_Value_8	:=	ri.FactRank_Value_8                     	;
self.FactRank_Description_8	:=	ri.FactRank_Description_8               	;
self.FactRank_Raw_Answer_8	:=	ri.FactRank_Raw_Answer_8                    	;
self.FactRank_Type_9	:=	ri.FactRank_Type_9                	;
self.FactRank_Value_9	:=	ri.FactRank_Value_9                     	;
self.FactRank_Description_9	:=	ri.FactRank_Description_9               	;
self.FactRank_Raw_Answer_9	:=	ri.FactRank_Raw_Answer_9                    	;
self.FactRank_Type_10	:=	ri.FactRank_Type_10               	;
self.FactRank_Value_10	:=	ri.FactRank_Value_10                    	;
self.FactRank_Description_10	:=	ri.FactRank_Description_10              	;
self.FactRank_Raw_Answer_10	:=	ri.FactRank_Raw_Answer_10                   	;
self.FactRank_Type_11	:=	ri.FactRank_Type_11               	;
self.FactRank_Value_11	:=	ri.FactRank_Value_11                    	;
self.FactRank_Description_11	:=	ri.FactRank_Description_11              	;
self.FactRank_Raw_Answer_11	:=	ri.FactRank_Raw_Answer_11                   	;
self.FactRank_Type_12	:=	ri.FactRank_Type_12               	;
self.FactRank_Value_12	:=	ri.FactRank_Value_12                    	;
self.FactRank_Description_12	:=	ri.FactRank_Description_12              	;
self.FactRank_Raw_Answer_12	:=	ri.FactRank_Raw_Answer_12                   	;
self.FactRank_Type_13	:=	ri.FactRank_Type_13               	;
self.FactRank_Value_13	:=	ri.FactRank_Value_13                    	;
self.FactRank_Description_13	:=	ri.FactRank_Description_13              	;
self.FactRank_Raw_Answer_13	:=	ri.FactRank_Raw_Answer_13                   	;
self.FactRank_Type_14	:=	ri.FactRank_Type_14               	;
self.FactRank_Value_14	:=	ri.FactRank_Value_14                    	;
self.FactRank_Description_14	:=	ri.FactRank_Description_14              	;
self.FactRank_Raw_Answer_14	:=	ri.FactRank_Raw_Answer_14                   	;
self.FactRank_Type_15	:=	ri.FactRank_Type_15               	;
self.FactRank_Value_15	:=	ri.FactRank_Value_15                    	;
self.FactRank_Description_15	:=	ri.FactRank_Description_15              	;
self.FactRank_Raw_Answer_15	:=	ri.FactRank_Raw_Answer_15                   	;
self.FactRank_Type_16	:=	ri.FactRank_Type_16               	;
self.FactRank_Value_16	:=	ri.FactRank_Value_16                    	;
self.FactRank_Description_16	:=	ri.FactRank_Description_16              	;
self.FactRank_Raw_Answer_16	:=	ri.FactRank_Raw_Answer_16                   	;
self.FactRank_Type_17	:=	ri.FactRank_Type_17               	;
self.FactRank_Value_17	:=	ri.FactRank_Value_17                    	;
self.FactRank_Description_17	:=	ri.FactRank_Description_17              	;
self.FactRank_Raw_Answer_17	:=	ri.FactRank_Raw_Answer_17                   	;
self.FactRank_Type_18	:=	ri.FactRank_Type_18               	;
self.FactRank_Value_18	:=	ri.FactRank_Value_18                    	;
self.FactRank_Description_18	:=	ri.FactRank_Description_18              	;
self.FactRank_Raw_Answer_18	:=	ri.FactRank_Raw_Answer_18                   	;
self.FactRank_Type_19	:=	ri.FactRank_Type_19               	;
self.FactRank_Value_19	:=	ri.FactRank_Value_19                    	;
self.FactRank_Description_19	:=	ri.FactRank_Description_19              	;
self.FactRank_Raw_Answer_19	:=	ri.FactRank_Raw_Answer_19                   	;
self.FactRank_Type_20	:=	ri.FactRank_Type_20               	;
self.FactRank_Value_20	:=	ri.FactRank_Value_20                    	;
self.FactRank_Description_20	:=	ri.FactRank_Description_20              	;
self.FactRank_Raw_Answer_20	:=	ri.FactRank_Raw_Answer_20     	;
self.FactRank_Type_21	:=	ri.FactRank_Type_21               	;
self.FactRank_Value_21	:=	ri.FactRank_Value_21                    	;
self.FactRank_Description_21	:=	ri.FactRank_Description_21              	;
self.FactRank_Type_22	:=	ri.FactRank_Type_22               	;
self.FactRank_Value_22	:=	ri.FactRank_Value_22                    	;
self.FactRank_Description_22	:=	ri.FactRank_Description_22              	;
self.FactRank_Type_23	:=	ri.FactRank_Type_23               	;
self.FactRank_Value_23	:=	ri.FactRank_Value_23                    	;
self.FactRank_Description_23	:=	ri.FactRank_Description_23              	;
self.FactRank_Type_24	:=	ri.FactRank_Type_24               	;
self.FactRank_Value_24	:=	ri.FactRank_Value_24                    	;
self.FactRank_Description_24	:=	ri.FactRank_Description_24              	;
self.FactRank_Type_25	:=	ri.FactRank_Type_25               	;
self.FactRank_Value_25	:=	ri.FactRank_Value_25                    	;
self.FactRank_Description_25	:=	ri.FactRank_Description_25              	;
self.FactRank_Type_26	:=	ri.FactRank_Type_26               	;
self.FactRank_Value_26	:=	ri.FactRank_Value_26                    	;
self.FactRank_Description_26	:=	ri.FactRank_Description_26              	;
self.FactRank_Type_27	:=	ri.FactRank_Type_27               	;
self.FactRank_Value_27	:=	ri.FactRank_Value_27                    	;
self.FactRank_Description_27	:=	ri.FactRank_Description_27              	;
self.FactRank_Type_28	:=	ri.FactRank_Type_28               	;
self.FactRank_Value_28	:=	ri.FactRank_Value_28                    	;
self.FactRank_Description_28	:=	ri.FactRank_Description_28              	;
self.FactRank_Type_29	:=	ri.FactRank_Type_29               	;
self.FactRank_Value_29	:=	ri.FactRank_Value_29                    	;
self.FactRank_Description_29	:=	ri.FactRank_Description_29              	;
self.FactRank_Type_30	:=	ri.FactRank_Type_30               	;
self.FactRank_Value_30	:=	ri.FactRank_Value_30                    	;
self.FactRank_Description_30	:=	ri.FactRank_Description_30              	;
self.Question_Num_Answers := ri.Question_Num_Answers;
														 
self.Question_Type_Diversionary := ri.Question_Type_Diversionary;
self.Question_AnswerInclude_NOA := ri.Question_AnswerInclude_NOA;
                                     
self.Question_AnswerReal_NOA := ri.Question_AnswerReal_NOA;

self.Question_AnswerInclude_AOA := ri.Question_AnswerInclude_AOA;
self.Question_AnswerReal_AOA  :=  ri.Question_AnswerReal_AOA;

self := le;
self := ri;

end;


avenger_verid_factranking_comb := join(distribute(verid_question_transaction_comb, hash(tran_id)),

distribute(verid_factranking, hash(FactRank_TransactionID)),

left.tran_id = right.FactRank_TransactionID, tjoin_factranking(left,right),full outer, local) :persist('~thor_data400::persist::avenger_verid_quest_trans_comb');


combine_all := 
									avenger_verid_factranking_comb +
									avenger.fn_mapping_irm(infile_quiz) + 
									Avenger.append_DID;

	
return 
					sequential(output(combine_all,,'~thor_data400::base::avenger::combine_all_' + filedate, overwrite, __compressed__));
					//fileservices.promotesuperfilelist(['~thor_data400::base::avenger::full_history',
							//											'~thor_data400::base::avenger::full_history_father'],'~thor100_21::base::avenger::combine_all' + filedate, true));
											
end;
