IMPORT corp2, corp2_mapping;      

EXPORT Functions := Module
     
	 EXPORT status_desc(string code) := case( trim(code,left,right),
	                                          '0'=>'GOOD STANDING',
																						'1'=>'ADMIN DISSOLVED - OTHER',
																						'2'=>'CANCELED',
																						'3'=>'INACTIVE - CONSOLIDATED',
																						'4'=>'INACTIVE - CONVERTED',
																						'5'=>'DISSOLVED',
																						'6'=>'ENTITY DELETED',
																						'7'=>'FICTITIOUS EXPIRED',
																						'8'=>'IN PROCESS',
																						'9'=>'INACTIVE',
																						'10'=>'ORDERED DISSOLVED',
																						'11'=>'INACTIVE - MERGED',
																						'12'=>'NON-QUALIFIED',
																						'13'=>'ACCEPTANCE INACTIVE',
																						'14'=>'QUALIFIED - AUTHORIZED',
																						'15'=>'REGISTERED',
																						'16'=>'RESERVED NAME',
																						'19'=>'SUSPENDED',
																						'20'=>'TERMINATED/CANCELED',
																						'21'=>'USED NAME RESERVATION',
																						'22'=>'VOLUNTARILY DISSOLVED',
																						'23'=>'WITHDRAWN',
																						'24'=>'REJECTED',
																						'25'=>'COURT ORDER DISSOLVED',
																						'1001'=>'ACCEPTED INACTIVE',             
																						'1003'=>'FICTITIOUS ACTIVE',
																						'1002'=>'ACTIVE',
																						'1004'=>'ADMIN CANCEL - AGENT',
																						'1005'=>'ADMIN CANCEL - DURATION',
																						'1006'=>'ADMIN CANCELLATION',
																						'1007'=>'ADMIN DISSOLVED - NONPROFIT',
																						'1008'=>'ADMIN DISSOLVED - PROFIT',
																						'1009'=>'ADMIN/DISS/CANCEL/OTHER',
																						'1010'=>'DISSOLVED NONPROFIT',
																						'1011'=>'FORFEITED',
																						'1012'=>'WITHDRAWN BY CONSOLIDATION',
																						'1013'=>'WITHDRAWN BY MERGER',
																						''		=> '',
																						'**|'+ corp2.t2u(code)
																					);
																					
	EXPORT Orig_desc(string code) := case(trim(code,left,right),
																				'4'=>'GEN. BUSINESS - FOR PROFIT',
																				'6'=>'NONPROFIT CORPORATION',
																				'7'=>'PROFESSIONAL CORPORATION',
																				'8'=>'LIMITED LIABILITY COMPANY',
																				'10'=>'LIMITED PARTNERSHIP',
																				'11'=>'LIMITED LIABILITY PARTNERSHIP',
																				'13'=>'BANK',
																				'14'=>'INSURANCE COMPANY',
																				'15'=>'COOPERATIVE ASSOCIATION',
																				'19'=>'',
																				'26'=>'SOP-NONRESIDENT MOTORIST',
																				'1002'=>'ALL',
																				'1003'=>'BENEVOLENT',
																				'1004'=>'BRIDGE CORPORATION',
																				'1005'=>'BUILDING & LOAN',
																				'1006'=>'CLOSE CORPORATION',
																				'1007'=>'CREDIT UNION',
																				'1008'=>'DOR RECORD',
																				'1009'=>'DRAINAGE DISTRICTS',
																				'1010'=>'INSURANCE-FARMERS MUTUAL',
																				'1011'=>'',
																				'1012'=>'FIRE PROTECTION DISTRICT',
																				'1013'=>'GENERAL ASSEMBLY',
																				'1014'=>'INDUSTRIAL DEVELOPMENT CORP',
																				'1015'=>'LEVEE DISTRICTS',
																				'1016'=>'LLC/LP/LLP',
																				'1017'=>'NON-PROFIT SEWER (CHAPTER 347 RSMO)',
																				'1018'=>'NON-PROFIT SEWER (CHAPTER 355 RSMO)',
																				'1019'=>'NON-PROFIT WATER (CHAPTER 347 RSMO)',
																				'1020'=>'NON-PROFIT WATER (CHAPTER 355 RSMO)',
																				'1021'=>'NON-STOCK COOP',
																				'1022'=>'PUBLIC WATER SUPPLY DISTRICT',
																				'1023'=>'RAILROAD',
																				'1024'=>'RURAL ELECTRIC COOP',
																				'1025'=>'SAVINGS & LOAN',
																				'1026'=>'SEWER DISTRICT',
																				'1027'=>'STOCK COOP CORP',
																				'1028'=>'TELEPHONE CORP',
																				'1029'=>'TRUST',
																				'1030'=>'URBAN REDEVELOPMENT',
																				''		=> '',
																				'**|'+ corp2.t2u(code)
																				);
																				
	//********************************************************************
		//fGetStateCode: validates vendor codes and Returns '**' if we receive invalid or new codes from vendor 
	//********************************************************************	
		EXPORT fGetStateCode(string code) 
	        := map( corp2.t2u(code) in 
									['AB','AL','AK','AP','AS','AZ','AR','CA','CD','CO','CT','DE','DC','FM','FL','GA',							
									 'GU','HI','ID','IL','IN','IA','KS','KY','LA','ME','MH','MD','MA','MI','MN','MS',							
									 'MT','NC','NE','NV','NH','NJ','NM','NY','ND','MP','OH','OK','OR','PW','PA','PR',							
									 'RI','SC','SD','TN','TX','UK','US','UT','VT','VI','VA','WA','WV','WI','WY'							
								  ]=>corp2.t2u(code),
									   corp2.t2u(code) in ['XX','X','NA','']=>'', // !!as per CI
								'**');
									
	//********************************************************************
		//fGetStateDesc: Returns full name from "Two digit State_Code" 
	//********************************************************************	
	EXPORT  string fGetStateDesc(STRING state) := FUNCTION

		st  := corp2.t2u(state);
		RETURN case(st,
								'AA'=>'ARMED FORCES AMERICAS EXCEPT CANADA',						
								'AB'=>'CANADA',						
								'AE'=>'ARMED FORCES EUROPE, THE MIDDLE EAST, AND CANADA',						
								'AF'=>'AFRICA',						
								'AK'=>'ALASKA',						
								'AL'=>'ALABAMA',						
								'AP'=>'ARMED FORCES PACIFIC',						
								'AR'=>'ARKANSAS',						
								'AS'=>'AMERICAN SAMOA',						
								'AU'=>'AUSTRALIA',						
								'AZ'=>'ARIZONA',						
								'BE'=>'BERMUDA',						
								'BL'=>'BELGIUM',						
								'BR'=>'BARBADOS',						
								'BW'=>'BRITISH WEST INDIES',						
								'CA'=>'CALIFORNIA',						
								'CB'=>'COLUMBIA',						
								'CD'=>'CANADA',						
								'CH'=>'CHINA',						
								'CI'=>'COOK ISLANDS',						
								'CO'=>'COLORADO',						
								'CT'=>'CONNECTICUT',						
								'CZ'=>'CANAL ZONE',						
								'DC'=>'DISTRICT OF COLUMBIA',						
								'DE'=>'DELAWARE',						
								'EU'=>'EUROPE',						
								'FL'=>'FLORIDA',						
								'FM'=>'FEDERATED STATES OF MICRONESIA',						
								'FR'=>'FRANCE',						
								'GA'=>'GEORGIA',						
								'GB'=>'GREAT BRITAIN',						
								'GR'=>'GERMANY',						
								'GU'=>'GUAM',						
								'HI'=>'HAWAII',						
								'HK'=>'HONG KONG',						
								'IA'=>'IOWA',						
								'ID'=>'IDAHO',						
								'IE'=>'IRELAND',						
								'II'=>'INDIA',						
								'IL'=>'ILLINOIS',						
								'IN'=>'INDIANA',						
								'JA'=>'JAPAN',						
								'KS'=>'KANSAS',						
								'KY'=>'KENTUCKY',						
								'LA'=>'LOUISIANA',						
								'LX'=>'LUXEMBOURG',						
								'MA'=>'MASSACHUSETTS',						
								'MD'=>'MARYLAND',						
								'ME'=>'MAINE',						
								'MH'=>'MARSHALL ISLANDS',						
								'MI'=>'MICHIGAN',						
								'MN'=>'MINNESOTA',						
								'MP'=>'NORTHERN MARIANA ISLANDS',						
								'MS'=>'MISSISSIPPI',						
								'MT'=>'MONTANA',						
								'MX'=>'MEXICO',						
								'NC'=>'NORTH CAROLINA',						
								'ND'=>'NORTH DAKOTA',						
								'NE'=>'NEBRASKA',						
								'NH'=>'NEW HAMPSHIRE',						
								'NJ'=>'NEW JERSEY',						
								'NL'=>'NETHERLANDS',						
								'NM'=>'NEW MEXICO',						
								'NS'=>'NOVA SCOTIA, CANADA',						
								'NV'=>'NEVADA',						
								'NY'=>'NEW YORK',						
								'OA'=>'OTHER ASIA',						
								'OH'=>'OHIO',						
								'OK'=>'OKLAHOMA',						
								'OR'=>'OREGON',						
								'PA'=>'PENNSYLVANIA',						
								'PH'=>'PHILIPPINES',						
								'PN'=>'PANAMA',						
								'PR'=>'PUERTO RICO',						
								'PW'=>'PALAU',						
								'RI'=>'RHODE ISLAND',						
								'SA'=>'OTHER S&C AMERICAN',						
								'SC'=>'SOUTH CAROLINA',						
								'SD'=>'SOUTH DAKOTA',						
								'SL'=>'SCOTLAND',						
								'TN'=>'TENNESSEE',						
								'TX'=>'TEXAS',						
								'UK'=>'UNITED KINGDOM',						
								'US'=>'US',						
								'UT'=>'UTAH',						
								'VA'=>'VIRGINIA',						
								'VI'=>'VIRGIN ISLANDS',						
								'VT'=>'VERMONT',						
								'WA'=>'WASHINGTON',						
								'WI'=>'WISCONSIN',						
								'WV'=>'WEST VIRGINIA',						
								'WY'=>'WYOMING',
								'XX'=>'',
								'X' =>'',
								'NA'=>'',
								''	=>'',
								'**|'+ st);
							
		END;
		
	//********************************************************************
		//fgetAgentName: validates AgentNames !
	//********************************************************************	
		EXPORT fgetAgentName( string Ra_name, string state_origin ='MO', string state_desc='MISSOURI'):= FUNCTION
		
			 invalid_name  := '####|^OWN$|^INACTIVE \\(SEE FILE|^INACTIVE  SEE FILE|^INACTIVE DUE TO|^INACTIVE';				
			 valid_ra_name :=	map(Regexfind(invalid_name ,corp2.t2u(Ra_name),nocase)=> '',
														Corp2_Mapping.fCleanBusinessName(state_origin,state_desc,Ra_name).BusinessName);	
			 RETURN valid_ra_name;
		 
		 End;
		 
		Export	Addr_type_cd(string addr_type_id)  := function 
				
			addr_id := trim(addr_type_id,left,right);
			return case(addr_id,
									'3'			=>'B',
									'5'			=>'5',
									'7'			=>'L',
									'9'			=>'O',
									'10'		=>'W',
									'1002'	=>'1002',
									'1003'	=>'1003',
									''			=>'',
									'**|'+ addr_id);
				
		End;
		
		Export	Addr_type_desc(string addr_type_id)  := function 
				
			addr_id := trim(addr_type_id,left,right);
			return case(addr_id,
									'3'			=>'BUSINESS',
									'5'			=>'UCC ADDRESS',
									'7'			=>'LISTING',
									'9'			=>'OTHER ADDRESS',
									'10'		=>'WITHDRAWAL ADDRESS',
									'1002'	=>'OWNER ADDRESS',
									'1003'	=>'PHYSICAL ADDRESS',
									'');
				
		End;			
																				
		Export	title_desc(string PartyTypeID)  := function 
				
			PtypeID := trim(PartyTypeID,left,right);
			return	Map( PtypeID= '0' 	=>'ASSISTANT SECRETARY',
									 PtypeID= '1' 	=>'ASSISTANT TREASURER',
									 PtypeID= '2' 	=>'ATTORNEY-IN-FACT',
									 PtypeID= '3'		=>'CEO',
									 PtypeID= '4'		=>'CFO',
									 PtypeID= '5'		=>'DIRECTOR',
									 PtypeID= '6' 	=>'GENERAL PARTNER',
									 PtypeID= '7' 	=>'MEMBER/MANAGER',
									 PtypeID= '8' 	=>'MEMBER', 
									 PtypeID= '9' 	=>'MANAGER',
									 PtypeID= '10' 	=>'INCORPORATOR',
									 PtypeID= '11' 	=>'OTHER',	
									 PtypeID= '12' 	=>'PRESIDENT',
									 PtypeID= '13' 	=>'SECRETARY',
									 PtypeID= '14' 	=>'TREASURER',
									 PtypeID= '15'	=>'VICE PRESIDENT',
									 PtypeID= '16' 	=>'CHAIRMAN',
									 PtypeID= '17'	=>'ORGANIZER',																		 
									 PtypeID= '18'	=>'OFFICER',
									 PtypeID= '19'	=>'PARTNER',									 
									 PtypeID= '1001'=>'LIMITED RECEIVER',
									 PtypeID= '1002'=>'GENERAL RECEIVER',
									 PtypeID= ''		=>'',
									 '**|'+ PtypeID );	
		End;															
    
		EXPORT filing_desc(string code) := case(trim(code,left,right),
																						'1002'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'1058'=>'NOTIFICATION FROM DIV OF FINANCE ON MERGER (NON-SURVIVOR)',
																						'1095'=>'APPLICATION FOR AMENDED CERT OF AUTH FOR A FOREIGN CORP',
																						'1125'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'1126'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1130'=>'APPLICATION FOR REINSTATEMENT OF A CLOSE CORPORATION', 
																						'1143'=>'AMENDED ARTICLES ACCEPTING PROFESSIONAL CORPORATION LAW', 
																						'1144'=>'AMENDED ARTICLES ACCEPTING CORPORATION TO NON PROFIT WATER',
																						'1145'=>'AMENDED ARTICLES ACCEPTING CORPORATION TO NON PROFIT WATER',
																						'1180'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1238'=>'NOTIFICATION FROM DIV OF FINANCE ON MERGER (NON-SURVIVOR)',
																						'1289'=>'SUMMARY  OF CONSOLIDATION OF A GENERAL BUSINESS', 
                                            '1298'=>'AMENDED AND RESTATED ARTICLES OF INCORPORATION BY DIRECTORS',																						
																						'1290'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1293'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1301'=>'AMENDED AND RESTATED ARTICLES OF INCORPORATION', 
																						'1309'=>'AMENDMENT OF ARTICLES OF INCORPORATION BY DIRECTORS', 
																						'1311'=>'AMENDMENT OF ARTICLES OF INCORPORATION CLOSE CORPORATION', 
																						'1318'=>'APPLICATION FOR AMENDED CERTIFICATE OF AUTH FOREIGN CORP',
																						'1321'=>'ARTICLES OF MERGER SUBMITTED (PARENT  SUBSIDIARY)',
																						'1342'=>'ARTICLES OF CANCELLATION OF A FOREIGN COOPERATIVE ASSOC',
																						'1361'=>'ARTICLES OF CONSOLIDATION', 
																						'1364'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1365'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'1454'=>'SUMMARY ARTICLES OF CONSOLIDATION ',
																						'1459'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1514'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'1528'=>'ADMIN DISSOLUTION NOTIFICATION-FAILURE TO FILE REGIS REPORT',
																						'1570'=>'AFFIDAVIT TO RESCIND CANCELLATION OF LIMITED PARTNERSHIP',
																						'1572'=>'APPLICATION FOR A CERT OF AUTH FOREIGN NON PROFIT CORP',
																						'1601'=>'NOTIFICATION DIV CREDIT UNIONS CONSOLIDATION (NON-SURVIVOR)',
																						'1608'=>'AFFIDAVIT TO RESCIND CANCELLATION OF LIMITED PARTNERSHIP', 
																						'1681'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1722'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'1795'=>'APPLICATION FOR REGISTRATION OF A LLP',
																						'1825'=>'NOTIFICATION FROM DIV OF INS ON CONSOLIDATION (NON-SURVIVOR)',
																						'1848'=>'NOTIFICATION FROM DIV OF INS ON CONSOLIDATION (NON-SURVIVOR)',
																						'1885'=>'RENEWAL APPLICATION FOR REGISTRATION OF A MISSOURI LLLP', 
																						'1886'=>'RENEWAL APPLICATION FOR REGISTRATION OF A FOREIGN LLLP',
																						'1914'=>'APPLICATION FOR AN AMENDED REGISTRATION FOREIGN LP',
																						'1935'=>'APPLICATION FOR REGISTRATION OF A FOREIGN LLC',
																						'1951'=>'LETTER OF RESIGNATION OF AGENT WITHOUT APPT OF NEW AGENT',
																						'1952'=>'AMENDED REGISTRATION OF A FOREIGN LLP',
																						'2019'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'2049'=>'MO CORPORATION MERGING INTO A FOREIGN PROFESSIONAL CORP',
																						'2051'=>'NOTIFICATION FROM DIV OF INSURANCE ON MERGER (NON-SURVIVOR)',
																						'2052'=>'NOTIFICATION FROM DIV OF INSURANCE ON MERGER (NON-SURVIVOR)',
																						'2054'=>'LETTER OF RESIGNATION OF AGENT WITHOUT APPT OF NEW AGENT',
																						'2055'=>'NOTIFICATION FROM DIVISION OF INSURANCE ON CORRECTION', 
																						'2090'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'2104'=>'APPLICATION FOR AMENDED CERT OF AUTH FOREIGN NON PROFIT CORP',
																						'2201'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'2266'=>'NOTIFICATION DIV OF CREDIT UNIONS ON MERGER (NON-SURVIVOR)',
																						'2324'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'2326'=>'CONVERSION OF A DOMESTIC LP TO DOMESTIC LLC', 
																						'2335'=>'APPLICATION FOR REINSTATEMENT OF A CLOSE CORPORATION',
																						'2368'=>'APPLICATION FOR REINSTATEMENT OF A CLOSE CORPORATION',
																						'2381'=>'CONVERSION OF A DOMESTIC LLP TO A DOMESTIC LLC',
																						'2390'=>'AMENDED ARTICLES CONVERTING CORPORATION TO RURAL ELEC COOP',
																						'2392'=>'ARTICLES OF CONVERSION OF ANY CORPORATION TO STOCK COOP',
																						'2400'=>'RESTATED ARTICLES OF INCORPORATION',
																						'2418'=>'ARTICLES OF AMENDED AGREEMENT', 
																						'2451'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'2500'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'2578'=>'ARTICLES OF MERGER (NON-SURVIVOR)',
																						'2591'=>'NOTIFICATION FROM DIV OF FINANCE FOR STATEMENT OF CORRECTION',
																						'2614'=>'APPLICATION FOR AMENDED CERTIFICATE OF AUTHORITY', 
																						'2738'=>'AMENDED ARTICLES CONVERTING CORPORATION TO RURAL ELEC COOP',
																						'2850'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'2909'=>'RESTATED ARTICLES OF AGREEMENT',
																						'2953'=>'ART OF CONSOL-CERTIF THROUGH REC OF DEED\'S OFFICE (NON-SURV)',
																						'3079'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'3094'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						'3100'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'3101'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION',
																						'3105'=>'ADMINISTRATIVE DISSOLUTION NOTIFICATION', 
																						''		=>'',
																						'**|'+ corp2.t2u(code)
																					);

End;