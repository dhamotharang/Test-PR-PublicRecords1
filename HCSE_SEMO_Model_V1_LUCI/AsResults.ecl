EXPORT AsResults(infile) := FUNCTIONMACRO
IMPORT HCSE_SEMO_Model_V1_LUCI,LUCI;
  Res(DATASET(RECORDOF(infile)) myfile) := MODULE(LUCI.Results)
  IMPORT iesp;
  SHARED RCToMessage(SET OF STRING5 rc) := FUNCTION
    d1 := DATASET(rc,{ STRING5 Code });
    iesp.ins_share_iss.t_InsuranceScoreMessage into(d1 le) := TRANSFORM
      SELF.MessageType := HCSE_SEMO_Model_V1_LUCI.RCCodes(le.code).GroupType;
      SELF.Description := HCSE_SEMO_Model_V1_LUCI.RCCodes(le.code).Description;
      SELF.Code := le.code;
    END;
    RETURN PROJECT(d1,into(LEFT));
  END;
    // Simple and quick
  EXPORT BaseF := HCSE_SEMO_Model_V1_LUCI.AppendAll(myfile,do_Model1,ADDRMOSTRECENTCRIMEDIFF,ADDRMOSTRECENTDISTANCE,ADDRMOSTRECENTINCOMEDIFF,ADDRMOSTRECENTMOVEAGE,ADDRMOSTRECENTVALUEDIFF,ADDRRECENTECONTRAJECTORY,AGEOLDESTRECORD,AGE_IN_YEARS,AG_PRED_MOT,AVGSTATECOST,BP1,BP2,BPV1,BUSINESSINPUTADDRCOUNT,CORRELATIONRISKLEVEL,CURRADDRAGELASTSALE,CURRADDRAGEOLDESTRECORD,CURRADDRAVMVALUE,CURRADDRAVMVALUE12,CURRADDRAVMVALUE60,CURRADDRBURGLARYINDEX,CURRADDRBURGLARYINDEX_12,CURRADDRBURGLARYINDEX_24,CURRADDRCARTHEFTINDEX,CURRADDRCOUNTYINDEX,CURRADDRCRIMEINDEX,CURRADDRLENOFRES,CURRADDRMEDIANINCOME,CURRADDRMEDIANVALUE,CURRADDRMURDERINDEX,CURRADDRTRACTINDEX,DEROGAGE,DIVADDRIDENTITYCOUNT,DIVADDRIDENTITYMSOURCECOUNT,DIVADDRSSNCOUNT,DIVADDRSSNMSOURCECOUNT,DIVSSNADDRMSOURCECOUNT,ESTIMATEDANNUALINCOME,ESTIMATEDANNUALINCOME_12,ESTIMATEDANNUALINCOME_24,ESTINCOME0_1,ESTINCOME0_1_PCNT,ESTINCOME0_2,ESTINCOME0_2_PCNT,ESTINCOME1_2,FEMALE,INPUTADDRAGELASTSALE,INPUTADDRAGEOLDESTRECORD,INPUTADDRBURGLARYINDEX,INPUTADDRBUSINESSCOUNT,INPUTADDRCARTHEFTINDEX,INPUTADDRCRIMEINDEX,INPUTADDRLENOFRES,INPUTADDRMEDIANINCOME,INPUTADDRMEDIANVALUE,INPUTADDRMULTIFAMILYCOUNT,INPUTADDRMURDERINDEX,INPUTADDRPHONECOUNT,INPUTADDRTAXVALUE,INPUTADDRVACANTPROPCOUNT,INPUTPHONESERVICETYPE,LASTNAMECHANGEAGE,LIENFILEDAGE,NONDEROGCOUNT,PHONEEDAAGENEWESTRECORD,PHONEEDAAGEOLDESTRECORD,PHONEOTHERAGENEWESTRECORD,PHONEOTHERAGEOLDESTRECORD,PREVADDRAGELASTSALE,PREVADDRAGENEWESTRECORD,PREVADDRAGEOLDESTRECORD,PREVADDRAVMVALUE,PREVADDRBLOCKINDEX,PREVADDRBURGLARYINDEX,PREVADDRCARTHEFTINDEX,PREVADDRCOUNTYINDEX,PREVADDRCRIMEINDEX,PREVADDRLENOFRES,PREVADDRMEDIANINCOME,PREVADDRMEDIANVALUE,PREVADDRMURDERINDEX,PREVADDRTRACTINDEX,PROPAGENEWESTPURCHASE,PROPAGEOLDESTPURCHASE,PROPTAXPERRELATIVE,PRSEARCHLOCATECOUNT,PRSEARCHOTHERCOUNT,P_ESTIMATEDHHINCOMEPERCAPITA,P_TIME_FIRST_LAST_PURCHASE,RELATIVESCOUNT,RELATIVESPROPOWNEDTAXTOTAL,SEARCHADDRSEARCHCOUNT,SEARCHSSNSEARCHCOUNT,SFDUADDRIDENTITIESCOUNT_24,SFDUADDRSSNCOUNT,SOURCERISKLEVEL,SSNADDRCOUNT,SSNHIGHISSUEAGE,SSNISSUESTATE,SSNLOWISSUEAGE,SUBJECTADDRCOUNT,V1_CRTRECMSDMEANCNT,V1_CRTRECMSDMEANTIMENEWEST,V1_CRTRECTIMENEWEST,V1_HHPROPCURRAVMHIGHEST,V1_LIFEEVTIMEFIRSTASSETPURCHASE,V1_LIFEEVTIMELASTASSETPURCHASE,V1_LIFEEVTIMELASTMOVE,V1_PROPCURROWNEDASSESSEDTTL,V1_PROPCURROWNEDAVMTTL,V1_PROSPECTAGE,V1_PROSPECTTIMELASTUPDATE,V1_PROSPECTTIMEONRECORD,V1_RAACRTRECLIENJUDGAMTMAX,V1_RAACRTRECLIENJUDGMMBRCNT,V1_RAACRTRECMMBRCNT,V1_RAAMMBRCNT,V1_RAAPROPCURROWNERMMBRCNT,V1_RAAPROPOWNERAVMHIGHEST,V1_RAAPROPOWNERAVMMED,V1_RESCURRAVMBLOCKRATIO,V1_RESCURRAVMCNTYRATIO,V1_RESCURRAVMRATIODIFF60MO,V1_RESCURRAVMTRACTRATIO,V1_RESCURRAVMVALUE12MO,V1_RESCURRAVMVALUE60MO,V1_RESINPUTAVMCNTYRATIO,V1_RESINPUTAVMRATIODIFF60MO);
    BaseLayout TrModel1(BaseF le) := TRANSFORM
      SELF.TransactionId := le.TransactionId;
      SELF.name := 'Model1';
      SELF.description := 'MOT_SE_Model';
      SELF.Score := (STRING)le.Model1_Score;
      SELF.Messages := RCToMessage(le.Model1_Reasons);
    END;
    Model1AsBase := PROJECT(BaseF(do_Model1),TrModel1(LEFT));
  EXPORT Base() := Model1AsBase;
    // With attributes
  EXPORT AttrF := HCSE_SEMO_Model_V1_LUCI.AppendAll(myfile,do_Model1,ADDRMOSTRECENTCRIMEDIFF,ADDRMOSTRECENTDISTANCE,ADDRMOSTRECENTINCOMEDIFF,ADDRMOSTRECENTMOVEAGE,ADDRMOSTRECENTVALUEDIFF,ADDRRECENTECONTRAJECTORY,AGEOLDESTRECORD,AGE_IN_YEARS,AG_PRED_MOT,AVGSTATECOST,BP1,BP2,BPV1,BUSINESSINPUTADDRCOUNT,CORRELATIONRISKLEVEL,CURRADDRAGELASTSALE,CURRADDRAGEOLDESTRECORD,CURRADDRAVMVALUE,CURRADDRAVMVALUE12,CURRADDRAVMVALUE60,CURRADDRBURGLARYINDEX,CURRADDRBURGLARYINDEX_12,CURRADDRBURGLARYINDEX_24,CURRADDRCARTHEFTINDEX,CURRADDRCOUNTYINDEX,CURRADDRCRIMEINDEX,CURRADDRLENOFRES,CURRADDRMEDIANINCOME,CURRADDRMEDIANVALUE,CURRADDRMURDERINDEX,CURRADDRTRACTINDEX,DEROGAGE,DIVADDRIDENTITYCOUNT,DIVADDRIDENTITYMSOURCECOUNT,DIVADDRSSNCOUNT,DIVADDRSSNMSOURCECOUNT,DIVSSNADDRMSOURCECOUNT,ESTIMATEDANNUALINCOME,ESTIMATEDANNUALINCOME_12,ESTIMATEDANNUALINCOME_24,ESTINCOME0_1,ESTINCOME0_1_PCNT,ESTINCOME0_2,ESTINCOME0_2_PCNT,ESTINCOME1_2,FEMALE,INPUTADDRAGELASTSALE,INPUTADDRAGEOLDESTRECORD,INPUTADDRBURGLARYINDEX,INPUTADDRBUSINESSCOUNT,INPUTADDRCARTHEFTINDEX,INPUTADDRCRIMEINDEX,INPUTADDRLENOFRES,INPUTADDRMEDIANINCOME,INPUTADDRMEDIANVALUE,INPUTADDRMULTIFAMILYCOUNT,INPUTADDRMURDERINDEX,INPUTADDRPHONECOUNT,INPUTADDRTAXVALUE,INPUTADDRVACANTPROPCOUNT,INPUTPHONESERVICETYPE,LASTNAMECHANGEAGE,LIENFILEDAGE,NONDEROGCOUNT,PHONEEDAAGENEWESTRECORD,PHONEEDAAGEOLDESTRECORD,PHONEOTHERAGENEWESTRECORD,PHONEOTHERAGEOLDESTRECORD,PREVADDRAGELASTSALE,PREVADDRAGENEWESTRECORD,PREVADDRAGEOLDESTRECORD,PREVADDRAVMVALUE,PREVADDRBLOCKINDEX,PREVADDRBURGLARYINDEX,PREVADDRCARTHEFTINDEX,PREVADDRCOUNTYINDEX,PREVADDRCRIMEINDEX,PREVADDRLENOFRES,PREVADDRMEDIANINCOME,PREVADDRMEDIANVALUE,PREVADDRMURDERINDEX,PREVADDRTRACTINDEX,PROPAGENEWESTPURCHASE,PROPAGEOLDESTPURCHASE,PROPTAXPERRELATIVE,PRSEARCHLOCATECOUNT,PRSEARCHOTHERCOUNT,P_ESTIMATEDHHINCOMEPERCAPITA,P_TIME_FIRST_LAST_PURCHASE,RELATIVESCOUNT,RELATIVESPROPOWNEDTAXTOTAL,SEARCHADDRSEARCHCOUNT,SEARCHSSNSEARCHCOUNT,SFDUADDRIDENTITIESCOUNT_24,SFDUADDRSSNCOUNT,SOURCERISKLEVEL,SSNADDRCOUNT,SSNHIGHISSUEAGE,SSNISSUESTATE,SSNLOWISSUEAGE,SUBJECTADDRCOUNT,V1_CRTRECMSDMEANCNT,V1_CRTRECMSDMEANTIMENEWEST,V1_CRTRECTIMENEWEST,V1_HHPROPCURRAVMHIGHEST,V1_LIFEEVTIMEFIRSTASSETPURCHASE,V1_LIFEEVTIMELASTASSETPURCHASE,V1_LIFEEVTIMELASTMOVE,V1_PROPCURROWNEDASSESSEDTTL,V1_PROPCURROWNEDAVMTTL,V1_PROSPECTAGE,V1_PROSPECTTIMELASTUPDATE,V1_PROSPECTTIMEONRECORD,V1_RAACRTRECLIENJUDGAMTMAX,V1_RAACRTRECLIENJUDGMMBRCNT,V1_RAACRTRECMMBRCNT,V1_RAAMMBRCNT,V1_RAAPROPCURROWNERMMBRCNT,V1_RAAPROPOWNERAVMHIGHEST,V1_RAAPROPOWNERAVMMED,V1_RESCURRAVMBLOCKRATIO,V1_RESCURRAVMCNTYRATIO,V1_RESCURRAVMRATIODIFF60MO,V1_RESCURRAVMTRACTRATIO,V1_RESCURRAVMVALUE12MO,V1_RESCURRAVMVALUE60MO,V1_RESINPUTAVMCNTYRATIO,V1_RESINPUTAVMRATIODIFF60MO);
    AttrLayout TrModel1(AttrF le) := TRANSFORM
      SELF.TransactionId := le.TransactionId;
      SELF.name := 'Model1';
      SELF.description := 'MOT_SE_Model';
      SELF.Score := (STRING)le.Model1_Score;
      SELF.Messages := RCToMessage(le.Model1_Reasons);
      SELF.Attributes := DATASET([
          {'PHONEOTHERAGEOLDESTRECORD',le.PHONEOTHERAGEOLDESTRECORD},
          {'PHONEEDAAGENEWESTRECORD',le.PHONEEDAAGENEWESTRECORD},
          {'RELATIVESPROPOWNEDTAXTOTAL',le.RELATIVESPROPOWNEDTAXTOTAL},
          {'INPUTADDRBUSINESSCOUNT',le.INPUTADDRBUSINESSCOUNT},
          {'PREVADDRCOUNTYINDEX',le.PREVADDRCOUNTYINDEX},
          {'V1_PROSPECTAGE',le.V1_PROSPECTAGE},
          {'SSNISSUESTATE',le.SSNISSUESTATE},
          {'DIVADDRIDENTITYCOUNT',le.DIVADDRIDENTITYCOUNT},
          {'ESTIMATEDANNUALINCOME_24',le.ESTIMATEDANNUALINCOME_24},
          {'V1_RAACRTRECLIENJUDGAMTMAX',le.V1_RAACRTRECLIENJUDGAMTMAX},
          {'LIENFILEDAGE',le.LIENFILEDAGE},
          {'PREVADDRAGENEWESTRECORD',le.PREVADDRAGENEWESTRECORD},
          {'V1_RESCURRAVMVALUE12MO',le.V1_RESCURRAVMVALUE12MO},
          {'SSNHIGHISSUEAGE',le.SSNHIGHISSUEAGE},
          {'ESTINCOME1_2',le.ESTINCOME1_2},
          {'PROPAGEOLDESTPURCHASE',le.PROPAGEOLDESTPURCHASE},
          {'PREVADDRMEDIANVALUE',le.PREVADDRMEDIANVALUE},
          {'DIVADDRIDENTITYMSOURCECOUNT',le.DIVADDRIDENTITYMSOURCECOUNT},
          {'CURRADDRCRIMEINDEX',le.CURRADDRCRIMEINDEX},
          {'V1_RAAMMBRCNT',le.V1_RAAMMBRCNT},
          {'PREVADDRAGEOLDESTRECORD',le.PREVADDRAGEOLDESTRECORD},
          {'PREVADDRCARTHEFTINDEX',le.PREVADDRCARTHEFTINDEX},
          {'ESTIMATEDANNUALINCOME',le.ESTIMATEDANNUALINCOME},
          {'PREVADDRTRACTINDEX',le.PREVADDRTRACTINDEX},
          {'ESTIMATEDANNUALINCOME_12',le.ESTIMATEDANNUALINCOME_12},
          {'ADDRMOSTRECENTVALUEDIFF',le.ADDRMOSTRECENTVALUEDIFF},
          {'FEMALE',le.FEMALE},
          {'SUBJECTADDRCOUNT',le.SUBJECTADDRCOUNT},
          {'V1_RESINPUTAVMRATIODIFF60MO',le.V1_RESINPUTAVMRATIODIFF60MO},
          {'V1_CRTRECMSDMEANTIMENEWEST',le.V1_CRTRECMSDMEANTIMENEWEST},
          {'V1_PROPCURROWNEDAVMTTL',le.V1_PROPCURROWNEDAVMTTL},
          {'INPUTADDRCARTHEFTINDEX',le.INPUTADDRCARTHEFTINDEX},
          {'PREVADDRAGELASTSALE',le.PREVADDRAGELASTSALE},
          {'BUSINESSINPUTADDRCOUNT',le.BUSINESSINPUTADDRCOUNT},
          {'PHONEOTHERAGENEWESTRECORD',le.PHONEOTHERAGENEWESTRECORD},
          {'CURRADDRAGEOLDESTRECORD',le.CURRADDRAGEOLDESTRECORD},
          {'SFDUADDRSSNCOUNT',le.SFDUADDRSSNCOUNT},
          {'AGE_IN_YEARS',le.AGE_IN_YEARS},
          {'CURRADDRBURGLARYINDEX',le.CURRADDRBURGLARYINDEX},
          {'V1_RAAPROPOWNERAVMHIGHEST',le.V1_RAAPROPOWNERAVMHIGHEST},
          {'V1_RESCURRAVMRATIODIFF60MO',le.V1_RESCURRAVMRATIODIFF60MO},
          {'SSNADDRCOUNT',le.SSNADDRCOUNT},
          {'P_ESTIMATEDHHINCOMEPERCAPITA',le.P_ESTIMATEDHHINCOMEPERCAPITA},
          {'CURRADDRCOUNTYINDEX',le.CURRADDRCOUNTYINDEX},
          {'V1_RAAPROPOWNERAVMMED',le.V1_RAAPROPOWNERAVMMED},
          {'PRSEARCHLOCATECOUNT',le.PRSEARCHLOCATECOUNT},
          {'CORRELATIONRISKLEVEL',le.CORRELATIONRISKLEVEL},
          {'DIVADDRSSNMSOURCECOUNT',le.DIVADDRSSNMSOURCECOUNT},
          {'AVGSTATECOST',le.AVGSTATECOST},
          {'ESTINCOME0_2_PCNT',le.ESTINCOME0_2_PCNT},
          {'AG_PRED_MOT',le.AG_PRED_MOT},
          {'ESTINCOME0_2',le.ESTINCOME0_2},
          {'CURRADDRLENOFRES',le.CURRADDRLENOFRES},
          {'ESTINCOME0_1',le.ESTINCOME0_1},
          {'ADDRMOSTRECENTINCOMEDIFF',le.ADDRMOSTRECENTINCOMEDIFF},
          {'V1_RAACRTRECMMBRCNT',le.V1_RAACRTRECMMBRCNT},
          {'V1_LIFEEVTIMELASTMOVE',le.V1_LIFEEVTIMELASTMOVE},
          {'PRSEARCHOTHERCOUNT',le.PRSEARCHOTHERCOUNT},
          {'CURRADDRMEDIANVALUE',le.CURRADDRMEDIANVALUE},
          {'INPUTADDRCRIMEINDEX',le.INPUTADDRCRIMEINDEX},
          {'SEARCHADDRSEARCHCOUNT',le.SEARCHADDRSEARCHCOUNT},
          {'CURRADDRAVMVALUE60',le.CURRADDRAVMVALUE60},
          {'V1_LIFEEVTIMELASTASSETPURCHASE',le.V1_LIFEEVTIMELASTASSETPURCHASE},
          {'V1_CRTRECTIMENEWEST',le.V1_CRTRECTIMENEWEST},
          {'PREVADDRLENOFRES',le.PREVADDRLENOFRES},
          {'BPV1',le.BPV1},
          {'CURRADDRTRACTINDEX',le.CURRADDRTRACTINDEX},
          {'DIVSSNADDRMSOURCECOUNT',le.DIVSSNADDRMSOURCECOUNT},
          {'CURRADDRMEDIANINCOME',le.CURRADDRMEDIANINCOME},
          {'CURRADDRMURDERINDEX',le.CURRADDRMURDERINDEX},
          {'PREVADDRAVMVALUE',le.PREVADDRAVMVALUE},
          {'SOURCERISKLEVEL',le.SOURCERISKLEVEL},
          {'V1_RESINPUTAVMCNTYRATIO',le.V1_RESINPUTAVMCNTYRATIO},
          {'SSNLOWISSUEAGE',le.SSNLOWISSUEAGE},
          {'INPUTADDRAGELASTSALE',le.INPUTADDRAGELASTSALE},
          {'V1_PROPCURROWNEDASSESSEDTTL',le.V1_PROPCURROWNEDASSESSEDTTL},
          {'BP1',le.BP1},
          {'ADDRMOSTRECENTDISTANCE',le.ADDRMOSTRECENTDISTANCE},
          {'V1_LIFEEVTIMEFIRSTASSETPURCHASE',le.V1_LIFEEVTIMEFIRSTASSETPURCHASE},
          {'BP2',le.BP2},
          {'ADDRMOSTRECENTCRIMEDIFF',le.ADDRMOSTRECENTCRIMEDIFF},
          {'PREVADDRBURGLARYINDEX',le.PREVADDRBURGLARYINDEX},
          {'INPUTADDRBURGLARYINDEX',le.INPUTADDRBURGLARYINDEX},
          {'CURRADDRAVMVALUE',le.CURRADDRAVMVALUE},
          {'V1_RESCURRAVMBLOCKRATIO',le.V1_RESCURRAVMBLOCKRATIO},
          {'INPUTADDRMEDIANVALUE',le.INPUTADDRMEDIANVALUE},
          {'CURRADDRAGELASTSALE',le.CURRADDRAGELASTSALE},
          {'INPUTADDRVACANTPROPCOUNT',le.INPUTADDRVACANTPROPCOUNT},
          {'PREVADDRBLOCKINDEX',le.PREVADDRBLOCKINDEX},
          {'ESTINCOME0_1_PCNT',le.ESTINCOME0_1_PCNT},
          {'RELATIVESCOUNT',le.RELATIVESCOUNT},
          {'V1_RESCURRAVMVALUE60MO',le.V1_RESCURRAVMVALUE60MO},
          {'V1_HHPROPCURRAVMHIGHEST',le.V1_HHPROPCURRAVMHIGHEST},
          {'CURRADDRBURGLARYINDEX_12',le.CURRADDRBURGLARYINDEX_12},
          {'INPUTADDRMEDIANINCOME',le.INPUTADDRMEDIANINCOME},
          {'INPUTPHONESERVICETYPE',le.INPUTPHONESERVICETYPE},
          {'INPUTADDRPHONECOUNT',le.INPUTADDRPHONECOUNT},
          {'PROPAGENEWESTPURCHASE',le.PROPAGENEWESTPURCHASE},
          {'CURRADDRAVMVALUE12',le.CURRADDRAVMVALUE12},
          {'ADDRMOSTRECENTMOVEAGE',le.ADDRMOSTRECENTMOVEAGE},
          {'PREVADDRMURDERINDEX',le.PREVADDRMURDERINDEX},
          {'INPUTADDRAGEOLDESTRECORD',le.INPUTADDRAGEOLDESTRECORD},
          {'V1_RAACRTRECLIENJUDGMMBRCNT',le.V1_RAACRTRECLIENJUDGMMBRCNT},
          {'DIVADDRSSNCOUNT',le.DIVADDRSSNCOUNT},
          {'V1_RESCURRAVMCNTYRATIO',le.V1_RESCURRAVMCNTYRATIO},
          {'CURRADDRCARTHEFTINDEX',le.CURRADDRCARTHEFTINDEX},
          {'PREVADDRCRIMEINDEX',le.PREVADDRCRIMEINDEX},
          {'V1_RESCURRAVMTRACTRATIO',le.V1_RESCURRAVMTRACTRATIO},
          {'INPUTADDRLENOFRES',le.INPUTADDRLENOFRES},
          {'INPUTADDRMURDERINDEX',le.INPUTADDRMURDERINDEX},
          {'PHONEEDAAGEOLDESTRECORD',le.PHONEEDAAGEOLDESTRECORD},
          {'V1_CRTRECMSDMEANCNT',le.V1_CRTRECMSDMEANCNT},
          {'P_TIME_FIRST_LAST_PURCHASE',le.P_TIME_FIRST_LAST_PURCHASE},
          {'CURRADDRBURGLARYINDEX_24',le.CURRADDRBURGLARYINDEX_24},
          {'V1_PROSPECTTIMEONRECORD',le.V1_PROSPECTTIMEONRECORD},
          {'SEARCHSSNSEARCHCOUNT',le.SEARCHSSNSEARCHCOUNT},
          {'V1_PROSPECTTIMELASTUPDATE',le.V1_PROSPECTTIMELASTUPDATE},
          {'SFDUADDRIDENTITIESCOUNT_24',le.SFDUADDRIDENTITIESCOUNT_24},
          {'DEROGAGE',le.DEROGAGE},
          {'INPUTADDRMULTIFAMILYCOUNT',le.INPUTADDRMULTIFAMILYCOUNT},
          {'AGEOLDESTRECORD',le.AGEOLDESTRECORD},
          {'PREVADDRMEDIANINCOME',le.PREVADDRMEDIANINCOME},
          {'ADDRRECENTECONTRAJECTORY',le.ADDRRECENTECONTRAJECTORY},
          {'PROPTAXPERRELATIVE',le.PROPTAXPERRELATIVE},
          {'NONDEROGCOUNT',le.NONDEROGCOUNT},
          {'INPUTADDRTAXVALUE',le.INPUTADDRTAXVALUE},
          {'LASTNAMECHANGEAGE',le.LASTNAMECHANGEAGE},
          {'V1_RAAPROPCURROWNERMMBRCNT',le.V1_RAAPROPCURROWNERMMBRCNT}],NVPair);
    END;
    Model1AsAttr := PROJECT(AttrF(do_Model1),TrModel1(LEFT));
  EXPORT Attr() := Model1AsAttr;
    // Validation
  EXPORT ValidationF := HCSE_SEMO_Model_V1_LUCI.AppendAll_Debug(myfile,do_Model1,ADDRMOSTRECENTCRIMEDIFF,ADDRMOSTRECENTDISTANCE,ADDRMOSTRECENTINCOMEDIFF,ADDRMOSTRECENTMOVEAGE,ADDRMOSTRECENTVALUEDIFF,ADDRRECENTECONTRAJECTORY,AGEOLDESTRECORD,AGE_IN_YEARS,AG_PRED_MOT,AVGSTATECOST,BP1,BP2,BPV1,BUSINESSINPUTADDRCOUNT,CORRELATIONRISKLEVEL,CURRADDRAGELASTSALE,CURRADDRAGEOLDESTRECORD,CURRADDRAVMVALUE,CURRADDRAVMVALUE12,CURRADDRAVMVALUE60,CURRADDRBURGLARYINDEX,CURRADDRBURGLARYINDEX_12,CURRADDRBURGLARYINDEX_24,CURRADDRCARTHEFTINDEX,CURRADDRCOUNTYINDEX,CURRADDRCRIMEINDEX,CURRADDRLENOFRES,CURRADDRMEDIANINCOME,CURRADDRMEDIANVALUE,CURRADDRMURDERINDEX,CURRADDRTRACTINDEX,DEROGAGE,DIVADDRIDENTITYCOUNT,DIVADDRIDENTITYMSOURCECOUNT,DIVADDRSSNCOUNT,DIVADDRSSNMSOURCECOUNT,DIVSSNADDRMSOURCECOUNT,ESTIMATEDANNUALINCOME,ESTIMATEDANNUALINCOME_12,ESTIMATEDANNUALINCOME_24,ESTINCOME0_1,ESTINCOME0_1_PCNT,ESTINCOME0_2,ESTINCOME0_2_PCNT,ESTINCOME1_2,FEMALE,INPUTADDRAGELASTSALE,INPUTADDRAGEOLDESTRECORD,INPUTADDRBURGLARYINDEX,INPUTADDRBUSINESSCOUNT,INPUTADDRCARTHEFTINDEX,INPUTADDRCRIMEINDEX,INPUTADDRLENOFRES,INPUTADDRMEDIANINCOME,INPUTADDRMEDIANVALUE,INPUTADDRMULTIFAMILYCOUNT,INPUTADDRMURDERINDEX,INPUTADDRPHONECOUNT,INPUTADDRTAXVALUE,INPUTADDRVACANTPROPCOUNT,INPUTPHONESERVICETYPE,LASTNAMECHANGEAGE,LIENFILEDAGE,NONDEROGCOUNT,PHONEEDAAGENEWESTRECORD,PHONEEDAAGEOLDESTRECORD,PHONEOTHERAGENEWESTRECORD,PHONEOTHERAGEOLDESTRECORD,PREVADDRAGELASTSALE,PREVADDRAGENEWESTRECORD,PREVADDRAGEOLDESTRECORD,PREVADDRAVMVALUE,PREVADDRBLOCKINDEX,PREVADDRBURGLARYINDEX,PREVADDRCARTHEFTINDEX,PREVADDRCOUNTYINDEX,PREVADDRCRIMEINDEX,PREVADDRLENOFRES,PREVADDRMEDIANINCOME,PREVADDRMEDIANVALUE,PREVADDRMURDERINDEX,PREVADDRTRACTINDEX,PROPAGENEWESTPURCHASE,PROPAGEOLDESTPURCHASE,PROPTAXPERRELATIVE,PRSEARCHLOCATECOUNT,PRSEARCHOTHERCOUNT,P_ESTIMATEDHHINCOMEPERCAPITA,P_TIME_FIRST_LAST_PURCHASE,RELATIVESCOUNT,RELATIVESPROPOWNEDTAXTOTAL,SEARCHADDRSEARCHCOUNT,SEARCHSSNSEARCHCOUNT,SFDUADDRIDENTITIESCOUNT_24,SFDUADDRSSNCOUNT,SOURCERISKLEVEL,SSNADDRCOUNT,SSNHIGHISSUEAGE,SSNISSUESTATE,SSNLOWISSUEAGE,SUBJECTADDRCOUNT,V1_CRTRECMSDMEANCNT,V1_CRTRECMSDMEANTIMENEWEST,V1_CRTRECTIMENEWEST,V1_HHPROPCURRAVMHIGHEST,V1_LIFEEVTIMEFIRSTASSETPURCHASE,V1_LIFEEVTIMELASTASSETPURCHASE,V1_LIFEEVTIMELASTMOVE,V1_PROPCURROWNEDASSESSEDTTL,V1_PROPCURROWNEDAVMTTL,V1_PROSPECTAGE,V1_PROSPECTTIMELASTUPDATE,V1_PROSPECTTIMEONRECORD,V1_RAACRTRECLIENJUDGAMTMAX,V1_RAACRTRECLIENJUDGMMBRCNT,V1_RAACRTRECMMBRCNT,V1_RAAMMBRCNT,V1_RAAPROPCURROWNERMMBRCNT,V1_RAAPROPOWNERAVMHIGHEST,V1_RAAPROPOWNERAVMMED,V1_RESCURRAVMBLOCKRATIO,V1_RESCURRAVMCNTYRATIO,V1_RESCURRAVMRATIODIFF60MO,V1_RESCURRAVMTRACTRATIO,V1_RESCURRAVMVALUE12MO,V1_RESCURRAVMVALUE60MO,V1_RESINPUTAVMCNTYRATIO,V1_RESINPUTAVMRATIODIFF60MO);
    ValidationLayout TrModel1(ValidationF le) := TRANSFORM
      SELF.TransactionId := le.TransactionId;
      SELF.name := 'Model1';
      SELF.description := 'MOT_SE_Model';
      SELF.Score := (STRING)le.Model1_Score;
      SELF.Messages := RCToMessage(le.Model1_Reasons);
      SELF.Attributes := DATASET([
          {'PHONEOTHERAGEOLDESTRECORD',le.PHONEOTHERAGEOLDESTRECORD},
          {'PHONEEDAAGENEWESTRECORD',le.PHONEEDAAGENEWESTRECORD},
          {'RELATIVESPROPOWNEDTAXTOTAL',le.RELATIVESPROPOWNEDTAXTOTAL},
          {'INPUTADDRBUSINESSCOUNT',le.INPUTADDRBUSINESSCOUNT},
          {'PREVADDRCOUNTYINDEX',le.PREVADDRCOUNTYINDEX},
          {'V1_PROSPECTAGE',le.V1_PROSPECTAGE},
          {'SSNISSUESTATE',le.SSNISSUESTATE},
          {'DIVADDRIDENTITYCOUNT',le.DIVADDRIDENTITYCOUNT},
          {'ESTIMATEDANNUALINCOME_24',le.ESTIMATEDANNUALINCOME_24},
          {'V1_RAACRTRECLIENJUDGAMTMAX',le.V1_RAACRTRECLIENJUDGAMTMAX},
          {'LIENFILEDAGE',le.LIENFILEDAGE},
          {'PREVADDRAGENEWESTRECORD',le.PREVADDRAGENEWESTRECORD},
          {'V1_RESCURRAVMVALUE12MO',le.V1_RESCURRAVMVALUE12MO},
          {'SSNHIGHISSUEAGE',le.SSNHIGHISSUEAGE},
          {'ESTINCOME1_2',le.ESTINCOME1_2},
          {'PROPAGEOLDESTPURCHASE',le.PROPAGEOLDESTPURCHASE},
          {'PREVADDRMEDIANVALUE',le.PREVADDRMEDIANVALUE},
          {'DIVADDRIDENTITYMSOURCECOUNT',le.DIVADDRIDENTITYMSOURCECOUNT},
          {'CURRADDRCRIMEINDEX',le.CURRADDRCRIMEINDEX},
          {'V1_RAAMMBRCNT',le.V1_RAAMMBRCNT},
          {'PREVADDRAGEOLDESTRECORD',le.PREVADDRAGEOLDESTRECORD},
          {'PREVADDRCARTHEFTINDEX',le.PREVADDRCARTHEFTINDEX},
          {'ESTIMATEDANNUALINCOME',le.ESTIMATEDANNUALINCOME},
          {'PREVADDRTRACTINDEX',le.PREVADDRTRACTINDEX},
          {'ESTIMATEDANNUALINCOME_12',le.ESTIMATEDANNUALINCOME_12},
          {'ADDRMOSTRECENTVALUEDIFF',le.ADDRMOSTRECENTVALUEDIFF},
          {'FEMALE',le.FEMALE},
          {'SUBJECTADDRCOUNT',le.SUBJECTADDRCOUNT},
          {'V1_RESINPUTAVMRATIODIFF60MO',le.V1_RESINPUTAVMRATIODIFF60MO},
          {'V1_CRTRECMSDMEANTIMENEWEST',le.V1_CRTRECMSDMEANTIMENEWEST},
          {'V1_PROPCURROWNEDAVMTTL',le.V1_PROPCURROWNEDAVMTTL},
          {'INPUTADDRCARTHEFTINDEX',le.INPUTADDRCARTHEFTINDEX},
          {'PREVADDRAGELASTSALE',le.PREVADDRAGELASTSALE},
          {'BUSINESSINPUTADDRCOUNT',le.BUSINESSINPUTADDRCOUNT},
          {'PHONEOTHERAGENEWESTRECORD',le.PHONEOTHERAGENEWESTRECORD},
          {'CURRADDRAGEOLDESTRECORD',le.CURRADDRAGEOLDESTRECORD},
          {'SFDUADDRSSNCOUNT',le.SFDUADDRSSNCOUNT},
          {'AGE_IN_YEARS',le.AGE_IN_YEARS},
          {'CURRADDRBURGLARYINDEX',le.CURRADDRBURGLARYINDEX},
          {'V1_RAAPROPOWNERAVMHIGHEST',le.V1_RAAPROPOWNERAVMHIGHEST},
          {'V1_RESCURRAVMRATIODIFF60MO',le.V1_RESCURRAVMRATIODIFF60MO},
          {'SSNADDRCOUNT',le.SSNADDRCOUNT},
          {'P_ESTIMATEDHHINCOMEPERCAPITA',le.P_ESTIMATEDHHINCOMEPERCAPITA},
          {'CURRADDRCOUNTYINDEX',le.CURRADDRCOUNTYINDEX},
          {'V1_RAAPROPOWNERAVMMED',le.V1_RAAPROPOWNERAVMMED},
          {'PRSEARCHLOCATECOUNT',le.PRSEARCHLOCATECOUNT},
          {'CORRELATIONRISKLEVEL',le.CORRELATIONRISKLEVEL},
          {'DIVADDRSSNMSOURCECOUNT',le.DIVADDRSSNMSOURCECOUNT},
          {'AVGSTATECOST',le.AVGSTATECOST},
          {'ESTINCOME0_2_PCNT',le.ESTINCOME0_2_PCNT},
          {'AG_PRED_MOT',le.AG_PRED_MOT},
          {'ESTINCOME0_2',le.ESTINCOME0_2},
          {'CURRADDRLENOFRES',le.CURRADDRLENOFRES},
          {'ESTINCOME0_1',le.ESTINCOME0_1},
          {'ADDRMOSTRECENTINCOMEDIFF',le.ADDRMOSTRECENTINCOMEDIFF},
          {'V1_RAACRTRECMMBRCNT',le.V1_RAACRTRECMMBRCNT},
          {'V1_LIFEEVTIMELASTMOVE',le.V1_LIFEEVTIMELASTMOVE},
          {'PRSEARCHOTHERCOUNT',le.PRSEARCHOTHERCOUNT},
          {'CURRADDRMEDIANVALUE',le.CURRADDRMEDIANVALUE},
          {'INPUTADDRCRIMEINDEX',le.INPUTADDRCRIMEINDEX},
          {'SEARCHADDRSEARCHCOUNT',le.SEARCHADDRSEARCHCOUNT},
          {'CURRADDRAVMVALUE60',le.CURRADDRAVMVALUE60},
          {'V1_LIFEEVTIMELASTASSETPURCHASE',le.V1_LIFEEVTIMELASTASSETPURCHASE},
          {'V1_CRTRECTIMENEWEST',le.V1_CRTRECTIMENEWEST},
          {'PREVADDRLENOFRES',le.PREVADDRLENOFRES},
          {'BPV1',le.BPV1},
          {'CURRADDRTRACTINDEX',le.CURRADDRTRACTINDEX},
          {'DIVSSNADDRMSOURCECOUNT',le.DIVSSNADDRMSOURCECOUNT},
          {'CURRADDRMEDIANINCOME',le.CURRADDRMEDIANINCOME},
          {'CURRADDRMURDERINDEX',le.CURRADDRMURDERINDEX},
          {'PREVADDRAVMVALUE',le.PREVADDRAVMVALUE},
          {'SOURCERISKLEVEL',le.SOURCERISKLEVEL},
          {'V1_RESINPUTAVMCNTYRATIO',le.V1_RESINPUTAVMCNTYRATIO},
          {'SSNLOWISSUEAGE',le.SSNLOWISSUEAGE},
          {'INPUTADDRAGELASTSALE',le.INPUTADDRAGELASTSALE},
          {'V1_PROPCURROWNEDASSESSEDTTL',le.V1_PROPCURROWNEDASSESSEDTTL},
          {'BP1',le.BP1},
          {'ADDRMOSTRECENTDISTANCE',le.ADDRMOSTRECENTDISTANCE},
          {'V1_LIFEEVTIMEFIRSTASSETPURCHASE',le.V1_LIFEEVTIMEFIRSTASSETPURCHASE},
          {'BP2',le.BP2},
          {'ADDRMOSTRECENTCRIMEDIFF',le.ADDRMOSTRECENTCRIMEDIFF},
          {'PREVADDRBURGLARYINDEX',le.PREVADDRBURGLARYINDEX},
          {'INPUTADDRBURGLARYINDEX',le.INPUTADDRBURGLARYINDEX},
          {'CURRADDRAVMVALUE',le.CURRADDRAVMVALUE},
          {'V1_RESCURRAVMBLOCKRATIO',le.V1_RESCURRAVMBLOCKRATIO},
          {'INPUTADDRMEDIANVALUE',le.INPUTADDRMEDIANVALUE},
          {'CURRADDRAGELASTSALE',le.CURRADDRAGELASTSALE},
          {'INPUTADDRVACANTPROPCOUNT',le.INPUTADDRVACANTPROPCOUNT},
          {'PREVADDRBLOCKINDEX',le.PREVADDRBLOCKINDEX},
          {'ESTINCOME0_1_PCNT',le.ESTINCOME0_1_PCNT},
          {'RELATIVESCOUNT',le.RELATIVESCOUNT},
          {'V1_RESCURRAVMVALUE60MO',le.V1_RESCURRAVMVALUE60MO},
          {'V1_HHPROPCURRAVMHIGHEST',le.V1_HHPROPCURRAVMHIGHEST},
          {'CURRADDRBURGLARYINDEX_12',le.CURRADDRBURGLARYINDEX_12},
          {'INPUTADDRMEDIANINCOME',le.INPUTADDRMEDIANINCOME},
          {'INPUTPHONESERVICETYPE',le.INPUTPHONESERVICETYPE},
          {'INPUTADDRPHONECOUNT',le.INPUTADDRPHONECOUNT},
          {'PROPAGENEWESTPURCHASE',le.PROPAGENEWESTPURCHASE},
          {'CURRADDRAVMVALUE12',le.CURRADDRAVMVALUE12},
          {'ADDRMOSTRECENTMOVEAGE',le.ADDRMOSTRECENTMOVEAGE},
          {'PREVADDRMURDERINDEX',le.PREVADDRMURDERINDEX},
          {'INPUTADDRAGEOLDESTRECORD',le.INPUTADDRAGEOLDESTRECORD},
          {'V1_RAACRTRECLIENJUDGMMBRCNT',le.V1_RAACRTRECLIENJUDGMMBRCNT},
          {'DIVADDRSSNCOUNT',le.DIVADDRSSNCOUNT},
          {'V1_RESCURRAVMCNTYRATIO',le.V1_RESCURRAVMCNTYRATIO},
          {'CURRADDRCARTHEFTINDEX',le.CURRADDRCARTHEFTINDEX},
          {'PREVADDRCRIMEINDEX',le.PREVADDRCRIMEINDEX},
          {'V1_RESCURRAVMTRACTRATIO',le.V1_RESCURRAVMTRACTRATIO},
          {'INPUTADDRLENOFRES',le.INPUTADDRLENOFRES},
          {'INPUTADDRMURDERINDEX',le.INPUTADDRMURDERINDEX},
          {'PHONEEDAAGEOLDESTRECORD',le.PHONEEDAAGEOLDESTRECORD},
          {'V1_CRTRECMSDMEANCNT',le.V1_CRTRECMSDMEANCNT},
          {'P_TIME_FIRST_LAST_PURCHASE',le.P_TIME_FIRST_LAST_PURCHASE},
          {'CURRADDRBURGLARYINDEX_24',le.CURRADDRBURGLARYINDEX_24},
          {'V1_PROSPECTTIMEONRECORD',le.V1_PROSPECTTIMEONRECORD},
          {'SEARCHSSNSEARCHCOUNT',le.SEARCHSSNSEARCHCOUNT},
          {'V1_PROSPECTTIMELASTUPDATE',le.V1_PROSPECTTIMELASTUPDATE},
          {'SFDUADDRIDENTITIESCOUNT_24',le.SFDUADDRIDENTITIESCOUNT_24},
          {'DEROGAGE',le.DEROGAGE},
          {'INPUTADDRMULTIFAMILYCOUNT',le.INPUTADDRMULTIFAMILYCOUNT},
          {'AGEOLDESTRECORD',le.AGEOLDESTRECORD},
          {'PREVADDRMEDIANINCOME',le.PREVADDRMEDIANINCOME},
          {'ADDRRECENTECONTRAJECTORY',le.ADDRRECENTECONTRAJECTORY},
          {'PROPTAXPERRELATIVE',le.PROPTAXPERRELATIVE},
          {'NONDEROGCOUNT',le.NONDEROGCOUNT},
          {'INPUTADDRTAXVALUE',le.INPUTADDRTAXVALUE},
          {'LASTNAMECHANGEAGE',le.LASTNAMECHANGEAGE},
          {'V1_RAAPROPCURROWNERMMBRCNT',le.V1_RAAPROPCURROWNERMMBRCNT}],NVPair);
      SELF.ScoreCard := 'Score1';
      SELF.score_date := StringLib.GetDateYYYYMMDD();
      SELF.raw_score := le.Model1_Score1_Score0;
      SELF.calc_temp_score := le.Model1_Score1_Score;
      SELF.INSUFFICIENT_INFO := FALSE; // Insufficient_Info* not found
      SELF.NO_HIT := FALSE; // No_Hit* not found
      SELF.reason_codes_base := DATASET([],RC_Contributions_Layout);
    END;
    Model1AsValidation := PROJECT(ValidationF(do_Model1),TrModel1(LEFT));
  EXPORT Validation() := Model1AsValidation;
// Now compute some statistics
  Accum := RECORD
    TotalProcessed := COUNT(GROUP);
    Model1_sc_Score1 := COUNT(GROUP,ValidationF.Model1_sc = 1);
  END;
  EXPORT StatsF := TABLE(ValidationF,Accum);
  EXPORT Stats() := DATASET([{'ADR Report','','','',0,0,0,'',0,0,'',0,0}
    ,{'Model1','MOT_SE_Model','Score1','',0,0,0,'',0,0,'',StatsF[1].Model1_sc_Score1,100*StatsF[1].Model1_sc_Score1/StatsF[1].TotalProcessed}
    ],LUCI.Results.StatsLayout);
  END;
  RETURN res(infile);
ENDMACRO;
