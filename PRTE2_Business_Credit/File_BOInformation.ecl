import prte2_business_credit, BIPV2, Address;

layouts.BOInformation 	xformBOInformation(files.basefile L) := transform
		self.powid															:= L.powid;
		self.proxid															:= L.proxid;
		self.seleid															:= L.seleid;
		self.orgid															:= L.orgid;
		self.ultid															:= L.ultid;
		self.Version														:= L.process_date;
		self.Original_Version										:= L.process_date;
		self.record_type												:= L.BusinessOwner_Segment_Identifier;
		self.Sbfe_Contributor_Number						:= L.Header_Sbfe_Contributor_Number;
		self.Contract_Account_Number						:= L.Contract_Account_Number;
		self.Original_Contract_Account_Number		:= L.Original_Contract_Account_Number;
		self.Account_Type_Reported							:= L.account_type_reported; //003
		self.dt_first_seen											:= L.dt_first_seen;
		self.dt_last_seen												:= L.dt_last_seen;
		self.dt_vendor_first_reported						:= L.dt_vendor_first_reported;	
		self.dt_vendor_last_reported						:= L.dt_vendor_last_reported;
		self.dt_datawarehouse_first_reported		:= L.dt_datawarehouse_first_reported;
		self.dt_datawarehouse_last_reported			:= L.dt_datawarehouse_last_reported;
		self.Account_Holder_Business_Name				:= L.Account_Holder_Business_Name;
		self.Clean_Account_Holder_Business_Name	:= L.Account_Holder_Business_Name;
		self.DBA																:= L.DBA;
		self.Clean_DBA													:= L.DBA;
		self.Business_Name											:= L.Account_Holder_Business_Name;
		self.Clean_Business_Name								:= L.Account_Holder_Business_Name;
		self.Company_Website										:= L.company_website;
		self.Guarantor_Owner_Indicator					:= L.BusinessOwner_Guarantor_Owner_Indicator	;
		self.Relationship_To_Business_Indicator	:= L.BusinessOwner_Relationship_To_Business_Indicator;
		self.Percent_Of_Liability								:= L.BusinessOwner_Percent_Of_Liability;
		self.Percent_Of_Ownership_If_Owner_Principal := L.BusinessOwner_Percent_Of_Ownership_If_Owner_Principal;;
		self.Original_Address_Line_1						:= L.BusinessOwner_Address_Line_1;
		self.Original_Address_Line_2						:= L.BusinessOwner_Address_Line_2;
		self.Original_City											:= L.BusinessOwner_Address_City;
		self.Original_State											:= L.BusinessOwner_Address_State;
		self.Original_Zip_Code_or_CA_Postal_Code := L.BusinessOwner_Address_Zip_Code_or_CA_Postal_Code;
		self.Original_Postal_Code								:= L.BusinessOwner_Address_Postal_Code;
		self.Original_Country_Code							:= L.BusinessOwner_Address_Country_Code;
		self.Primary_Address_Indicator					:= L.BusinessOwner_Address_Primary_Address_Indicator;
		self.Address_Classification							:= L.BusinessOwner_Address_Address_Classification;
		self.prim_range						:= L.clean_busowner.prim_range; 
		self.predir								:= L.clean_busowner.predir;
		self.prim_name						:= L.clean_busowner.prim_name;	
		self.addr_suffix					:= L.clean_busowner.addr_suffix; 
		self.postdir							:= L.clean_busowner.postdir;
		self.unit_desig						:= L.clean_busowner.unit_desig;	
		self.sec_range						:= L.clean_busowner.sec_range;	
		self.p_city_name					:= L.clean_busowner.p_city_name;	
		self.v_city_name					:= L.clean_busowner.v_city_name; 
		self.st										:= L.clean_busowner.st;	
		self.zip									:= L.clean_busowner.zip;	
		self.zip4									:= L.clean_busowner.zip4;		
		self.cart									:= L.clean_busowner.cart;
		self.cr_sort_sz						:= L.clean_busowner.cr_sort_sz;	
		self.lot									:= L.clean_busowner.lot;	
		self.lot_order						:= L.clean_busowner.lot_order;	
		self.dbpc									:= L.clean_busowner.dbpc;	
		self.chk_digit						:= L.clean_busowner.chk_digit;		
		self.rec_type							:= L.clean_busowner.rec_type;
		self.fips_state						:= L.clean_busowner.fips_state;
		self.fips_county					:= L.clean_busowner.fips_county;	
		self.geo_lat							:= L.clean_busowner.geo_lat;
		self.geo_long							:= L.clean_busowner.geo_long;	
		self.msa									:= L.clean_busowner.msa;	
		self.geo_blk							:= L.clean_busowner.geo_blk;	
		self.geo_match						:= L.clean_busowner.geo_match;	
		self.err_stat							:= L.clean_busowner.err_stat;	
		self.rawaid								:=	0;
		self.Original_Area_Code								:= L.BusinessOwner_PhoneNumber_Area_Code;
		self.Original_Phone_Number						:= L.BusinessOwner_PhoneNumber_Phone_Number;
		self.Phone_Extension									:= L.BusinessOwner_PhoneNumber_Phone_Extension;
		self.Primary_Phone_Indicator					:= L.BusinessOwner_PhoneNumber_Primary_Phone_Indicator;
		self.Published_Unlisted_Indicator			:= L.BusinessOwner_PhoneNumber_Published_Unlisted_Indicator;
		self.Phone_Type												:= L.BusinessOwner_PhoneNumber_Phone_Type;
		self.Phone_Number											:= L.BusinessOwner_PhoneNumber_Phone_Number;
		self.Federal_TaxID_SSN								:= L.BusinessOwner_Federal_TaxID_SSN;
		self.Federal_TaxID_SSN_Identifier			:= L.BusinessOwner_Federal_TaxID_SSN_Identifier;
		self.did															:= 0;
  	self.source														:= L.source;
		self := L;
		self := [];
	END;

EXPORT File_BOInformation := project(files.basefile(BusinessOwner_Segment_Identifier <> ''), xformBOInformation(left));

