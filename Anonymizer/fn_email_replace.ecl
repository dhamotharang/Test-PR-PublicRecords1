IMPORT STD;
SET OF STRING ssDomains 	:= ['PIEDPIPER','AVIATO','HOOLI','ITHUNDER','PEAR','YEEHOO','ALO','ZMAIL','GIGGLE','AMAIL'];
SET OF STRING ssUsers 		:= ['JOHNDALE','JANEBOLTON','MRMCCANN','HANEY992','DRMARK','BRIGHTLIGHT','KIDDO972','JACK.WERNER','BUTTERSHEA','GENERALOCONNELL',
	'SIRHOLMAN','MASTERCARVER','PRESIDENTGOFF','MONKEYCUEVAS','LIME001','ZAVALA','PETER.NOVAK','ALBERTEINSTEIN','BLANCOGENIE1','MOONEY561','JAMIELANCASTER',
	'DR.MCGRATH','MCNEWELL','SEARS654','MASTERSNIDER111','KIDMINOR','KRAUSE','MICHELLE.ARELLANO','MATTDILLARD','MFULTON','MRMONKEY123',
	'IAMSCHMITT777','JUAN.GUEVARA','MERRILLSTRIP1567','MRGUTHRIE','ALFREDFORD','JAMESSLATER','JCARNEY','RROSADO','MIKEBYERS','JANEPICKETT',
	'DELANEY','IHEARTCLEVELAND','MKINNEY','ROBERT.TILLMAN','LAKEFROZEN456','FRITZSIMMONS','JANEMCGOWAN','MOTHEROFDRAGRONS444','RITTERSKITTER789','QUINTANA',
	'CHOCOLATE.HERBERT','MRDODD19853','BRAUNIE888','CRAFTNCHEESE123','HOLLEYNUGGETS','STARRYNIGHT888','JOHNKAISER','MCLEOD','GORMAN','MYWITT',
	'BRITTMASTER','NOEL','THEREALNICHOLASCAGE','KAYJEWL567','BARLOW','IHARTLEY','PCOSTELLO','MISTERWORKMAN','WINTER1982','IAMWILDER999',
	'MARIODUARTE','KENDALLJENN3','PATEWINS3R','OHANNA258','THOR159','HEMERSON','THISGUY123456','LKIRKLAND','FRANKS777','RITTAMAYFIELD',
	'BOPHAN','HOUSEGOLDSTEIN','JUSTICERULES426','JERRYSPRINGER','ANNAFARRIS3','ODELLFAN456','MATTDONAHUE','JONGOLDBERG','KMACKEY','MISSESTRACY123',
	'LFINCH','MONKEYPALACIOS','JONMARINO','OWHITFIELD','JKATZ159','ILOVETHEFREYS','CSHOEMAKER','JIMMYCHO','JEMMA.SIMMS','LADYSTARK'];
  
EXPORT fn_email_replace(STRING email):=FUNCTION
	AllCapsEmail := STD.Str.ToUpperCase(email);
	UNSIGNED AtPos := STD.Str.Find(email, '@', 1);
	UNSIGNED DotPos := IF(STD.Str.FindCount(email, '.') = 1, STD.Str.Find(email, '.', 1), STD.Str.Find(email, '.', 2));
	STRING User := AllCapsEmail[..AtPos-1];
  UNSIGNED iHashUser:=(HASH32(User)%100)+1;
	STRING NewUser := ssUsers[iHashUser];
	STRING Domain := AllCapsEmail[AtPos+1..DotPos-1];
  UNSIGNED iHashDomain:=(HASH32(Domain)%10)+1;
	STRING NewDomain := ssDomains[iHashDomain];
	
  RETURN NewUser+'@'+NewDomain+AllCapsEmail[DotPos..];
END;
