import ut,lib_fileservices,VersionControl, _control, PhonesFeedback;

export SendReport(string srctype = '')  :=

module
shared run_dt := ut.GetTimeDate();
	shared SuccessSubject := 'Stats for ECrash monthly report SRC ID - '+srctype ;
	
 string  bodycontent :=        '|Field.........................................Total Count.......Previous count....Difference' + '\n\n' +
                                '-------------------------------------------------------------------------------------------------'+'\n' +
'| source_id_count           |'       + count(buildreport.infile ( 	trim(source_id) = srctype) )	+ '|      |'+ count(buildreport.infileprev(	trim(source_id) = srctype ))  + '|      |'+ 	(count(buildreport.infile ( 	trim(source_id) = srctype) ) - count(buildreport.infileprev(	trim(source_id) = srctype ))) +                     '\n' +										                                                                                                                                                                                                               
'|accident_cross_street_countnonblank |' + count(buildreport.infile(accident_cross_street <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(accident_cross_street <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(accident_cross_street <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(accident_cross_street <> '' and trim(source_id) = srctype))) +                                                      '\n' +                                                                                 
'|accident_date_countnonblank          |'+  count(buildreport.infile(accident_date <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(accident_date <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(accident_date <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(accident_date <> '' and trim(source_id) = srctype))) +                                                                            '\n' +                                                                                          
'|accident_location_countnonblank     |' +  count(buildreport.infile(accident_location <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(accident_location <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(accident_location <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(accident_location <> '' and trim(source_id) = srctype))) +                                                                 '\n' +                                                                                     
'|accident_street_countnonblank       |' +  count(buildreport.infile(accident_street <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(accident_street <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(accident_street <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(accident_street <> '' and trim(source_id) = srctype))) +                                                                       '\n' +                                                                                       
'|addl_report_number_countnonblank    |' +  count(buildreport.infile(addl_report_number <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(addl_report_number <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(addl_report_number <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(addl_report_number <> '' and trim(source_id) = srctype))) +                                                              '\n' +                                                                                    
'|addr_suffix_countnonblank           |' +  count(buildreport.infile(addr_suffix <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(addr_suffix <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(addr_suffix <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(addr_suffix <> '' and trim(source_id) = srctype))) +                                                                                   '\n' +                                                                                           
'|agency_ori_countnonblank            |' +  count(buildreport.infile(agency_ori <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(agency_ori <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(agency_ori <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(agency_ori <> '' and trim(source_id) = srctype))) +                                                                                      '\n' +                                                                                            
'|airbags_deploy_countnonblank        |' +  count(buildreport.infile(airbags_deploy <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(airbags_deploy <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(airbags_deploy <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(airbags_deploy <> '' and trim(source_id) = srctype))) +                                                                          '\n' +                                                                                        
'|assembly_country_countnonblank      |' +  count(buildreport.infile(assembly_country <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(assembly_country <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(assembly_country <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(assembly_country <> '' and trim(source_id) = srctype))) +                                                                    '\n' +                                                                                      
'|b_did_countnonblank                 |' +  count(buildreport.infile(b_did <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(b_did <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(b_did <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(b_did <> '' and trim(source_id) = srctype))) +                                                                                                     '\n' +                                                                                                 
'|bed_length_countnonblank            |' +  count(buildreport.infile(bed_length <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(bed_length <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(bed_length <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(bed_length <> '' and trim(source_id) = srctype))) +                                                                                      '\n' +                                                                                            
'|body_size_code_countnonblank        |' +  count(buildreport.infile(body_size_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(body_size_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(body_size_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(body_size_code <> '' and trim(source_id) = srctype))) +                                                                          '\n' +                                                                                        
'|body_style_code_countnonblank       |' +  count(buildreport.infile(body_style_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(body_style_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(body_style_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(body_style_code <> '' and trim(source_id) = srctype))) +                                                                       '\n' +                                                                                       
'|cab_type_code_countnonblank         |' +  count(buildreport.infile(cab_type_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(cab_type_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(cab_type_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(cab_type_code <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                         
'|car_body_style_code_countnonblank   |' +  count(buildreport.infile(car_body_style_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_body_style_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_body_style_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_body_style_code <> '' and trim(source_id) = srctype))) +                                                           '\n' +                                                                                   
'|car_body_style_countnonblank        |' +  count(buildreport.infile(car_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_body_style <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_body_style <> '' and trim(source_id) = srctype))) +                                                                          '\n' +                                                                                        
'|car_carburetion_countnonblank       |' +  count(buildreport.infile(car_carburetion <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_carburetion <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_carburetion <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_carburetion <> '' and trim(source_id) = srctype))) +                                                                       '\n' +                                                                                       
'|car_cid_countnonblank               |' +  count(buildreport.infile(car_cid <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_cid <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_cid <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_cid <> '' and trim(source_id) = srctype))) +                                                                                               '\n' +                                                                                               
'|car_cylinders_countnonblank         |' +  count(buildreport.infile(car_cylinders <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_cylinders <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_cylinders <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_cylinders <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                         
'|car_fuel_code_countnonblank         |' +  count(buildreport.infile(car_fuel_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_fuel_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_fuel_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_fuel_code <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                         
'|car_line_code_countnonblank         |' +  count(buildreport.infile(car_line_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_line_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_line_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_line_code <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                         
'|car_series_code_countnonblank       |' +  count(buildreport.infile(car_series_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_series_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_series_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_series_code <> '' and trim(source_id) = srctype))) +                                                                       '\n' +                                                                                       
'|car_series_countnonblank            |' +  count(buildreport.infile(car_series <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(car_series <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(car_series <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(car_series <> '' and trim(source_id) = srctype))) +                                                                                      '\n' +                                                                                            
'|carburetion_type_countnonblank      |' +  count(buildreport.infile(carburetion_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(carburetion_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(carburetion_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(carburetion_type <> '' and trim(source_id) = srctype))) +                                                                    '\n' +                                                                                      
'|carrier_name_countnonblank          |' +  count(buildreport.infile(carrier_name <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(carrier_name <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(carrier_name <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(carrier_name <> '' and trim(source_id) = srctype))) +                                                                                '\n' +                                                                                          
'|client_type_id_countnonblank        |' +  count(buildreport.infile(client_type_id <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(client_type_id <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(client_type_id <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(client_type_id <> '' and trim(source_id) = srctype))) +                                                                          '\n' +                                                                                        
'|cname_countnonblank                 |' +  count(buildreport.infile(cname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(cname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(cname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(cname <> '' and trim(source_id) = srctype))) +                                                                                                     '\n' +                                                                                                 
'|cru_order_id_countnonblank          |' +  count(buildreport.infile(cru_order_id <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(cru_order_id <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(cru_order_id <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(cru_order_id <> '' and trim(source_id) = srctype))) +                                                                                '\n' +                                                                                          
'|cru_sequence_nbr_countnonblank      |' +  count(buildreport.infile(cru_sequence_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(cru_sequence_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(cru_sequence_nbr <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(cru_sequence_nbr <> '' and trim(source_id) = srctype))) +                                                                    '\n' +                                                                                      
'|damage_type_countnonblank           |' +  count(buildreport.infile(damage_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(damage_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(damage_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(damage_type <> '' and trim(source_id) = srctype))) +                                                                                   '\n' +                                                                                           
'|date_vendor_last_reported_countnonblank |'   +  count(buildreport.infile(date_vendor_last_reported <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(date_vendor_last_reported <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(date_vendor_last_reported <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(date_vendor_last_reported <> '' and trim(source_id) = srctype))) +                                     '\n' +                                                                           
'|dhsmv_vehicle_ind_countnonblank     |' +  count(buildreport.infile(dhsmv_vehicle_ind <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(dhsmv_vehicle_ind <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(dhsmv_vehicle_ind <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(dhsmv_vehicle_ind <> '' and trim(source_id) = srctype))) +                                                                 '\n' +                                                                                     
'|did_countnonblank                   |' +  count(buildreport.infile(did <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(did <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(did <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(did <> '' and trim(source_id) = srctype))) +                                                                                                           '\n' +                                                                                                   
//'|did_rate_countnonblank |'            +  count(buildreport.infile(did_rate <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(did_rate <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(did_rate <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(did_rate <> '' and trim(source_id) = srctype))) +                                                                                                       '\n' +                                                                                   
'|direction_travel_countnonblank      |' +  count(buildreport.infile(direction_travel <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(direction_travel <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(direction_travel <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(direction_travel <> '' and trim(source_id) = srctype))) +                                                                    '\n' +                                                                                      
'|division_code_countnonblank         |' +  count(buildreport.infile(division_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(division_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(division_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(division_code <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                         
'|dlnbr_st_countnonblank               |'+  count(buildreport.infile(dlnbr_st <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(dlnbr_st <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(dlnbr_st <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(dlnbr_st <> '' and trim(source_id) = srctype))) +                                                                                           '\n' +                                                                                               
'|dob_countnonblank                   |' +  count(buildreport.infile(dob <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(dob <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(dob <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(dob <> '' and trim(source_id) = srctype))) +                                                                                                           '\n' +                                                                                                   
'|drive_type_countnonblank            |' +  count(buildreport.infile(drive_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(drive_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(drive_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(drive_type <> '' and trim(source_id) = srctype))) +                                                                                      '\n' +                                                                                            
'|driver_license_nbr_countnonblank    |' +  count(buildreport.infile(driver_license_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(driver_license_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(driver_license_nbr <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(driver_license_nbr <> '' and trim(source_id) = srctype))) +                                                              '\n' +                                                                                    
'|dt_first_seen_countnonblank         |' +  count(buildreport.infile(dt_first_seen <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(dt_first_seen <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(dt_first_seen <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(dt_first_seen <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                         
'|dt_last_seen_countnonblank          |' +  count(buildreport.infile(dt_last_seen <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(dt_last_seen <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(dt_last_seen <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(dt_last_seen <> '' and trim(source_id) = srctype))) +                                                                                '\n' +                                                                                          
'|engine_cylinder_code_countnonblank  |' +  count(buildreport.infile(engine_cylinder_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(engine_cylinder_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(engine_cylinder_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(engine_cylinder_code <> '' and trim(source_id) = srctype))) +                                                        '\n' +                                                                                  
'|engine_size_countnonblank           |' +  count(buildreport.infile(engine_size <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(engine_size <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(engine_size <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(engine_size <> '' and trim(source_id) = srctype))) +                                                                                   '\n' +                                                                                           
'|est_vehicle_damage_countnonblank    |' +  count(buildreport.infile(est_vehicle_damage <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(est_vehicle_damage <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(est_vehicle_damage <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(est_vehicle_damage <> '' and trim(source_id) = srctype))) +                                                              '\n' +                                                                                    
'|est_vehicle_speed_countnonblank     |' +  count(buildreport.infile(est_vehicle_speed <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(est_vehicle_speed <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(est_vehicle_speed <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(est_vehicle_speed <> '' and trim(source_id) = srctype))) +                                                                 '\n' +                                                                                     
'|fname_countnonblank                 |' +  count(buildreport.infile(fname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(fname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(fname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(fname <> '' and trim(source_id) = srctype))) +                                                                                                     '\n' +                                                                                                 
'|fuel_code_countnonblank             |' +  count(buildreport.infile(fuel_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(fuel_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(fuel_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(fuel_code <> '' and trim(source_id) = srctype))) +                                                                                         '\n' +                                                                                             
'|gvw_code_countnonblank              |' +  count(buildreport.infile(gvw_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(gvw_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(gvw_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(gvw_code <> '' and trim(source_id) = srctype))) +                                                                                            '\n' +                                                                                              
'|hazard_material_transport_countnonblank |'   +  count(buildreport.infile(hazard_material_transport <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(hazard_material_transport <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(hazard_material_transport <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(hazard_material_transport <> '' and trim(source_id) = srctype))) +                                     '\n' +                                                                           
'|headquarter_country_countnonblank   |' +  count(buildreport.infile(headquarter_country <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(headquarter_country <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(headquarter_country <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(headquarter_country <> '' and trim(source_id) = srctype))) +                                                           '\n' +                                                                                   
'|how_removed_code_countnonblank      |' +  count(buildreport.infile(how_removed_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(how_removed_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(how_removed_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(how_removed_code <> '' and trim(source_id) = srctype))) +                                                                    '\n' +                                                                                      
'|image_hash_countnonblank             |'+  count(buildreport.infile(image_hash <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(image_hash <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(image_hash <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(image_hash <> '' and trim(source_id) = srctype))) +                                                                                     '\n' +                                                                                             
'|impact_location_countnonblank        |'+  count(buildreport.infile(impact_location <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(impact_location <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(impact_location <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(impact_location <> '' and trim(source_id) = srctype))) +                                                                    '\n' +                                                                                          
'|insurance_company_standardi_countnonblank |'   +  count(buildreport.infile(insurance_company_standardized <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(insurance_company_standardized <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(insurance_company_standardized <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(insurance_company_standardized <> '' and trim(source_id) = srctype))) +               '\n' +                                                                           
'|is_available_for_public_countnonblank |'       +  count(buildreport.infile(is_available_for_public <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(is_available_for_public <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(is_available_for_public <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(is_available_for_public <> '' and trim(source_id) = srctype))) +                                           '\n' +                                                                           
'|jurisdiction_countnonblank            |'+  count(buildreport.infile(jurisdiction <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(jurisdiction <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(jurisdiction <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(jurisdiction <> '' and trim(source_id) = srctype))) +                                                                            '\n' +                                                                                             
'|jurisdiction_nbr_countnonblank        |'+  count(buildreport.infile(jurisdiction_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(jurisdiction_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(jurisdiction_nbr <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(jurisdiction_nbr <> '' and trim(source_id) = srctype))) +                                                                '\n' +                                                                                         
'|jurisdiction_state_countnonblank      |'+  count(buildreport.infile(jurisdiction_state <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(jurisdiction_state <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(jurisdiction_state <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(jurisdiction_state <> '' and trim(source_id) = srctype))) +                                                          '\n' +                                                                                       
'|l_accnbr_countnonblank                |'+  count(buildreport.infile(l_accnbr <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(l_accnbr <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(l_accnbr <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(l_accnbr <> '' and trim(source_id) = srctype))) +                                                                                        '\n' +                                                                                                 
'|lname_countnonblank                    |' +  count(buildreport.infile(lname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(lname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(lname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(lname <> '' and trim(source_id) = srctype))) +                                                                                                '\n' +                                                                                                   
'|load_capacity_code_countnonblank      |'  +  count(buildreport.infile(load_capacity_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(load_capacity_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(load_capacity_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(load_capacity_code <> '' and trim(source_id) = srctype))) +                                                          '\n' +                                                                                     
'|make_description_countnonblank         |' +  count(buildreport.infile(make_description <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(make_description <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(make_description <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(make_description <> '' and trim(source_id) = srctype))) +                                                               '\n' +                                                                                        
'|manufacture_body_style_countnonblank   |' +  count(buildreport.infile(manufacture_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(manufacture_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(manufacture_body_style <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(manufacture_body_style <> '' and trim(source_id) = srctype))) +                                             '\n' +                                                                                  
'|manufacturer_corporation_countnonblank |' +  count(buildreport.infile(manufacturer_corporation <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(manufacturer_corporation <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(manufacturer_corporation <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(manufacturer_corporation <> '' and trim(source_id) = srctype))) +                                       '\n' +                                                                                
'|match_code_countnonblank               |' +  count(buildreport.infile(match_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(match_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(match_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(match_code <> '' and trim(source_id) = srctype))) +                                                                                 '\n' +                                                                                              
'|mname_countnonblank                    |' +  count(buildreport.infile(mname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(mname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(mname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(mname <> '' and trim(source_id) = srctype))) +                                                                                                '\n' +                                                                                                   
'|model_description_countnonblank       |'  +  count(buildreport.infile(model_description <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(model_description <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(model_description <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(model_description <> '' and trim(source_id) = srctype))) +                                                             '\n' +                                                                                      
'|model_year_countnonblank               |' +  count(buildreport.infile(model_year <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(model_year <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(model_year <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(model_year <> '' and trim(source_id) = srctype))) +                                                                                 '\n' +                                                                                              
'|motorcycle_cylinder_coding_countnonblank |'    +  count(buildreport.infile(motorcycle_cylinder_coding <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(motorcycle_cylinder_coding <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(motorcycle_cylinder_coding <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(motorcycle_cylinder_coding <> '' and trim(source_id) = srctype))) +                               '\n' +                                                                           
'|motorcycle_engine_displacem_countnonblank |'   +  count(buildreport.infile(motorcycle_engine_displacement <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(motorcycle_engine_displacement <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(motorcycle_engine_displacement <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(motorcycle_engine_displacement <> '' and trim(source_id) = srctype))) +               '\n' +                                                                           
'|motorcycle_make_abbreviatio_countnonblank |'   +  count(buildreport.infile(motorcycle_make_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(motorcycle_make_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(motorcycle_make_abbreviation <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(motorcycle_make_abbreviation <> '' and trim(source_id) = srctype))) +                       '\n' +                                                                           
'|motorcycle_model_countnonblank          |' +  count(buildreport.infile(motorcycle_model <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(motorcycle_model <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(motorcycle_model <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(motorcycle_model <> '' and trim(source_id) = srctype))) +                                                              '\n' +                                                                                        
'|motorcycle_type_of_bike_countnonblank |'       +  count(buildreport.infile(motorcycle_type_of_bike <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(motorcycle_type_of_bike <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(motorcycle_type_of_bike <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(motorcycle_type_of_bike <> '' and trim(source_id) = srctype))) +                                           '\n' +                                                                           
'|moving_violation_countnonblank        |'   +  count(buildreport.infile(moving_violation <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(moving_violation <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(moving_violation <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(moving_violation <> '' and trim(source_id) = srctype))) +                                                                '\n' +                                                                                      
'|name_suffix_countnonblank             |'   +  count(buildreport.infile(name_suffix <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(name_suffix <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(name_suffix <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(name_suffix <> '' and trim(source_id) = srctype))) +                                                                               '\n' +                                                                                           
'|next_street_countnonblank             |'   +  count(buildreport.infile(next_street <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(next_street <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(next_street <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(next_street <> '' and trim(source_id) = srctype))) +                                                                               '\n' +                                                                                           
'|number_of_barrels_countnonblank       |'   +  count(buildreport.infile(number_of_barrels <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(number_of_barrels <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(number_of_barrels <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(number_of_barrels <> '' and trim(source_id) = srctype))) +                                                             '\n' +                                                                                     
'|number_of_cylinders_countnonblank      |'  +  count(buildreport.infile(number_of_cylinders <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(number_of_cylinders <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(number_of_cylinders <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(number_of_cylinders <> '' and trim(source_id) = srctype))) +                                                      '\n' +                                                                                    
'|number_of_doors_countnonblank          |'  +  count(buildreport.infile(number_of_doors <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(number_of_doors <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(number_of_doors <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(number_of_doors <> '' and trim(source_id) = srctype))) +                                                                  '\n' +                                                                                        
'|number_of_driving_wheels_countnonblank |' +  count(buildreport.infile(number_of_driving_wheels <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(number_of_driving_wheels <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(number_of_driving_wheels <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(number_of_driving_wheels <> '' and trim(source_id) = srctype))) +                                            '\n' +                                                                           
'|number_of_wheels_on_road_countnonblank |' +  count(buildreport.infile(number_of_wheels_on_road <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(number_of_wheels_on_road <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(number_of_wheels_on_road <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(number_of_wheels_on_road <> '' and trim(source_id) = srctype))) +                                            '\n' +                                                                           
'|orig_accnbr_countnonblank              |'  +  count(buildreport.infile(orig_accnbr <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(orig_accnbr <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(orig_accnbr <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(orig_accnbr <> '' and trim(source_id) = srctype))) +                                                                                   '\n' +                                                                                       
'|orig_fname_countnonblank               |'  +  count(buildreport.infile(orig_fname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(orig_fname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(orig_fname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(orig_fname <> '' and trim(source_id) = srctype))) +                                                                                      '\n' +                                                                                        
'|orig_full_name_countnonblank           |'  +  count(buildreport.infile(orig_full_name <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(orig_full_name <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(orig_full_name <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(orig_full_name <> '' and trim(source_id) = srctype))) +                                                                          '\n' +                                                                                    
'|orig_lname_countnonblank               |'  +  count(buildreport.infile(orig_lname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(orig_lname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(orig_lname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(orig_lname <> '' and trim(source_id) = srctype))) +                                                                                      '\n' +                                                                                        
'|orig_mname_countnonblank                |' +  count(buildreport.infile(orig_mname <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(orig_mname <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(orig_mname <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(orig_mname <> '' and trim(source_id) = srctype))) +                                                                                     '\n' +                                                                                         
'|other_vin_indicator_countnonblank       |' +  count(buildreport.infile(other_vin_indicator <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(other_vin_indicator <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(other_vin_indicator <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(other_vin_indicator <> '' and trim(source_id) = srctype))) +                                                          '\n' +                                                                                
'|placarded_countnonblank                  |'+  count(buildreport.infile(placarded <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(placarded <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(placarded <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(placarded <> '' and trim(source_id) = srctype))) +                                                                                       '\n' +                                                                                           
'|point_of_impact_countnonblank           |' +  count(buildreport.infile(point_of_impact <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(point_of_impact <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(point_of_impact <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(point_of_impact <> '' and trim(source_id) = srctype))) +                                                                      '\n' +                                                                                    
'|policy_effective_date_countnonblank     |' +  count(buildreport.infile(policy_effective_date <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(policy_effective_date <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(policy_effective_date <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(policy_effective_date <> '' and trim(source_id) = srctype))) +                                                    '\n' +                                                                              
'|policy_expiration_date_countnonblank    |'   +  count(buildreport.infile(policy_expiration_date <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(policy_expiration_date <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(policy_expiration_date <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(policy_expiration_date <> '' and trim(source_id) = srctype))) +                                                 '\n' +                                                                           
'|policy_num_countnonblank                |' +  count(buildreport.infile(policy_num <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(policy_num <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(policy_num <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(policy_num <> '' and trim(source_id) = srctype))) +                                                                                     '\n' +                                                                                         
'|postdir_countnonblank                   |' +  count(buildreport.infile(postdir <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(postdir <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(postdir <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(postdir <> '' and trim(source_id) = srctype))) +                                                                                              '\n' +                                                                                            
'|posted_speed_countnonblank              |' +  count(buildreport.infile(posted_speed <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(posted_speed <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(posted_speed <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(posted_speed <> '' and trim(source_id) = srctype))) +                                                                               '\n' +                                                                                       
'|predir_countnonblank                    |' +  count(buildreport.infile(predir <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(predir <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(predir <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(predir <> '' and trim(source_id) = srctype))) +                                                                                                 '\n' +                                                                                             
'|price_class_code_countnonblank          |' +  count(buildreport.infile(price_class_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(price_class_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(price_class_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(price_class_code <> '' and trim(source_id) = srctype))) +                                                                   '\n' +                                                                                   
'|prim_name_countnonblank                 |' +  count(buildreport.infile(prim_name <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(prim_name <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(prim_name <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(prim_name <> '' and trim(source_id) = srctype))) +                                                                                        '\n' +                                                                                          
'|prim_range_countnonblank                 |'+  count(buildreport.infile(prim_range <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(prim_range <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(prim_range <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(prim_range <> '' and trim(source_id) = srctype))) +                                                                                    '\n' +                                                                                          
'|record_type_countnonblank                 |'+  count(buildreport.infile(record_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(record_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(record_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(record_type <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                            
'|reference_number_countnonblank          |'  +  count(buildreport.infile(reference_number <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(reference_number <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(reference_number <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(reference_number <> '' and trim(source_id) = srctype))) +                                                                '\n' +                                                                                     
'|report_category_countnonblank           |'  +  count(buildreport.infile(report_category <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(report_category <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(report_category <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(report_category <> '' and trim(source_id) = srctype))) +                                                                   '\n' +                                                                                      
'|report_code_countnonblank               |'  +  count(buildreport.infile(report_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(report_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(report_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(report_code <> '' and trim(source_id) = srctype))) +                                                                               '\n' +                                                                                          
'|report_code_desc_countnonblank           |' +  count(buildreport.infile(report_code_desc <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(report_code_desc <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(report_code_desc <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(report_code_desc <> '' and trim(source_id) = srctype))) +                                                               '\n' +                                                                                      
'|report_has_coversheet_countnonblank      |' +  count(buildreport.infile(report_has_coversheet <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(report_has_coversheet <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(report_has_coversheet <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(report_has_coversheet <> '' and trim(source_id) = srctype))) +                                                '\n' +                                                                                 
'|report_status_countnonblank              |' +  count(buildreport.infile(report_status <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(report_status <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(report_status <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(report_status <> '' and trim(source_id) = srctype))) +                                                                        '\n' +                                                                                         
'|report_type_id_countnonblank            |'  +  count(buildreport.infile(report_type_id <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(report_type_id <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(report_type_id <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(report_type_id <> '' and trim(source_id) = srctype))) +                                                                      '\n' +                                                                                       
'|rim_size_countnonblank                  |'  +  count(buildreport.infile(rim_size <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(rim_size <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(rim_size <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(rim_size <> '' and trim(source_id) = srctype))) +                                                                                        '\n' +                                                                                             
'|seating_capacity_countnonblank          |'  +  count(buildreport.infile(seating_capacity <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(seating_capacity <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(seating_capacity <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(seating_capacity <> '' and trim(source_id) = srctype))) +                                                                '\n' +                                                                                     
'|sec_range_countnonblank                  |' +  count(buildreport.infile(sec_range <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(sec_range <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(sec_range <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(sec_range <> '' and trim(source_id) = srctype))) +                                                                                    '\n' +                                                                                             
'|series_description_countnonblank        |'  +  count(buildreport.infile(series_description <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(series_description <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(series_description <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(series_description <> '' and trim(source_id) = srctype))) +                                                          '\n' +                                                                                   
'|ssn_countnonblank                       |'  +  count(buildreport.infile(ssn <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(ssn <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(ssn <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(ssn <> '' and trim(source_id) = srctype))) +                                                                                                       '\n' +                                                                                                  
'|st_countnonblank                        |'  +  count(buildreport.infile(st <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(st <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(st <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(st <> '' and trim(source_id) = srctype))) +                                                                                                          '\n' +                                                                                                   
'|steering_type_countnonblank             |'  +  count(buildreport.infile(steering_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(steering_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(steering_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(steering_type <> '' and trim(source_id) = srctype))) +                                                                         '\n' +                                                                                        
'|tag_nbr_countnonblank                    |' +  count(buildreport.infile(tag_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(tag_nbr <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(tag_nbr <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(tag_nbr <> '' and trim(source_id) = srctype))) +                                                                                          '\n' +                                                                                               
'|tagnbr_st_countnonblank                  |' +  count(buildreport.infile(tagnbr_st <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(tagnbr_st <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(tagnbr_st <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(tagnbr_st <> '' and trim(source_id) = srctype))) +                                                                                    '\n' +                                                                                             
'|tif_image_hash_countnonblank             |' +  count(buildreport.infile(tif_image_hash <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(tif_image_hash <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(tif_image_hash <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(tif_image_hash <> '' and trim(source_id) = srctype))) +                                                                     '\n' +                                                                                        
'|title_countnonblank                      |' +  count(buildreport.infile(title <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(title <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(title <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(title <> '' and trim(source_id) = srctype))) +                                                                                                '\n' +                                                                                                 
'|total_occu_saf_equipment_countnonblank |'    +  count(buildreport.infile(total_occu_saf_equip <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(total_occu_saf_equip <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(total_occu_saf_equip <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(total_occu_saf_equip <> '' and trim(source_id) = srctype))) +                                                         '\n' +                                                                           
'|total_occu_vehicle_countnonblank         |' +  count(buildreport.infile(total_occu_vehicle <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(total_occu_vehicle <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(total_occu_vehicle <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(total_occu_vehicle <> '' and trim(source_id) = srctype))) +                                                         '\n' +                                                                                    
'|towed_countnonblank                       |'+  count(buildreport.infile(towed <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(towed <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(towed <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(towed <> '' and trim(source_id) = srctype))) +                                                                                               '\n' +                                                                                                  
'|truck_body_style_abbrevia_countnonblank |'   +  count(buildreport.infile(truck_body_style_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_body_style_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_body_style_abbreviation <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_body_style_abbreviation <> '' and trim(source_id) = srctype))) +                     '\n' +                                                                           
'|truck_chassis_body_style_countnonblank  |'    +  count(buildreport.infile(truck_chassis_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_chassis_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_chassis_body_style <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_chassis_body_style <> '' and trim(source_id) = srctype))) +                                        '\n' +                                                                           
'|truck_cid_countnonblank                   |'+  count(buildreport.infile(truck_cid <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_cid <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_cid <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_cid <> '' and trim(source_id) = srctype))) +                                                                                  '\n' +                                                                                               
'|truck_cylinders_countnonblank              |'+  count(buildreport.infile(truck_cylinders <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_cylinders <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_cylinders <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_cylinders <> '' and trim(source_id) = srctype))) +                                                               '\n' +                                                                                         
'|truck_fuel_code_countnonblank              |'+  count(buildreport.infile(truck_fuel_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_fuel_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_fuel_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_fuel_code <> '' and trim(source_id) = srctype))) +                                                               '\n' +                                                                                         
'|truck_make_abbreviation_countnonblank      |'      +  count(buildreport.infile(truck_make_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_make_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_make_abbreviation <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_make_abbreviation <> '' and trim(source_id) = srctype))) +                                       '\n' +                                                                           
'|truck_manufacturers_gvw_cod_countnonblank |'  +  count(buildreport.infile(truck_manufacturers_gvw_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_manufacturers_gvw_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_manufacturers_gvw_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_manufacturers_gvw_code <> '' and trim(source_id) = srctype)))  +                        '\n' +                                                                          
'|truck_model_countnonblank                 |' +  count(buildreport.infile(truck_model <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_model <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_model <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_model <> '' and trim(source_id) = srctype))) +                                                                            '\n' +                                                                                            
'|truck_series_countnonblank                 |'+  count(buildreport.infile(truck_series <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_series <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_series <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_series <> '' and trim(source_id) = srctype))) +                                                                        '\n' +                                                                                            
'|truck_ton_rating_code_countnonblank         |'+  count(buildreport.infile(truck_ton_rating_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_ton_rating_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_ton_rating_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_ton_rating_code <> '' and trim(source_id) = srctype))) +                                            '\n' +                                                                                   
'|truck_wheels_driving_wheel_countnonblank   |'   +  count(buildreport.infile(truck_wheels_driving_wheels <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(truck_wheels_driving_wheels <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(truck_wheels_driving_wheels <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(truck_wheels_driving_wheels <> '' and trim(source_id) = srctype))) +                          '\n' +                                                                           
'|unit_desig_countnonblank                    |'+  count(buildreport.infile(unit_desig <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(unit_desig <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(unit_desig <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(unit_desig <> '' and trim(source_id) = srctype))) +                                                                             '\n' +                                                                                              
'|v_city_name_countnonblank                  |' +  count(buildreport.infile(v_city_name <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(v_city_name <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(v_city_name <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(v_city_name <> '' and trim(source_id) = srctype))) +                                                                           '\n' +                                                                                            
'|vehicle_abbreviation_countnonblank         |' +  count(buildreport.infile(vehicle_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_abbreviation <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_abbreviation <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_abbreviation <> '' and trim(source_id) = srctype))) +                                                '\n' +                                                                                   
'|vehicle_cap_code_countnonblank            |'  +  count(buildreport.infile(vehicle_cap_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_cap_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_cap_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_cap_code <> '' and trim(source_id) = srctype))) +                                                             '\n' +                                                                                      
'|vehicle_driver_action_countnonblank       |'  +  count(buildreport.infile(vehicle_driver_action <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_driver_action <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_driver_action <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_driver_action <> '' and trim(source_id) = srctype))) +                                              '\n' +                                                                                 
'|vehicle_fault_code_countnonblank          |'  +  count(buildreport.infile(vehicle_fault_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_fault_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_fault_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_fault_code <> '' and trim(source_id) = srctype))) +                                                       '\n' +                                                                                    
'|vehicle_fr_code_countnonblank             |'  +  count(buildreport.infile(vehicle_fr_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_fr_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_fr_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_fr_code <> '' and trim(source_id) = srctype))) +                                                                '\n' +                                                                                       
'|vehicle_function_countnonblank             |' +  count(buildreport.infile(vehicle_function <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_function <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_function <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_function <> '' and trim(source_id) = srctype))) +                                                            '\n' +                                                                                       
'|vehicle_group_code_countnonblank           |' +  count(buildreport.infile(vehicle_group_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_group_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_group_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_group_code <> '' and trim(source_id) = srctype))) +                                                      '\n' +                                                                                     
'|vehicle_incident_city_countnonblank        |' +  count(buildreport.infile(vehicle_incident_city <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_incident_city <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_incident_city <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_incident_city <> '' and trim(source_id) = srctype))) +                                               '\n' +                                                                                
'|vehicle_incident_id_countnonblank          |' +  count(buildreport.infile(vehicle_incident_id <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_incident_id <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_incident_id <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_incident_id <> '' and trim(source_id) = srctype))) +                                                     '\n' +                                                                                  
'|vehicle_incident_st_countnonblank          |' +  count(buildreport.infile(vehicle_incident_st <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_incident_st <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_incident_st <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_incident_st <> '' and trim(source_id) = srctype))) +                                                     '\n' +                                                                                  
'|vehicle_insur_code_countnonblank            |'+  count(buildreport.infile(vehicle_insur_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_insur_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_insur_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_insur_code <> '' and trim(source_id) = srctype))) +                                                       '\n' +                                                                                    
'|vehicle_make_countnonblank                 |' +  count(buildreport.infile(vehicle_make <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_make <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_make <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_make <> '' and trim(source_id) = srctype))) +                                                                          '\n' +                                                                                         
'|vehicle_modified_countnonblank             |' +  count(buildreport.infile(vehicle_modified <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_modified <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_modified <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_modified <> '' and trim(source_id) = srctype))) +                                                              '\n' +                                                                                     
'|vehicle_movement_countnonblank             |' +  count(buildreport.infile(vehicle_movement <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_movement <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_movement <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_movement <> '' and trim(source_id) = srctype))) +                                                              '\n' +                                                                                     
'|vehicle_owner_driver_code_countnonblank    |'  +  count(buildreport.infile(vehicle_owner_driver_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_owner_driver_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_owner_driver_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_owner_driver_code <> '' and trim(source_id) = srctype))) +                                   '\n' +                                                                           
'|vehicle_removed_by_countnonblank           |' +  count(buildreport.infile(vehicle_removed_by <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_removed_by <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_removed_by <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_removed_by <> '' and trim(source_id) = srctype))) +                                                        '\n' +                                                                                   
'|vehicle_roadway_loc_countnonblank          |' +  count(buildreport.infile(vehicle_roadway_loc <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_roadway_loc <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_roadway_loc <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_roadway_loc <> '' and trim(source_id) = srctype))) +                                                     '\n' +                                                                                  
'|vehicle_seg_countnonblank                   |'+  count(buildreport.infile(vehicle_seg <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_seg <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_seg <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_seg <> '' and trim(source_id) = srctype))) +                                                                            '\n' +                                                                                           
'|vehicle_seg_type_countnonblank              |'+  count(buildreport.infile(vehicle_seg_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_seg_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_seg_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_seg_type <> '' and trim(source_id) = srctype))) +                                                             '\n' +                                                                                      
'|vehicle_series_code_countnonblank           |'+  count(buildreport.infile(vehicle_series_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_series_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_series_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_series_code <> '' and trim(source_id) = srctype))) +                                                    '\n' +                                                                                   
'|vehicle_status_countnonblank                |'+  count(buildreport.infile(vehicle_status <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_status <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_status <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_status <> '' and trim(source_id) = srctype))) +                                                                   '\n' +                                                                                        
'|vehicle_subgroup_code_countnonblank         |'+  count(buildreport.infile(vehicle_subgroup_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_subgroup_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_subgroup_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_subgroup_code <> '' and trim(source_id) = srctype))) +                                              '\n' +                                                                                 
'|vehicle_travel_on_countnonblank              |'+  count(buildreport.infile(vehicle_travel_on <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_travel_on <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_travel_on <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_travel_on <> '' and trim(source_id) = srctype))) +                                                         '\n' +                                                                                     
'|vehicle_type_code_countnonblank              |'+  count(buildreport.infile(vehicle_type_code <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_type_code <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_type_code <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_type_code <> '' and trim(source_id) = srctype))) +                                                         '\n' +                                                                                     
'|vehicle_type_countnonblank                   |'+  count(buildreport.infile(vehicle_type <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_type <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_type <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_type <> '' and trim(source_id) = srctype))) +                                                                        '\n' +                                                                                          
'|vehicle_unit_number_countnonblank             |'+  count(buildreport.infile(vehicle_unit_number <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_unit_number <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_unit_number <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_unit_number <> '' and trim(source_id) = srctype))) +                                                  '\n' +                                                                                   
'|vehicle_use_countnonblank                     |'+  count(buildreport.infile(vehicle_use <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_use <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_use <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_use <> '' and trim(source_id) = srctype))) +                                                                                  '\n' +                                                                                   
 '|vehicle_year_countnonblank                    |'+  count(buildreport.infile(vehicle_year <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehicle_year <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehicle_year <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehicle_year <> '' and trim(source_id) = srctype))) +                                                                               '\n' +                                                                                                                  
'|vehs_first_defect_countnonblank         |'  +  count(buildreport.infile(vehs_first_defect <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehs_first_defect <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehs_first_defect <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehs_first_defect <> '' and trim(source_id) = srctype))) +                                                                      '\n' +                                                                                                           
'|vehs_second_defect_countnonblank              |' +  count(buildreport.infile(vehs_second_defect <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vehs_second_defect <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vehs_second_defect <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vehs_second_defect <> '' and trim(source_id) = srctype))) +                                                             '\n' +                                                                                                           
'|vin_countnonblank                              |' +  count(buildreport.infile(vin <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vin <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vin <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vin <> '' and trim(source_id) = srctype))) +                                                                                                         '\n' +                                                                                                                          
'|vina_body_style_countnonblank            |'    +  count(buildreport.infile(vina_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vina_body_style <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vina_body_style <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vina_body_style <> '' and trim(source_id) = srctype))) +                                                                           '\n' +                                                                                                           
'|vina_make_countnonblank                     |'    +  count(buildreport.infile(vina_make <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vina_make <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vina_make <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vina_make <> '' and trim(source_id) = srctype))) +                                                                                          '\n' +                                                                                                                 
'|vina_model_countnonblank                |'         +  count(buildreport.infile(vina_model <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vina_model <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vina_model <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vina_model <> '' and trim(source_id) = srctype))) +                                                                                           '\n' +                                                                                                           
'|vina_series_countnonblank                |'        +  count(buildreport.infile(vina_series <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(vina_series <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(vina_series <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(vina_series <> '' and trim(source_id) = srctype))) +                                                                                       '\n' +                                                                                                           
'|work_type_id_countnonblank               |'       +  count(buildreport.infile(work_type_id <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(work_type_id <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(work_type_id <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(work_type_id <> '' and trim(source_id) = srctype))) +                                                                                    '\n' +                                                                                                           
'|zip_countnonblank                        |'                +  count(buildreport.infile(zip <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(zip <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(zip <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(zip <> '' and trim(source_id) = srctype))) +                                                                                                               '\n' +                                                                                                           
'|zip4_countnonblank                       |'               +  count(buildreport.infile(zip4 <> '' and trim(source_id) = srctype)) + '|      |'+ count(buildreport.infileprev(zip4 <> '' and trim(source_id) = srctype)) + '|      |'+ (count(buildreport.infile(zip4 <> '' and trim(source_id) = srctype)) - count(buildreport.infileprev(zip4 <> '' and trim(source_id) = srctype))) +                                                                                                            '\n';                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
 
 
	
shared	 SuccessBody		:= bodycontent;
	
  //SendEmailAttachText(const varstring to, const varstring subject, const varstring body, const varstring attachment, const varstring mimeType, const varstring attachmentName, const varstring mailServer=GETENV('SMTPserver'), unsigned4 port=(unsigned4) GETENV('SMTPport', '25'), const varstring sender=GETENV('emailSenderAddress')) : c,action,context,entrypoint='fsSendEmailAttachText'; 

	export BuildSuccess	:= fileservices.sendemail(
													'procurementservicespm@lexisnexis.com; sudhir.kasavajjala@lexisnexis.com',
													SuccessSubject,
													SuccessBody);
	//													'Stats Complete - Please view attachment\n**File on thor expires in 7 days',
	//												'text/xml',
	//'attachment.txt') ;
												

	export BuildFailure	:= fileservices.sendemail(
													'procurementservicespm@lexisnexis.com; sudhir.kasavajjala@lexisnexis.com',
													'ECrash Stat Failed ',
													workunit +  failmessage);
													
	shared SuccessSubject_incdnt := 'Stats for ECrash monthly report unique incidents -- '+ut.GetDate[1..6] ;


string bodycontent_incdnt := '|sourcetype.......................accident date...........................Total Unique Incidents..........Total Unique Incidents till date' + '\n\n' +
 
 '|ECRASH|' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'ECRASH' ) ,vehicle_incident_id),vehicle_incident_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'ECRASH' ) ,hash(vehicle_incident_id)) ,vehicle_incident_id,local),vehicle_incident_id,local)) +  '\n' +
  '|EA-CRU|' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'EA-CRU') ,cru_order_id),cru_order_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'EA-CRU') ,hash(cru_order_id)) ,cru_order_id,local),cru_order_id,local)) +  '\n' +
	'|CRU-NIGHTLY |' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'CRU-NIGHTL' ),cru_order_id),cru_order_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'CRU-NIGHTL') ,hash(cru_order_id)) ,cru_order_id,local),cru_order_id,local)) +  '\n' +
 '|CRU-INQ |' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'CRU-INQ' ),cru_order_id),cru_order_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'CRU-INQ') ,hash(cru_order_id)) ,cru_order_id,local),cru_order_id,local)) +  '\n' +
 '|FA |' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'FA' ),vehicle_incident_id),vehicle_incident_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'FA') ,hash(vehicle_incident_id)) ,vehicle_incident_id,local),vehicle_incident_id,local)) +  '\n' +
 '|TM |' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'TM' ),vehicle_incident_id),vehicle_incident_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'TM') ,hash(vehicle_incident_id)) ,vehicle_incident_id,local),vehicle_incident_id,local)) +  '\n' +
 '|TF |' + ut.getDateOffset(-20,ut.GetDate)[1..6] + '|---------|' + count(dedup(sort(buildreport.infile ( dt_last_seen[1..6] = ut.getDateOffset(-20,ut.GetDate)[1..6] and  trim(source_id) = 'TF' ),vehicle_incident_id),vehicle_incident_id)) +  '|---------|' + count(dedup(sort(distribute(buildreport.infile ( trim(source_id) = 'TF') ,hash(vehicle_incident_id)) ,vehicle_incident_id,local),vehicle_incident_id,local)) +  '\n' ;

 
 shared	 SuccessBody_incdnt		:= bodycontent_incdnt;
 
 export BuildSuccess_incdnt	:= fileservices.sendemail(
													'procurementservicespm@lexisnexis.com; sudhir.kasavajjala@lexisnexis.com',
													SuccessSubject_incdnt,
													SuccessBody_incdnt);
	//													'Stats Complete - Please view attachment\n**File on thor expires in 7 days',
	//												'text/xml',
	//'attachment.txt') ;
												

	export BuildFailure_incdnt	:= fileservices.sendemail(
													'procurementservicespm@lexisnexis.com; sudhir.kasavajjala@lexisnexis.com',
													'ECrash Stat Failed ',
													workunit +  failmessage);
													
end;