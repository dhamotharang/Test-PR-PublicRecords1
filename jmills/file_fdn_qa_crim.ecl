#CONSTANT('DataLocationCC', 'NONAME');  
import FraudDefenseNetwork;
key_in := dataset('~thor_data400::base::fdn::qa::crim', FraudDefenseNetwork.Layouts.Base.crim, THOR);

layout_key_out := RECORD
// layout_clean_name := RECORD
   // string5 title;
   // string20 fname;
   // string20 mname;
   // string20 lname;
   // string5 name_suffix;
   // string3 name_score;
  // END;

// RECORD
  string8 file_date;
  string60 offender_key;
  string2 vendor;
  string20 source_file;
  string2 record_type;
  string25 orig_state;
  string15 id_num;
  string56 pty_nm;
  string1 pty_nm_fmt;
  string20 orig_lname;
  string20 orig_fname;
  string20 orig_mname;
  string10 orig_name_suffix;
  string20 lname;
  string20 fname;
  string20 mname;
  string6 name_suffix;
  string1 pty_typ;
  string1 ntype;
  unsigned2 nindicator;
  string1 nitro_flag;
  string9 ssn;
  string35 case_num;
  string40 case_court;
  string8 case_date;
  string5 case_type;
  string25 case_type_desc;
  string30 county_of_origin;
  string10 dle_num;
  string9 fbi_num;
  string10 doc_num;
  string10 ins_num;
  string25 dl_num;
  string2 dl_state;
  string2 citizenship;
  string8 dob;
  string8 dob_alias;
  string13 county_of_birth;
  string25 place_of_birth;
  string25 street_address_1;
  string25 street_address_2;
  string25 street_address_3;
  string10 street_address_4;
  string10 street_address_5;
  string13 current_residence_county;
  string13 legal_residence_county;
  string3 race;
  string30 race_desc;
  string7 sex;
  string3 hair_color;
  string15 hair_color_desc;
  string3 eye_color;
  string15 eye_color_desc;
  string3 skin_color;
  string15 skin_color_desc;
  string10 scars_marks_tattoos_1;
  string10 scars_marks_tattoos_2;
  string10 scars_marks_tattoos_3;
  string10 scars_marks_tattoos_4;
  string10 scars_marks_tattoos_5;
  string3 height;
  string3 weight;
  string5 party_status;
  string60 party_status_desc;
  string10 _3g_offender;
  string10 violent_offender;
  string10 sex_offender;
  string10 vop_offender;
  string1 data_type;
  string26 record_setup_date;
  string45 datasource;
  qstring10 prim_range;
  string2 predir;
  qstring28 prim_name;
  qstring4 addr_suffix;
  string2 postdir;
  qstring10 unit_desig;
  qstring8 sec_range;
  qstring25 p_city_name;
  qstring25 v_city_name;
  string2 st;
  qstring5 zip5;
  qstring4 zip4;
  string4 cart;
  string1 cr_sort_sz;
  string4 lot;
  string1 lot_order;
  string2 dpbc;
  string1 chk_digit;
  string2 rec_type;
  string2 ace_fips_st;
  string3 ace_fips_county;
  string10 geo_lat;
  string11 geo_long;
  string4 msa;
  string7 geo_blk;
  string1 geo_match;
  string4 err_stat;
  unsigned1 clean_errors;
  string18 county_name;
  string12 did;
  string3 score;
  string9 ssn_appended;
  string1 curr_incar_flag;
  string1 curr_parole_flag;
  string1 curr_probation_flag;
  string8 src_upload_date;
  string3 age;
  string150 image_link;
  string1 fcra_conviction_flag;
  string1 fcra_traffic_flag;
  string8 fcra_date;
  string1 fcra_date_type;
  string8 conviction_override_date;
  string1 conviction_override_date_type;
  string2 offense_score;
  unsigned8 offender_persistent_id;
  string75 off_desc_1;
  string50 off_desc_2;
  string8 off_date;
  string8 arr_date;
  string8 convict_dt;
  string8 ct_disp_dt;
  string8 stc_dt;
  string8 inc_adm_dt;
  string3 fd_scores__fraudpointv2;
  unsigned8 source_rec_id;
  string4 source;
  unsigned4 process_date;
  unsigned4 dt_first_seen;
  unsigned4 dt_last_seen;
  unsigned4 dt_vendor_last_reported;
  unsigned4 dt_vendor_first_reported;
  string current;
  unsigned8 unique_id;
  // layout_clean_name cleaned_name;
   string5 title;
   string20 fname;
   string20 mname;
   string20 lname;
   string5 name_suffix;
   string3 name_score;

// Remaining Layout
  unsigned8 nid;
  unsigned2 name_ind;
  string100 address_1;
  string50 address_2;
 END;

//transform statement
layout_key_out makerecord (key_in L) := transform
self.file_date := L.file_date;
self.offender_key := L.offender_key;
self.vendor := L.vendor;
self.source_file := L.source_file;
self.record_type := L.record_type;
self.orig_state := L.orig_state;
self.id_num := L.id_num;
self.pty_nm := L.pty_nm;
self.pty_nm_fmt := L.pty_nm_fmt;
self.orig_lname := L.orig_lname;
self.orig_fname := L.orig_fname;
self.orig_mname := L.orig_mname;
self.orig_name_suffix := L.orig_name_suffix;
self.lname := L.lname;
self.fname := L.fname;
self.mname := L.mname;
self.name_suffix := L.name_suffix;
self.pty_typ := L.pty_typ;
self.ntype := L.ntype;
self.nindicator := L.nindicator;
self.nitro_flag := L.nitro_flag;
self.ssn := L.ssn;
self.case_num := L.case_num;
self.case_court := L.case_court;
self.case_date := L.case_date;
self.case_type := L.case_type;
self.case_type_desc := L.case_type_desc;
self.county_of_origin := L.county_of_origin;
self.dle_num := L.dle_num;
self.fbi_num := L.fbi_num;
self.doc_num := L.doc_num;
self.ins_num := L.ins_num;
self.dl_num := L.dl_num;
self.dl_state := L.dl_state;
self.citizenship := L.citizenship;
self.dob := L.dob;
self.dob_alias := L.dob_alias;
self.county_of_birth := L.county_of_birth;
self.place_of_birth := L.place_of_birth;
self.street_address_1 := L.street_address_1;
self.street_address_2 := L.street_address_2;
self.street_address_3 := L.street_address_3;
self.street_address_4 := L.street_address_4;
self.street_address_5 := L.street_address_5;
self.current_residence_county := L.current_residence_county;
self.legal_residence_county := L.legal_residence_county;
self.race := L.race;
self.race_desc := L.race_desc;
self.sex := L.sex;
self.hair_color := L.hair_color;
self.hair_color_desc := L.hair_color_desc;
self.eye_color := L.eye_color;
self.eye_color_desc := L.eye_color_desc;
self.skin_color := L.skin_color;
self.skin_color_desc := L.skin_color_desc;
self.scars_marks_tattoos_1 := L.scars_marks_tattoos_1;
self.scars_marks_tattoos_2 := L.scars_marks_tattoos_2;
self.scars_marks_tattoos_3 := L.scars_marks_tattoos_3;
self.scars_marks_tattoos_4 := L.scars_marks_tattoos_4;
self.scars_marks_tattoos_5 := L.scars_marks_tattoos_5;
self.height := L.height;
self.weight := L.weight;
self.party_status := L.party_status;
self.party_status_desc := L.party_status_desc;
self._3g_offender := L._3g_offender;
self.violent_offender := L.violent_offender;
self.sex_offender := L.sex_offender;
self.vop_offender := L.vop_offender;
self.data_type := L.data_type;
self.record_setup_date := L.record_setup_date;
self.datasource := L.datasource;
self.prim_range := L.prim_range;
self.predir := L.predir;
self.prim_name := L.prim_name;
self.addr_suffix := L.addr_suffix;
self.postdir := L.postdir;
self.unit_desig := L.unit_desig;
self.sec_range := L.sec_range;
self.p_city_name := L.p_city_name;
self.v_city_name := L.v_city_name;
self.st := L.st;
self.zip5 := L.zip5;
self.zip4 := L.zip4;
self.cart := L.cart;
self.cr_sort_sz := L.cr_sort_sz;
self.lot := L.lot;
self.lot_order := L.lot_order;
self.dpbc := L.dpbc;
self.chk_digit := L.chk_digit;
self.rec_type := L.rec_type;
self.ace_fips_st := L.ace_fips_st;
self.ace_fips_county := L.ace_fips_county;
self.geo_lat := L.geo_lat;
self.geo_long := L.geo_long;
self.msa := L.msa;
self.geo_blk := L.geo_blk;
self.geo_match := L.geo_match;
self.err_stat := L.err_stat;
self.clean_errors := L.clean_errors;
self.county_name := L.county_name;
self.did := L.did;
self.score := L.score;
self.ssn_appended := L.ssn_appended;
self.curr_incar_flag := L.curr_incar_flag;
self.curr_parole_flag := L.curr_parole_flag;
self.curr_probation_flag := L.curr_probation_flag;
self.src_upload_date := L.src_upload_date;
self.age := L.age;
self.image_link := L.image_link;
self.fcra_conviction_flag := L.fcra_conviction_flag;
self.fcra_traffic_flag := L.fcra_traffic_flag;
self.fcra_date := L.fcra_date;
self.fcra_date_type := L.fcra_date_type;
self.conviction_override_date := L.conviction_override_date;
self.conviction_override_date_type := L.conviction_override_date_type;
self.offense_score := L.offense_score;
self.offender_persistent_id := L.offender_persistent_id;
self.off_desc_1 := L.off_desc_1;
self.off_desc_2 := L.off_desc_2;
self.off_date := L.off_date;
self.arr_date := L.arr_date;
self.convict_dt := L.convict_dt;
self.ct_disp_dt := L.ct_disp_dt;
self.stc_dt := L.stc_dt;
self.inc_adm_dt := L.inc_adm_dt;
self.fd_scores__fraudpointv2 := L.fd_scores__fraudpointv2;
self.source_rec_id := L.source_rec_id;
self.source := L.source;
self.process_date := L.process_date;
self.dt_first_seen := L.dt_first_seen;
self.dt_last_seen := L.dt_last_seen;
self.dt_vendor_last_reported := L.dt_vendor_last_reported;
self.dt_vendor_first_reported := L.dt_vendor_first_reported;
self.current := L.current;
self.unique_id := L.unique_id;
 // layout_clean_name cleaned_name;
self.title := L.cleaned_name.title;
self.fname := L.cleaned_name.fname;
self.mname := L.cleaned_name.mname;
self.lname := L.cleaned_name.lname;
self.name_suffix := L.cleaned_name.name_suffix;
self.name_score := L.cleaned_name.name_score;
// Remaining Layout
self.nid := L.nid;
self.name_ind := L.name_ind;
self.address_1 := L.address_1;
self.address_2 := L.address_2;
end;

EXPORT file_fdn_qa_crim := project(key_in,makerecord(left));