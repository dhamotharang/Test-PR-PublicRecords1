#workunit('name','Prerun Stats for Hygenics Sex Offenders')
import ut, okc_sexual_offenders;

in_file := Hygenics_SOff.mapping_offender;

okc := in_file;

Layout_okc_stat := record
	okc.state_of_origin;
	okc.source;
	integer4 total                                                        := count(group);
	integer4 source_count                                           	  := sum(group, if(okc.source                                              <> '',1,0));
	integer4 scrape_date_count                                            := sum(group, if(okc.date_added                                              <> '',1,0));
	integer4 state_of_origin_count                                        := sum(group, if(okc.state_of_origin                                               <> '',1,0));
	integer4 name_orig_count                                              := sum(group, if(okc.name_orig                                                <> '',1,0));
	integer4 name_aka_count                                               := sum(group, if(okc.name_aka                                                 <> '',1,0));
	integer4 offender_status_count                                        := sum(group, if(okc.offender_status                                          <> '',1,0));
	integer4 offender_category_count                                      := sum(group, if(okc.offender_category                                        <> '',1,0));
	integer4 risk_level_code_count                                        := sum(group, if(okc.risk_level_code                                          <> '',1,0));
	integer4 risk_description_count                                       := sum(group, if(okc.risk_description                                         <> '',1,0));
	integer4 police_agency_count                                          := sum(group, if(okc.police_agency                                            <> '',1,0));
	integer4 police_agency_contact_name_count                             := sum(group, if(okc.police_agency_contact_name                               <> '',1,0));
	integer4 police_agency_address_1_count                                := sum(group, if(okc.police_agency_address_1                                  <> '',1,0));
	integer4 police_agency_address_2_count                                := sum(group, if(okc.police_agency_address_2                                  <> '',1,0));
	integer4 police_agency_phone_count                                    := sum(group, if(okc.police_agency_phone                                      <> '',1,0));
	integer4 registration_type_count                                      := sum(group, if(okc.registration_type                                        <> '',1,0));
	integer4 reg_date_1_count                                             := sum(group, if(okc.reg_date_1                                               <> '',1,0));
	integer4 reg_date_1_type_count                                        := sum(group, if(okc.reg_date_1_type                                          <> '',1,0));
	integer4 reg_date_2_count                                             := sum(group, if(okc.reg_date_2                                               <> '',1,0));
	integer4 reg_date_2_type_count                                        := sum(group, if(okc.reg_date_2_type                                          <> '',1,0));
	integer4 reg_date_3_count                                             := sum(group, if(okc.reg_date_3                                               <> '',1,0));
	integer4 reg_date_3_type_count                                        := sum(group, if(okc.reg_date_3_type                                          <> '',1,0));
	integer4 registration_address_1_count                                 := sum(group, if(okc.registration_address_1                                   <> '',1,0));
	integer4 registration_address_2_count                                 := sum(group, if(okc.registration_address_2                                   <> '',1,0));
	integer4 registration_address_3_count                                 := sum(group, if(okc.registration_address_3                                   <> '',1,0));
	integer4 registration_address_4_count                                 := sum(group, if(okc.registration_address_4                                   <> '',1,0));
	integer4 registration_address_5_count                                 := sum(group, if(okc.registration_address_5                                   <> '',1,0));
	integer4 registration_county_count                                    := sum(group, if(okc.registration_county                                      <> '',1,0));
	integer4 employer_count                                               := sum(group, if(okc.employer                                                 <> '',1,0));
	integer4 employer_address_1_count                                     := sum(group, if(okc.employer_address_1                                       <> '',1,0));
	integer4 employer_address_2_count                                     := sum(group, if(okc.employer_address_2                                       <> '',1,0));
	integer4 employer_address_3_count                                     := sum(group, if(okc.employer_address_3                                       <> '',1,0));
	integer4 employer_address_4_count                                     := sum(group, if(okc.employer_address_4                                       <> '',1,0));
	integer4 employer_address_5_count                                     := sum(group, if(okc.employer_address_5                                       <> '',1,0));
	integer4 employer_county_count                                        := sum(group, if(okc.employer_county                                          <> '',1,0));
	integer4 school_count                                                 := sum(group, if(okc.school                                                   <> '',1,0));
	integer4 school_address_1_count                                       := sum(group, if(okc.school_address_1                                         <> '',1,0));
	integer4 school_address_2_count                                       := sum(group, if(okc.school_address_2                                         <> '',1,0));
	integer4 school_address_3_count                                       := sum(group, if(okc.school_address_3                                         <> '',1,0));
	integer4 school_address_4_count                                       := sum(group, if(okc.school_address_4                                         <> '',1,0));
	integer4 school_address_5_count                                       := sum(group, if(okc.school_address_5                                         <> '',1,0));
	integer4 school_county_count                                          := sum(group, if(okc.school_county                                            <> '',1,0));
	integer4 offender_id_count                                            := sum(group, if(okc.offender_id                                              <> '',1,0));
	integer4 doc_number_count                                             := sum(group, if(okc.doc_number                                               <> '',1,0));
	integer4 sor_number_count                                             := sum(group, if(okc.sor_number                                               <> '',1,0));
		integer4 st_id_number_count                                           := sum(group, if(okc.st_id_number                                             <> '',1,0));
		integer4 fbi_number_count                                             := sum(group, if(okc.fbi_number                                               <> '',1,0));
		integer4 ncic_number_count                                            := sum(group, if(okc.ncic_number                                              <> '',1,0));
		integer4 orig_ssn_count                                               := sum(group, if(okc.orig_ssn                                                 <> '',1,0));
		integer4 date_of_birth_count                                          := sum(group, if(okc.date_of_birth                                            <> '',1,0));
		integer4 date_of_birth_aka_count                                      := sum(group, if(okc.date_of_birth_aka                                        <> '',1,0));
		integer4 age_count                                                    := sum(group, if(okc.age                                                      <> '',1,0));
		integer4 race_count                                                   := sum(group, if(okc.race                                                     <> '',1,0));
		integer4 ethnicity_count                                              := sum(group, if(okc.ethnicity                                                <> '',1,0));
		integer4 sex_count                                                    := sum(group, if(okc.sex                                                      <> '',1,0));
		integer4 hair_color_count                                             := sum(group, if(okc.hair_color                                               <> '',1,0));
		integer4 eye_color_count                                              := sum(group, if(okc.eye_color                                                <> '',1,0));
		integer4 height_count                                                 := sum(group, if(okc.height                                                   <> '',1,0));
		integer4 weight_count                                                 := sum(group, if(okc.weight                                                   <> '',1,0));
		integer4 skin_tone_count                                              := sum(group, if(okc.skin_tone                                                <> '',1,0));
		integer4 build_type_count                                             := sum(group, if(okc.build_type                                               <> '',1,0));
		integer4 scars_marks_tattoos_count                                    := sum(group, if(okc.scars_marks_tattoos                                      <> '',1,0));
		integer4 shoe_size_count                                              := sum(group, if(okc.shoe_size                                                <> '',1,0));
		integer4 corrective_lense_flag_count                                  := sum(group, if(okc.corrective_lense_flag                                    <> '',1,0));
		integer4 conviction_jurisdiction_1_count                              := sum(group, if(okc.conviction_jurisdiction_1                                <> '',1,0));
		integer4 conviction_date_1_count                                      := sum(group, if(okc.conviction_date_1                                        <> '',1,0));
		integer4 court_1_count                                                := sum(group, if(okc.court_1                                                  <> '',1,0));
		integer4 court_case_number_1_count                                    := sum(group, if(okc.court_case_number_1                                      <> '',1,0));
		integer4 offense_date_1_count                                         := sum(group, if(okc.offense_date_1                                           <> '',1,0));
		integer4 offense_code_or_statute_1_count                              := sum(group, if(okc.offense_code_or_statute_1                                <> '',1,0));
		integer4 offense_description_1_count                                  := sum(group, if(okc.offense_description_1                                    <> '',1,0));
		integer4 offense_description_1_2_count                                := sum(group, if(okc.offense_description_1_2                                  <> '',1,0));
		integer4 victim_minor_1_count                                         := sum(group, if(okc.victim_minor_1                                           <> '',1,0));
		integer4 victim_age_1_count                                           := sum(group, if(okc.victim_age_1                                             <> '',1,0));
		integer4 victim_gender_1_count                                        := sum(group, if(okc.victim_gender_1                                          <> '',1,0));
		integer4 victim_relationship_1_count                                  := sum(group, if(okc.victim_relationship_1                                    <> '',1,0));
		integer4 sentence_description_1_count                                 := sum(group, if(okc.sentence_description_1                                   <> '',1,0));
		integer4 sentence_description_1_2_count                               := sum(group, if(okc.sentence_description_1_2                                 <> '',1,0));
		integer4 conviction_jurisdiction_2_count                              := sum(group, if(okc.conviction_jurisdiction_2                                <> '',1,0));
		integer4 conviction_date_2_count                                      := sum(group, if(okc.conviction_date_2                                        <> '',1,0));
		integer4 court_2_count                                                := sum(group, if(okc.court_2                                                  <> '',1,0));
		integer4 court_case_number_2_count                                    := sum(group, if(okc.court_case_number_2                                      <> '',1,0));
		integer4 offense_date_2_count                                         := sum(group, if(okc.offense_date_2                                           <> '',1,0));
		integer4 offense_code_or_statute_2_count                              := sum(group, if(okc.offense_code_or_statute_2                                <> '',1,0));
		integer4 offense_description_2_count                                  := sum(group, if(okc.offense_description_2                                    <> '',1,0));
		integer4 offense_description_2_2_count                                := sum(group, if(okc.offense_description_2_2                                  <> '',1,0));
		integer4 victim_minor_2_count                                         := sum(group, if(okc.victim_minor_2                                           <> '',1,0));
		integer4 victim_age_2_count                                           := sum(group, if(okc.victim_age_2                                             <> '',1,0));
		integer4 victim_gender_2_count                                        := sum(group, if(okc.victim_gender_2                                          <> '',1,0));
		integer4 victim_relationship_2_count                                  := sum(group, if(okc.victim_relationship_2                                    <> '',1,0));
		integer4 sentence_description_2_count                                 := sum(group, if(okc.sentence_description_2                                   <> '',1,0));
		integer4 sentence_description_2_2_count                               := sum(group, if(okc.sentence_description_2_2                                 <> '',1,0));
		integer4 conviction_jurisdiction_3_count                              := sum(group, if(okc.conviction_jurisdiction_3                                <> '',1,0));
		integer4 conviction_date_3_count                                      := sum(group, if(okc.conviction_date_3                                        <> '',1,0));
		integer4 court_3_count                                                := sum(group, if(okc.court_3                                                  <> '',1,0));
		integer4 court_case_number_3_count                                    := sum(group, if(okc.court_case_number_3                                      <> '',1,0));
		integer4 offense_date_3_count                                         := sum(group, if(okc.offense_date_3                                           <> '',1,0));
		integer4 offense_code_or_statute_3_count                              := sum(group, if(okc.offense_code_or_statute_3                                <> '',1,0));
		integer4 offense_description_3_count                                  := sum(group, if(okc.offense_description_3                                    <> '',1,0));
		integer4 offense_description_3_2_count                                := sum(group, if(okc.offense_description_3_2                                  <> '',1,0));
		integer4 victim_minor_3_count                                         := sum(group, if(okc.victim_minor_3                                           <> '',1,0));
		integer4 victim_age_3_count                                           := sum(group, if(okc.victim_age_3                                             <> '',1,0));
		integer4 victim_gender_3_count                                        := sum(group, if(okc.victim_gender_3                                          <> '',1,0));
		integer4 victim_relationship_3_count                                  := sum(group, if(okc.victim_relationship_3                                    <> '',1,0));
		integer4 sentence_description_3_count                                 := sum(group, if(okc.sentence_description_3                                   <> '',1,0));
		integer4 sentence_description_3_2_count                               := sum(group, if(okc.sentence_description_3_2                                 <> '',1,0));
		integer4 conviction_jurisdiction_4_count                              := sum(group, if(okc.conviction_jurisdiction_4                                <> '',1,0));
		integer4 conviction_date_4_count                                      := sum(group, if(okc.conviction_date_4                                        <> '',1,0));
		integer4 court_4_count                                                := sum(group, if(okc.court_4                                                  <> '',1,0));
		integer4 court_case_number_4_count                                    := sum(group, if(okc.court_case_number_4                                      <> '',1,0));
		integer4 offense_date_4_count                                         := sum(group, if(okc.offense_date_4                                           <> '',1,0));
		integer4 offense_code_or_statute_4_count                              := sum(group, if(okc.offense_code_or_statute_4                                <> '',1,0));
		integer4 offense_description_4_count                                  := sum(group, if(okc.offense_description_4                                    <> '',1,0));
		integer4 offense_description_4_2_count                                := sum(group, if(okc.offense_description_4_2                                  <> '',1,0));
		integer4 victim_minor_4_count                                         := sum(group, if(okc.victim_minor_4                                           <> '',1,0));
		integer4 victim_age_4_count                                           := sum(group, if(okc.victim_age_4                                             <> '',1,0));
		integer4 victim_gender_4_count                                        := sum(group, if(okc.victim_gender_4                                          <> '',1,0));
		integer4 victim_relationship_4_count                                  := sum(group, if(okc.victim_relationship_4                                    <> '',1,0));
		integer4 sentence_description_4_count                                 := sum(group, if(okc.sentence_description_4                                   <> '',1,0));
		integer4 sentence_description_4_2_count                               := sum(group, if(okc.sentence_description_4_2                                 <> '',1,0));
		integer4 conviction_jurisdiction_5_count                              := sum(group, if(okc.conviction_jurisdiction_5                                <> '',1,0));
		integer4 conviction_date_5_count                                      := sum(group, if(okc.conviction_date_5                                        <> '',1,0));
		integer4 court_5_count                                                := sum(group, if(okc.court_5                                                  <> '',1,0));
		integer4 court_case_number_5_count                                    := sum(group, if(okc.court_case_number_5                                      <> '',1,0));
		integer4 offense_date_5_count                                         := sum(group, if(okc.offense_date_5                                           <> '',1,0));
		integer4 offense_code_or_statute_5_count                              := sum(group, if(okc.offense_code_or_statute_5                                <> '',1,0));
		integer4 offense_description_5_count                                  := sum(group, if(okc.offense_description_5                                    <> '',1,0));
		integer4 offense_description_5_2_count                                := sum(group, if(okc.offense_description_5_2                                  <> '',1,0));
		integer4 victim_minor_5_count                                         := sum(group, if(okc.victim_minor_5                                           <> '',1,0));
		integer4 victim_age_5_count                                           := sum(group, if(okc.victim_age_5                                             <> '',1,0));
		integer4 victim_gender_5_count                                        := sum(group, if(okc.victim_gender_5                                          <> '',1,0));
		integer4 victim_relationship_5_count                                  := sum(group, if(okc.victim_relationship_5                                    <> '',1,0));
		integer4 sentence_description_5_count                                 := sum(group, if(okc.sentence_description_5                                   <> '',1,0));
		integer4 sentence_description_5_2_count                               := sum(group, if(okc.sentence_description_5_2                                 <> '',1,0));
		integer4 addl_comments_1_count                                        := sum(group, if(okc.addl_comments_1                                          <> '',1,0));
		integer4 addl_comments_2_count                                        := sum(group, if(okc.addl_comments_2                                          <> '',1,0));
		integer4 orig_dl_number_count                                         := sum(group, if(okc.orig_dl_number                                           <> '',1,0));
		integer4 orig_dl_state_count                                          := sum(group, if(okc.orig_dl_state                                            <> '',1,0));
		integer4 orig_veh_year_1_count                                        := sum(group, if(okc.orig_veh_year_1                                          <> '',1,0));
		integer4 orig_veh_color_1_count                                       := sum(group, if(okc.orig_veh_color_1                                         <> '',1,0));
		integer4 orig_veh_make_model_1_count                                  := sum(group, if(okc.orig_veh_make_model_1                                    <> '',1,0));
		integer4 orig_veh_plate_1_count                                       := sum(group, if(okc.orig_veh_plate_1                                         <> '',1,0));
		integer4 orig_veh_state_1_count                                       := sum(group, if(okc.orig_veh_state_1                                         <> '',1,0));
		integer4 orig_veh_year_2_count                                        := sum(group, if(okc.orig_veh_year_2                                          <> '',1,0));
		integer4 orig_veh_color_2_count                                       := sum(group, if(okc.orig_veh_color_2                                         <> '',1,0));
		integer4 orig_veh_make_model_2_count                                  := sum(group, if(okc.orig_veh_make_model_2                                    <> '',1,0));
		integer4 orig_veh_plate_2_count                                       := sum(group, if(okc.orig_veh_plate_2                                         <> '',1,0));
		integer4 orig_veh_state_2_count                                       := sum(group, if(okc.orig_veh_state_2                                         <> '',1,0));
		integer4 image_link_count                                             := sum(group, if(okc.image_link                                               <> '',1,0));
		integer4 image_date_count                                             := sum(group, if(okc.image_date                                               <> '',1,0));
	end;
	
okc_stat 			:= table(okc, Layout_okc_stat, state_of_origin, source, few);
output_okc_stat 	:= output(sort(okc_stat, state_of_origin, source), named('okc_field_population_stats'), all);

export Stats_Pre 	:= output_okc_stat;
