THRESHOLD:45
//BLOCKTHRESHOLD:5 
//HACK:MAXBLOCKSIZE:20000
MODULE:HealthCareFacilityHeader
FILENAME:HealthFacility
IDNAME:LNPID
IDFIELD:EXISTS:LNPID
SOURCEFIELD:SRC
SOURCERIDFIELD:SOURCE_RID
//FieldType
FIELDTYPE:DEFAULT:LEFTTRIM:NOQUOTES("'):ONFAIL(CLEAN):
FIELDTYPE:NUMBER:ALLOW(0123456789-):
FIELDTYPE:ALPHA:CAPS:ALLOW(ABCDEFGHIJKLMNOPQRSTUVWXYZ):
FIELDTYPE:ALPHANUM:CAPS:ALLOW(ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-):
FIELDTYPE:WORDBAG:CAPS:ALLOW(ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'):SPACES( <>{}[]-^=!+&,./):ONFAIL(CLEAN):
//Uncomment up to NINES for internal or external adl
RIDFIELD:RID
RECORDS:7688562
POPULATION:1600000
NINES:4
//Fuzzy
//HACK
//HACK:SLICEDISTANCE:18
//HACK:SLICETHRESHOLD:1
HACK:CUSTOMINTERNALJOIN:Custom_JOIN
//Phone and Fax
FIELD:PHONE:SWITCH0:20,226
FIELD:FAX:SWITCH0:20,193
//UNIQUE	
FIELD:UPIN:CARRY:0,0
FIELD:NPI_NUMBER:LIKE(NUMBER):PROP:FORCE(--):22,0
FIELD:DEA_NUMBER:21,38
FIELD:CLIA_NUMBER:PROP:FORCE(--):22,0
FIELD:MEDICARE_FACILITY_NUMBER:21,147
//TAX
FIELD:TAX_ID:WEIGHT(0.25):21,34
FIELD:FEIN:PROP:FORCE(--,OR(NPI_NUMBER[15])):17,23
//LIC NUMBER
FIELD:C_LIC_NBR:CONTEXT(LIC_STATE):WEIGHT(0.75):EDIT1:19,147
//Fields
FIELD:SRC:CARRY
// Name
FIELD:CNAME:CARRY:0,0
//FIELD:CNP_NAME:BAGOFWORDS(MOST):LIKE(WORDBAG):TYPE(STRING120):INITIAL:HYPHEN1:ABBR(ACRONYM,INITIAL):STEM(3):EDIT1(3):SWITCH0:FORCE(+,OR(FEIN[10]),OR(NPI_NUMBER[15]),OR(C_LIC_NBR[10]),OR(CLIA_NUMBER[15]),OR(MEDICARE_FACILITY_NUMBER[15])):13,292
FIELD:CNP_NAME:BAGOFWORDS(MANY):LIKE(WORDBAG):TYPE(STRING120):FORCE(+,OR(FEIN[10]),OR(NPI_NUMBER[15]),OR(C_LIC_NBR[10]),OR(CLIA_NUMBER[15]),OR(MEDICARE_FACILITY_NUMBER[15])):20,366
FIELD:CNP_NUMBER:PROP:FORCE(--,OR(FEIN[10]),OR(NPI_NUMBER[15]),OR(CLIA_NUMBER[15]),OR(C_LIC_NBR[10]),OR(MEDICARE_FACILITY_NUMBER[15])):13,44
FIELD:CNP_STORE_NUMBER:PROP:FORCE(--,OR(FEIN[10]),OR(NPI_NUMBER[15]),OR(C_LIC_NBR[10]),OR(CLIA_NUMBER[15]),OR(MEDICARE_FACILITY_NUMBER[15])):20,44
FIELD:CNP_BTYPE:PROP:FORCE(--,OR(FEIN[10]),OR(NPI_NUMBER[15]),OR(C_LIC_NBR[10]),OR(CLIA_NUMBER[15]),OR(MEDICARE_FACILITY_NUMBER[15])):4,22
FIELD:CNP_LOWV:CARRY:5,0
FIELD:CNP_TRANSLATED:CARRY:5,0
FIELD:CNP_CLASSID:CARRY:5,0
// Address
FIELD:ADDRESS_ID:LIKE(NUMBER):CARRY
FIELD:PRIM_RANGE:PROP:EDIT1:SWITCH0:FORCE(+,OR(NPI_NUMBER[15])):12,210
FIELD:PRIM_NAME:TYPE(STRING28):SWITCH0:BAGOFWORDS(MOST):EDIT1:INITIAL:ABBR(FIRST):PROP:FORCE(+,OR(NPI_NUMBER[15])):13,290
FIELD:SEC_RANGE:HYPHEN2:EDIT1:PROP:SWITCH0:FORCE(--,OR(NPI_NUMBER[15])):7,70
FIELD:ST:LIKE(ALPHA):SWITCH0:FORCE(+,OR(NPI_NUMBER[15])):5,73
FIELD:V_CITY_NAME:CONTEXT(ST):SWITCH0:11,191
FIELD:ZIP:SWITCH0:13,240
//
FIELD:TAXONOMY:PROP:SWITCH0:7,85
FIELD:TAXONOMY_CODE:WEIGHT(0.25):PROP:FORCE(--,OR(NPI_NUMBER[15])):4,10
FIELD:MEDICAID_NUMBER:PROP:22,14
FIELD:NCPDP_NUMBER:PROP:FORCE(--):22,2
FIELD:VENDOR_ID:CONTEXT(SRC):SWITCH0:WEIGHT(0.1):21,934
//CONCEPT
CONCEPT:FAC_NAME:CNP_NAME:CNP_NUMBER:CNP_STORE_NUMBER:CNP_BTYPE:BAGOFWORDS:SWITCH0:20,401
CONCEPT:ADDR1:PRIM_RANGE:PRIM_NAME:SEC_RANGE:BAGOFWORDS:SWITCH0:20,447
CONCEPT:LOCALE:V_CITY_NAME:ST:ZIP:FORCE(+-2,OR(NPI_NUMBER[15])):SWITCH0:13,242
CONCEPT:ADDRESS:ADDR1:LOCALE:FORCE(+,OR(NPI_NUMBER[15])):SWITCH0:20,449
//CLEAVE RULES
CLEAVE:Rule01:BASIS(NPI_NUMBER):EXPLODE:MATCH(ALL)
//CLEAVE:RULE02:BASIS(CNP_NAME:CNP_STORE_NUMBER):MINIMUM(1)
//CLEAVE:RULE03:BASIS(CNP_NAME:CNP_BTYPE):MINIMUM(1)