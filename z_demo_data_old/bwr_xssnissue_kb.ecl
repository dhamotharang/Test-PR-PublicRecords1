import header, doxie, ut;

filedate:='20081103';

my_data := dataset([
{'77300','9999','0001','1935','1999','United States'},
{'77301','9999','0001','1935','1999','United States'},
{'77302','9999','0001','1935','1999','United States'},
{'77303','9999','0001','1935','1999','United States'},
{'77304','9999','0001','1935','1999','United States'},
{'77305','9999','0001','1935','1999','United States'},
{'77306','9999','0001','1935','1999','United States'},
{'77307','9999','0001','1935','1999','United States'},
{'77308','9999','0001','1935','1999','United States'},
{'77309','9999','0001','1935','1999','United States'},
{'77310','9999','0001','1935','1999','United States'},
{'77311','9999','0001','1935','1999','United States'},
{'77312','9999','0001','1935','1999','United States'},
{'77313','9999','0001','1935','1999','United States'},
{'77314','9999','0001','1935','1999','United States'},
{'77315','9999','0001','1935','1999','United States'},
{'77316','9999','0001','1935','1999','United States'},
{'77317','9999','0001','1935','1999','United States'},
{'77318','9999','0001','1935','1999','United States'},
{'77319','9999','0001','1935','1999','United States'},
{'77320','9999','0001','1935','1999','United States'},
{'77321','9999','0001','1935','1999','United States'},
{'77322','9999','0001','1935','1999','United States'},
{'77323','9999','0001','1935','1999','United States'},
{'77324','9999','0001','1935','1999','United States'},
{'77325','9999','0001','1935','1999','United States'},
{'77326','9999','0001','1935','1999','United States'},
{'77327','9999','0001','1935','1999','United States'},
{'77328','9999','0001','1935','1999','United States'},
{'77329','9999','0001','1935','1999','United States'},
{'77330','9999','0001','1935','1999','United States'},
{'77331','9999','0001','1935','1999','United States'},
{'77332','9999','0001','1935','1999','United States'},
{'77333','9999','0001','1935','1999','United States'},
{'77334','9999','0001','1935','1999','United States'},
{'77335','9999','0001','1935','1999','United States'},
{'77336','9999','0001','1935','1999','United States'},
{'77337','9999','0001','1935','1999','United States'},
{'77338','9999','0001','1935','1999','United States'},
{'77339','9999','0001','1935','1999','United States'},
{'77340','9999','0001','1935','1999','United States'},
{'77341','9999','0001','1935','1999','United States'},
{'77342','9999','0001','1935','1999','United States'},
{'77343','9999','0001','1935','1999','United States'},
{'77344','9999','0001','1935','1999','United States'},
{'77345','9999','0001','1935','1999','United States'},
{'77346','9999','0001','1935','1999','United States'},
{'77347','9999','0001','1935','1999','United States'},
{'77348','9999','0001','1935','1999','United States'},
{'77349','9999','0001','1935','1999','United States'},
{'77350','9999','0001','1935','1999','United States'},
{'77351','9999','0001','1935','1999','United States'},
{'77352','9999','0001','1935','1999','United States'},
{'77353','9999','0001','1935','1999','United States'},
{'77354','9999','0001','1935','1999','United States'},
{'77355','9999','0001','1935','1999','United States'},
{'77356','9999','0001','1935','1999','United States'},
{'77357','9999','0001','1935','1999','United States'},
{'77358','9999','0001','1935','1999','United States'},
{'77359','9999','0001','1935','1999','United States'},
{'77360','9999','0001','1935','1999','United States'},
{'77361','9999','0001','1935','1999','United States'},
{'77362','9999','0001','1935','1999','United States'},
{'77363','9999','0001','1935','1999','United States'},
{'77364','9999','0001','1935','1999','United States'},
{'77365','9999','0001','1935','1999','United States'},
{'77366','9999','0001','1935','1999','United States'},
{'77367','9999','0001','1935','1999','United States'},
{'77368','9999','0001','1935','1999','United States'},
{'77369','9999','0001','1935','1999','United States'},
{'77370','9999','0001','1935','1999','United States'},
{'77371','9999','0001','1935','1999','United States'},
{'77372','9999','0001','1935','1999','United States'},
{'77373','9999','0001','1935','1999','United States'},
{'77374','9999','0001','1935','1999','United States'},
{'77375','9999','0001','1935','1999','United States'},
{'77376','9999','0001','1935','1999','United States'},
{'77377','9999','0001','1935','1999','United States'},
{'77378','9999','0001','1935','1999','United States'},
{'77379','9999','0001','1935','1999','United States'},
{'77380','9999','0001','1935','1999','United States'},
{'77381','9999','0001','1935','1999','United States'},
{'77382','9999','0001','1935','1999','United States'},
{'77383','9999','0001','1935','1999','United States'},
{'77384','9999','0001','1935','1999','United States'},
{'77385','9999','0001','1935','1999','United States'},
{'77386','9999','0001','1935','1999','United States'},
{'77387','9999','0001','1935','1999','United States'},
{'77388','9999','0001','1935','1999','United States'},
{'77389','9999','0001','1935','1999','United States'},
{'77390','9999','0001','1935','1999','United States'},
{'77391','9999','0001','1935','1999','United States'},
{'77392','9999','0001','1935','1999','United States'},
{'77393','9999','0001','1935','1999','United States'},
{'77394','9999','0001','1935','1999','United States'},
{'77395','9999','0001','1935','1999','United States'},
{'77396','9999','0001','1935','1999','United States'},
{'77397','9999','0001','1935','1999','United States'},
{'77398','9999','0001','1935','1999','United States'},
{'77399','9999','0001','1935','1999','United States'} ],
  header.layout_ssn_map
  )
 ;

df := header.File_SSN_Map (ssn5!= '') + my_data;

s1:= buildindex (df, {ssn5, start_serial, end_serial}, {df},
  '~thor_data400::key::ssnissue2::' + filedate + '::ssn5');

s2 := fileservices.clearsuperfile('~thor_data400::key::ssnissue2::qa::ssn5');

s3 := fileservices.addsuperfile('~thor_data400::key::ssnissue2::qa::ssn5', '~thor_data400::key::ssnissue2::' + filedate + '::ssn5');

sequential(s1,s2,s3);

