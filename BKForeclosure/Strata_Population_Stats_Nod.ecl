IMPORT ut,strata, BKForeclosure;

EXPORT Strata_Population_Stats_Nod(STRING filedate) := FUNCTION
basefile_nod := File_BK_Foreclosure.fNod;
rPopulationStats_NOD := RECORD
      basefile_nod.src_state;
      CountGroup     := COUNT(GROUP);
			record_id_CountNonBlank         	:= SUM(GROUP,IF(basefile_nod.record_id<>0,1,0));   
	    date_first_seen_CountNonBlank   	:= SUM(GROUP,IF(basefile_nod.date_first_seen<>'',1,0));   
	    date_last_seen_CountNonBlank    	:= SUM(GROUP,IF(basefile_nod.date_last_seen<>'',1,0));  
	    date_vendor_first_reported_CountNonBlank   := SUM(GROUP,IF(basefile_nod.date_vendor_first_reported<>'',1,0));   
	    date_vendor_last_reported_CountNonBlank    := SUM(GROUP,IF(basefile_nod.date_vendor_last_reported<>'',1,0));   
	    process_date_CountNonBlank      	:= SUM(GROUP,IF(basefile_nod.process_date<>'',1,0));   
      src_CountNonBlank               	:= SUM(GROUP,IF(basefile_nod.src<>'',1,0));  
	    Delete_Flag_CountNonBlank         := SUM(GROUP,IF(basefile_nod.Delete_Flag<>'',1,0));
			foreclosure_id_CountNonBlank			:= SUM(GROUP,IF(basefile_nod.foreclosure_id<>'',1,0));
			ln_filedate_CountNonBlank         := SUM(GROUP,IF(basefile_nod.ln_filedate<>'',1,0));
	    bk_infile_type_CountNonBlank      := SUM(GROUP,IF(basefile_nod.bk_infile_type<>'',1,0));	
	    src_county_CountNonBlank          := SUM(GROUP,IF(basefile_nod.src_county<>'',1,0));
	    fips_cd_CountNonBlank             := SUM(GROUP,IF(basefile_nod.fips_cd<>'',1,0));
	    doc_type_CountNonBlank            := SUM(GROUP,IF(basefile_nod.doc_type<>'',1,0));
	    recording_dt_CountNonBlank        := SUM(GROUP,IF(basefile_nod.recording_dt<>'',1,0));
	    recording_doc_num_CountNonBlank   := SUM(GROUP,IF(basefile_nod.recording_doc_num<>'',1,0));
	    book_number_CountNonBlank         := SUM(GROUP,IF(basefile_nod.book_number<>'',1,0));
	    page_number_CountNonBlank         := SUM(GROUP,IF(basefile_nod.page_number<>'',1,0));
	    loan_number_CountNonBlank         := SUM(GROUP,IF(basefile_nod.loan_number<>'',1,0));
	    trustee_sale_number_CountNonBlank := SUM(GROUP,IF(basefile_nod.trustee_sale_number<>'',1,0));
	    case_number_CountNonBlank         := SUM(GROUP,IF(basefile_nod.case_number<>'',1,0));
	    orig_contract_date_CountNonBlank  := SUM(GROUP,IF(basefile_nod.orig_contract_date<>'',1,0));
	    unpaid_balance_CountNonBlank      := SUM(GROUP,IF(basefile_nod.unpaid_balance<>'',1,0));
	    past_due_amt_CountNonBlank        := SUM(GROUP,IF(basefile_nod.past_due_amt<>'',1,0));
	    as_of_dt_CountNonBlank            := SUM(GROUP,IF(basefile_nod.as_of_dt<>'',1,0));
	    contact_Fname_CountNonBlank       := SUM(GROUP,IF(basefile_nod.contact_Fname<>'',1,0));
	    contact_Lname_CountNonBlank       := SUM(GROUP,IF(basefile_nod.contact_Lname<>'',1,0));
	    attention_to_CountNonBlank        := SUM(GROUP,IF(basefile_nod.attention_to<>'',1,0));
	    contact_mail_full_addr_CountNonBlank   := SUM(GROUP,IF(basefile_nod.contact_mail_full_addr<>'',1,0));
	    contact_mail_unit_CountNonBlank   := SUM(GROUP,IF(basefile_nod.contact_mail_unit<>'',1,0));
	    contact_mail_city_CountNonBlank   := SUM(GROUP,IF(basefile_nod.contact_mail_city<>'',1,0));
	    contact_mail_state_CountNonBlank  := SUM(GROUP,IF(basefile_nod.contact_mail_state<>'',1,0));
	    contact_mail_zip5_CountNonBlank   := SUM(GROUP,IF(basefile_nod.contact_mail_zip5<>'',1,0));
	    contact_mail_zip4_CountNonBlank   := SUM(GROUP,IF(basefile_nod.contact_mail_zip4<>'',1,0));
	    contact_telephone_CountNonBlank   := SUM(GROUP,IF(basefile_nod.contact_telephone<>'',1,0));
	    due_date_CountNonBlank            := SUM(GROUP,IF(basefile_nod.due_date<>'',1,0));
	    trustee_fname_CountNonBlank       := SUM(GROUP,IF(basefile_nod.trustee_fname<>'',1,0));
	    trustee_lname_CountNonBlank       := SUM(GROUP,IF(basefile_nod.trustee_lname<>'',1,0));
	    trustee_mail_full_addr_CountNonBlank   := SUM(GROUP,IF(basefile_nod.trustee_mail_full_addr<>'',1,0));
	    trustee_mail_unit_CountNonBlank   := SUM(GROUP,IF(basefile_nod.trustee_mail_unit<>'',1,0));
	    trustee_mail_city_CountNonBlank   := SUM(GROUP,IF(basefile_nod.trustee_mail_city<>'',1,0));
	    trustee_mail_state_CountNonBlank  := SUM(GROUP,IF(basefile_nod.trustee_mail_state<>'',1,0));
	    trustee_mail_zip5_CountNonBlank   := SUM(GROUP,IF(basefile_nod.trustee_mail_zip5<>'',1,0));
	    trustee_mail_zip4_CountNonBlank   := SUM(GROUP,IF(basefile_nod.trustee_mail_zip4<>'',1,0));
	    trustee_telephone_CountNonBlank   := SUM(GROUP,IF(basefile_nod.trustee_telephone<>'',1,0));
	    borrower1_fname_CountNonBlank     := SUM(GROUP,IF(basefile_nod.borrower1_fname<>'',1,0));
	    borrower1_lname_CountNonBlank     := SUM(GROUP,IF(basefile_nod.borrower1_lname<>'',1,0));
	    borrower1_id_cd_CountNonBlank     := SUM(GROUP,IF(basefile_nod.borrower1_id_cd<>'',1,0));
	    borrower2_fname_CountNonBlank     := SUM(GROUP,IF(basefile_nod.borrower2_fname<>'',1,0));
	    borrower2_lname_CountNonBlank     := SUM(GROUP,IF(basefile_nod.borrower2_lname<>'',1,0));
	    borrower2_id_cd_CountNonBlank     := SUM(GROUP,IF(basefile_nod.borrower2_id_cd<>'',1,0));
	    orig_lender_name_CountNonBlank    := SUM(GROUP,IF(basefile_nod.orig_lender_name<>'',1,0));
	    orig_lender_type_CountNonBlank    := SUM(GROUP,IF(basefile_nod.orig_lender_type<>'',1,0));
	    curr_lender_name_CountNonBlank    := SUM(GROUP,IF(basefile_nod.curr_lender_name<>'',1,0));
	    curr_lender_type_CountNonBlank    := SUM(GROUP,IF(basefile_nod.curr_lender_type<>'',1,0));
	    mers_indicator_CountNonBlank      := SUM(GROUP,IF(basefile_nod.mers_indicator<>'',1,0));
	    loan_recording_date_CountNonBlank := SUM(GROUP,IF(basefile_nod.loan_recording_date<>'',1,0));
	    loan_doc_num_CountNonBlank        := SUM(GROUP,IF(basefile_nod.loan_doc_num<>'',1,0));
	    loan_book_CountNonBlank           := SUM(GROUP,IF(basefile_nod.loan_book<>'',1,0));
	    loan_page_CountNonBlank           := SUM(GROUP,IF(basefile_nod.loan_page<>'',1,0));
	    orig_loan_amt_CountNonBlank       := SUM(GROUP,IF(basefile_nod.orig_loan_amt<>'',1,0));
	    legal_lot_num_CountNonBlank       := SUM(GROUP,IF(basefile_nod.legal_lot_num<>'',1,0));
	    legal_block_CountNonBlank         := SUM(GROUP,IF(basefile_nod.legal_block<>'',1,0));
	    legal_subdivision_name_CountNonBlank   := SUM(GROUP,IF(basefile_nod.legal_subdivision_name<>'',1,0));
	    legal_brief_desc_CountNonBlank    := SUM(GROUP,IF(basefile_nod.legal_brief_desc<>'',1,0));
	    auction_date_CountNonBlank        := SUM(GROUP,IF(basefile_nod.auction_date<>'',1,0));
	    auction_time_CountNonBlank        := SUM(GROUP,IF(basefile_nod.auction_time<>'',1,0));
	    auction_location_CountNonBlank    := SUM(GROUP,IF(basefile_nod.auction_location<>'',1,0));
	    auction_min_bid_amt_CountNonBlank := SUM(GROUP,IF(basefile_nod.auction_min_bid_amt<>'',1,0));
	    trustee_mail_careof_CountNonBlank := SUM(GROUP,IF(basefile_nod.trustee_mail_careof<>'',1,0));
	    property_addr_cd_CountNonBlank    := SUM(GROUP,IF(basefile_nod.property_addr_cd<>'',1,0));
	    auction_city_CountNonBlank        := SUM(GROUP,IF(basefile_nod.auction_city<>'',1,0));
	    original_nod_recording_date_CountNonBlank   := SUM(GROUP,IF(basefile_nod.original_nod_recording_date<>'',1,0));
	    original_nod_doc_num_CountNonBlank:= SUM(GROUP,IF(basefile_nod.original_nod_doc_num<>'',1,0));
	    original_nod_book_CountNonBlank   := SUM(GROUP,IF(basefile_nod.original_nod_book<>'',1,0));
	    original_nod_page_CountNonBlank   := SUM(GROUP,IF(basefile_nod.original_nod_page<>'',1,0));
	    nod_apn_CountNonBlank             := SUM(GROUP,IF(basefile_nod.nod_apn<>'',1,0));
	    property_full_addr_CountNonBlank  := SUM(GROUP,IF(basefile_nod.property_full_addr<>'',1,0));
	    prop_addr_unit_type_CountNonBlank := SUM(GROUP,IF(basefile_nod.prop_addr_unit_type<>'',1,0));
	    prop_addr_unit_no_CountNonBlank   := SUM(GROUP,IF(basefile_nod.prop_addr_unit_no<>'',1,0));
	    prop_addr_city_CountNonBlank      := SUM(GROUP,IF(basefile_nod.prop_addr_city<>'',1,0));
	    prop_addr_state_CountNonBlank     := SUM(GROUP,IF(basefile_nod.prop_addr_state<>'',1,0));
	    prop_addr_zip5_CountNonBlank      := SUM(GROUP,IF(basefile_nod.prop_addr_zip5<>'',1,0));
	    prop_addr_zip4_CountNonBlank      := SUM(GROUP,IF(basefile_nod.prop_addr_zip4<>'',1,0));
	    APN_CountNonBlank                 := SUM(GROUP,IF(basefile_nod.APN<>'',1,0));
	    sam_pid_CountNonBlank             := SUM(GROUP,IF(basefile_nod.sam_pid<>'',1,0));
	    deed_pid_CountNonBlank            := SUM(GROUP,IF(basefile_nod.deed_pid<>'',1,0));
	    lps_internal_pid_CountNonBlank    := SUM(GROUP,IF(basefile_nod.lps_internal_pid<>'',1,0));
	    nod_source_CountNonBlank          := SUM(GROUP,IF(basefile_nod.nod_source<>'',1,0));
			document_desc_CountNonBlank				:= SUM(GROUP,IF(basefile_nod.document_desc<>'',1,0));
END;

  
	basestrata := SORT(TABLE(basefile_nod,rPopulationStats_NOD,src_state,few),src_state);

	strata.createXMLStats(basestrata,'BKForeclosure_Nod','data',filedate,'',strataResults);
	
RETURN strataresults;
END;							 