c_in:= sample(misc.bus_compass_query1(bdid<>0),5000,1);
c := distribute(c_in,hash(bdid));

i_in := misc.bus_infousa_abius_query1(bdid<>0);
i := distribute(i_in,hash(bdid));

d_in :=misc.bus_dnb_dmi_query1(bdid<>0);
d := distribute(d_in,hash(bdid));


layout_all_three := record
unsigned6 c_bdid:=0;
//
string30 c_SALES_VOLUME_DESC:='';
string30 i_SALES_VOLUME_DESC:='';
string30 i_TOTAL_OUTPUT_SALES_DESC:='';
string30 d_annual_sales_volume_desc:='';
//
string30 c_EMPLOYEE_SIZE_DESC:='';
string30 i_EMPLOYEE_SIZE_DESC:='';
string30 i_OFFICE_SIZE_DESC:='';
string1 i_OFFICE_SIZE_CD:='';
string30 i_TOTAL_EMPLOYEE_SIZE_DESC:='';
string30 d_employees_total_desc:='';
string30 d_employees_here_desc:=''; 
//
string c_Sales_Volume:='';
string c_Employee_Size:='';
string1 i_SALES_VOLUME_CD:='';
string1 i_TOTAL_OUTPUT_SALES_CD:='';
string1 i_EMPLOYEE_SIZE_CD:='';
string1 i_TOTAL_EMPLOYEE_SIZE_CD:='';
string1	d_my_annual_sales_volume_cd:='';
string1	d_my_employees_total_cd:='';
string1	d_my_employees_here_cd:=''; 
//
unsigned6 i_bdid:=0;
unsigned6 d_bdid:=0;
//
string c_Company:='';
string c_Address:='';
string c_City:='';
string c_State:='';
string c_Zip_Code:='';
string c_Phone:='';
string c_Fax:='';
string c_Contact_First_Name:='';
string c_Contact_Last_Name:='';
string c_Contact_Title:='';
string c_SIC:='';
string c_Credit_Rating:='';
string c_Number_of_PCs:='';
string c_Square_Footage:='';
string c_County:='';
string c_MSA_Area:='';
string c_Gender:='';
string c_NACIS_Code:='';
string c_NACIS_Description:='';
string c_SIC2:='';
string c_SIC4:='';
string c_Ethnicity:='';
string c_Women_Owned:='';
string c_Ethnic_Owned:='';
string c_SIC_Description:='';
string c_Start_Year:='';
string c_Years_in_Business:='';
string c_Franchise_Code:='';
string c_Source_Code:='';
string c_Business_Title_Category:='';
string c_FIPS_State_County_Code:='';
string c_SOHO:='';
string c_ZipPlus4:='';
string c_CRRT:='';
string c_Secondary_SIC:='';
string c_Secondary_SIC_Description:='';
string c_Web_Address:='';
string c_MSA_Code:='';
string c_New_Business_Flag:='';
string c_Unique_ID:='';
//
string30 i_POPULATION_DESC:='';
string6 i_relo_NUM_EMPLOYEES_ACTUAL:='';
string6 i_relo_TOTAL_EMPLOYEES_ACTUAL:='';
string30 i_CONTACT_NAME:='';
string30 i_COMPANY_NAME:='';
string30 i_STREET1:='';
string16 i_CITY1:='';
string2 i_STATE1:='';
string5 i_ZIP1_5:='';
string4 i_ZIP1_4:='';
string4 i_CARRIER_CD:='';
string2 i_STATE_CD:='';
string3 i_COUNTY_CD:='';
string10 i_PHONE:='';
string6 i_SIC_CD:='';
string6 i_FRANCHISE_CD:='';
string1 i_AD_SIZE:='';
string1 i_POPULATION_CD:='';
string1 i_INDIVIDUAL_FIRM_CD:='';
string4 i_YEAR_STARTED:='';
string6 i_DATE_ADDED:='';
string14 i_CONTACT_LNAME:='';
string11 i_CONTACT_FNAME:='';
string3 i_CONTACT_PROF_TITLE:='';
string1 i_CONTACT_TITLE:='';
string1 i_GENDER_CD:='';
string1 i_INDUSTRY_SPECIFIC_CD:='';
string1 i_BUSINESS_STATUS_CD:='';
string10 i_KEY_CD:='';
string10 i_FAX:='';
string8 i_PRODUCTION_DATE:='';
string9 i_ABI_NUMBER:='';
string9 i_SUBSIDIARY_PARENT_NUM:='';
string9 i_ULTIMATE_PARENT_NUM:='';
string6 i_PRIMARY_SIC:='';
string6 i_SECONDARY_SIC_1:='';
string6 i_SECONDARY_SIC_2:='';
string6 i_SECONDARY_SIC_3:='';
string6 i_SECONDARY_SIC_4:='';
string1 i_PUBLIC_CO_INDICATOR:='';
string1 i_STOCK_EXCHANGE_CD:='';
string6 i_STOCK_TICKER_SYMBOL:='';
string6 i_NUM_EMPLOYEES_ACTUAL:='';
string6 i_TOTAL_EMPLOYEES_ACTUAL:='';
string30 i_SECONDARY_ADDRESS:='';
string16 i_SECONDARY_CITY:='';
string2 i_SECONDARY_STATE:='';
string5 i_SECONDARY_ZIP_CODE:='';
string1 i_CREDIT_CODE:='';
// 
unsigned6 d_i_annual_sales_volume:=0;
unsigned6 d_i_employees_here:=0;
unsigned6 d_i_employees_total:=0;
string8   d_date_first_seen:='';
string8   d_date_last_seen:='';
string9   d_duns_number:='';
string90  d_business_name:='';
string30  d_trade_style:='';
string25  d_street:='';
string20  d_city:='';
string2   d_state:='';
string9   d_zip_code:='';
string17  d_mail_address:='';
string14  d_mail_city:='';
string2   d_mail_state:='';
string5   d_mail_zip_code:='';
string10  d_telephone_number:='';
string21  d_county_name:='';
string4   d_msa_code:='';
string40  d_msa_name:='';
string128 d_line_of_business_description:='';
string8   d_sic1:='';
string60  d_sic1desc:='';
string8   d_sic1a:='';
string60  d_sic1adesc:='';
string8   d_sic1b:='';
string60  d_sic1bdesc:='';
string8   d_sic1c:='';
string60  d_sic1cdesc:='';
string8   d_sic1d:='';
string60  d_sic1ddesc:='';
string8   d_sic2:='';
string60  d_sic2desc:='';
string8   d_sic2a:='';
string60  d_sic2adesc:='';
string8   d_sic2b:='';
string60  d_sic2bdesc:='';
string8   d_sic2c:='';
string60  d_sic2cdesc:='';
string8   d_sic2d:='';
string60  d_sic2ddesc:='';
string8   d_sic3:='';
string60  d_sic3desc:='';
string8   d_sic3a:='';
string60  d_sic3adesc:='';
string8   d_sic3b:='';
string60  d_sic3bdesc:='';
string8   d_sic3c:='';
string60  d_sic3cdesc:='';
string8   d_sic3d:='';
string60  d_sic3ddesc:='';
string8   d_sic4:='';
string60  d_sic4desc:='';
string8   d_sic4a:='';
string60  d_sic4adesc:='';
string8   d_sic4b:='';
string60  d_sic4bdesc:='';
string8   d_sic4c:='';
string60  d_sic4cdesc:='';
string8   d_sic4d:='';
string60  d_sic4ddesc:='';
string8   d_sic5:='';
string60  d_sic5desc:='';
string8   d_sic5a:='';
string60  d_sic5adesc:='';
string8   d_sic5b:='';
string60  d_sic5bdesc:='';
string8   d_sic5c:='';
string60  d_sic5cdesc:='';
string8   d_sic5d:='';
string60  d_sic5ddesc:='';
string8   d_sic6:='';
string60  d_sic6desc:='';
string8   d_sic6a:='';
string60  d_sic6adesc:='';
string8   d_sic6b:='';
string60  d_sic6bdesc:='';
string8   d_sic6c:='';
string60  d_sic6cdesc:='';
string8   d_sic6d:='';
string60  d_sic6ddesc:='';
string1   d_industry_group:='';
string4   d_year_started:='';
string8   d_date_of_incorporation:='';  // YYYYMMDD
string2   d_state_of_incorporation_abbr:='';
string1   d_annual_sales_volume_sign:='';
string15  d_annual_sales_volume:='';  //signed field
string1   d_annual_sales_code:='';
string1   d_employees_here_sign:='';
string10  d_employees_here:='';  //signed field
string1   d_employees_total_sign:='';
string10  d_employees_total:=''; //signed field
string1   d_employees_here_code:='';
string1   d_internal_use:='';
string8   d_annual_sales_revision_date:='';  // YYYYMMDD
string1   d_net_worth_sign:='';
string12  d_net_worth:='';  //signed field
string1   d_trend_sales_sign:='';
string15  d_trend_sales:='';  //signed field
string1   d_trend_employment_total_sign:='';
string10  d_trend_employment_total:='';  //signed field
string1   d_base_sales_sign:='';
string15  d_base_sales:='';  //signed field
string1   d_base_employment_total_sign:='';
string10  d_base_employment_total:='';  //signed field
string1   d_percentage_sales_growth_sign:='';
string4   d_percentage_sales_growth:='';  //signed field
string1   d_percentage_employment_growth_sign:='';
string4   d_percentage_employment_growth:='';  //signed field
string9   d_square_footage:='';
string1   d_sales_territory:='';
string1   d_owns_rents:='';
string9   d_number_of_accounts:='';
string9   d_bank_duns_number:='';
string30  d_bank_name:='';
string30  d_accounting_firm_name:='';
string1   d_small_business_indicator:='';
string1   d_minority_owned:='';
string1   d_cottage_indicator:='';
string1   d_foreign_owned:='';
string1   d_manufacturing_here_indicator:='';
string1   d_public_indicator:='';
string1   d_importer_exporter_indicator:='';
string1   d_structure_type:='';
string1   d_type_of_establishment:='';
string9   d_parent_duns_number:='';
string9   d_ultimate_duns_number:='';
string9   d_headquarters_duns_number:='';
string30  d_parent_company_name:='';
string30  d_ultimate_company_name:='';
string9   d_dias_code:='';
string3   d_hierarchy_code:='';
string1   d_ultimate_indicator:='';
string30  d_internal_use1:='';
string10  d_internal_use2:='';
string1   d_internal_use3:='';
string1   d_hot_list_new_indicator:='';
string1   d_hot_list_ownership_change_indicator:='';
string1   d_hot_list_ceo_change_indicator:='';
string1   d_hot_list_company_name_change_ind:='';
string1   d_hot_list_address_change_indicator:='';
string1   d_hot_list_telephone_change_indicator:='';
string6   d_hot_list_new_change_date:='';
string6   d_hot_list_ownership_change_date:='';
string6   d_hot_list_ceo_change_date:='';
string6   d_hot_list_company_name_chg_date:='';
string6   d_hot_list_address_change_date:='';
string6   d_hot_list_telephone_change_date:='';
string8   d_report_date:='';
string1   d_delete_record_indicator:='';
end;

layout_all_three to_c_plus_i(c l,i r) := transform
self.c_bdid:=l.bdid;
self.c_SALES_VOLUME_DESC:=l.SALES_VOLUME_DESC;
self.c_EMPLOYEE_SIZE_DESC:=l.EMPLOYEE_SIZE_DESC;
self.c_Company:=l.Company;
self.c_Address:=l.Address;
self.c_City:=l.City;
self.c_State:=l.State;
self.c_Zip_Code:=l.Zip_Code;
self.c_Phone:=l.Phone;
self.c_Fax:=l.Fax;
self.c_Sales_Volume:=l.Sales_Volume;
self.c_Employee_Size:=l.Employee_Size;
self.c_Contact_First_Name:=l.Contact_First_Name;
self.c_Contact_Last_Name:=l.Contact_Last_Name;
self.c_Contact_Title:=l.Contact_Title;
self.c_SIC:=l.SIC;
self.c_Credit_Rating:=l.Credit_Rating;
self.c_Number_of_PCs:=l.Number_of_PCs;
self.c_Square_Footage:=l.Square_Footage;
self.c_County:=l.County;
self.c_MSA_Area:=l.MSA_Area;
self.c_Gender:=l.Gender;
self.c_NACIS_Code:=l.NACIS_Code;
self.c_NACIS_Description:=l.NACIS_Description;
self.c_SIC2:=l.SIC2;
self.c_SIC4:=l.SIC4;
self.c_Ethnicity:=l.Ethnicity;
self.c_Women_Owned:=l.Women_Owned;
self.c_Ethnic_Owned:=l.Ethnic_Owned;
self.c_SIC_Description:=l.SIC_Description;
self.c_Start_Year:=l.Start_Year;
self.c_Years_in_Business:=l.Years_in_Business;
self.c_Franchise_Code:=l.Franchise_Code;
self.c_Source_Code:=l.Source_Code;
self.c_Business_Title_Category:=l.Business_Title_Category;
self.c_FIPS_State_County_Code:=l.FIPS_State_County_Code;
self.c_SOHO:=l.SOHO;
self.c_ZipPlus4:=l.ZipPlus4;
self.c_CRRT:=l.CRRT;
self.c_Secondary_SIC:=l.Secondary_SIC;
self.c_Secondary_SIC_Description:=l.Secondary_SIC_Description;
self.c_Web_Address:=l.Web_Address;
self.c_MSA_Code:=l.MSA_Code;
self.c_New_Business_Flag:=l.New_Business_Flag;
self.c_Unique_ID:=l.Unique_ID;
//
self.i_bdid:=r.bdid;
self.i_POPULATION_DESC:=r.POPULATION_DESC;
self.i_EMPLOYEE_SIZE_DESC:=r.EMPLOYEE_SIZE_DESC;
self.i_OFFICE_SIZE_DESC:=r.OFFICE_SIZE_DESC;
self.i_TOTAL_EMPLOYEE_SIZE_DESC:=r.TOTAL_EMPLOYEE_SIZE_DESC;
self.i_relo_NUM_EMPLOYEES_ACTUAL:=r.relo_NUM_EMPLOYEES_ACTUAL;
self.i_relo_TOTAL_EMPLOYEES_ACTUAL:=r.relo_TOTAL_EMPLOYEES_ACTUAL;
self.i_SALES_VOLUME_DESC:=r.SALES_VOLUME_DESC;
self.i_TOTAL_OUTPUT_SALES_DESC:=r.TOTAL_OUTPUT_SALES_DESC;
self.i_CONTACT_NAME:=r.CONTACT_NAME;
self.i_COMPANY_NAME:=r.COMPANY_NAME;
self.i_STREET1:=r.STREET1;
self.i_CITY1:=r.CITY1;
self.i_STATE1:=r.STATE1;
self.i_ZIP1_5:=r.ZIP1_5;
self.i_ZIP1_4:=r.ZIP1_4;
self.i_CARRIER_CD:=r.CARRIER_CD;
self.i_STATE_CD:=r.STATE_CD;
self.i_COUNTY_CD:=r.COUNTY_CD;
self.i_PHONE:=r.PHONE;
self.i_SIC_CD:=r.SIC_CD;
self.i_FRANCHISE_CD:=r.FRANCHISE_CD;
self.i_AD_SIZE:=r.AD_SIZE;
self.i_POPULATION_CD:=r.POPULATION_CD;
self.i_INDIVIDUAL_FIRM_CD:=r.INDIVIDUAL_FIRM_CD;
self.i_YEAR_STARTED:=r.YEAR_STARTED;
self.i_DATE_ADDED:=r.DATE_ADDED;
self.i_CONTACT_LNAME:=r.CONTACT_LNAME;
self.i_CONTACT_FNAME:=r.CONTACT_FNAME;
self.i_CONTACT_PROF_TITLE:=r.CONTACT_PROF_TITLE;
self.i_CONTACT_TITLE:=r.CONTACT_TITLE;
self.i_GENDER_CD:=r.GENDER_CD;
self.i_EMPLOYEE_SIZE_CD:=r.EMPLOYEE_SIZE_CD;
self.i_SALES_VOLUME_CD:=r.SALES_VOLUME_CD;
self.i_INDUSTRY_SPECIFIC_CD:=r.INDUSTRY_SPECIFIC_CD;
self.i_BUSINESS_STATUS_CD:=r.BUSINESS_STATUS_CD;
self.i_KEY_CD:=r.KEY_CD;
self.i_FAX:=r.FAX;
self.i_OFFICE_SIZE_CD:=r.OFFICE_SIZE_CD;
self.i_PRODUCTION_DATE:=r.PRODUCTION_DATE;
self.i_ABI_NUMBER:=r.ABI_NUMBER;
self.i_SUBSIDIARY_PARENT_NUM:=r.SUBSIDIARY_PARENT_NUM;
self.i_ULTIMATE_PARENT_NUM:=r.ULTIMATE_PARENT_NUM;
self.i_PRIMARY_SIC:=r.PRIMARY_SIC;
self.i_SECONDARY_SIC_1:=r.SECONDARY_SIC_1;
self.i_SECONDARY_SIC_2:=r.SECONDARY_SIC_2;
self.i_SECONDARY_SIC_3:=r.SECONDARY_SIC_3;
self.i_SECONDARY_SIC_4:=r.SECONDARY_SIc_4;
self.i_TOTAL_EMPLOYEE_SIZE_CD:=r.TOTAL_EMPLOYEE_SIZE_CD;
self.i_TOTAL_OUTPUT_SALES_CD:=r.TOTAL_OUTPUT_SALES_CD;
self.i_PUBLIC_CO_INDICATOR:=r.PUBLIC_CO_INDICATOR;
self.i_STOCK_EXCHANGE_CD:=r.STOCK_EXCHANGE_CD;
self.i_STOCK_TICKER_SYMBOL:=r.STOCK_TICKER_SYMBOL;
self.i_NUM_EMPLOYEES_ACTUAL:=r.NUM_EMPLOYEES_ACTUAL;
self.i_TOTAL_EMPLOYEES_ACTUAL:=r.TOTAL_EMPLOYEES_ACTUAL;
self.i_SECONDARY_ADDRESS:=r.SECONDARY_ADDRESS;
self.i_SECONDARY_CITY:=r.SECONDARY_CITY;
self.i_SECONDARY_STATE:=r.SECONDARY_STATE;
self.i_SECONDARY_ZIP_CODE:=r.SECONDARY_ZIP_CODE;
self.i_CREDIT_CODE:=r.CREDIT_CODE;

end;

c_plus_i := join(c,i,left.bdid=right.bdid,to_c_plus_i(left,right),local);
count(c);
count(i);
count(c_plus_i);

layout_all_three to_c_plus_i_plus_d(c_plus_i l,d r) := transform
self.d_my_annual_sales_volume_cd:=r.my_annual_sales_volume_cd;
self.d_annual_sales_volume_desc:=r.annual_sales_volume_desc;
self.d_i_annual_sales_volume:=r.i_annual_sales_volume;
self.d_my_employees_here_cd:=r.my_employees_here_cd;
self.d_employees_here_desc:=r.employees_here_desc;
self.d_i_employees_here:=r.i_employees_here;
self.d_my_employees_total_cd:=r.my_employees_total_cd;
self.d_employees_total_desc:=r.employees_total_desc;
self.d_i_employees_total:=r.i_employees_total;
self.d_bdid:=r.bdid;
self.d_date_first_seen:=r.date_first_seen;
self.d_date_last_seen:=r.date_last_seen;
self.d_duns_number:=r.duns_number;
self.d_business_name:=r.business_name;
self.d_trade_style:=r.trade_style;
self.d_street:=r.street;
self.d_city:=r.city;
self.d_state:=r.state;
self.d_zip_code:=r.zip_code;
self.d_mail_address:=r.mail_address;
self.d_mail_city:=r.mail_city;
self.d_mail_state:=r.mail_state;
self.d_mail_zip_code:=r.mail_zip_code;
self.d_telephone_number:=r.telephone_number;
self.d_county_name:=r.county_name;
self.d_msa_code:=r.msa_code;
self.d_msa_name:=r.msa_name;
self.d_line_of_business_description:=r.line_of_business_description;
self.d_sic1:=r.sic1;
self.d_sic1desc:=r.sic1desc;
self.d_sic1a:=r.sic1a;
self.d_sic1adesc:=r.sic1adesc;
self.d_sic1b:=r.sic1b;
self.d_sic1bdesc:=r.sic1bdesc;
self.d_sic1c:=r.sic1c;
self.d_sic1cdesc:=r.sic1cdesc;
self.d_sic1d:=r.sic1d;
self.d_sic1ddesc:=r.sic1ddesc;
self.d_sic2:=r.sic2;
self.d_sic2desc:=r.sic2desc;
self.d_sic2a:=r.sic2a;
self.d_sic2adesc:=r.sic2adesc;
self.d_sic2b:=r.sic2b;
self.d_sic2bdesc:=r.sic2bdesc;
self.d_sic2c:=r.sic2c;
self.d_sic2cdesc:=r.sic2cdesc;
self.d_sic2d:=r.sic2d;
self.d_sic2ddesc:=r.sic2ddesc;
self.d_sic3:=r.sic3;
self.d_sic3desc:=r.sic3desc;
self.d_sic3a:=r.sic3a;
self.d_sic3adesc:=r.sic3adesc;
self.d_sic3b:=r.sic3b;
self.d_sic3bdesc:=r.sic3bdesc;
self.d_sic3c:=r.sic3c;
self.d_sic3cdesc:=r.sic3cdesc;
self.d_sic3d:=r.sic3d;
self.d_sic3ddesc:=r.sic3ddesc;
self.d_sic4:=r.sic4;
self.d_sic4desc:=r.sic4desc;
self.d_sic4a:=r.sic4a;
self.d_sic4adesc:=r.sic4adesc;
self.d_sic4b:=r.sic4b;
self.d_sic4bdesc:=r.sic4bdesc;
self.d_sic4c:=r.sic4c;
self.d_sic4cdesc:=r.sic4cdesc;
self.d_sic4d:=r.sic4d;
self.d_sic4ddesc:=r.sic4ddesc;
self.d_sic5:=r.sic5;
self.d_sic5desc:=r.sic5desc;
self.d_sic5a:=r.sic5a;
self.d_sic5adesc:=r.sic5adesc;
self.d_sic5b:=r.sic5b;
self.d_sic5bdesc:=r.sic5bdesc;
self.d_sic5c:=r.sic5c;
self.d_sic5cdesc:=r.sic5cdesc;
self.d_sic5d:=r.sic5d;
self.d_sic5ddesc:=r.sic5ddesc;
self.d_sic6:=r.sic6;
self.d_sic6desc:=r.sic6desc;
self.d_sic6a:=r.sic6a;
self.d_sic6adesc:=r.sic6adesc;
self.d_sic6b:=r.sic6b;
self.d_sic6bdesc:=r.sic6bdesc;
self.d_sic6c:=r.sic6c;
self.d_sic6cdesc:=r.sic6cdesc;
self.d_sic6d:=r.sic6d;
self.d_sic6ddesc:=r.sic6ddesc;
self.d_industry_group:=r.industry_group;
self.d_year_started:=r.year_started;
self.d_date_of_incorporation:=r.date_of_incorporation;
self.d_state_of_incorporation_abbr:=r.state_of_incorporation_abbr;
self.d_annual_sales_volume_sign:=r.annual_sales_volume_sign;
self.d_annual_sales_volume:=r.annual_sales_volume;
self.d_annual_sales_code:=r.annual_sales_code;
self.d_employees_here_sign:=r.employees_here_sign;
self.d_employees_here:=r.employees_here;
self.d_employees_total_sign:=r.employees_total_sign;
self.d_employees_total:=r.employees_total;
self.d_employees_here_code:=r.employees_here_code;
self.d_internal_use:=r.internal_use;
self.d_annual_sales_revision_date:=r.annual_sales_revision_date;
self.d_net_worth_sign:=r.net_worth_sign;
self.d_net_worth:=r.net_worth;
self.d_trend_sales_sign:=r.trend_sales_sign;
self.d_trend_sales:=r.trend_sales;
self.d_trend_employment_total_sign:=r.trend_employment_total_sign;
self.d_trend_employment_total:=r.trend_employment_total;
self.d_base_sales_sign:=r.base_sales_sign;
self.d_base_sales:=r.base_sales;
self.d_base_employment_total_sign:=r.base_employment_total_sign;
self.d_base_employment_total:=r.base_employment_total;
self.d_percentage_sales_growth_sign:=r.percentage_sales_growth_sign;
self.d_percentage_sales_growth:=r.percentage_sales_growth;
self.d_percentage_employment_growth_sign:=r.percentage_employment_growth_sign;
self.d_percentage_employment_growth:=r.percentage_employment_growth;
self.d_square_footage:=r.square_footage;
self.d_sales_territory:=r.sales_territory;
self.d_owns_rents:=r.owns_rents;
self.d_number_of_accounts:=r.number_of_accounts;
self.d_bank_duns_number:=r.bank_duns_number;
self.d_bank_name:=r.bank_name;
self.d_accounting_firm_name:=r.accounting_firm_name;
self.d_small_business_indicator:=r.small_business_indicator;
self.d_minority_owned:=r.minority_owned;
self.d_cottage_indicator:=r.cottage_indicator;
self.d_foreign_owned:=r.foreign_owned;
self.d_manufacturing_here_indicator:=r.manufacturing_here_indicator;
self.d_public_indicator:=r.public_indicator;
self.d_importer_exporter_indicator:=r.importer_exporter_indicator;
self.d_structure_type:=r.structure_type;
self.d_type_of_establishment:=r.type_of_establishment;
self.d_parent_duns_number:=r.parent_duns_number;
self.d_ultimate_duns_number:=r.ultimate_duns_number;
self.d_headquarters_duns_number:=r.headquarters_duns_number;
self.d_parent_company_name:=r.parent_company_name;
self.d_ultimate_company_name:=r.ultimate_company_name;
self.d_dias_code:=r.dias_code;
self.d_hierarchy_code:=r.hierarchy_code;
self.d_ultimate_indicator:=r.ultimate_indicator;
self.d_internal_use1:=r.internal_use1;
self.d_internal_use2:=r.internal_use2;
self.d_internal_use3:=r.internal_use3;
self.d_hot_list_new_indicator:=r.hot_list_new_indicator;
self.d_hot_list_ownership_change_indicator:=r.hot_list_ownership_change_indicator;
self.d_hot_list_ceo_change_indicator:=r.hot_list_ceo_change_indicator;
self.d_hot_list_company_name_change_ind:=r.hot_list_company_name_change_ind;
self.d_hot_list_address_change_indicator:=r.hot_list_address_change_indicator;
self.d_hot_list_telephone_change_indicator:=r.hot_list_telephone_change_indicator;
self.d_hot_list_new_change_date:=r.hot_list_new_change_date;
self.d_hot_list_ownership_change_date:=r.hot_list_ownership_change_date;
self.d_hot_list_ceo_change_date:=r.hot_list_ceo_change_date;
self.d_hot_list_company_name_chg_date:=r.hot_list_company_name_chg_date;
self.d_hot_list_address_change_date:=r.hot_list_address_change_date;
self.d_hot_list_telephone_change_date:=r.hot_list_telephone_change_date;
self.d_report_date:=r.report_date;
self.d_delete_record_indicator:=r.delete_record_indicator;
self := l;
end;

c_plus_i_plus_d := join(c_plus_i,d,left.c_bdid=right.bdid,to_c_plus_i_plus_d(left,right),local);
count(d);
count(c_plus_i_plus_d);

layout_all_three_slim := record
unsigned6 c_bdid:=0;
//
string30 c_SALES_VOLUME_DESC:='';
string30 i_SALES_VOLUME_DESC:='';
string30 i_TOTAL_OUTPUT_SALES_DESC:='';
string30 d_annual_sales_volume_desc:='';
//
string30 c_EMPLOYEE_SIZE_DESC:='';
string30 i_EMPLOYEE_SIZE_DESC:='';
string30 i_OFFICE_SIZE_DESC:='';
string1 i_OFFICE_SIZE_CD:='';
string30 i_TOTAL_EMPLOYEE_SIZE_DESC:='';
string30 d_employees_total_desc:='';
string30 d_employees_here_desc:='';
end;

all_three_slim := project(c_plus_i_plus_d,layout_all_three_slim);

all_three_slim_deduped := dedup(all_three_slim,all);

//
export bus_combined_query1 := all_three_slim : persist('~thor_data400::misc::bus_combined_query1_20060814');
 