//HPCC Systems KEL Compiler Version 0.11.4
IMPORT KEL011 AS KEL;
IMPORT CFG_Compile,E_Address,E_Zip_Code FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Address_1(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(E_Address(__in,__cfg).__Result) __E_Address := E_Address(__in,__cfg).__Result;
  SHARED __EE19841 := __E_Address;
  EXPORT __ST10503_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_D_V_O_Date_Summary_Layout) A_D_V_O_Date_Summary_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Vacation_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_C_A_Layout) A_C_A_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Most_Recent_Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) Most_Recent_College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Most_Recent_Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Most_Recent_Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Most_Recent_Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Most_Recent_Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Most_Recent_Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Most_Recent_Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Most_Recent_Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Most_Recent_Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Most_Recent_Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Most_Recent_Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Most_Recent_Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Most_Recent_Vacation_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST10503_Layout __ND22679__Project(E_Address(__in,__cfg).Layout __PP18841) := TRANSFORM
    __EE19265 := __PP18841.Address_Type_;
    __BS19985 := __T(__EE19265);
    __EE20000 := __BN(TOPN(__BS19985(__NN(KEL.era.ToDate(__T(__EE19265).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19265).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19265).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19265).Date_First_Seen_)),__T(Address_Type_Code_)),__NL(__EE19265));
    SELF.Most_Recent_Address_Type_ := __EE20000;
    __EE19295 := __PP18841.College_;
    __BS20003 := __T(__EE19295);
    __EE20020 := __BN(TOPN(__BS20003(__NN(KEL.era.ToDate(__T(__EE19295).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19295).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19295).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19295).Date_First_Seen_)),__T(College_Indicator_),__T(College_Start_Suppression_Date_),__T(College_End_Suppression_Date_)),__NL(__EE19295));
    SELF.Most_Recent_College_ := __EE20020;
    __EE19325 := __PP18841.Do_Not_Deliver_;
    __BS20022 := __T(__EE19325);
    __EE20037 := __BN(TOPN(__BS20022(__NN(KEL.era.ToDate(__T(__EE19325).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19325).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19325).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19325).Date_First_Seen_)),__T(Do_Not_Deliver_Indicator_)),__NL(__EE19325));
    SELF.Most_Recent_Do_Not_Deliver_ := __EE20037;
    __EE19355 := __PP18841.Mail_Drop_;
    __BS20039 := __T(__EE19355);
    __EE20054 := __BN(TOPN(__BS20039(__NN(KEL.era.ToDate(__T(__EE19355).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19355).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19355).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19355).Date_First_Seen_)),__T(Drop_Indicator_)),__NL(__EE19355));
    SELF.Most_Recent_Mail_Drop_ := __EE20054;
    __EE19385 := __PP18841.Mixed_Usage_;
    __BS20056 := __T(__EE19385);
    __EE20071 := __BN(TOPN(__BS20056(__NN(KEL.era.ToDate(__T(__EE19385).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19385).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19385).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19385).Date_First_Seen_)),__T(Mixed_Usage_Code_)),__NL(__EE19385));
    SELF.Most_Recent_Mixed_Usage_ := __EE20071;
    __EE19415 := __PP18841.Only_Way_To_Get_Mail_;
    __BS20073 := __T(__EE19415);
    __EE20088 := __BN(TOPN(__BS20073(__NN(KEL.era.ToDate(__T(__EE19415).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19415).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19415).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19415).Date_First_Seen_)),__T(Only_Way_To_Get_Mail_Indicator_)),__NL(__EE19415));
    SELF.Most_Recent_Only_Way_To_Get_Mail_ := __EE20088;
    __EE19445 := __PP18841.Record_Type_;
    __BS20090 := __T(__EE19445);
    __EE20105 := __BN(TOPN(__BS20090(__NN(KEL.era.ToDate(__T(__EE19445).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19445).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19445).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19445).Date_First_Seen_)),__T(Record_Type_Code_)),__NL(__EE19445));
    SELF.Most_Recent_Record_Type_ := __EE20105;
    __EE19475 := __PP18841.Residential_Or_Business_;
    __BS20107 := __T(__EE19475);
    __EE20122 := __BN(TOPN(__BS20107(__NN(KEL.era.ToDate(__T(__EE19475).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19475).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19475).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19475).Date_First_Seen_)),__T(Residential_Or_Business_Indicator_)),__NL(__EE19475));
    SELF.Most_Recent_Residential_Or_Business_ := __EE20122;
    __EE19505 := __PP18841.Seasonal_Delivery_;
    __BS20124 := __T(__EE19505);
    __EE20141 := __BN(TOPN(__BS20124(__NN(KEL.era.ToDate(__T(__EE19505).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19505).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19505).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19505).Date_First_Seen_)),__T(Seasonal_Delivery_Indicator_),__T(Seasonal_Start_Suppression_Date_),__T(Seasonal_End_Suppression_Date_)),__NL(__EE19505));
    SELF.Most_Recent_Seasonal_Delivery_ := __EE20141;
    __EE19535 := __PP18841.Simplify_;
    __BS20143 := __T(__EE19535);
    __EE20158 := __BN(TOPN(__BS20143(__NN(KEL.era.ToDate(__T(__EE19535).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19535).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19535).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19535).Date_First_Seen_)),__T(Simplify_Count_)),__NL(__EE19535));
    SELF.Most_Recent_Simplify_ := __EE20158;
    __EE19565 := __PP18841.Style_;
    __BS20160 := __T(__EE19565);
    __EE20175 := __BN(TOPN(__BS20160(__NN(KEL.era.ToDate(__T(__EE19565).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19565).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19565).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19565).Date_First_Seen_)),__T(Style_Code_)),__NL(__EE19565));
    SELF.Most_Recent_Style_ := __EE20175;
    __EE19595 := __PP18841.Throw_Back_;
    __BS20177 := __T(__EE19595);
    __EE20192 := __BN(TOPN(__BS20177(__NN(KEL.era.ToDate(__T(__EE19595).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19595).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19595).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19595).Date_First_Seen_)),__T(Throw_Back_Indicator_)),__NL(__EE19595));
    SELF.Most_Recent_Throw_Back_ := __EE20192;
    __EE19625 := __PP18841.Vacancy_;
    __BS20194 := __T(__EE19625);
    __EE20209 := __BN(TOPN(__BS20194(__NN(KEL.era.ToDate(__T(__EE19625).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19625).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19625).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19625).Date_First_Seen_)),__T(Vacancy_Indicator_)),__NL(__EE19625));
    SELF.Most_Recent_Vacancy_ := __EE20209;
    __EE19655 := __PP18841.Vacation_;
    __BS20211 := __T(__EE19655);
    __EE20230 := __BN(TOPN(__BS20211(__NN(KEL.era.ToDate(__T(__EE19655).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE19655).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE19655).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE19655).Date_First_Seen_)),__T(Number_Of_Current_Vacation_Months_),__T(Max_Vacation_Months_),__T(Vacation_Periods_Count_),__T(Vacation_Begin_Date_),__T(Vacation_End_Date_)),__NL(__EE19655));
    SELF.Most_Recent_Vacation_ := __EE20230;
    SELF := __PP18841;
  END;
  EXPORT __ENH_Address_1 := PROJECT(__EE19841,__ND22679__Project(LEFT));
END;
