//HPCC Systems KEL Compiler Version 0.11.6
IMPORT KEL011 AS KEL;
IMPORT CFG_Compile,E_Address,E_Zip_Code FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Address_1(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(E_Address(__in,__cfg).__Result) __E_Address := E_Address(__in,__cfg).__Result;
  SHARED __EE22405 := __E_Address;
  EXPORT __ST12160_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_D_V_O_Date_Summary_Layout) A_D_V_O_Date_Summary_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Vacation_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_C_A_Layout) A_C_A_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Most_Recent_Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) Most_Recent_College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Most_Recent_Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Most_Recent_Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Most_Recent_Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Most_Recent_Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Most_Recent_Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Most_Recent_Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Most_Recent_Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Most_Recent_Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Most_Recent_Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Most_Recent_Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Most_Recent_Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Most_Recent_Vacation_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST12160_Layout __ND25243__Project(E_Address(__in,__cfg).Layout __PP21283) := TRANSFORM
    __EE21707 := __PP21283.Address_Type_;
    __BS22549 := __T(__EE21707);
    __EE22564 := __BN(TOPN(__BS22549(__NN(KEL.era.ToDate(__T(__EE21707).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21707).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21707).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21707).Date_First_Seen_)),__T(Address_Type_Code_)),__NL(__EE21707));
    SELF.Most_Recent_Address_Type_ := __EE22564;
    __EE21744 := __PP21283.College_;
    __BS22567 := __T(__EE21744);
    __EE22584 := __BN(TOPN(__BS22567(__NN(KEL.era.ToDate(__T(__EE21744).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21744).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21744).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21744).Date_First_Seen_)),__T(College_Indicator_),__T(College_Start_Suppression_Date_),__T(College_End_Suppression_Date_)),__NL(__EE21744));
    SELF.Most_Recent_College_ := __EE22584;
    __EE21787 := __PP21283.Do_Not_Deliver_;
    __BS22586 := __T(__EE21787);
    __EE22601 := __BN(TOPN(__BS22586(__NN(KEL.era.ToDate(__T(__EE21787).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21787).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21787).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21787).Date_First_Seen_)),__T(Do_Not_Deliver_Indicator_)),__NL(__EE21787));
    SELF.Most_Recent_Do_Not_Deliver_ := __EE22601;
    __EE21824 := __PP21283.Mail_Drop_;
    __BS22603 := __T(__EE21824);
    __EE22618 := __BN(TOPN(__BS22603(__NN(KEL.era.ToDate(__T(__EE21824).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21824).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21824).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21824).Date_First_Seen_)),__T(Drop_Indicator_)),__NL(__EE21824));
    SELF.Most_Recent_Mail_Drop_ := __EE22618;
    __EE21861 := __PP21283.Mixed_Usage_;
    __BS22620 := __T(__EE21861);
    __EE22635 := __BN(TOPN(__BS22620(__NN(KEL.era.ToDate(__T(__EE21861).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21861).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21861).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21861).Date_First_Seen_)),__T(Mixed_Usage_Code_)),__NL(__EE21861));
    SELF.Most_Recent_Mixed_Usage_ := __EE22635;
    __EE21898 := __PP21283.Only_Way_To_Get_Mail_;
    __BS22637 := __T(__EE21898);
    __EE22652 := __BN(TOPN(__BS22637(__NN(KEL.era.ToDate(__T(__EE21898).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21898).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21898).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21898).Date_First_Seen_)),__T(Only_Way_To_Get_Mail_Indicator_)),__NL(__EE21898));
    SELF.Most_Recent_Only_Way_To_Get_Mail_ := __EE22652;
    __EE21935 := __PP21283.Record_Type_;
    __BS22654 := __T(__EE21935);
    __EE22669 := __BN(TOPN(__BS22654(__NN(KEL.era.ToDate(__T(__EE21935).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21935).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21935).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21935).Date_First_Seen_)),__T(Record_Type_Code_)),__NL(__EE21935));
    SELF.Most_Recent_Record_Type_ := __EE22669;
    __EE21972 := __PP21283.Residential_Or_Business_;
    __BS22671 := __T(__EE21972);
    __EE22686 := __BN(TOPN(__BS22671(__NN(KEL.era.ToDate(__T(__EE21972).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21972).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21972).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21972).Date_First_Seen_)),__T(Residential_Or_Business_Indicator_)),__NL(__EE21972));
    SELF.Most_Recent_Residential_Or_Business_ := __EE22686;
    __EE22009 := __PP21283.Seasonal_Delivery_;
    __BS22688 := __T(__EE22009);
    __EE22705 := __BN(TOPN(__BS22688(__NN(KEL.era.ToDate(__T(__EE22009).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE22009).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE22009).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE22009).Date_First_Seen_)),__T(Seasonal_Delivery_Indicator_),__T(Seasonal_Start_Suppression_Date_),__T(Seasonal_End_Suppression_Date_)),__NL(__EE22009));
    SELF.Most_Recent_Seasonal_Delivery_ := __EE22705;
    __EE22052 := __PP21283.Simplify_;
    __BS22707 := __T(__EE22052);
    __EE22722 := __BN(TOPN(__BS22707(__NN(KEL.era.ToDate(__T(__EE22052).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE22052).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE22052).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE22052).Date_First_Seen_)),__T(Simplify_Count_)),__NL(__EE22052));
    SELF.Most_Recent_Simplify_ := __EE22722;
    __EE22089 := __PP21283.Style_;
    __BS22724 := __T(__EE22089);
    __EE22739 := __BN(TOPN(__BS22724(__NN(KEL.era.ToDate(__T(__EE22089).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE22089).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE22089).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE22089).Date_First_Seen_)),__T(Style_Code_)),__NL(__EE22089));
    SELF.Most_Recent_Style_ := __EE22739;
    __EE22126 := __PP21283.Throw_Back_;
    __BS22741 := __T(__EE22126);
    __EE22756 := __BN(TOPN(__BS22741(__NN(KEL.era.ToDate(__T(__EE22126).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE22126).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE22126).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE22126).Date_First_Seen_)),__T(Throw_Back_Indicator_)),__NL(__EE22126));
    SELF.Most_Recent_Throw_Back_ := __EE22756;
    __EE22163 := __PP21283.Vacancy_;
    __BS22758 := __T(__EE22163);
    __EE22773 := __BN(TOPN(__BS22758(__NN(KEL.era.ToDate(__T(__EE22163).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE22163).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE22163).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE22163).Date_First_Seen_)),__T(Vacancy_Indicator_)),__NL(__EE22163));
    SELF.Most_Recent_Vacancy_ := __EE22773;
    __EE22200 := __PP21283.Vacation_;
    __BS22775 := __T(__EE22200);
    __EE22794 := __BN(TOPN(__BS22775(__NN(KEL.era.ToDate(__T(__EE22200).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE22200).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE22200).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE22200).Date_First_Seen_)),__T(Number_Of_Current_Vacation_Months_),__T(Max_Vacation_Months_),__T(Vacation_Periods_Count_),__T(Vacation_Begin_Date_),__T(Vacation_End_Date_)),__NL(__EE22200));
    SELF.Most_Recent_Vacation_ := __EE22794;
    SELF := __PP21283;
  END;
  EXPORT __ENH_Address_1 := PROJECT(__EE22405,__ND25243__Project(LEFT));
END;
