//HPCC Systems KEL Compiler Version 0.11.6
IMPORT KEL011 AS KEL;
IMPORT CFG_Compile,E_Address,E_Zip_Code FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Address_1(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(E_Address(__in,__cfg).__Result) __E_Address := E_Address(__in,__cfg).__Result;
  SHARED __EE26501 := __E_Address;
  EXPORT __ST14917_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_D_V_O_Date_Summary_Layout) A_D_V_O_Date_Summary_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Vacation_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_C_A_Layout) A_C_A_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Most_Recent_Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) Most_Recent_College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Most_Recent_Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Most_Recent_Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Most_Recent_Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Most_Recent_Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Most_Recent_Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Most_Recent_Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Most_Recent_Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Most_Recent_Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Most_Recent_Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Most_Recent_Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Most_Recent_Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Most_Recent_Vacation_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST14917_Layout __ND29339__Project(E_Address(__in,__cfg).Layout __PP25379) := TRANSFORM
    __EE25803 := __PP25379.Address_Type_;
    __BS26645 := __T(__EE25803);
    __EE26660 := __BN(TOPN(__BS26645(__NN(KEL.era.ToDate(__T(__EE25803).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE25803).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE25803).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE25803).Date_First_Seen_)),__T(Address_Type_Code_)),__NL(__EE25803));
    SELF.Most_Recent_Address_Type_ := __EE26660;
    __EE25840 := __PP25379.College_;
    __BS26663 := __T(__EE25840);
    __EE26680 := __BN(TOPN(__BS26663(__NN(KEL.era.ToDate(__T(__EE25840).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE25840).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE25840).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE25840).Date_First_Seen_)),__T(College_Indicator_),__T(College_Start_Suppression_Date_),__T(College_End_Suppression_Date_)),__NL(__EE25840));
    SELF.Most_Recent_College_ := __EE26680;
    __EE25883 := __PP25379.Do_Not_Deliver_;
    __BS26682 := __T(__EE25883);
    __EE26697 := __BN(TOPN(__BS26682(__NN(KEL.era.ToDate(__T(__EE25883).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE25883).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE25883).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE25883).Date_First_Seen_)),__T(Do_Not_Deliver_Indicator_)),__NL(__EE25883));
    SELF.Most_Recent_Do_Not_Deliver_ := __EE26697;
    __EE25920 := __PP25379.Mail_Drop_;
    __BS26699 := __T(__EE25920);
    __EE26714 := __BN(TOPN(__BS26699(__NN(KEL.era.ToDate(__T(__EE25920).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE25920).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE25920).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE25920).Date_First_Seen_)),__T(Drop_Indicator_)),__NL(__EE25920));
    SELF.Most_Recent_Mail_Drop_ := __EE26714;
    __EE25957 := __PP25379.Mixed_Usage_;
    __BS26716 := __T(__EE25957);
    __EE26731 := __BN(TOPN(__BS26716(__NN(KEL.era.ToDate(__T(__EE25957).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE25957).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE25957).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE25957).Date_First_Seen_)),__T(Mixed_Usage_Code_)),__NL(__EE25957));
    SELF.Most_Recent_Mixed_Usage_ := __EE26731;
    __EE25994 := __PP25379.Only_Way_To_Get_Mail_;
    __BS26733 := __T(__EE25994);
    __EE26748 := __BN(TOPN(__BS26733(__NN(KEL.era.ToDate(__T(__EE25994).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE25994).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE25994).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE25994).Date_First_Seen_)),__T(Only_Way_To_Get_Mail_Indicator_)),__NL(__EE25994));
    SELF.Most_Recent_Only_Way_To_Get_Mail_ := __EE26748;
    __EE26031 := __PP25379.Record_Type_;
    __BS26750 := __T(__EE26031);
    __EE26765 := __BN(TOPN(__BS26750(__NN(KEL.era.ToDate(__T(__EE26031).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26031).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26031).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26031).Date_First_Seen_)),__T(Record_Type_Code_)),__NL(__EE26031));
    SELF.Most_Recent_Record_Type_ := __EE26765;
    __EE26068 := __PP25379.Residential_Or_Business_;
    __BS26767 := __T(__EE26068);
    __EE26782 := __BN(TOPN(__BS26767(__NN(KEL.era.ToDate(__T(__EE26068).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26068).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26068).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26068).Date_First_Seen_)),__T(Residential_Or_Business_Indicator_)),__NL(__EE26068));
    SELF.Most_Recent_Residential_Or_Business_ := __EE26782;
    __EE26105 := __PP25379.Seasonal_Delivery_;
    __BS26784 := __T(__EE26105);
    __EE26801 := __BN(TOPN(__BS26784(__NN(KEL.era.ToDate(__T(__EE26105).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26105).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26105).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26105).Date_First_Seen_)),__T(Seasonal_Delivery_Indicator_),__T(Seasonal_Start_Suppression_Date_),__T(Seasonal_End_Suppression_Date_)),__NL(__EE26105));
    SELF.Most_Recent_Seasonal_Delivery_ := __EE26801;
    __EE26148 := __PP25379.Simplify_;
    __BS26803 := __T(__EE26148);
    __EE26818 := __BN(TOPN(__BS26803(__NN(KEL.era.ToDate(__T(__EE26148).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26148).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26148).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26148).Date_First_Seen_)),__T(Simplify_Count_)),__NL(__EE26148));
    SELF.Most_Recent_Simplify_ := __EE26818;
    __EE26185 := __PP25379.Style_;
    __BS26820 := __T(__EE26185);
    __EE26835 := __BN(TOPN(__BS26820(__NN(KEL.era.ToDate(__T(__EE26185).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26185).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26185).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26185).Date_First_Seen_)),__T(Style_Code_)),__NL(__EE26185));
    SELF.Most_Recent_Style_ := __EE26835;
    __EE26222 := __PP25379.Throw_Back_;
    __BS26837 := __T(__EE26222);
    __EE26852 := __BN(TOPN(__BS26837(__NN(KEL.era.ToDate(__T(__EE26222).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26222).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26222).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26222).Date_First_Seen_)),__T(Throw_Back_Indicator_)),__NL(__EE26222));
    SELF.Most_Recent_Throw_Back_ := __EE26852;
    __EE26259 := __PP25379.Vacancy_;
    __BS26854 := __T(__EE26259);
    __EE26869 := __BN(TOPN(__BS26854(__NN(KEL.era.ToDate(__T(__EE26259).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26259).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26259).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26259).Date_First_Seen_)),__T(Vacancy_Indicator_)),__NL(__EE26259));
    SELF.Most_Recent_Vacancy_ := __EE26869;
    __EE26296 := __PP25379.Vacation_;
    __BS26871 := __T(__EE26296);
    __EE26890 := __BN(TOPN(__BS26871(__NN(KEL.era.ToDate(__T(__EE26296).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE26296).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE26296).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE26296).Date_First_Seen_)),__T(Number_Of_Current_Vacation_Months_),__T(Max_Vacation_Months_),__T(Vacation_Periods_Count_),__T(Vacation_Begin_Date_),__T(Vacation_End_Date_)),__NL(__EE26296));
    SELF.Most_Recent_Vacation_ := __EE26890;
    SELF := __PP25379;
  END;
  EXPORT __ENH_Address_1 := PROJECT(__EE26501,__ND29339__Project(LEFT));
END;
