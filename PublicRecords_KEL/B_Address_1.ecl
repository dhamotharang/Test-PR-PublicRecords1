//HPCC Systems KEL Compiler Version 0.11.6
IMPORT KEL011 AS KEL;
IMPORT CFG_Compile,E_Address,E_Zip_Code FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Address_1(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(E_Address(__in,__cfg).__Result) __E_Address := E_Address(__in,__cfg).__Result;
  SHARED __EE21860 := __E_Address;
  EXPORT __ST12151_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.nstr Unit_Designation_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Postal_City_;
    KEL.typ.nstr Vanity_City_;
    KEL.typ.nstr State_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nint Z_I_P4_;
    KEL.typ.nstr Carrier_Route_Number_;
    KEL.typ.nstr Carrier_Route_Sortation_At_Z_I_P_;
    KEL.typ.nint Line_Of_Travel_;
    KEL.typ.nstr Line_Of_Travel_Order_;
    KEL.typ.nint Delivery_Point_Barcode_;
    KEL.typ.nint Delivery_Point_Barcode_Check_Digit_;
    KEL.typ.nstr Type_Code_;
    KEL.typ.nint County_;
    KEL.typ.nfloat Latitude_;
    KEL.typ.nfloat Longitude_;
    KEL.typ.nint Metropolitan_Statistical_Area_;
    KEL.typ.nint Geo_Block_;
    KEL.typ.nstr Geo_Match_;
    KEL.typ.nstr A_C_E_Cleaner_Error_Code_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_D_V_O_Date_Summary_Layout) A_D_V_O_Date_Summary_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Vacation_;
    KEL.typ.ndataset(E_Address(__in,__cfg).A_C_A_Layout) A_C_A_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Address_Type_Layout) Most_Recent_Address_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).College_Layout) Most_Recent_College_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Do_Not_Deliver_Layout) Most_Recent_Do_Not_Deliver_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mail_Drop_Layout) Most_Recent_Mail_Drop_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Mixed_Usage_Layout) Most_Recent_Mixed_Usage_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Only_Way_To_Get_Mail_Layout) Most_Recent_Only_Way_To_Get_Mail_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Record_Type_Layout) Most_Recent_Record_Type_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Residential_Or_Business_Layout) Most_Recent_Residential_Or_Business_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Seasonal_Delivery_Layout) Most_Recent_Seasonal_Delivery_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Simplify_Layout) Most_Recent_Simplify_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Style_Layout) Most_Recent_Style_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Throw_Back_Layout) Most_Recent_Throw_Back_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacancy_Layout) Most_Recent_Vacancy_;
    KEL.typ.ndataset(E_Address(__in,__cfg).Vacation_Layout) Most_Recent_Vacation_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST12151_Layout __ND24698__Project(E_Address(__in,__cfg).Layout __PP20738) := TRANSFORM
    __EE21162 := __PP20738.Address_Type_;
    __BS22004 := __T(__EE21162);
    __EE22019 := __BN(TOPN(__BS22004(__NN(KEL.era.ToDate(__T(__EE21162).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21162).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21162).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21162).Date_First_Seen_)),__T(Address_Type_Code_)),__NL(__EE21162));
    SELF.Most_Recent_Address_Type_ := __EE22019;
    __EE21199 := __PP20738.College_;
    __BS22022 := __T(__EE21199);
    __EE22039 := __BN(TOPN(__BS22022(__NN(KEL.era.ToDate(__T(__EE21199).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21199).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21199).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21199).Date_First_Seen_)),__T(College_Indicator_),__T(College_Start_Suppression_Date_),__T(College_End_Suppression_Date_)),__NL(__EE21199));
    SELF.Most_Recent_College_ := __EE22039;
    __EE21242 := __PP20738.Do_Not_Deliver_;
    __BS22041 := __T(__EE21242);
    __EE22056 := __BN(TOPN(__BS22041(__NN(KEL.era.ToDate(__T(__EE21242).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21242).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21242).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21242).Date_First_Seen_)),__T(Do_Not_Deliver_Indicator_)),__NL(__EE21242));
    SELF.Most_Recent_Do_Not_Deliver_ := __EE22056;
    __EE21279 := __PP20738.Mail_Drop_;
    __BS22058 := __T(__EE21279);
    __EE22073 := __BN(TOPN(__BS22058(__NN(KEL.era.ToDate(__T(__EE21279).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21279).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21279).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21279).Date_First_Seen_)),__T(Drop_Indicator_)),__NL(__EE21279));
    SELF.Most_Recent_Mail_Drop_ := __EE22073;
    __EE21316 := __PP20738.Mixed_Usage_;
    __BS22075 := __T(__EE21316);
    __EE22090 := __BN(TOPN(__BS22075(__NN(KEL.era.ToDate(__T(__EE21316).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21316).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21316).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21316).Date_First_Seen_)),__T(Mixed_Usage_Code_)),__NL(__EE21316));
    SELF.Most_Recent_Mixed_Usage_ := __EE22090;
    __EE21353 := __PP20738.Only_Way_To_Get_Mail_;
    __BS22092 := __T(__EE21353);
    __EE22107 := __BN(TOPN(__BS22092(__NN(KEL.era.ToDate(__T(__EE21353).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21353).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21353).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21353).Date_First_Seen_)),__T(Only_Way_To_Get_Mail_Indicator_)),__NL(__EE21353));
    SELF.Most_Recent_Only_Way_To_Get_Mail_ := __EE22107;
    __EE21390 := __PP20738.Record_Type_;
    __BS22109 := __T(__EE21390);
    __EE22124 := __BN(TOPN(__BS22109(__NN(KEL.era.ToDate(__T(__EE21390).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21390).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21390).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21390).Date_First_Seen_)),__T(Record_Type_Code_)),__NL(__EE21390));
    SELF.Most_Recent_Record_Type_ := __EE22124;
    __EE21427 := __PP20738.Residential_Or_Business_;
    __BS22126 := __T(__EE21427);
    __EE22141 := __BN(TOPN(__BS22126(__NN(KEL.era.ToDate(__T(__EE21427).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21427).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21427).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21427).Date_First_Seen_)),__T(Residential_Or_Business_Indicator_)),__NL(__EE21427));
    SELF.Most_Recent_Residential_Or_Business_ := __EE22141;
    __EE21464 := __PP20738.Seasonal_Delivery_;
    __BS22143 := __T(__EE21464);
    __EE22160 := __BN(TOPN(__BS22143(__NN(KEL.era.ToDate(__T(__EE21464).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21464).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21464).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21464).Date_First_Seen_)),__T(Seasonal_Delivery_Indicator_),__T(Seasonal_Start_Suppression_Date_),__T(Seasonal_End_Suppression_Date_)),__NL(__EE21464));
    SELF.Most_Recent_Seasonal_Delivery_ := __EE22160;
    __EE21507 := __PP20738.Simplify_;
    __BS22162 := __T(__EE21507);
    __EE22177 := __BN(TOPN(__BS22162(__NN(KEL.era.ToDate(__T(__EE21507).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21507).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21507).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21507).Date_First_Seen_)),__T(Simplify_Count_)),__NL(__EE21507));
    SELF.Most_Recent_Simplify_ := __EE22177;
    __EE21544 := __PP20738.Style_;
    __BS22179 := __T(__EE21544);
    __EE22194 := __BN(TOPN(__BS22179(__NN(KEL.era.ToDate(__T(__EE21544).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21544).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21544).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21544).Date_First_Seen_)),__T(Style_Code_)),__NL(__EE21544));
    SELF.Most_Recent_Style_ := __EE22194;
    __EE21581 := __PP20738.Throw_Back_;
    __BS22196 := __T(__EE21581);
    __EE22211 := __BN(TOPN(__BS22196(__NN(KEL.era.ToDate(__T(__EE21581).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21581).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21581).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21581).Date_First_Seen_)),__T(Throw_Back_Indicator_)),__NL(__EE21581));
    SELF.Most_Recent_Throw_Back_ := __EE22211;
    __EE21618 := __PP20738.Vacancy_;
    __BS22213 := __T(__EE21618);
    __EE22228 := __BN(TOPN(__BS22213(__NN(KEL.era.ToDate(__T(__EE21618).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21618).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21618).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21618).Date_First_Seen_)),__T(Vacancy_Indicator_)),__NL(__EE21618));
    SELF.Most_Recent_Vacancy_ := __EE22228;
    __EE21655 := __PP20738.Vacation_;
    __BS22230 := __T(__EE21655);
    __EE22249 := __BN(TOPN(__BS22230(__NN(KEL.era.ToDate(__T(__EE21655).Date_Last_Seen_)) AND __NN(KEL.era.ToDate(__T(__EE21655).Date_First_Seen_))),1, -__T(KEL.era.ToDate(__T(__EE21655).Date_Last_Seen_)), -__T(KEL.era.ToDate(__T(__EE21655).Date_First_Seen_)),__T(Number_Of_Current_Vacation_Months_),__T(Max_Vacation_Months_),__T(Vacation_Periods_Count_),__T(Vacation_Begin_Date_),__T(Vacation_End_Date_)),__NL(__EE21655));
    SELF.Most_Recent_Vacation_ := __EE22249;
    SELF := __PP20738;
  END;
  EXPORT __ENH_Address_1 := PROJECT(__EE21860,__ND24698__Project(LEFT));
END;
