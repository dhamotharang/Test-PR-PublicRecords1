//HPCC Systems KEL Compiler Version 0.11.6
IMPORT KEL011 AS KEL;
IMPORT B_Business_4,B_Tradeline_4,CFG_Compile,E_Business,E_Tradeline,E_Tradeline_Business,FN_Compile FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Business_3(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(B_Business_4(__in,__cfg).__ENH_Business_4) __ENH_Business_4 := B_Business_4(__in,__cfg).__ENH_Business_4;
  SHARED VIRTUAL TYPEOF(B_Tradeline_4(__in,__cfg).__ENH_Tradeline_4) __ENH_Tradeline_4 := B_Tradeline_4(__in,__cfg).__ENH_Tradeline_4;
  SHARED VIRTUAL TYPEOF(E_Tradeline_Business(__in,__cfg).__Result) __E_Tradeline_Business := E_Tradeline_Business(__in,__cfg).__Result;
  SHARED __EE201783 := __ENH_Business_4;
  SHARED __EE201787 := __ENH_Tradeline_4;
  SHARED __EE201785 := __E_Tradeline_Business;
  SHARED __EE203508 := __EE201785(__NN(__EE201785.Company_) AND __NN(__EE201785.Account_));
  SHARED __ST181669_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC203526(B_Tradeline_4(__in,__cfg).__ST69803_Layout __EE201787, E_Tradeline_Business(__in,__cfg).Layout __EE203508) := __EEQP(__EE203508.Account_,__EE201787.UID);
  __ST181669_Layout __JT203526(B_Tradeline_4(__in,__cfg).__ST69803_Layout __l, E_Tradeline_Business(__in,__cfg).Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE203527 := JOIN(__EE203508,__EE201787,__JC203526(RIGHT,LEFT),__JT203526(RIGHT,LEFT),INNER,HASH);
  SHARED __ST181910_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC203612(__ST181669_Layout __EE203527, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE203598) := __T(__EE203598.Is_Two_Year_Full_Record_);
  __ST181910_Layout __JT203612(__ST181669_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC203612(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE203613 := NORMALIZE(__EE203527,__T(LEFT.Records_),__JT203612(LEFT,RIGHT));
  SHARED __ST169540_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST169540_Layout __ND216167__Project(__ST181910_Layout __PP203614) := TRANSFORM
    SELF.Data_Sources_ := __PP203614.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP203614.Company_;
    SELF := __PP203614;
  END;
  SHARED __EE216168 := PROJECT(__EE203613,__ND216167__Project(LEFT));
  SHARED __ST174886_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.nint Exp1_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Exp2_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nint Exp3_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Exp4_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nint Exp5_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST174886_Layout __ND216247__Project(__ST169540_Layout __PP216169) := TRANSFORM
    SELF.Exp1_ := IF(__T(__PP216169.Carrier_Segment_),__ECAST(KEL.typ.nint,__PP216169.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp2_ := IF(__T(__PP216169.Fleet_Segment_),__ECAST(KEL.typ.nint,__PP216169.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp3_ := IF(__T(__PP216169.Materials_Segment_),__ECAST(KEL.typ.nint,__PP216169.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp4_ := IF(__T(__PP216169.Operations_Segment_),__ECAST(KEL.typ.nint,__PP216169.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp5_ := IF(__T(__PP216169.Other_Segment_),__ECAST(KEL.typ.nint,__PP216169.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF := __PP216169;
  END;
  SHARED __EE216315 := PROJECT(__EE216168,__ND216247__Project(LEFT));
  SHARED __ST174955_Layout := RECORD
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE222831 := PROJECT(__CLEANANDDO(__EE216315,TABLE(__EE216315,{KEL.typ.int S_U_M___Total_A_R_L_N_ := KEL.Aggregates.SumNG(__EE216315.Exp1_),KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP,__T(__EE216315.Carrier_Segment_)),KEL.typ.int S_U_M___Total_A_R_L_N__1_ := KEL.Aggregates.SumNG(__EE216315.Exp2_),KEL.typ.int C_O_U_N_T___Exp1__1_ := COUNT(GROUP,__T(__EE216315.Fleet_Segment_)),KEL.typ.int S_U_M___Total_A_R_L_N__2_ := KEL.Aggregates.SumNG(__EE216315.Exp3_),KEL.typ.int C_O_U_N_T___Exp1__2_ := COUNT(GROUP,__T(__EE216315.Materials_Segment_)),KEL.typ.int S_U_M___Total_A_R_L_N__3_ := KEL.Aggregates.SumNG(__EE216315.Exp4_),KEL.typ.int C_O_U_N_T___Exp1__3_ := COUNT(GROUP,__T(__EE216315.Operations_Segment_)),KEL.typ.int S_U_M___Total_A_R_L_N__4_ := KEL.Aggregates.SumNG(__EE216315.Exp5_),KEL.typ.int C_O_U_N_T___Exp1__4_ := COUNT(GROUP,__T(__EE216315.Other_Segment_)),KEL.typ.int S_U_M___Total_A_R_L_N__5_ := KEL.Aggregates.SumNG(__EE216315.Total_A_R_L_N_),A_R_Date_Group_,U_I_D__1_},A_R_Date_Group_,U_I_D__1_,MERGE)),__ST174955_Layout);
  SHARED __ST182315_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(__ST174955_Layout) Exp1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC222837(B_Business_4(__in,__cfg).__ST68821_Layout __EE201783, __ST174955_Layout __EE222831) := __EEQP(__EE201783.UID,__EE222831.U_I_D__1_);
  __ST182315_Layout __Join__ST182315_Layout(B_Business_4(__in,__cfg).__ST68821_Layout __r, DATASET(__ST174955_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Exp1_ := __CN(__recs);
  END;
  SHARED __EE222897 := DENORMALIZE(DISTRIBUTE(__EE201783,HASH(UID)),DISTRIBUTE(__EE222831,HASH(U_I_D__1_)),__JC222837(LEFT,RIGHT),GROUP,__Join__ST182315_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  SHARED __ST170605_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.bool Exp1_ := FALSE;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.bool Exp2_ := FALSE;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.bool Exp3_ := FALSE;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.bool Exp4_ := FALSE;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.bool Exp5_ := FALSE;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST170620_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST170620_Layout __ND222906__Project(__ST182315_Layout __PP222902) := TRANSFORM
    __EE222900 := __PP222902.Exp1_;
    __ST170605_Layout __ND223030__Project(__ST174955_Layout __PP223026) := TRANSFORM
      SELF.Exp1_ := __PP223026.C_O_U_N_T___Exp1_ <> 0;
      SELF.Exp2_ := __PP223026.C_O_U_N_T___Exp1__1_ <> 0;
      SELF.Exp3_ := __PP223026.C_O_U_N_T___Exp1__2_ <> 0;
      SELF.Exp4_ := __PP223026.C_O_U_N_T___Exp1__3_ <> 0;
      SELF.Exp5_ := __PP223026.C_O_U_N_T___Exp1__4_ <> 0;
      SELF := __PP223026;
    END;
    SELF.Exp1_ := __PROJECT(__EE222900,__ND223030__Project(LEFT));
    SELF := __PP222902;
  END;
  SHARED __EE223129 := PROJECT(__EE222897,__ND222906__Project(LEFT));
  SHARED __EE211153 := __EE201787;
  SHARED __EE211239 := __EE211153(__T(__EE211153.Is_Active_));
  SHARED __EE211192 := __EE203508;
  SHARED __ST183521_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC211248(B_Tradeline_4(__in,__cfg).__ST69803_Layout __EE211239, E_Tradeline_Business(__in,__cfg).Layout __EE211192) := __EEQP(__EE211192.Account_,__EE211239.UID);
  __ST183521_Layout __JT211248(B_Tradeline_4(__in,__cfg).__ST69803_Layout __l, E_Tradeline_Business(__in,__cfg).Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE211249 := JOIN(__EE211192,__EE211239,__JC211248(RIGHT,LEFT),__JT211248(RIGHT,LEFT),INNER,HASH);
  SHARED __ST178955_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST178955_Layout __ND211322__Project(__ST183521_Layout __PP211250) := TRANSFORM
    SELF.UID := __PP211250.Company_;
    SELF.Data_Sources_ := __PP211250.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP211250.UID;
    SELF := __PP211250;
  END;
  SHARED __EE211367 := PROJECT(__EE211249,__ND211322__Project(LEFT));
  SHARED __ST179009_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE211397 := PROJECT(__EE211367,__ST179009_Layout);
  SHARED __ST179044_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE211433 := PROJECT(__CLEANANDDO(__EE211397,TABLE(__EE211397,{KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP,__EE211397.Is_Carrier_Segment_),KEL.typ.int C_O_U_N_T___Exp1__1_ := COUNT(GROUP,__EE211397.Is_Fleet_Segment_),KEL.typ.int C_O_U_N_T___Exp1__2_ := COUNT(GROUP,__EE211397.Is_Materials_Segment_),KEL.typ.int C_O_U_N_T___Exp1__3_ := COUNT(GROUP,__EE211397.Is_Operations_Segment_),KEL.typ.int C_O_U_N_T___Exp1__4_ := COUNT(GROUP,__EE211397.Is_Other_Segment_),UID},UID,MERGE)),__ST179044_Layout);
  SHARED __ST183658_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC223135(__ST170620_Layout __EE223129, __ST179044_Layout __EE211433) := __EEQP(__EE223129.UID,__EE211433.UID);
  __ST183658_Layout __JT223135(__ST170620_Layout __l, __ST179044_Layout __r) := TRANSFORM
    SELF.U_I_D__1_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE223202 := JOIN(__EE223129,__EE211433,__JC223135(LEFT,RIGHT),__JT223135(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE211198 := __EE203527;
  SHARED __ST183093_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC211521(__ST181669_Layout __EE211198, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE211511) := __T(__EE211511.Is_Most_Recent_Active_Record1_Y_);
  __ST183093_Layout __JT211521(__ST181669_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC211521(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE211522 := NORMALIZE(__EE211198,__T(LEFT.Records_),__JT211521(LEFT,RIGHT));
  SHARED __ST177571_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST177571_Layout __ND211625__Project(__ST183093_Layout __PP211523) := TRANSFORM
    SELF.UID := __PP211523.Company_;
    SELF.Data_Sources_ := __PP211523.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP211523.UID;
    SELF.Data_Sources__1_ := __PP211523.Data_Sources_;
    SELF := __PP211523;
  END;
  SHARED __EE211938 := PROJECT(__EE211522,__ND211625__Project(LEFT));
  SHARED __ST177809_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nint Exp1_;
    KEL.typ.nint Exp2_;
    KEL.typ.nint Exp3_;
    KEL.typ.nint Exp4_;
    KEL.typ.nint Exp5_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST177809_Layout __ND211943__Project(__ST177571_Layout __PP211939) := TRANSFORM
    SELF.Exp1_ := IF(__T(__PP211939.Carrier_Segment_),__ECAST(KEL.typ.nint,__PP211939.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp2_ := IF(__T(__PP211939.Fleet_Segment_),__ECAST(KEL.typ.nint,__PP211939.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp3_ := IF(__T(__PP211939.Materials_Segment_),__ECAST(KEL.typ.nint,__PP211939.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp4_ := IF(__T(__PP211939.Operations_Segment_),__ECAST(KEL.typ.nint,__PP211939.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp5_ := IF(__T(__PP211939.Other_Segment_),__ECAST(KEL.typ.nint,__PP211939.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF := __PP211939;
  END;
  SHARED __EE211987 := PROJECT(__EE211938,__ND211943__Project(LEFT));
  SHARED __ST177849_Layout := RECORD
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE212028 := PROJECT(__CLEANANDDO(__EE211987,TABLE(__EE211987,{KEL.typ.int S_U_M___Total_A_R_L_N_ := KEL.Aggregates.SumNG(__EE211987.Exp1_),KEL.typ.int S_U_M___Total_A_R_L_N__1_ := KEL.Aggregates.SumNG(__EE211987.Exp2_),KEL.typ.int S_U_M___Total_A_R_L_N__2_ := KEL.Aggregates.SumNG(__EE211987.Exp3_),KEL.typ.int S_U_M___Total_A_R_L_N__3_ := KEL.Aggregates.SumNG(__EE211987.Exp4_),KEL.typ.int S_U_M___Total_A_R_L_N__4_ := KEL.Aggregates.SumNG(__EE211987.Exp5_),KEL.typ.int S_U_M___Total_A_R_L_N__5_ := KEL.Aggregates.SumNG(__EE211987.Total_A_R_L_N_),UID},UID,MERGE)),__ST177849_Layout);
  SHARED __ST184380_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC223208(__ST183658_Layout __EE223202, __ST177849_Layout __EE212028) := __EEQP(__EE223202.UID,__EE212028.UID);
  __ST184380_Layout __JT223208(__ST183658_Layout __l, __ST177849_Layout __r) := TRANSFORM
    SELF.U_I_D__2_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE223282 := JOIN(__EE223202,__EE212028,__JC223208(LEFT,RIGHT),__JT223208(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE211201 := __EE203508;
  SHARED __EE211159 := __EE201787;
  SHARED __ST180015_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC212120(E_Tradeline_Business(__in,__cfg).Layout __EE211201, B_Tradeline_4(__in,__cfg).__ST69803_Layout __EE211159) := __EEQP(__EE211201.Account_,__EE211159.UID);
  __ST180015_Layout __JT212120(E_Tradeline_Business(__in,__cfg).Layout __l, B_Tradeline_4(__in,__cfg).__ST69803_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE212121 := JOIN(__EE211201,__EE211159,__JC212120(LEFT,RIGHT),__JT212120(LEFT,RIGHT),INNER,HASH);
  SHARED __ST180127_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __CC11111 := 730;
  __JC223288(__ST180015_Layout __EE212121, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE212193) := __T(__AND(__EE212193.Carrier_Segment_,__OP2(__EE212193.Record_Age_In_Days_,<=,__CN(__CC11111))));
  __ST180127_Layout __JT223288(__ST180015_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC223288(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE223289 := NORMALIZE(__EE212121,__T(LEFT.Records_),__JT223288(LEFT,RIGHT));
  SHARED __ST185718_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.ndataset(__ST180127_Layout) Tradeline_Business_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC223395(__ST184380_Layout __EE223282, __ST180127_Layout __EE223289) := __EEQP(__EE223282.UID,__EE223289.Company_);
  __ST185718_Layout __Join__ST185718_Layout(__ST184380_Layout __r, DATASET(__ST180127_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Tradeline_Business_ := __CN(__recs);
  END;
  SHARED __EE223566 := DENORMALIZE(DISTRIBUTE(__EE223282,HASH(UID)),DISTRIBUTE(__EE223289,HASH(Company_)),__JC223395(LEFT,RIGHT),GROUP,__Join__ST185718_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  SHARED __EE212489 := __EE212121;
  SHARED __ST180371_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC223572(__ST180015_Layout __EE212489, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE212493) := __T(__AND(__EE212493.Fleet_Segment_,__OP2(__EE212493.Record_Age_In_Days_,<=,__CN(__CC11111))));
  __ST180371_Layout __JT223572(__ST180015_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC223572(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE223573 := NORMALIZE(__EE212489,__T(LEFT.Records_),__JT223572(LEFT,RIGHT));
  SHARED __ST186789_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.ndataset(__ST180127_Layout) Tradeline_Business_;
    KEL.typ.ndataset(__ST180371_Layout) Tradeline_Business__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC223679(__ST185718_Layout __EE223566, __ST180371_Layout __EE223573) := __EEQP(__EE223566.UID,__EE223573.Company_);
  __ST186789_Layout __Join__ST186789_Layout(__ST185718_Layout __r, DATASET(__ST180371_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Tradeline_Business__1_ := __CN(__recs);
  END;
  SHARED __EE223949 := DENORMALIZE(DISTRIBUTE(__EE223566,HASH(UID)),DISTRIBUTE(__EE223573,HASH(Company_)),__JC223679(LEFT,RIGHT),GROUP,__Join__ST186789_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  SHARED __EE212888 := __EE212121;
  SHARED __ST180614_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC223955(__ST180015_Layout __EE212888, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE212892) := __T(__AND(__EE212892.Materials_Segment_,__OP2(__EE212892.Record_Age_In_Days_,<=,__CN(__CC11111))));
  __ST180614_Layout __JT223955(__ST180015_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC223955(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE223956 := NORMALIZE(__EE212888,__T(LEFT.Records_),__JT223955(LEFT,RIGHT));
  SHARED __ST188068_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.ndataset(__ST180127_Layout) Tradeline_Business_;
    KEL.typ.ndataset(__ST180371_Layout) Tradeline_Business__1_;
    KEL.typ.ndataset(__ST180614_Layout) Tradeline_Business__2_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC224062(__ST186789_Layout __EE223949, __ST180614_Layout __EE223956) := __EEQP(__EE223949.UID,__EE223956.Company_);
  __ST188068_Layout __Join__ST188068_Layout(__ST186789_Layout __r, DATASET(__ST180614_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Tradeline_Business__2_ := __CN(__recs);
  END;
  SHARED __EE224431 := DENORMALIZE(DISTRIBUTE(__EE223949,HASH(UID)),DISTRIBUTE(__EE223956,HASH(Company_)),__JC224062(LEFT,RIGHT),GROUP,__Join__ST188068_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  SHARED __EE213386 := __EE212121;
  SHARED __ST180857_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC224437(__ST180015_Layout __EE213386, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE213390) := __T(__AND(__EE213390.Operations_Segment_,__OP2(__EE213390.Record_Age_In_Days_,<=,__CN(__CC11111))));
  __ST180857_Layout __JT224437(__ST180015_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC224437(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE224438 := NORMALIZE(__EE213386,__T(LEFT.Records_),__JT224437(LEFT,RIGHT));
  SHARED __ST189555_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.ndataset(__ST180127_Layout) Tradeline_Business_;
    KEL.typ.ndataset(__ST180371_Layout) Tradeline_Business__1_;
    KEL.typ.ndataset(__ST180614_Layout) Tradeline_Business__2_;
    KEL.typ.ndataset(__ST180857_Layout) Tradeline_Business__3_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC224544(__ST188068_Layout __EE224431, __ST180857_Layout __EE224438) := __EEQP(__EE224431.UID,__EE224438.Company_);
  __ST189555_Layout __Join__ST189555_Layout(__ST188068_Layout __r, DATASET(__ST180857_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Tradeline_Business__3_ := __CN(__recs);
  END;
  SHARED __EE225012 := DENORMALIZE(DISTRIBUTE(__EE224431,HASH(UID)),DISTRIBUTE(__EE224438,HASH(Company_)),__JC224544(LEFT,RIGHT),GROUP,__Join__ST189555_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  SHARED __EE213983 := __EE212121;
  SHARED __ST181100_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC225018(__ST180015_Layout __EE213983, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE213987) := __T(__AND(__EE213987.Other_Segment_,__OP2(__EE213987.Record_Age_In_Days_,<=,__CN(__CC11111))));
  __ST181100_Layout __JT225018(__ST180015_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC225018(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE225019 := NORMALIZE(__EE213983,__T(LEFT.Records_),__JT225018(LEFT,RIGHT));
  SHARED __ST191250_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.ndataset(__ST180127_Layout) Tradeline_Business_;
    KEL.typ.ndataset(__ST180371_Layout) Tradeline_Business__1_;
    KEL.typ.ndataset(__ST180614_Layout) Tradeline_Business__2_;
    KEL.typ.ndataset(__ST180857_Layout) Tradeline_Business__3_;
    KEL.typ.ndataset(__ST181100_Layout) Tradeline_Business__4_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC225125(__ST189555_Layout __EE225012, __ST181100_Layout __EE225019) := __EEQP(__EE225012.UID,__EE225019.Company_);
  __ST191250_Layout __Join__ST191250_Layout(__ST189555_Layout __r, DATASET(__ST181100_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Tradeline_Business__4_ := __CN(__recs);
  END;
  SHARED __EE225692 := DENORMALIZE(DISTRIBUTE(__EE225012,HASH(UID)),DISTRIBUTE(__EE225019,HASH(Company_)),__JC225125(LEFT,RIGHT),GROUP,__Join__ST191250_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  SHARED __EE214679 := __EE212121;
  SHARED __ST181340_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_4(__in,__cfg).__ST69810_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC225697(__ST180015_Layout __EE214679, B_Tradeline_4(__in,__cfg).__ST69810_Layout __EE214683) := __T(__OP2(__EE214683.Record_Age_In_Days_,<=,__CN(__CC11111)));
  __ST181340_Layout __JT225697(__ST180015_Layout __l, B_Tradeline_4(__in,__cfg).__ST69810_Layout __r) := TRANSFORM, SKIP(NOT(__JC225697(__l,__r)))
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE225698 := NORMALIZE(__EE214679,__T(LEFT.Records_),__JT225697(LEFT,RIGHT));
  SHARED __ST193153_Layout := RECORD
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.ndataset(__ST170605_Layout) Exp1_;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__2_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__3_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__4_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.ndataset(__ST180127_Layout) Tradeline_Business_;
    KEL.typ.ndataset(__ST180371_Layout) Tradeline_Business__1_;
    KEL.typ.ndataset(__ST180614_Layout) Tradeline_Business__2_;
    KEL.typ.ndataset(__ST180857_Layout) Tradeline_Business__3_;
    KEL.typ.ndataset(__ST181100_Layout) Tradeline_Business__4_;
    KEL.typ.ndataset(__ST181340_Layout) Tradeline_Business__5_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC225804(__ST191250_Layout __EE225692, __ST181340_Layout __EE225698) := __EEQP(__EE225692.UID,__EE225698.Company_);
  __ST193153_Layout __Join__ST193153_Layout(__ST191250_Layout __r, DATASET(__ST181340_Layout) __recs) := TRANSFORM
    SELF := __r;
    SELF.Tradeline_Business__5_ := __CN(__recs);
  END;
  SHARED __EE226470 := DENORMALIZE(DISTRIBUTE(__EE225692,HASH(UID)),DISTRIBUTE(__EE225698,HASH(Company_)),__JC225804(LEFT,RIGHT),GROUP,__Join__ST193153_Layout(LEFT,ROWS(RIGHT)),LOCAL);
  EXPORT __ST28393_Layout := RECORD
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST28433_Layout := RECORD
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST28473_Layout := RECORD
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST28513_Layout := RECORD
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST28553_Layout := RECORD
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST28353_Layout := RECORD
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST170736_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int Total_A_R_L_N_Sum_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST170756_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int Total_A_R_L_N_Sum_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST170775_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int Total_A_R_L_N_Sum_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST170794_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int Total_A_R_L_N_Sum_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST170813_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int Total_A_R_L_N_Sum_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST170827_Layout := RECORD
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.int Total_A_R_L_N_Sum_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST64677_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(__ST28393_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(__ST28433_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(__ST28473_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(__ST28513_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(__ST28553_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(__ST28353_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(__ST170736_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(__ST170756_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(__ST170775_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(__ST170794_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(__ST170813_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(__ST170827_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST64677_Layout __ND226479__Project(__ST193153_Layout __PP226475) := TRANSFORM
    SELF.B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := __PP226475.S_U_M___Total_A_R_L_N_;
    SELF.B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := __PP226475.S_U_M___Total_A_R_L_N__1_;
    SELF.B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := __PP226475.S_U_M___Total_A_R_L_N__2_;
    SELF.B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := __PP226475.S_U_M___Total_A_R_L_N__3_;
    SELF.B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := __PP226475.S_U_M___Total_A_R_L_N__4_;
    SELF.B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := __PP226475.S_U_M___Total_A_R_L_N__5_;
    SELF.B2b_Actv_T_L_Cnt_Arch1_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := __PP226475.C_O_U_N_T___Exp1_;
    SELF.B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := __PP226475.C_O_U_N_T___Exp1__1_;
    SELF.B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := __PP226475.C_O_U_N_T___Exp1__2_;
    SELF.B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := __PP226475.C_O_U_N_T___Exp1__3_;
    SELF.B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := __PP226475.C_O_U_N_T___Exp1__4_;
    __CC3804 := -99998;
    SELF.B2b_Mon_W_T_L_Cnt24_Mfull_ := IF(__PP226475.B2b_T_L_Cnt24_Mfull_ = 0,__ECAST(KEL.typ.nint,__CN(__CC3804)),__ECAST(KEL.typ.nint,FN_Compile.FN_Find_Count(__ECAST(KEL.typ.nstr,__CN(__PP226475.B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_)),__ECAST(KEL.typ.nstr,__CN('1')))));
    SELF.B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_ := IF(__PP226475.B2b_T_L_In_Carr_Cnt24_Mfull_ = 0,__ECAST(KEL.typ.nint,__CN(__CC3804)),__ECAST(KEL.typ.nint,FN_Compile.FN_Find_Count(__ECAST(KEL.typ.nstr,__CN(__PP226475.B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_)),__ECAST(KEL.typ.nstr,__CN('1')))));
    SELF.B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_ := IF(__PP226475.B2b_T_L_In_Flt_Cnt24_Mfull_ = 0,__ECAST(KEL.typ.nint,__CN(__CC3804)),__ECAST(KEL.typ.nint,FN_Compile.FN_Find_Count(__ECAST(KEL.typ.nstr,__CN(__PP226475.B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_)),__ECAST(KEL.typ.nstr,__CN('1')))));
    SELF.B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_ := IF(__PP226475.B2b_T_L_In_Mat_Cnt24_Mfull_ = 0,__ECAST(KEL.typ.nint,__CN(__CC3804)),__ECAST(KEL.typ.nint,FN_Compile.FN_Find_Count(__ECAST(KEL.typ.nstr,__CN(__PP226475.B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_)),__ECAST(KEL.typ.nstr,__CN('1')))));
    SELF.B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_ := IF(__PP226475.B2b_T_L_In_Ops_Cnt24_Mfull_ = 0,__ECAST(KEL.typ.nint,__CN(__CC3804)),__ECAST(KEL.typ.nint,FN_Compile.FN_Find_Count(__ECAST(KEL.typ.nstr,__CN(__PP226475.B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_)),__ECAST(KEL.typ.nstr,__CN('1')))));
    SELF.B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_ := IF(__PP226475.B2b_T_L_In_Oth_Cnt24_Mfull_ = 0,__ECAST(KEL.typ.nint,__CN(__CC3804)),__ECAST(KEL.typ.nint,FN_Compile.FN_Find_Count(__ECAST(KEL.typ.nstr,__CN(__PP226475.B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_)),__ECAST(KEL.typ.nstr,__CN('1')))));
    __EE226721 := __PP226475.Tradeline_Business_;
    __EE226738 := PROJECT(TABLE(PROJECT(__T(__EE226721),__ST28393_Layout),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Total_A_R_L_N_,A_R_Date_},Total_A_R_L_N_,A_R_Date_,MERGE),__ST28393_Layout);
    __EE226751 := TOPN(__EE226738(__NN(__EE226738.Total_A_R_L_N_) AND __NN(__EE226738.A_R_Date_)),1, -__T(__EE226738.Total_A_R_L_N_), -__T(__EE226738.A_R_Date_));
    SELF.B2b_T_L_Bal_In_Carr_Newest_Date2_Y_ := __CN(__EE226751(__NN(Total_A_R_L_N_) OR __NN(A_R_Date_)));
    __EE226756 := __PP226475.Tradeline_Business__1_;
    __EE226773 := PROJECT(TABLE(PROJECT(__T(__EE226756),__ST28433_Layout),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Total_A_R_L_N_,A_R_Date_},Total_A_R_L_N_,A_R_Date_,MERGE),__ST28433_Layout);
    __EE226786 := TOPN(__EE226773(__NN(__EE226773.Total_A_R_L_N_) AND __NN(__EE226773.A_R_Date_)),1, -__T(__EE226773.Total_A_R_L_N_), -__T(__EE226773.A_R_Date_));
    SELF.B2b_T_L_Bal_In_Flt_Newest_Date2_Y_ := __CN(__EE226786(__NN(Total_A_R_L_N_) OR __NN(A_R_Date_)));
    __EE226791 := __PP226475.Tradeline_Business__2_;
    __EE226808 := PROJECT(TABLE(PROJECT(__T(__EE226791),__ST28473_Layout),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Total_A_R_L_N_,A_R_Date_},Total_A_R_L_N_,A_R_Date_,MERGE),__ST28473_Layout);
    __EE226821 := TOPN(__EE226808(__NN(__EE226808.Total_A_R_L_N_) AND __NN(__EE226808.A_R_Date_)),1, -__T(__EE226808.Total_A_R_L_N_), -__T(__EE226808.A_R_Date_));
    SELF.B2b_T_L_Bal_In_Mat_Newest_Date2_Y_ := __CN(__EE226821(__NN(Total_A_R_L_N_) OR __NN(A_R_Date_)));
    __EE226826 := __PP226475.Tradeline_Business__3_;
    __EE226843 := PROJECT(TABLE(PROJECT(__T(__EE226826),__ST28513_Layout),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Total_A_R_L_N_,A_R_Date_},Total_A_R_L_N_,A_R_Date_,MERGE),__ST28513_Layout);
    __EE226856 := TOPN(__EE226843(__NN(__EE226843.Total_A_R_L_N_) AND __NN(__EE226843.A_R_Date_)),1, -__T(__EE226843.Total_A_R_L_N_), -__T(__EE226843.A_R_Date_));
    SELF.B2b_T_L_Bal_In_Ops_Newest_Date2_Y_ := __CN(__EE226856(__NN(Total_A_R_L_N_) OR __NN(A_R_Date_)));
    __EE226861 := __PP226475.Tradeline_Business__4_;
    __EE226878 := PROJECT(TABLE(PROJECT(__T(__EE226861),__ST28553_Layout),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Total_A_R_L_N_,A_R_Date_},Total_A_R_L_N_,A_R_Date_,MERGE),__ST28553_Layout);
    __EE226891 := TOPN(__EE226878(__NN(__EE226878.Total_A_R_L_N_) AND __NN(__EE226878.A_R_Date_)),1, -__T(__EE226878.Total_A_R_L_N_), -__T(__EE226878.A_R_Date_));
    SELF.B2b_T_L_Bal_In_Oth_Newest_Date2_Y_ := __CN(__EE226891(__NN(Total_A_R_L_N_) OR __NN(A_R_Date_)));
    __EE226896 := __PP226475.Tradeline_Business__5_;
    __EE226913 := PROJECT(TABLE(PROJECT(__T(__EE226896),__ST28353_Layout),{KEL.typ.int __RecordCount := SUM(GROUP,__RecordCount),KEL.typ.epoch Date_First_Seen_ := KEL.era.SimpleRoll(GROUP,Date_First_Seen_,MIN,TRUE),KEL.typ.epoch Date_Last_Seen_ := KEL.era.SimpleRoll(GROUP,Date_Last_Seen_,MAX,FALSE),Total_A_R_L_N_,A_R_Date_},Total_A_R_L_N_,A_R_Date_,MERGE),__ST28353_Layout);
    __EE226926 := TOPN(__EE226913(__NN(__EE226913.Total_A_R_L_N_) AND __NN(__EE226913.A_R_Date_)),1, -__T(__EE226913.Total_A_R_L_N_), -__T(__EE226913.A_R_Date_));
    SELF.B2b_T_L_Bal_Newest_Date2_Y_ := __CN(__EE226926(__NN(Total_A_R_L_N_) OR __NN(A_R_Date_)));
    SELF.B2b_T_L_Cnt2_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_T_L_Cnt2_Y_No_Cap_,0,999);
    __EE226473 := __PP226475.Exp1_;
    __BS226940 := __T(__EE226473);
    __EE226945 := __BS226940(__T(__EE226473).Exp1_);
    SELF.B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_ := __CN(PROJECT(__EE226945,TRANSFORM(__ST170736_Layout,SELF.Total_A_R_L_N_Sum_ := LEFT.S_U_M___Total_A_R_L_N_,SELF := LEFT)));
    __BS226961 := __T(__EE226473);
    __EE226966 := __BS226961(__T(__EE226473).Exp2_);
    SELF.B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_ := __CN(PROJECT(__EE226966,TRANSFORM(__ST170756_Layout,SELF.Total_A_R_L_N_Sum_ := LEFT.S_U_M___Total_A_R_L_N__1_,SELF := LEFT)));
    __BS226982 := __T(__EE226473);
    __EE226987 := __BS226982(__T(__EE226473).Exp3_);
    SELF.B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_ := __CN(PROJECT(__EE226987,TRANSFORM(__ST170775_Layout,SELF.Total_A_R_L_N_Sum_ := LEFT.S_U_M___Total_A_R_L_N__2_,SELF := LEFT)));
    __BS227003 := __T(__EE226473);
    __EE227008 := __BS227003(__T(__EE226473).Exp4_);
    SELF.B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_ := __CN(PROJECT(__EE227008,TRANSFORM(__ST170794_Layout,SELF.Total_A_R_L_N_Sum_ := LEFT.S_U_M___Total_A_R_L_N__3_,SELF := LEFT)));
    __BS227024 := __T(__EE226473);
    __EE227029 := __BS227024(__T(__EE226473).Exp5_);
    SELF.B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_ := __CN(PROJECT(__EE227029,TRANSFORM(__ST170813_Layout,SELF.Total_A_R_L_N_Sum_ := LEFT.S_U_M___Total_A_R_L_N__4_,SELF := LEFT)));
    SELF.B2b_T_L_Group_Total_A_R_L_N_Sum_ := __PROJECT(__EE226473,TRANSFORM(__ST170827_Layout,SELF.Total_A_R_L_N_Sum_ := LEFT.S_U_M___Total_A_R_L_N__5_,SELF := LEFT));
    SELF.B2b_T_L_In_Carr_Cnt2_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_T_L_In_Carr_Cnt2_Y_No_Cap_,0,999);
    SELF.B2b_T_L_In_Flt_Cnt2_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_T_L_In_Flt_Cnt2_Y_No_Cap_,0,999);
    SELF.B2b_T_L_In_Mat_Cnt2_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_T_L_In_Mat_Cnt2_Y_No_Cap_,0,999);
    SELF.B2b_T_L_In_Ops_Cnt2_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_T_L_In_Ops_Cnt2_Y_No_Cap_,0,999);
    SELF.B2b_T_L_In_Oth_Cnt2_Y_ := KEL.Routines.BoundsFold(__PP226475.B2b_T_L_In_Oth_Cnt2_Y_No_Cap_,0,999);
    SELF := __PP226475;
  END;
  EXPORT __ENH_Business_3 := PROJECT(__EE226470,__ND226479__Project(LEFT));
END;
