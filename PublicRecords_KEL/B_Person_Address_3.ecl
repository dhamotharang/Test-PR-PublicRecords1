//HPCC Systems KEL Compiler Version 1.3.0beta5
IMPORT KEL13 AS KEL;
IMPORT B_Person_4,B_Person_5,B_Person_6,B_Person_8,CFG_Compile,E_Address,E_Geo_Link,E_Person,E_Person_Address,E_Zip_Code FROM PublicRecords_KEL;
IMPORT * FROM KEL13.Null;
EXPORT B_Person_Address_3(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(B_Person_4(__in,__cfg).__ENH_Person_4) __ENH_Person_4 := B_Person_4(__in,__cfg).__ENH_Person_4;
  SHARED VIRTUAL TYPEOF(E_Person_Address(__in,__cfg).__Result) __E_Person_Address := E_Person_Address(__in,__cfg).__Result;
  SHARED __EE880425 := __E_Person_Address;
  SHARED __EE4010715 := __ENH_Person_4;
  SHARED __ST880530_Layout := RECORD
    KEL.typ.ntyp(E_Person().Typ) Subject_;
    KEL.typ.ntyp(E_Address().Typ) Location_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Rank_Details_Layout) Address_Rank_Details_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Hierarchy_Layout) Address_Hierarchy_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nstr Gender_;
    KEL.typ.nstr Lex_I_D_Segment_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Full_Name_Layout) Full_Name_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST181934_Layout) Reported_Dates_Of_Birth_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Reported_Dates_Of_Death_Layout) Reported_Dates_Of_Death_;
    KEL.typ.nstr Race_;
    KEL.typ.nstr Race_Description_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Dunn_Data_Layout) Dunn_Data_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Conceal_Carry_Layout) Conceal_Carry_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Hunt_Fish_Layout) Hunt_Fish_;
    KEL.typ.ndataset(B_Person_8(__in,__cfg).__ST65387_Layout) Address_Hierarchy_Set_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST596811_Layout) All_Lien_Data_;
    KEL.typ.nkdate B_U_I_L_D___D_A_T_E_;
    KEL.typ.nstr Curr_Addr_Full_;
    KEL.typ.ndataset(B_Person_8(__in,__cfg).__ST65387_Layout) Curr_Addr_Full_Set_;
    B_Person_8(__in,__cfg).__ST65387_Layout Current_;
    KEL.typ.nstr Current_Addr_Pre_Dir_;
    KEL.typ.nstr Current_Addr_Prim_Name_;
    KEL.typ.nstr Current_Addr_Prim_Rng_;
    KEL.typ.nstr Current_Addr_Sec_Rng_;
    KEL.typ.nstr Current_Addr_Sffx_;
    KEL.typ.nstr Current_Addr_Zip5_;
    KEL.typ.nstr Current_Postdirectional_;
    KEL.typ.ndataset(B_Person_5(__in,__cfg).__ST66819_Layout) Edu_Rec_Ver_Source_List_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST66766_Layout) Edu_Rec_Ver_Source_List_Pre_;
    KEL.typ.ndataset(B_Person_5(__in,__cfg).__ST66819_Layout) Edu_Rec_Ver_Source_List_Sorted_;
    KEL.typ.str P___Lex_I_D_Seen_Flag_ := '';
    KEL.typ.ndataset(B_Person_8(__in,__cfg).__ST65387_Layout) Recent_Addr_Full_Set_;
    KEL.typ.nkdate Select_Age_;
    KEL.typ.epoch Archive___Date_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.epoch Date_Vendor_First_Reported_ := 0;
    KEL.typ.epoch Date_Vendor_Last_Reported_ := 0;
    KEL.typ.epoch Hybrid_Archive_Date_ := 0;
    KEL.typ.epoch Vault_Date_First_Seen_ := 0;
    KEL.typ.epoch Vault_Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC4010721(E_Person_Address(__in,__cfg).Layout __EE880425, B_Person_4(__in,__cfg).__ST181919_Layout __EE4010715) := __EEQP(__EE880425.Subject_,__EE4010715.UID);
  __ST880530_Layout __JT4010721(E_Person_Address(__in,__cfg).Layout __l, B_Person_4(__in,__cfg).__ST181919_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE4010722 := JOIN(__EE880425,__EE4010715,__JC4010721(LEFT,RIGHT),__JT4010721(LEFT,RIGHT),LEFT OUTER,HASH);
  EXPORT __ST172530_Layout := RECORD
    KEL.typ.ntyp(E_Person().Typ) Subject_;
    KEL.typ.ntyp(E_Address().Typ) Location_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Rank_Details_Layout) Address_Rank_Details_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Hierarchy_Layout) Address_Hierarchy_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nbool Curennt_Addr_Matchattribute_;
    KEL.typ.epoch Archive___Date_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.epoch Date_Vendor_First_Reported_ := 0;
    KEL.typ.epoch Date_Vendor_Last_Reported_ := 0;
    KEL.typ.epoch Hybrid_Archive_Date_ := 0;
    KEL.typ.epoch Vault_Date_First_Seen_ := 0;
    KEL.typ.epoch Vault_Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST172530_Layout __ND4011200__Project(__ST880530_Layout __PP4010723) := TRANSFORM
    SELF.Curennt_Addr_Matchattribute_ := __AND(__AND(__AND(__AND(__AND(__AND(__OP2(__PP4010723.Current_Addr_Prim_Rng_,=,__PP4010723.Primary_Range_),__OR(__OP2(__PP4010723.Current_Addr_Pre_Dir_,=,__PP4010723.Predirectional_),__AND(__OR(__OP2(__PP4010723.Current_Addr_Pre_Dir_,=,__CN('')),__NT(__PP4010723.Current_Addr_Pre_Dir_)),__OR(__OP2(__PP4010723.Predirectional_,=,__CN('')),__NT(__PP4010723.Predirectional_))))),__OP2(__PP4010723.Current_Addr_Prim_Name_,=,__PP4010723.Primary_Name_)),__OP2(__PP4010723.Current_Addr_Sffx_,=,__PP4010723.Suffix_)),__OR(__OP2(__PP4010723.Current_Postdirectional_,=,__PP4010723.Postdirectional_),__AND(__OR(__OP2(__PP4010723.Current_Postdirectional_,=,__CN('')),__NT(__PP4010723.Current_Postdirectional_)),__OR(__OP2(__PP4010723.Postdirectional_,=,__CN('')),__NT(__PP4010723.Postdirectional_))))),__OP2(__CAST(KEL.typ.str,__PP4010723.Z_I_P5_),=,__PP4010723.Current_Addr_Zip5_)),__OR(__OP2(__PP4010723.Current_Addr_Sec_Rng_,=,__PP4010723.Secondary_Range_),__AND(__OR(__OP2(__PP4010723.Current_Addr_Sec_Rng_,=,__CN('')),__NT(__PP4010723.Current_Addr_Sec_Rng_)),__OR(__OP2(__PP4010723.Secondary_Range_,=,__CN('')),__NT(__PP4010723.Secondary_Range_)))));
    SELF := __PP4010723;
  END;
  EXPORT __ENH_Person_Address_3 := PROJECT(__EE4010722,__ND4011200__Project(LEFT));
END;
