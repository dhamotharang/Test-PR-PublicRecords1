//HPCC Systems KEL Compiler Version 1.5.0rc1
IMPORT KEL15 AS KEL;
IMPORT B_Person_10,B_Person_4,B_Person_5,B_Person_6,B_Person_7,B_Person_Accident_8,B_Person_Inquiry_5,CFG_Compile,E_Accident,E_Address,E_Address_Slim,E_Address_Summary,E_Email,E_Geo_Link,E_Household,E_Input_P_I_I,E_Inquiry,E_Name_Summary,E_Person,E_Person_Accident,E_Person_Address,E_Person_Inquiry,E_Phone,E_Phone_Summary,E_Property,E_S_S_N_Summary,E_Social_Security_Number,E_Surname,E_Utility,E_Zip_Code FROM PublicRecords_KEL;
IMPORT * FROM KEL15.Null;
EXPORT B_Person_Address_3(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(B_Person_4(__in,__cfg).__ENH_Person_4) __ENH_Person_4 := B_Person_4(__in,__cfg).__ENH_Person_4;
  SHARED VIRTUAL TYPEOF(E_Person_Address(__in,__cfg).__Result) __E_Person_Address := E_Person_Address(__in,__cfg).__Result;
  SHARED __EE1340756 := __E_Person_Address;
  SHARED __EE7527574 := __ENH_Person_4;
  SHARED __ST1341030_Layout := RECORD
    KEL.typ.ntyp(E_Person().Typ) Subject_;
    KEL.typ.ntyp(E_Address().Typ) Location_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Cart_;
    KEL.typ.nstr C_R_Sort_Sz_;
    KEL.typ.nstr Lot_;
    KEL.typ.nstr Lot_Order_;
    KEL.typ.nstr D_P_B_C_;
    KEL.typ.nstr C_H_K_Digit_;
    KEL.typ.nstr Ace_Fips_St_;
    KEL.typ.nstr Ace_Fips_County_;
    KEL.typ.nstr M_S_A_;
    KEL.typ.nstr Verified_City_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Rank_Details_Layout) Address_Rank_Details_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Hierarchy_Layout) Address_Hierarchy_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nuid UID;
    KEL.typ.nstr Gender_;
    KEL.typ.nstr Lex_I_D_Segment_;
    KEL.typ.nstr Lex_I_D_Segment2_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST349953_Layout) Full_Name_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST349968_Layout) Reported_Dates_Of_Birth_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Reported_Dates_Of_Death_Layout) Reported_Dates_Of_Death_;
    KEL.typ.nstr Race_;
    KEL.typ.nstr Race_Description_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST349984_Layout) Data_Sources__1_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Dunn_Data_Layout) Dunn_Data_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Conceal_Carry_Layout) Conceal_Carry_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Hunt_Fish_Layout) Hunt_Fish_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Consumer_Statement_Flags_Layout) Consumer_Statement_Flags_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Thrive_Layout) Thrive_;
    KEL.typ.ndataset(B_Person_Accident_8(__in,__cfg).__ST285174_Layout) Accident_Recs_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST106689_Layout) Accident_Recs_Formatted_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST106689_Layout) Accident_Recs_Formatted_Dedup_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST106689_Layout) Accident_Recs_Sorted_;
    KEL.typ.ndataset(B_Person_10(__in,__cfg).__ST96561_Layout) Address_Hierarchy_Set_;
    KEL.typ.ndataset(B_Person_7(__in,__cfg).__ST468489_Layout) All_Lien_Data_;
    KEL.typ.nstr B_K_Ln_J_L_T_D_Max_New_Date1_Y_;
    KEL.typ.nstr B_K_Ln_J_L_T_D_Min_Old_Date1_Y_;
    KEL.typ.nkdate B_U_I_L_D___D_A_T_E_;
    KEL.typ.nkdate Best_D_O_B_;
    KEL.typ.nint Best_D_O_B_Age_;
    KEL.typ.nkdate Curr_Addr_Dt_First_Sn_;
    KEL.typ.nkdate Curr_Addr_Dt_Last_Sn_;
    KEL.typ.nstr Curr_Addr_Full_;
    KEL.typ.ndataset(B_Person_10(__in,__cfg).__ST96561_Layout) Curr_Addr_Full_Set_;
    B_Person_10(__in,__cfg).__ST96561_Layout Current_;
    KEL.typ.nstr Current_Addr_Pre_Dir_;
    KEL.typ.nstr Current_Addr_Prim_Name_;
    KEL.typ.nstr Current_Addr_Prim_Rng_;
    KEL.typ.nstr Current_Addr_Sec_Rng_;
    KEL.typ.nstr Current_Addr_Sffx_;
    KEL.typ.nstr Current_Addr_Zip5_;
    KEL.typ.nstr Current_Postdirectional_;
    KEL.typ.ndataset(B_Person_5(__in,__cfg).__ST99575_Layout) Edu_Rec_Ver_Source_List_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST99548_Layout) Edu_Rec_Ver_Source_List_Pre_;
    KEL.typ.ndataset(B_Person_5(__in,__cfg).__ST99575_Layout) Edu_Rec_Ver_Source_List_Sorted_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST102513_Layout) Inquiries_Banking5_Y_Sorted_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST103509_Layout) Inquiries_Comm5_Y_Sorted_;
    KEL.typ.nstr L_T_D1_Y_New_Date_;
    KEL.typ.nstr L_T_D1_Y_Old_Date_;
    KEL.typ.nstr L_T_D7_Y_New_Date_;
    KEL.typ.nstr L_T_D7_Y_Old_Date_;
    KEL.typ.nstr Ln_J1_Y_New_Date_;
    KEL.typ.nstr Ln_J1_Y_Old_Date_;
    KEL.typ.nstr Ln_J7_Y_New_Date_;
    KEL.typ.nstr Ln_J7_Y_Old_Date_;
    KEL.typ.nstr Ln_J_L_T_D_Max_New_Date1_Y_;
    KEL.typ.nstr Ln_J_L_T_D_Max_New_Date7_Y_;
    KEL.typ.nstr Ln_J_L_T_D_Min_Old_Date_;
    KEL.typ.nstr Ln_J_L_T_D_Min_Old_Date1_Y_;
    KEL.typ.ntyp(E_Input_P_I_I().Typ) P_I_I_;
    KEL.typ.int P_L___Drg_Bk_Cnt1_Y_ := 0;
    KEL.typ.nstr P_L___Drg_Bk_New_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_Bk_New_Dt7_Y_;
    KEL.typ.nstr P_L___Drg_Bk_Old_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_Bk_Old_Dt7_Y_;
    KEL.typ.int P_L___Drg_Crim_Cnt1_Y_ := 0;
    KEL.typ.int P_L___Drg_Crim_Cnt1_Y_F_C_R_A_ := 0;
    KEL.typ.nstr P_L___Drg_Crim_New_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_Crim_New_Dt1_Y_F_C_R_A_;
    KEL.typ.nstr P_L___Drg_Crim_Old_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_Crim_Old_Dt1_Y_F_C_R_A_;
    KEL.typ.int P_L___Drg_L_T_D_Cnt1_Y_ := 0;
    KEL.typ.int P_L___Drg_L_T_D_Cnt7_Y_ := 0;
    KEL.typ.nstr P_L___Drg_L_T_D_New_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_L_T_D_New_Dt7_Y_;
    KEL.typ.nint P_L___Drg_L_T_D_New_Msnc1_Y_;
    KEL.typ.nint P_L___Drg_L_T_D_New_Msnc7_Y_;
    KEL.typ.nstr P_L___Drg_L_T_D_Old_Dt1_Y_;
    KEL.typ.nint P_L___Drg_L_T_D_Old_Msnc1_Y_;
    KEL.typ.nint P_L___Drg_L_T_D_Old_Msnc7_Y_;
    KEL.typ.int P_L___Drg_Ln_J_Cnt1_Y_ := 0;
    KEL.typ.int P_L___Drg_Ln_J_Cnt7_Y_ := 0;
    KEL.typ.nstr P_L___Drg_Ln_J_New_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_Ln_J_New_Dt7_Y_;
    KEL.typ.nint P_L___Drg_Ln_J_New_Msnc1_Y_;
    KEL.typ.nint P_L___Drg_Ln_J_New_Msnc7_Y_;
    KEL.typ.nstr P_L___Drg_Ln_J_Old_Dt1_Y_;
    KEL.typ.nstr P_L___Drg_Ln_J_Old_Dt7_Y_;
    KEL.typ.nint P_L___Drg_Ln_J_Old_Msnc1_Y_;
    KEL.typ.nint P_L___Drg_Ln_J_Old_Msnc7_Y_;
    KEL.typ.nstr P___Inp_Cln_Name_First_Raw_;
    KEL.typ.nstr P___Inp_Cln_Name_Last_Raw_;
    KEL.typ.nstr P___Inp_Cln_S_S_N_;
    KEL.typ.str P___Lex_I_D_Seen_Flag_ := '';
    KEL.typ.nint Person_Address_Hierarchy_Valid_Cnt_;
    KEL.typ.nint Person_Prev_Address_Hierarchy_Valid_Cnt_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST107672_Layout) Person_S_S_N_Match_Sources_;
    KEL.typ.ndataset(B_Person_5(__in,__cfg).__ST107612_Layout) Person_S_S_N_Match_Sources_Pre_;
    KEL.typ.nkdate Prev_Addr_Dt_First_Sn_;
    KEL.typ.nkdate Prev_Addr_Dt_Last_Sn_;
    KEL.typ.ndataset(B_Person_10(__in,__cfg).__ST96561_Layout) Prev_Addr_Full_Set_;
    B_Person_10(__in,__cfg).__ST96561_Layout Previous_;
    KEL.typ.nstr Previous_Addr_Pre_Dir_;
    KEL.typ.nstr Previous_Addr_Prim_Name_;
    KEL.typ.nstr Previous_Addr_Prim_Rng_;
    KEL.typ.nstr Previous_Addr_Sec_Rng_;
    KEL.typ.nstr Previous_Addr_Sffx_;
    KEL.typ.nstr Previous_Addr_Zip5_;
    KEL.typ.nstr Previous_Postdirectional_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST101008_Layout) Property_Data_Set_;
    KEL.typ.ndataset(B_Person_10(__in,__cfg).__ST96561_Layout) Recent_Addr_Full_Set_;
    KEL.typ.nkdate Select_Age_;
    KEL.typ.ndataset(B_Person_5(__in,__cfg).__ST606622_Layout) Translated_Sources_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST100549_Layout) Util_List_Pre_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST106333_Layout) Ver_Source_List_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST107261_Layout) Verified_First_Name_Sources_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST783206_Layout) Verified_First_Name_Sources_With_Dates_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST107423_Layout) Verified_Last_Name_Sources_;
    KEL.typ.ndataset(B_Person_4(__in,__cfg).__ST783221_Layout) Verified_Last_Name_Sources_With_Dates_;
    KEL.typ.ndataset(E_Household(__in,__cfg).Layout) Verson_One_House_Holds_;
    KEL.typ.epoch Archive___Date_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.epoch Hybrid_Archive_Date_ := 0;
    KEL.typ.epoch Vault_Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC7527580(E_Person_Address(__in,__cfg).Layout __EE1340756, B_Person_4(__in,__cfg).__ST349947_Layout __EE7527574) := __EEQP(__EE1340756.Subject_,__EE7527574.UID);
  __ST1341030_Layout __JT7527580(E_Person_Address(__in,__cfg).Layout __l, B_Person_4(__in,__cfg).__ST349947_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE7527581 := JOIN(__EE1340756,__EE7527574,__JC7527580(LEFT,RIGHT),__JT7527580(LEFT,RIGHT),LEFT OUTER,HASH);
  EXPORT __ST253174_Layout := RECORD
    KEL.typ.ntyp(E_Person().Typ) Subject_;
    KEL.typ.ntyp(E_Address().Typ) Location_;
    KEL.typ.nstr Primary_Range_;
    KEL.typ.nstr Predirectional_;
    KEL.typ.nstr Primary_Name_;
    KEL.typ.nstr Suffix_;
    KEL.typ.nstr Postdirectional_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Z_I_P5_;
    KEL.typ.nstr Secondary_Range_;
    KEL.typ.nstr Cart_;
    KEL.typ.nstr C_R_Sort_Sz_;
    KEL.typ.nstr Lot_;
    KEL.typ.nstr Lot_Order_;
    KEL.typ.nstr D_P_B_C_;
    KEL.typ.nstr C_H_K_Digit_;
    KEL.typ.nstr Ace_Fips_St_;
    KEL.typ.nstr Ace_Fips_County_;
    KEL.typ.nstr M_S_A_;
    KEL.typ.nstr Verified_City_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Rank_Details_Layout) Address_Rank_Details_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Address_Hierarchy_Layout) Address_Hierarchy_;
    KEL.typ.ndataset(E_Person_Address(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nbool Curennt_Addr_Matchattribute_;
    KEL.typ.nbool Previous_Addr_Matchattribute_;
    KEL.typ.epoch Archive___Date_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.epoch Hybrid_Archive_Date_ := 0;
    KEL.typ.epoch Vault_Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST253174_Layout __ND7529226__Project(__ST1341030_Layout __PP7527582) := TRANSFORM
    SELF.Curennt_Addr_Matchattribute_ := __AND(__AND(__AND(__AND(__AND(__AND(__OR(__OP2(__PP7527582.Current_Addr_Prim_Rng_,=,__PP7527582.Primary_Range_),__AND(__OR(__OP2(__PP7527582.Current_Addr_Prim_Rng_,=,__CN('')),__NT(__PP7527582.Current_Addr_Prim_Rng_)),__OR(__OP2(__PP7527582.Primary_Range_,=,__CN('')),__NT(__PP7527582.Primary_Range_)))),__OR(__OP2(__PP7527582.Current_Addr_Pre_Dir_,=,__PP7527582.Predirectional_),__AND(__OR(__OP2(__PP7527582.Current_Addr_Pre_Dir_,=,__CN('')),__NT(__PP7527582.Current_Addr_Pre_Dir_)),__OR(__OP2(__PP7527582.Predirectional_,=,__CN('')),__NT(__PP7527582.Predirectional_))))),__OR(__OP2(__PP7527582.Current_Addr_Prim_Name_,=,__PP7527582.Primary_Name_),__AND(__OR(__OP2(__PP7527582.Current_Addr_Prim_Name_,=,__CN('')),__NT(__PP7527582.Current_Addr_Prim_Name_)),__OR(__OP2(__PP7527582.Primary_Name_,=,__CN('')),__NT(__PP7527582.Primary_Name_))))),__OR(__OP2(__PP7527582.Current_Addr_Sffx_,=,__PP7527582.Suffix_),__AND(__OR(__OP2(__PP7527582.Current_Addr_Sffx_,=,__CN('')),__NT(__PP7527582.Current_Addr_Sffx_)),__OR(__OP2(__PP7527582.Suffix_,=,__CN('')),__NT(__PP7527582.Suffix_))))),__OR(__OP2(__PP7527582.Current_Postdirectional_,=,__PP7527582.Postdirectional_),__AND(__OR(__OP2(__PP7527582.Current_Postdirectional_,=,__CN('')),__NT(__PP7527582.Current_Postdirectional_)),__OR(__OP2(__PP7527582.Postdirectional_,=,__CN('')),__NT(__PP7527582.Postdirectional_))))),__OP2(__CAST(KEL.typ.str,__PP7527582.Z_I_P5_),=,__PP7527582.Current_Addr_Zip5_)),__OR(__OP2(__PP7527582.Current_Addr_Sec_Rng_,=,__PP7527582.Secondary_Range_),__AND(__OR(__OP2(__PP7527582.Current_Addr_Sec_Rng_,=,__CN('')),__NT(__PP7527582.Current_Addr_Sec_Rng_)),__OR(__OP2(__PP7527582.Secondary_Range_,=,__CN('')),__NT(__PP7527582.Secondary_Range_)))));
    SELF.Previous_Addr_Matchattribute_ := __AND(__AND(__AND(__AND(__AND(__AND(__OR(__OP2(__PP7527582.Previous_Addr_Prim_Rng_,=,__PP7527582.Primary_Range_),__AND(__OR(__OP2(__PP7527582.Previous_Addr_Prim_Rng_,=,__CN('')),__NT(__PP7527582.Previous_Addr_Prim_Rng_)),__OR(__OP2(__PP7527582.Primary_Range_,=,__CN('')),__NT(__PP7527582.Primary_Range_)))),__OR(__OP2(__PP7527582.Previous_Addr_Pre_Dir_,=,__PP7527582.Predirectional_),__AND(__OR(__OP2(__PP7527582.Previous_Addr_Pre_Dir_,=,__CN('')),__NT(__PP7527582.Previous_Addr_Pre_Dir_)),__OR(__OP2(__PP7527582.Predirectional_,=,__CN('')),__NT(__PP7527582.Predirectional_))))),__OR(__OP2(__PP7527582.Previous_Addr_Prim_Name_,=,__PP7527582.Primary_Name_),__AND(__OR(__OP2(__PP7527582.Previous_Addr_Prim_Name_,=,__CN('')),__NT(__PP7527582.Previous_Addr_Prim_Name_)),__OR(__OP2(__PP7527582.Primary_Name_,=,__CN('')),__NT(__PP7527582.Primary_Name_))))),__OR(__OP2(__PP7527582.Previous_Addr_Sffx_,=,__PP7527582.Suffix_),__AND(__OR(__OP2(__PP7527582.Previous_Addr_Sffx_,=,__CN('')),__NT(__PP7527582.Previous_Addr_Sffx_)),__OR(__OP2(__PP7527582.Suffix_,=,__CN('')),__NT(__PP7527582.Suffix_))))),__OR(__OP2(__PP7527582.Previous_Postdirectional_,=,__PP7527582.Postdirectional_),__AND(__OR(__OP2(__PP7527582.Previous_Postdirectional_,=,__CN('')),__NT(__PP7527582.Previous_Postdirectional_)),__OR(__OP2(__PP7527582.Postdirectional_,=,__CN('')),__NT(__PP7527582.Postdirectional_))))),__OP2(__CAST(KEL.typ.str,__PP7527582.Z_I_P5_),=,__PP7527582.Previous_Addr_Zip5_)),__OR(__OP2(__PP7527582.Previous_Addr_Sec_Rng_,=,__PP7527582.Secondary_Range_),__AND(__OR(__OP2(__PP7527582.Previous_Addr_Sec_Rng_,=,__CN('')),__NT(__PP7527582.Previous_Addr_Sec_Rng_)),__OR(__OP2(__PP7527582.Secondary_Range_,=,__CN('')),__NT(__PP7527582.Secondary_Range_)))));
    SELF := __PP7527582;
  END;
  EXPORT __ENH_Person_Address_3 := PROJECT(__EE7527581,__ND7529226__Project(LEFT));
END;
