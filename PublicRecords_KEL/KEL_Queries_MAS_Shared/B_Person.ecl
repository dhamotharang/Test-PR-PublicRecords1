//HPCC Systems KEL Compiler Version 1.5.0rc1
IMPORT KEL15 AS KEL;
IMPORT B_Person_1,B_Person_2,B_Person_6,B_Person_S_S_N_1,B_Person_S_S_N_2,CFG_Compile,E_Address,E_Geo_Link,E_Person,E_Person_Address,E_Person_S_S_N,E_Social_Security_Number,E_Zip_Code,FN_Compile FROM PublicRecords_KEL.KEL_Queries_MAS_Shared;
IMPORT * FROM KEL15.Null;
EXPORT B_Person(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(B_Person_1(__in,__cfg).__ENH_Person_1) __ENH_Person_1 := B_Person_1(__in,__cfg).__ENH_Person_1;
  SHARED VIRTUAL TYPEOF(B_Person_S_S_N_1(__in,__cfg).__ENH_Person_S_S_N_1) __ENH_Person_S_S_N_1 := B_Person_S_S_N_1(__in,__cfg).__ENH_Person_S_S_N_1;
  SHARED __EE189038 := __ENH_Person_1;
  SHARED __ST168739_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Gender_;
    KEL.typ.nstr Lex_I_D_Segment_;
    KEL.typ.nstr Lex_I_D_Segment2_;
    KEL.typ.ndataset(B_Person_2(__in,__cfg).__ST140081_Layout) Full_Name_;
    KEL.typ.ndataset(B_Person_2(__in,__cfg).__ST140094_Layout) Reported_Dates_Of_Birth_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Reported_Dates_Of_Death_Layout) Reported_Dates_Of_Death_;
    KEL.typ.nstr Race_;
    KEL.typ.nstr Race_Description_;
    KEL.typ.ndataset(B_Person_1(__in,__cfg).__ST140279_Layout) Data_Sources_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Dunn_Data_Layout) Dunn_Data_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Conceal_Carry_Layout) Conceal_Carry_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Hunt_Fish_Layout) Hunt_Fish_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Consumer_Statement_Flags_Layout) Consumer_Statement_Flags_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Thrive_Layout) Thrive_;
    KEL.typ.nkdate Best_D_O_B_;
    KEL.typ.nstr Best_First_Name_;
    KEL.typ.nstr Best_Last_Name_;
    KEL.typ.nstr Best_Mid_Name_;
    KEL.typ.ntyp(E_Social_Security_Number().Typ) Best_S_S_N_;
    KEL.typ.ndataset(B_Person_6(__in,__cfg).__ST77907_Layout) Curr_Addr_Full_Set_;
    B_Person_6(__in,__cfg).__ST77907_Layout Current_;
    E_Person_Address(__in,__cfg).Address_Hierarchy_Layout Emerging_;
    KEL.typ.str P___Lex_I_D_Seen_Flag_ := '';
    KEL.typ.nstr Prep_Current_Addr_Full_;
    B_Person_6(__in,__cfg).__ST77907_Layout Previous_;
    KEL.typ.bool Person_S_S_N_ := FALSE;
    KEL.typ.epoch Archive___Date_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.epoch Hybrid_Archive_Date_ := 0;
    KEL.typ.epoch Vault_Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __EE189041 := __ENH_Person_S_S_N_1;
  SHARED __EE191543 := __EE189041(__EE189041.Is_Best_S_S_N_ AND __NN(__EE189041.Subject_));
  __JC191560(B_Person_1(__in,__cfg).__ST140247_Layout __EE189038, B_Person_S_S_N_2(__in,__cfg).__ST137775_Layout __EE191543) := __EEQP(__EE189038.UID,__EE191543.Subject_);
  __JF191560(B_Person_S_S_N_2(__in,__cfg).__ST137775_Layout __EE191543) := __NN(__EE191543.Subject_);
  SHARED __EE191561 := JOIN(__EE189038,__EE191543,__JC191560(LEFT,RIGHT),TRANSFORM(__ST168739_Layout,SELF:=LEFT,SELF.Person_S_S_N_:=__JF191560(RIGHT)),HASH,LEFT OUTER,KEEP(1));
  EXPORT __ST137219_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nstr Gender_;
    KEL.typ.nstr Lex_I_D_Segment_;
    KEL.typ.nstr Lex_I_D_Segment2_;
    KEL.typ.ndataset(B_Person_2(__in,__cfg).__ST140081_Layout) Full_Name_;
    KEL.typ.ndataset(B_Person_2(__in,__cfg).__ST140094_Layout) Reported_Dates_Of_Birth_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Reported_Dates_Of_Death_Layout) Reported_Dates_Of_Death_;
    KEL.typ.nstr Race_;
    KEL.typ.nstr Race_Description_;
    KEL.typ.ndataset(B_Person_1(__in,__cfg).__ST140279_Layout) Data_Sources_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Dunn_Data_Layout) Dunn_Data_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Conceal_Carry_Layout) Conceal_Carry_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Hunt_Fish_Layout) Hunt_Fish_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Consumer_Statement_Flags_Layout) Consumer_Statement_Flags_;
    KEL.typ.ndataset(E_Person(__in,__cfg).Thrive_Layout) Thrive_;
    KEL.typ.nstr Emerging_Addr_Cnty_;
    KEL.typ.nstr Emerging_Addr_Geo_;
    KEL.typ.nstr Emerging_Addr_Pre_Dir_;
    KEL.typ.nstr Emerging_Addr_Prim_Name_;
    KEL.typ.nstr Emerging_Addr_Prim_Rng_;
    KEL.typ.nstr Emerging_Addr_Sec_Rng_;
    KEL.typ.nstr Emerging_Addr_Sffx_;
    KEL.typ.nstr Emerging_Addr_State_;
    KEL.typ.nstr Emerging_Addr_State_Code_;
    KEL.typ.ntyp(E_Zip_Code().Typ) Emerging_Addr_Zip5_;
    KEL.typ.nstr Emerging_Postdirectional_;
    KEL.typ.nstr P_L___Best_D_O_B_;
    KEL.typ.nstr P_L___Best_Name_First_;
    KEL.typ.nstr P_L___Best_Name_Last_;
    KEL.typ.nstr P_L___Best_Name_Mid_;
    KEL.typ.nstr P_L___Best_S_S_N_;
    KEL.typ.str P___Lex_I_D_Seen_Flag_ := '';
    KEL.typ.str P___Lex_I_D_Seen_Flag_F_C_R_A_ := '';
    KEL.typ.nstr Prep_Current_Addr_City_;
    KEL.typ.nstr Prep_Current_Addr_Cnty_;
    KEL.typ.nstr Prep_Current_Addr_Date_First_Seen_;
    KEL.typ.nstr Prep_Current_Addr_Date_Last_Seen_;
    KEL.typ.nstr Prep_Current_Addr_Full_;
    KEL.typ.nstr Prep_Current_Addr_Geo_;
    KEL.typ.nstr Prep_Current_Addr_Lat_;
    KEL.typ.nstr Prep_Current_Addr_Lng_;
    KEL.typ.nstr Prep_Current_Addr_Pre_Dir_;
    KEL.typ.nstr Prep_Current_Addr_Prim_Name_;
    KEL.typ.nstr Prep_Current_Addr_Prim_Rng_;
    KEL.typ.nstr Prep_Current_Addr_Sec_Rng_;
    KEL.typ.nstr Prep_Current_Addr_Sffx_;
    KEL.typ.nstr Prep_Current_Addr_State_;
    KEL.typ.nstr Prep_Current_Addr_State_Code_;
    KEL.typ.nstr Prep_Current_Addr_Status_;
    KEL.typ.nstr Prep_Current_Addr_Type_;
    KEL.typ.nstr Prep_Current_Addr_Unit_Designation_;
    KEL.typ.nstr Prep_Current_Addr_Zip4_;
    KEL.typ.nstr Prep_Current_Addr_Zip5_;
    KEL.typ.nstr Prep_Current_Postdirectional_;
    KEL.typ.nstr Prep_Previous_Addr_City_;
    KEL.typ.nstr Prep_Previous_Addr_Cnty_;
    KEL.typ.nstr Prep_Previous_Addr_Date_First_Seen_;
    KEL.typ.nstr Prep_Previous_Addr_Date_Last_Seen_;
    KEL.typ.nstr Prep_Previous_Addr_Full_;
    KEL.typ.nstr Prep_Previous_Addr_Geo_;
    KEL.typ.nstr Prep_Previous_Addr_Lat_;
    KEL.typ.nstr Prep_Previous_Addr_Lng_;
    KEL.typ.nstr Prep_Previous_Addr_Pre_Dir_;
    KEL.typ.nstr Prep_Previous_Addr_Prim_Name_;
    KEL.typ.nstr Prep_Previous_Addr_Prim_Rng_;
    KEL.typ.nstr Prep_Previous_Addr_Sec_Rng_;
    KEL.typ.nstr Prep_Previous_Addr_Sffx_;
    KEL.typ.nstr Prep_Previous_Addr_State_;
    KEL.typ.nstr Prep_Previous_Addr_State_Code_;
    KEL.typ.nstr Prep_Previous_Addr_Status_;
    KEL.typ.nstr Prep_Previous_Addr_Type_;
    KEL.typ.nstr Prep_Previous_Addr_Unit_Designation_;
    KEL.typ.nstr Prep_Previous_Addr_Zip4_;
    KEL.typ.nstr Prep_Previous_Addr_Zip5_;
    KEL.typ.nstr Prep_Previous_Postdirectional_;
    KEL.typ.epoch Archive___Date_ := 0;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.epoch Hybrid_Archive_Date_ := 0;
    KEL.typ.epoch Vault_Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST137219_Layout __ND192572__Project(__ST168739_Layout __PP191562) := TRANSFORM
    SELF.Emerging_Addr_Cnty_ := __PP191562.Emerging_.County_Code_;
    SELF.Emerging_Addr_Geo_ := __PP191562.Emerging_.Geo_Blk_;
    SELF.Emerging_Addr_Pre_Dir_ := __PP191562.Emerging_.Predirectional_;
    SELF.Emerging_Addr_Prim_Name_ := __PP191562.Emerging_.Primary_Name_;
    SELF.Emerging_Addr_Prim_Rng_ := __PP191562.Emerging_.Primary_Range_;
    SELF.Emerging_Addr_Sec_Rng_ := __PP191562.Emerging_.Secondary_Range_;
    SELF.Emerging_Addr_Sffx_ := __PP191562.Emerging_.Suffix_;
    SELF.Emerging_Addr_State_ := __PP191562.Emerging_.State_;
    SELF.Emerging_Addr_State_Code_ := __PP191562.Emerging_.State_Code_;
    SELF.Emerging_Addr_Zip5_ := __PP191562.Emerging_.Z_I_P5_;
    SELF.Emerging_Postdirectional_ := __PP191562.Emerging_.Postdirectional_;
    __CC13937 := '-99999';
    __CC13942 := '-99998';
    SELF.P_L___Best_D_O_B_ := MAP(__PP191562.P___Lex_I_D_Seen_Flag_ = '0'=>__ECAST(KEL.typ.nstr,__CN(__CC13937)),__T(__NT(__PP191562.Best_D_O_B_))=>__ECAST(KEL.typ.nstr,__CN(__CC13942)),__ECAST(KEL.typ.nstr,__FN2(KEL.Routines.DateToString,__PP191562.Best_D_O_B_,__CN('%Y%m%d'))));
    SELF.P_L___Best_Name_First_ := MAP(__PP191562.P___Lex_I_D_Seen_Flag_ = '0'=>__ECAST(KEL.typ.nstr,__CN(__CC13937)),__T(__OR(__OP2(__PP191562.Best_First_Name_,=,__CN('')),__NT(__PP191562.Best_First_Name_)))=>__ECAST(KEL.typ.nstr,__CN(__CC13942)),__ECAST(KEL.typ.nstr,__PP191562.Best_First_Name_));
    SELF.P_L___Best_Name_Last_ := MAP(__PP191562.P___Lex_I_D_Seen_Flag_ = '0'=>__ECAST(KEL.typ.nstr,__CN(__CC13937)),__T(__OR(__OP2(__PP191562.Best_Last_Name_,=,__CN('')),__NT(__PP191562.Best_Last_Name_)))=>__ECAST(KEL.typ.nstr,__CN(__CC13942)),__ECAST(KEL.typ.nstr,__PP191562.Best_Last_Name_));
    SELF.P_L___Best_Name_Mid_ := MAP(__PP191562.P___Lex_I_D_Seen_Flag_ = '0'=>__ECAST(KEL.typ.nstr,__CN(__CC13937)),__T(__OR(__OP2(__PP191562.Best_Mid_Name_,=,__CN('')),__NT(__PP191562.Best_Mid_Name_)))=>__ECAST(KEL.typ.nstr,__CN(__CC13942)),__ECAST(KEL.typ.nstr,__PP191562.Best_Mid_Name_));
    SELF.P_L___Best_S_S_N_ := MAP(__PP191562.P___Lex_I_D_Seen_Flag_ = '0'=>__ECAST(KEL.typ.nstr,__CN(__CC13937)), NOT (__PP191562.Person_S_S_N_)=>__ECAST(KEL.typ.nstr,__CN(__CC13942)),__ECAST(KEL.typ.nstr,__CAST(KEL.typ.str,__PP191562.Best_S_S_N_)));
    __CC73025 := 3652;
    __BS192030 := __T(__PP191562.Data_Sources_);
    __CC73023 := 2556;
    __BS192066 := __T(__PP191562.Data_Sources_);
    __BS192102 := __T(__PP191562.Data_Sources_);
    SELF.P___Lex_I_D_Seen_Flag_F_C_R_A_ := IF(EXISTS(__BS192030(__T(__AND(__NOT(__NT(__T(__PP191562.Data_Sources_).Header_Hit_Flag_)),__AND(__T(__PP191562.Data_Sources_).Header_Hit_Flag_,__AND(__OP2(__T(__PP191562.Data_Sources_).Source_,=,__CN('BA')),__AND(__OP2(__T(__PP191562.Data_Sources_).Age_In_Days_,<=,__CN(__CC73025)),__NOT(__NT(__T(__PP191562.Data_Sources_).Age_In_Days_))))))))) OR EXISTS(__BS192066(__T(__AND(__NOT(__NT(__T(__PP191562.Data_Sources_).Header_Hit_Flag_)),__AND(__T(__PP191562.Data_Sources_).Header_Hit_Flag_,__AND(__OP2(__T(__PP191562.Data_Sources_).Source_,=,__CN('L2')),__AND(__OP2(__T(__PP191562.Data_Sources_).Age_In_Days_,<=,__CN(__CC73023)),__NOT(__NT(__T(__PP191562.Data_Sources_).Age_In_Days_))))))))) OR EXISTS(__BS192102(__T(__AND(__NOT(__NT(__T(__PP191562.Data_Sources_).Header_Hit_Flag_)),__AND(__T(__PP191562.Data_Sources_).Header_Hit_Flag_,__AND(__OP2(__T(__PP191562.Data_Sources_).Source_,<>,__CN('BA')),__OP2(__T(__PP191562.Data_Sources_).Source_,<>,__CN('L2')))))))),'1','0');
    SELF.Prep_Current_Addr_City_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Postal_City_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Cnty_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.County_Code_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Date_First_Seen_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__FN2(KEL.Routines.DateToString,__PP191562.Current_.Hierarchy_Date_First_Seen_,__CN('%Y%m%d'))),__N(KEL.typ.str));
    __CC13282 := KEL.Routines.MinN(FN_Compile(__cfg).FN_G_E_T_B_U_I_L_D_D_A_T_E(__ECAST(KEL.typ.nstr,__CN('header_build_version'))),__CN(__cfg.CurrentDate));
    SELF.Prep_Current_Addr_Date_Last_Seen_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__FN2(KEL.Routines.DateToString,KEL.Routines.MinN(__PP191562.Current_.Hierarchy_Date_Last_Seen_,__CC13282),__CN('%Y%m%d'))),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Geo_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Geo_Blk_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Lat_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Latitude_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Lng_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Longitude_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Pre_Dir_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Predirectional_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Prim_Name_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Primary_Name_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Prim_Rng_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Primary_Range_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Sec_Rng_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Secondary_Range_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Sffx_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Suffix_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_State_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.State_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_State_Code_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.State_Code_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Status_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Address_Status_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Type_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Address_Type_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Unit_Designation_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Unit_Designation_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Zip4_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Z_I_P4_),__N(KEL.typ.str));
    SELF.Prep_Current_Addr_Zip5_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Z_I_P5_),__N(KEL.typ.str));
    SELF.Prep_Current_Postdirectional_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Current_.Postdirectional_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_City_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Postal_City_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Cnty_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.County_Code_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Date_First_Seen_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__FN2(KEL.Routines.DateToString,__PP191562.Previous_.Hierarchy_Date_First_Seen_,__CN('%Y%m%d'))),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Date_Last_Seen_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__FN2(KEL.Routines.DateToString,KEL.Routines.MinN(__PP191562.Previous_.Hierarchy_Date_Last_Seen_,__CC13282),__CN('%Y%m%d'))),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Full_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Addr_Full_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Geo_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Geo_Blk_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Lat_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Latitude_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Lng_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Longitude_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Pre_Dir_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Predirectional_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Prim_Name_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Primary_Name_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Prim_Rng_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Primary_Range_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Sec_Rng_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Secondary_Range_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Sffx_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Suffix_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_State_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.State_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_State_Code_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.State_Code_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Status_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Address_Status_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Type_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Address_Type_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Unit_Designation_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Unit_Designation_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Zip4_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Z_I_P4_),__N(KEL.typ.str));
    SELF.Prep_Previous_Addr_Zip5_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Z_I_P5_),__N(KEL.typ.str));
    SELF.Prep_Previous_Postdirectional_ := IF(__PP191562.P___Lex_I_D_Seen_Flag_ = '1',__ECAST(KEL.typ.nstr,__PP191562.Previous_.Postdirectional_),__N(KEL.typ.str));
    SELF := __PP191562;
  END;
  EXPORT __ENH_Person := PROJECT(__EE191561,__ND192572__Project(LEFT));
END;
