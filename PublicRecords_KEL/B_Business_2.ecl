//HPCC Systems KEL Compiler Version 0.11.6
IMPORT KEL011 AS KEL;
IMPORT B_Business_3,B_Tradeline_3,B_Tradeline_4,B_Tradeline_Business_3,CFG_Compile,E_Business,E_Tradeline,E_Tradeline_Business,FN_Compile FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Business_2(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(B_Business_3(__in,__cfg).__ENH_Business_3) __ENH_Business_3 := B_Business_3(__in,__cfg).__ENH_Business_3;
  SHARED VIRTUAL TYPEOF(B_Tradeline_3(__in,__cfg).__ENH_Tradeline_3) __ENH_Tradeline_3 := B_Tradeline_3(__in,__cfg).__ENH_Tradeline_3;
  SHARED VIRTUAL TYPEOF(B_Tradeline_Business_3(__in,__cfg).__ENH_Tradeline_Business_3) __ENH_Tradeline_Business_3 := B_Tradeline_Business_3(__in,__cfg).__ENH_Tradeline_Business_3;
  SHARED __EE297006 := __ENH_Business_3;
  SHARED __EE297023 := __ENH_Tradeline_Business_3;
  SHARED __EE301615 := __EE297023;
  SHARED __EE301627 := __EE301615(__NN(__EE301615.Company_));
  SHARED __ST286688_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout) Trade_Account_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __ST286688_Layout __JT301638(B_Tradeline_Business_3(__in,__cfg).__ST66184_Layout __l, B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout __r) := TRANSFORM
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE301639 := NORMALIZE(__EE301627,__T(LEFT.Trade_Account_),__JT301638(LEFT,RIGHT));
  SHARED __ST284657_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE301671 := PROJECT(__EE301639,TRANSFORM(__ST284657_Layout,SELF.UID := LEFT.Company_,SELF := LEFT));
  SHARED __ST284679_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE301684 := PROJECT(__CLEANANDDO(__EE301671,TABLE(__EE301671,{KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP),UID},UID,MERGE)),__ST284679_Layout);
  SHARED __ST286737_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28393_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28433_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28473_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28513_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28553_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28353_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170736_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170756_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170775_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170794_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170813_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170827_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC301690(B_Business_3(__in,__cfg).__ST64677_Layout __EE297006, __ST284679_Layout __EE301684) := __EEQP(__EE297006.UID,__EE301684.UID);
  __ST286737_Layout __JT301690(B_Business_3(__in,__cfg).__ST64677_Layout __l, __ST284679_Layout __r) := TRANSFORM
    SELF.U_I_D__1_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE301691 := JOIN(__EE297006,__EE301684,__JC301690(LEFT,RIGHT),__JT301690(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE297025 := __ENH_Tradeline_3;
  SHARED __EE297031 := __EE297025(__T(__EE297025.Is_Active_));
  SHARED __EE298502 := __EE297023(__NN(__EE297023.Company_) AND __NN(__EE297023.Account_));
  SHARED __ST285574_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66113_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout) Trade_Account_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC298520(B_Tradeline_3(__in,__cfg).__ST66106_Layout __EE297031, B_Tradeline_Business_3(__in,__cfg).__ST66184_Layout __EE298502) := __EEQP(__EE298502.Account_,__EE297031.UID);
  __ST285574_Layout __JT298520(B_Tradeline_3(__in,__cfg).__ST66106_Layout __l, B_Tradeline_Business_3(__in,__cfg).__ST66184_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE298521 := JOIN(__EE298502,__EE297031,__JC298520(RIGHT,LEFT),__JT298520(RIGHT,LEFT),INNER,HASH);
  SHARED __ST270147_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout) Trade_Account_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66113_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST270147_Layout __ND298602__Project(__ST285574_Layout __PP298522) := TRANSFORM
    SELF.UID := __PP298522.Company_;
    SELF.Data_Sources_ := __PP298522.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP298522.UID;
    SELF.Data_Sources__1_ := __PP298522.Data_Sources_;
    SELF := __PP298522;
  END;
  SHARED __EE298807 := PROJECT(__EE298521,__ND298602__Project(LEFT));
  SHARED __ST270338_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nint Exp1_;
    KEL.typ.nint Exp2_;
    KEL.typ.nint Exp3_;
    KEL.typ.nint Exp4_;
    KEL.typ.nint Exp5_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST270338_Layout __ND298812__Project(__ST270147_Layout __PP298808) := TRANSFORM
    SELF.Exp1_ := IF(__PP298808.Is_Carrier_Segment_,__ECAST(KEL.typ.nint,__PP298808.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp2_ := IF(__PP298808.Is_Fleet_Segment_,__ECAST(KEL.typ.nint,__PP298808.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp3_ := IF(__PP298808.Is_Materials_Segment_,__ECAST(KEL.typ.nint,__PP298808.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp4_ := IF(__PP298808.Is_Operations_Segment_,__ECAST(KEL.typ.nint,__PP298808.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp5_ := IF(__PP298808.Is_Other_Segment_,__ECAST(KEL.typ.nint,__PP298808.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF := __PP298808;
  END;
  SHARED __EE298856 := PROJECT(__EE298807,__ND298812__Project(LEFT));
  SHARED __ST270379_Layout := RECORD
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE298899 := PROJECT(__CLEANANDDO(__EE298856,TABLE(__EE298856,{KEL.typ.int S_U_M___Total_A_R_L_N_ := KEL.Aggregates.SumNG(__EE298856.Exp1_),KEL.typ.int S_U_M___Total_A_R_L_N__1_ := KEL.Aggregates.SumNG(__EE298856.Exp2_),KEL.typ.int S_U_M___Total_A_R_L_N__2_ := KEL.Aggregates.SumNG(__EE298856.Exp3_),KEL.typ.int S_U_M___Total_A_R_L_N__3_ := KEL.Aggregates.SumNG(__EE298856.Exp4_),KEL.typ.int S_U_M___Total_A_R_L_N__4_ := KEL.Aggregates.SumNG(__EE298856.Exp5_),KEL.typ.int S_U_M___Total_A_R_L_N__5_ := KEL.Aggregates.SumNG(__EE298856.Total_A_R_L_N_),KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP),UID},UID,MERGE)),__ST270379_Layout);
  SHARED __ST287730_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28393_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28433_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28473_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28513_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28553_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28353_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170736_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170756_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170775_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170794_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170813_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170827_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC301822(__ST286737_Layout __EE301691, __ST270379_Layout __EE298899) := __EEQP(__EE301691.UID,__EE298899.UID);
  __ST287730_Layout __JT301822(__ST286737_Layout __l, __ST270379_Layout __r) := TRANSFORM
    SELF.C_O_U_N_T___Exp1__1_ := __r.C_O_U_N_T___Exp1_;
    SELF.U_I_D__2_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE301823 := JOIN(__EE301691,__EE298899,__JC301822(LEFT,RIGHT),__JT301822(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE301612 := __EE297025;
  SHARED __EE301618 := __EE298502;
  SHARED __ST285873_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66113_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout) Trade_Account_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC301968(B_Tradeline_3(__in,__cfg).__ST66106_Layout __EE301612, B_Tradeline_Business_3(__in,__cfg).__ST66184_Layout __EE301618) := __EEQP(__EE301618.Account_,__EE301612.UID);
  __ST285873_Layout __JT301968(B_Tradeline_3(__in,__cfg).__ST66106_Layout __l, B_Tradeline_Business_3(__in,__cfg).__ST66184_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE301969 := JOIN(__EE301618,__EE301612,__JC301968(RIGHT,LEFT),__JT301968(RIGHT,LEFT),INNER,HASH);
  SHARED __ST286209_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66113_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout) Trade_Account_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nint D_P_D1_Total_;
    KEL.typ.nint D_P_D31_Total_;
    KEL.typ.nint D_P_D61_Total_;
    KEL.typ.nint D_P_D91_Total_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __ST286209_Layout __JT302056(__ST285873_Layout __l, B_Tradeline_3(__in,__cfg).__ST66113_Layout __r) := TRANSFORM
    SELF.Total_A_R_L_N__1_ := __r.Total_A_R_L_N_;
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE302057 := NORMALIZE(__EE301969,__T(LEFT.Records_),__JT302056(LEFT,RIGHT));
  SHARED __ST282780_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST26963_Layout) Trade_Account_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66113_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nint D_P_D1_Total_;
    KEL.typ.nint D_P_D31_Total_;
    KEL.typ.nint D_P_D61_Total_;
    KEL.typ.nint D_P_D91_Total_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST282780_Layout __ND302174__Project(__ST286209_Layout __PP302058) := TRANSFORM
    SELF.UID := __PP302058.Company_;
    SELF.Data_Sources_ := __PP302058.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP302058.UID;
    SELF.Data_Sources__1_ := __PP302058.Data_Sources_;
    SELF := __PP302058;
  END;
  SHARED __EE302523 := PROJECT(__EE302057,__ND302174__Project(LEFT));
  SHARED __ST283307_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nint Exp1_;
    KEL.typ.nint Exp2_;
    KEL.typ.nint Exp3_;
    KEL.typ.nint Exp4_;
    KEL.typ.nint Exp5_;
    KEL.typ.nint Exp6_;
    KEL.typ.nint Exp7_;
    KEL.typ.nint Exp8_;
    KEL.typ.nint Exp9_;
    KEL.typ.nint Exp10_;
    KEL.typ.nbool Exp11_;
    KEL.typ.nbool Exp12_;
    KEL.typ.nbool Exp13_;
    KEL.typ.nbool Exp14_;
    KEL.typ.nbool Exp15_;
    KEL.typ.nbool Exp16_;
    KEL.typ.nbool Exp17_;
    KEL.typ.nbool Exp18_;
    KEL.typ.nbool Exp19_;
    KEL.typ.nbool Exp20_;
    KEL.typ.nbool Exp21_;
    KEL.typ.nbool Exp22_;
    KEL.typ.nbool Exp23_;
    KEL.typ.nbool Exp24_;
    KEL.typ.nbool Exp25_;
    KEL.typ.nbool Exp26_;
    KEL.typ.nbool Exp27_;
    KEL.typ.nbool Exp28_;
    KEL.typ.nbool Exp29_;
    KEL.typ.nbool Exp30_;
    KEL.typ.nbool Exp31_;
    KEL.typ.nbool Exp32_;
    KEL.typ.nbool Exp33_;
    KEL.typ.nbool Exp34_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST283307_Layout __ND304142__Project(__ST282780_Layout __PP302524) := TRANSFORM
    SELF.Exp1_ := IF(__T(__PP302524.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP302524.D_P_D1_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp2_ := IF(__T(__PP302524.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP302524.D_P_D31_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp3_ := IF(__T(__PP302524.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP302524.D_P_D61_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp4_ := IF(__T(__PP302524.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP302524.D_P_D91_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp5_ := IF(__T(__PP302524.Is_Two_Year_Full_Record_),__ECAST(KEL.typ.nint,__PP302524.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp6_ := IF(__T(__AND(__PP302524.Carrier_Segment_,__PP302524.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP302524.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp7_ := IF(__T(__AND(__PP302524.Fleet_Segment_,__PP302524.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP302524.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp8_ := IF(__T(__AND(__PP302524.Materials_Segment_,__PP302524.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP302524.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp9_ := IF(__T(__AND(__PP302524.Operations_Segment_,__PP302524.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP302524.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp10_ := IF(__T(__AND(__PP302524.Other_Segment_,__PP302524.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP302524.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    __CC11111 := 730;
    SELF.Exp11_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging91_Plus_L_N_,>,__CN(0))),__PP302524.Carrier_Segment_);
    SELF.Exp12_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging61_To90_L_N_,>,__CN(0))),__PP302524.Carrier_Segment_);
    SELF.Exp13_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging31_To60_L_N_,>,__CN(0))),__PP302524.Carrier_Segment_);
    SELF.Exp14_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging1_To30_L_N_,>,__CN(0))),__PP302524.Carrier_Segment_);
    SELF.Exp15_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging91_Plus_L_N_,>,__CN(0))),__PP302524.Fleet_Segment_);
    SELF.Exp16_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging61_To90_L_N_,>,__CN(0))),__PP302524.Fleet_Segment_);
    SELF.Exp17_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging31_To60_L_N_,>,__CN(0))),__PP302524.Fleet_Segment_);
    SELF.Exp18_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging1_To30_L_N_,>,__CN(0))),__PP302524.Fleet_Segment_);
    SELF.Exp19_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging91_Plus_L_N_,>,__CN(0))),__PP302524.Materials_Segment_);
    SELF.Exp20_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging61_To90_L_N_,>,__CN(0))),__PP302524.Materials_Segment_);
    SELF.Exp21_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging31_To60_L_N_,>,__CN(0))),__PP302524.Materials_Segment_);
    SELF.Exp22_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging1_To30_L_N_,>,__CN(0))),__PP302524.Materials_Segment_);
    SELF.Exp23_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging91_Plus_L_N_,>,__CN(0))),__PP302524.Operations_Segment_);
    SELF.Exp24_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging61_To90_L_N_,>,__CN(0))),__PP302524.Operations_Segment_);
    SELF.Exp25_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging31_To60_L_N_,>,__CN(0))),__PP302524.Operations_Segment_);
    SELF.Exp26_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging1_To30_L_N_,>,__CN(0))),__PP302524.Operations_Segment_);
    SELF.Exp27_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging91_Plus_L_N_,>,__CN(0))),__PP302524.Other_Segment_);
    SELF.Exp28_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging61_To90_L_N_,>,__CN(0))),__PP302524.Other_Segment_);
    SELF.Exp29_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging31_To60_L_N_,>,__CN(0))),__PP302524.Other_Segment_);
    SELF.Exp30_ := __AND(__AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging1_To30_L_N_,>,__CN(0))),__PP302524.Other_Segment_);
    SELF.Exp31_ := __AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging91_Plus_L_N_,>,__CN(0)));
    SELF.Exp32_ := __AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging61_To90_L_N_,>,__CN(0)));
    SELF.Exp33_ := __AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging31_To60_L_N_,>,__CN(0)));
    SELF.Exp34_ := __AND(__OP2(__PP302524.Record_Age_In_Days_,<=,__CN(__CC11111)),__OP2(__PP302524.Aging1_To30_L_N_,>,__CN(0)));
    SELF := __PP302524;
  END;
  SHARED __EE304313 := PROJECT(__EE302523,__ND304142__Project(LEFT));
  SHARED __ST283487_Layout := RECORD
    KEL.typ.int S_U_M___D_P_D1_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D31_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D61_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D91_Total_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__6_ := 0;
    KEL.typ.int C_O_U_N_T___Records_ := 0;
    KEL.typ.int C_O_U_N_T___Records__1_ := 0;
    KEL.typ.int C_O_U_N_T___Records__2_ := 0;
    KEL.typ.int C_O_U_N_T___Records__3_ := 0;
    KEL.typ.int C_O_U_N_T___Records__4_ := 0;
    KEL.typ.int C_O_U_N_T___Records__5_ := 0;
    KEL.typ.int C_O_U_N_T___Records__6_ := 0;
    KEL.typ.int C_O_U_N_T___Records__7_ := 0;
    KEL.typ.int C_O_U_N_T___Records__8_ := 0;
    KEL.typ.int C_O_U_N_T___Records__9_ := 0;
    KEL.typ.int C_O_U_N_T___Records__10_ := 0;
    KEL.typ.int C_O_U_N_T___Records__11_ := 0;
    KEL.typ.int C_O_U_N_T___Records__12_ := 0;
    KEL.typ.int C_O_U_N_T___Records__13_ := 0;
    KEL.typ.int C_O_U_N_T___Records__14_ := 0;
    KEL.typ.int C_O_U_N_T___Records__15_ := 0;
    KEL.typ.int C_O_U_N_T___Records__16_ := 0;
    KEL.typ.int C_O_U_N_T___Records__17_ := 0;
    KEL.typ.int C_O_U_N_T___Records__18_ := 0;
    KEL.typ.int C_O_U_N_T___Records__19_ := 0;
    KEL.typ.int C_O_U_N_T___Records__20_ := 0;
    KEL.typ.int C_O_U_N_T___Records__21_ := 0;
    KEL.typ.int C_O_U_N_T___Records__22_ := 0;
    KEL.typ.int C_O_U_N_T___Records__23_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE304518 := PROJECT(__CLEANANDDO(__EE304313,TABLE(__EE304313,{KEL.typ.int S_U_M___D_P_D1_Total_ := KEL.Aggregates.SumNG(__EE304313.Exp1_),KEL.typ.int S_U_M___D_P_D31_Total_ := KEL.Aggregates.SumNG(__EE304313.Exp2_),KEL.typ.int S_U_M___D_P_D61_Total_ := KEL.Aggregates.SumNG(__EE304313.Exp3_),KEL.typ.int S_U_M___D_P_D91_Total_ := KEL.Aggregates.SumNG(__EE304313.Exp4_),KEL.typ.int S_U_M___Total_A_R_L_N__1_ := KEL.Aggregates.SumNG(__EE304313.Exp5_),KEL.typ.int S_U_M___Total_A_R_L_N__2_ := KEL.Aggregates.SumNG(__EE304313.Exp6_),KEL.typ.int S_U_M___Total_A_R_L_N__3_ := KEL.Aggregates.SumNG(__EE304313.Exp7_),KEL.typ.int S_U_M___Total_A_R_L_N__4_ := KEL.Aggregates.SumNG(__EE304313.Exp8_),KEL.typ.int S_U_M___Total_A_R_L_N__5_ := KEL.Aggregates.SumNG(__EE304313.Exp9_),KEL.typ.int S_U_M___Total_A_R_L_N__6_ := KEL.Aggregates.SumNG(__EE304313.Exp10_),KEL.typ.int C_O_U_N_T___Records_ := COUNT(GROUP,__T(__EE304313.Exp11_)),KEL.typ.int C_O_U_N_T___Records__1_ := COUNT(GROUP,__T(__EE304313.Exp12_)),KEL.typ.int C_O_U_N_T___Records__2_ := COUNT(GROUP,__T(__EE304313.Exp13_)),KEL.typ.int C_O_U_N_T___Records__3_ := COUNT(GROUP,__T(__EE304313.Exp14_)),KEL.typ.int C_O_U_N_T___Records__4_ := COUNT(GROUP,__T(__EE304313.Exp15_)),KEL.typ.int C_O_U_N_T___Records__5_ := COUNT(GROUP,__T(__EE304313.Exp16_)),KEL.typ.int C_O_U_N_T___Records__6_ := COUNT(GROUP,__T(__EE304313.Exp17_)),KEL.typ.int C_O_U_N_T___Records__7_ := COUNT(GROUP,__T(__EE304313.Exp18_)),KEL.typ.int C_O_U_N_T___Records__8_ := COUNT(GROUP,__T(__EE304313.Exp19_)),KEL.typ.int C_O_U_N_T___Records__9_ := COUNT(GROUP,__T(__EE304313.Exp20_)),KEL.typ.int C_O_U_N_T___Records__10_ := COUNT(GROUP,__T(__EE304313.Exp21_)),KEL.typ.int C_O_U_N_T___Records__11_ := COUNT(GROUP,__T(__EE304313.Exp22_)),KEL.typ.int C_O_U_N_T___Records__12_ := COUNT(GROUP,__T(__EE304313.Exp23_)),KEL.typ.int C_O_U_N_T___Records__13_ := COUNT(GROUP,__T(__EE304313.Exp24_)),KEL.typ.int C_O_U_N_T___Records__14_ := COUNT(GROUP,__T(__EE304313.Exp25_)),KEL.typ.int C_O_U_N_T___Records__15_ := COUNT(GROUP,__T(__EE304313.Exp26_)),KEL.typ.int C_O_U_N_T___Records__16_ := COUNT(GROUP,__T(__EE304313.Exp27_)),KEL.typ.int C_O_U_N_T___Records__17_ := COUNT(GROUP,__T(__EE304313.Exp28_)),KEL.typ.int C_O_U_N_T___Records__18_ := COUNT(GROUP,__T(__EE304313.Exp29_)),KEL.typ.int C_O_U_N_T___Records__19_ := COUNT(GROUP,__T(__EE304313.Exp30_)),KEL.typ.int C_O_U_N_T___Records__20_ := COUNT(GROUP,__T(__EE304313.Exp31_)),KEL.typ.int C_O_U_N_T___Records__21_ := COUNT(GROUP,__T(__EE304313.Exp32_)),KEL.typ.int C_O_U_N_T___Records__22_ := COUNT(GROUP,__T(__EE304313.Exp33_)),KEL.typ.int C_O_U_N_T___Records__23_ := COUNT(GROUP,__T(__EE304313.Exp34_)),UID},UID,MERGE)),__ST283487_Layout);
  SHARED __ST288742_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28393_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28433_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28473_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28513_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28553_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28353_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170736_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170756_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170775_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170794_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170813_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170827_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.int S_U_M___D_P_D1_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D31_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D61_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D91_Total_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__6_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__7_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__8_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__9_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__10_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__11_ := 0;
    KEL.typ.int C_O_U_N_T___Records_ := 0;
    KEL.typ.int C_O_U_N_T___Records__1_ := 0;
    KEL.typ.int C_O_U_N_T___Records__2_ := 0;
    KEL.typ.int C_O_U_N_T___Records__3_ := 0;
    KEL.typ.int C_O_U_N_T___Records__4_ := 0;
    KEL.typ.int C_O_U_N_T___Records__5_ := 0;
    KEL.typ.int C_O_U_N_T___Records__6_ := 0;
    KEL.typ.int C_O_U_N_T___Records__7_ := 0;
    KEL.typ.int C_O_U_N_T___Records__8_ := 0;
    KEL.typ.int C_O_U_N_T___Records__9_ := 0;
    KEL.typ.int C_O_U_N_T___Records__10_ := 0;
    KEL.typ.int C_O_U_N_T___Records__11_ := 0;
    KEL.typ.int C_O_U_N_T___Records__12_ := 0;
    KEL.typ.int C_O_U_N_T___Records__13_ := 0;
    KEL.typ.int C_O_U_N_T___Records__14_ := 0;
    KEL.typ.int C_O_U_N_T___Records__15_ := 0;
    KEL.typ.int C_O_U_N_T___Records__16_ := 0;
    KEL.typ.int C_O_U_N_T___Records__17_ := 0;
    KEL.typ.int C_O_U_N_T___Records__18_ := 0;
    KEL.typ.int C_O_U_N_T___Records__19_ := 0;
    KEL.typ.int C_O_U_N_T___Records__20_ := 0;
    KEL.typ.int C_O_U_N_T___Records__21_ := 0;
    KEL.typ.int C_O_U_N_T___Records__22_ := 0;
    KEL.typ.int C_O_U_N_T___Records__23_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__3_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC304524(__ST287730_Layout __EE301823, __ST283487_Layout __EE304518) := __EEQP(__EE301823.UID,__EE304518.UID);
  __ST288742_Layout __JT304524(__ST287730_Layout __l, __ST283487_Layout __r) := TRANSFORM
    SELF.S_U_M___Total_A_R_L_N__6_ := __r.S_U_M___Total_A_R_L_N__1_;
    SELF.S_U_M___Total_A_R_L_N__7_ := __r.S_U_M___Total_A_R_L_N__2_;
    SELF.S_U_M___Total_A_R_L_N__8_ := __r.S_U_M___Total_A_R_L_N__3_;
    SELF.S_U_M___Total_A_R_L_N__9_ := __r.S_U_M___Total_A_R_L_N__4_;
    SELF.S_U_M___Total_A_R_L_N__10_ := __r.S_U_M___Total_A_R_L_N__5_;
    SELF.S_U_M___Total_A_R_L_N__11_ := __r.S_U_M___Total_A_R_L_N__6_;
    SELF.U_I_D__3_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE304705 := JOIN(__EE301823,__EE304518,__JC304524(LEFT,RIGHT),__JT304524(LEFT,RIGHT),LEFT OUTER,HASH);
  EXPORT __ST59336_Layout := RECORD
    KEL.typ.nstr Source_;
    KEL.typ.nstr Translated_Source_Code_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST59322_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(__ST59336_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L1p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L31p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L61p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L91p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.int B2b_T_L_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.nint B2b_T_L_Bal_In_Carr_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28393_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Flt_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28433_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Mat_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28473_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Ops_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28513_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Oth_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28553_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28353_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.nint B2b_T_L_Cnt_Ev_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170736_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170756_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170775_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170794_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170813_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST170827_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Carr_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Flt_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Mat_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Ops_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Oth_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Carr_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Flt_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Mat_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Ops_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Oth_;
    KEL.typ.str B2b_T_L_Worst_Perf_In_Carr_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Flt_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Mat_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Ops_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Oth_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_Index2_Y_ := '';
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST59322_Layout __ND304714__Project(__ST288742_Layout __PP304710) := TRANSFORM
    __EE304708 := __PP304710.Data_Sources_;
    __ST59336_Layout __ND304903__Project(E_Business(__in,__cfg).Data_Sources_Layout __PP304899) := TRANSFORM
      SELF.Translated_Source_Code_ := FN_Compile.FN_Source_Group(__ECAST(KEL.typ.nstr,__PP304899.Source_));
      SELF := __PP304899;
    END;
    SELF.Data_Sources_ := __PROJECT(__EE304708,__ND304903__Project(LEFT));
    __CC3804 := -99998;
    SELF.B2b_Actv_T_L_Bal_Arch1_Y_ := IF(__PP304710.B2b_Actv_T_L_Cnt_Arch1_Y_ = 0,__CC3804,KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Carr_Arch1_Y_ := IF(__PP304710.B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ = 0,__CC3804,KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Carr_Tot_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N_;
    SELF.B2b_Actv_T_L_Bal_In_Flt_Arch1_Y_ := IF(__PP304710.B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ = 0,__CC3804,KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Flt_Tot_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__1_;
    SELF.B2b_Actv_T_L_Bal_In_Mat_Arch1_Y_ := IF(__PP304710.B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ = 0,__CC3804,KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Mat_Tot_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__2_;
    SELF.B2b_Actv_T_L_Bal_In_Ops_Arch1_Y_ := IF(__PP304710.B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ = 0,__CC3804,KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Ops_Tot_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__3_;
    SELF.B2b_Actv_T_L_Bal_In_Oth_Arch1_Y_ := IF(__PP304710.B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ = 0,__CC3804,KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Oth_Tot_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__4_;
    SELF.B2b_Actv_T_L_Bal_Tot_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__5_;
    SELF.B2b_Actv_T_L_Cnt_No_Cap_ := __PP304710.C_O_U_N_T___Exp1__1_;
    SELF.B2b_Actv_T_L_In_Carr_Cnt_ := KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_In_Carr_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Flt_Cnt_ := KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_In_Flt_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Mat_Cnt_ := KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_In_Mat_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Ops_Cnt_ := KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_In_Ops_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Oth_Cnt_ := KEL.Routines.BoundsFold(__PP304710.B2b_Actv_T_L_In_Oth_Cnt_No_Cap_,0,999);
    SELF.B2b_Bal_On_Actv_T_L1p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP304710.S_U_M___D_P_D1_Total_;
    SELF.B2b_Bal_On_Actv_T_L31p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP304710.S_U_M___D_P_D31_Total_;
    SELF.B2b_Bal_On_Actv_T_L61p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP304710.S_U_M___D_P_D61_Total_;
    SELF.B2b_Bal_On_Actv_T_L91p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP304710.S_U_M___D_P_D91_Total_;
    SELF.B2b_T_L_Bal24_Mfull_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__6_;
    __EE305066 := __PP304710.B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Carr_Max2_Y_No_Cap_ := (__T(__EE305066))[1].Total_A_R_L_N_;
    __EE305081 := __PP304710.B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Flt_Max2_Y_No_Cap_ := (__T(__EE305081))[1].Total_A_R_L_N_;
    __EE305096 := __PP304710.B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Mat_Max2_Y_No_Cap_ := (__T(__EE305096))[1].Total_A_R_L_N_;
    __EE305111 := __PP304710.B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Ops_Max2_Y_No_Cap_ := (__T(__EE305111))[1].Total_A_R_L_N_;
    __EE305126 := __PP304710.B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Oth_Max2_Y_No_Cap_ := (__T(__EE305126))[1].Total_A_R_L_N_;
    __EE305141 := __PP304710.B2b_T_L_Bal_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_Max2_Y_No_Cap_ := (__T(__EE305141))[1].Total_A_R_L_N_;
    SELF.B2b_T_L_Cnt_Ev_ := __FN3(KEL.Routines.BoundsFold,__CN(__PP304710.C_O_U_N_T___Exp1_),__CN(0),__CN(9999));
    SELF.B2b_T_L_In_Carr_Bal24_Mfull_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__7_;
    SELF.B2b_T_L_In_Flt_Bal24_Mfull_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__8_;
    SELF.B2b_T_L_In_Mat_Bal24_Mfull_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__9_;
    SELF.B2b_T_L_In_Ops_Bal24_Mfull_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__10_;
    SELF.B2b_T_L_In_Oth_Bal24_Mfull_No_Cap_ := __PP304710.S_U_M___Total_A_R_L_N__11_;
    SELF.B2b_T_L_Modified_N_Count_ := __FN1(SQRT,__OP2(__PP304710.B2b_Mon_W_T_L_Cnt24_Mfull_,/,__OP2(__PP304710.B2b_Mon_W_T_L_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Carr_ := __FN1(SQRT,__OP2(__PP304710.B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_,/,__OP2(__PP304710.B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Flt_ := __FN1(SQRT,__OP2(__PP304710.B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_,/,__OP2(__PP304710.B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Mat_ := __FN1(SQRT,__OP2(__PP304710.B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_,/,__OP2(__PP304710.B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Ops_ := __FN1(SQRT,__OP2(__PP304710.B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_,/,__OP2(__PP304710.B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Oth_ := __FN1(SQRT,__OP2(__PP304710.B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_,/,__OP2(__PP304710.B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_,-,__CN(1))));
    __EE305280 := __PP304710.B2b_T_L_Group_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_ := KEL.Aggregates.CalcStdDevNN(__EE305280,__CN(__T(__EE305280).Total_A_R_L_N_Sum_));
    __EE305294 := __PP304710.B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Carr_ := KEL.Aggregates.CalcStdDevNN(__EE305294,__CN(__T(__EE305294).Total_A_R_L_N_Sum_));
    __EE305308 := __PP304710.B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Flt_ := KEL.Aggregates.CalcStdDevNN(__EE305308,__CN(__T(__EE305308).Total_A_R_L_N_Sum_));
    __EE305322 := __PP304710.B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Mat_ := KEL.Aggregates.CalcStdDevNN(__EE305322,__CN(__T(__EE305322).Total_A_R_L_N_Sum_));
    __EE305336 := __PP304710.B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Ops_ := KEL.Aggregates.CalcStdDevNN(__EE305336,__CN(__T(__EE305336).Total_A_R_L_N_Sum_));
    __EE305350 := __PP304710.B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Oth_ := KEL.Aggregates.CalcStdDevNN(__EE305350,__CN(__T(__EE305350).Total_A_R_L_N_Sum_));
    __CC3801 := '-99998';
    SELF.B2b_T_L_Worst_Perf_In_Carr_Index2_Y_ := MAP(__PP304710.B2b_T_L_In_Carr_Cnt2_Y_ = 0=>__CC3801,__PP304710.C_O_U_N_T___Records_ <> 0=>(KEL.typ.str)4,__PP304710.C_O_U_N_T___Records__1_ <> 0=>(KEL.typ.str)3,__PP304710.C_O_U_N_T___Records__2_ <> 0=>(KEL.typ.str)2,__PP304710.C_O_U_N_T___Records__3_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Flt_Index2_Y_ := MAP(__PP304710.B2b_T_L_In_Flt_Cnt2_Y_ = 0=>__CC3801,__PP304710.C_O_U_N_T___Records__4_ <> 0=>(KEL.typ.str)4,__PP304710.C_O_U_N_T___Records__5_ <> 0=>(KEL.typ.str)3,__PP304710.C_O_U_N_T___Records__6_ <> 0=>(KEL.typ.str)2,__PP304710.C_O_U_N_T___Records__7_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Mat_Index2_Y_ := MAP(__PP304710.B2b_T_L_In_Mat_Cnt2_Y_ = 0=>__CC3801,__PP304710.C_O_U_N_T___Records__8_ <> 0=>(KEL.typ.str)4,__PP304710.C_O_U_N_T___Records__9_ <> 0=>(KEL.typ.str)3,__PP304710.C_O_U_N_T___Records__10_ <> 0=>(KEL.typ.str)2,__PP304710.C_O_U_N_T___Records__11_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Ops_Index2_Y_ := MAP(__PP304710.B2b_T_L_In_Ops_Cnt2_Y_ = 0=>__CC3801,__PP304710.C_O_U_N_T___Records__12_ <> 0=>(KEL.typ.str)4,__PP304710.C_O_U_N_T___Records__13_ <> 0=>(KEL.typ.str)3,__PP304710.C_O_U_N_T___Records__14_ <> 0=>(KEL.typ.str)2,__PP304710.C_O_U_N_T___Records__15_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Oth_Index2_Y_ := MAP(__PP304710.B2b_T_L_In_Oth_Cnt2_Y_ = 0=>__CC3801,__PP304710.C_O_U_N_T___Records__16_ <> 0=>(KEL.typ.str)4,__PP304710.C_O_U_N_T___Records__17_ <> 0=>(KEL.typ.str)3,__PP304710.C_O_U_N_T___Records__18_ <> 0=>(KEL.typ.str)2,__PP304710.C_O_U_N_T___Records__19_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_Index2_Y_ := MAP(__PP304710.B2b_T_L_Cnt2_Y_ = 0=>__CC3801,__PP304710.C_O_U_N_T___Records__20_ <> 0=>(KEL.typ.str)4,__PP304710.C_O_U_N_T___Records__21_ <> 0=>(KEL.typ.str)3,__PP304710.C_O_U_N_T___Records__22_ <> 0=>(KEL.typ.str)2,__PP304710.C_O_U_N_T___Records__23_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF := __PP304710;
  END;
  EXPORT __ENH_Business_2 := PROJECT(__EE304705,__ND304714__Project(LEFT));
END;
