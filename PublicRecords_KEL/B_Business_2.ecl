//HPCC Systems KEL Compiler Version 0.11.6
IMPORT KEL011 AS KEL;
IMPORT B_Business_3,B_Tradeline_3,B_Tradeline_4,B_Tradeline_Business_3,CFG_Compile,E_Business,E_Tradeline,E_Tradeline_Business,FN_Compile FROM PublicRecords_KEL;
IMPORT * FROM KEL011.Null;
EXPORT B_Business_2(CFG_Compile.FDCDataset __in = CFG_Compile.FDCDefault, CFG_Compile __cfg = CFG_Compile) := MODULE
  SHARED VIRTUAL TYPEOF(B_Business_3(__in,__cfg).__ENH_Business_3) __ENH_Business_3 := B_Business_3(__in,__cfg).__ENH_Business_3;
  SHARED VIRTUAL TYPEOF(B_Tradeline_3(__in,__cfg).__ENH_Tradeline_3) __ENH_Tradeline_3 := B_Tradeline_3(__in,__cfg).__ENH_Tradeline_3;
  SHARED VIRTUAL TYPEOF(B_Tradeline_Business_3(__in,__cfg).__ENH_Tradeline_Business_3) __ENH_Tradeline_Business_3 := B_Tradeline_Business_3(__in,__cfg).__ENH_Tradeline_Business_3;
  SHARED __EE298229 := __ENH_Business_3;
  SHARED __EE298246 := __ENH_Tradeline_Business_3;
  SHARED __EE302838 := __EE298246;
  SHARED __EE302850 := __EE302838(__NN(__EE302838.Company_));
  SHARED __ST287911_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout) Trade_Account_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __ST287911_Layout __JT302861(B_Tradeline_Business_3(__in,__cfg).__ST66530_Layout __l, B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout __r) := TRANSFORM
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE302862 := NORMALIZE(__EE302850,__T(LEFT.Trade_Account_),__JT302861(LEFT,RIGHT));
  SHARED __ST285880_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE302894 := PROJECT(__EE302862,TRANSFORM(__ST285880_Layout,SELF.UID := LEFT.Company_,SELF := LEFT));
  SHARED __ST285902_Layout := RECORD
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE302907 := PROJECT(__CLEANANDDO(__EE302894,TABLE(__EE302894,{KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP),UID},UID,MERGE)),__ST285902_Layout);
  SHARED __ST287960_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28558_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28598_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28638_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28678_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28718_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28518_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171937_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171957_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171976_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171995_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172014_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172028_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC302913(B_Business_3(__in,__cfg).__ST65030_Layout __EE298229, __ST285902_Layout __EE302907) := __EEQP(__EE298229.UID,__EE302907.UID);
  __ST287960_Layout __JT302913(B_Business_3(__in,__cfg).__ST65030_Layout __l, __ST285902_Layout __r) := TRANSFORM
    SELF.U_I_D__1_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE302914 := JOIN(__EE298229,__EE302907,__JC302913(LEFT,RIGHT),__JT302913(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE298248 := __ENH_Tradeline_3;
  SHARED __EE298254 := __EE298248(__T(__EE298248.Is_Active_));
  SHARED __EE299725 := __EE298246(__NN(__EE298246.Company_) AND __NN(__EE298246.Account_));
  SHARED __ST286797_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66459_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout) Trade_Account_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC299743(B_Tradeline_3(__in,__cfg).__ST66452_Layout __EE298254, B_Tradeline_Business_3(__in,__cfg).__ST66530_Layout __EE299725) := __EEQP(__EE299725.Account_,__EE298254.UID);
  __ST286797_Layout __JT299743(B_Tradeline_3(__in,__cfg).__ST66452_Layout __l, B_Tradeline_Business_3(__in,__cfg).__ST66530_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE299744 := JOIN(__EE299725,__EE298254,__JC299743(RIGHT,LEFT),__JT299743(RIGHT,LEFT),INNER,HASH);
  SHARED __ST271370_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout) Trade_Account_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66459_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST271370_Layout __ND299825__Project(__ST286797_Layout __PP299745) := TRANSFORM
    SELF.UID := __PP299745.Company_;
    SELF.Data_Sources_ := __PP299745.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP299745.UID;
    SELF.Data_Sources__1_ := __PP299745.Data_Sources_;
    SELF := __PP299745;
  END;
  SHARED __EE300030 := PROJECT(__EE299744,__ND299825__Project(LEFT));
  SHARED __ST271561_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nint Exp1_;
    KEL.typ.nint Exp2_;
    KEL.typ.nint Exp3_;
    KEL.typ.nint Exp4_;
    KEL.typ.nint Exp5_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST271561_Layout __ND300035__Project(__ST271370_Layout __PP300031) := TRANSFORM
    SELF.Exp1_ := IF(__PP300031.Is_Carrier_Segment_,__ECAST(KEL.typ.nint,__PP300031.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp2_ := IF(__PP300031.Is_Fleet_Segment_,__ECAST(KEL.typ.nint,__PP300031.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp3_ := IF(__PP300031.Is_Materials_Segment_,__ECAST(KEL.typ.nint,__PP300031.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp4_ := IF(__PP300031.Is_Operations_Segment_,__ECAST(KEL.typ.nint,__PP300031.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp5_ := IF(__PP300031.Is_Other_Segment_,__ECAST(KEL.typ.nint,__PP300031.Total_A_R_L_N_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF := __PP300031;
  END;
  SHARED __EE300079 := PROJECT(__EE300030,__ND300035__Project(LEFT));
  SHARED __ST271602_Layout := RECORD
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE300122 := PROJECT(__CLEANANDDO(__EE300079,TABLE(__EE300079,{KEL.typ.int S_U_M___Total_A_R_L_N_ := KEL.Aggregates.SumNG(__EE300079.Exp1_),KEL.typ.int S_U_M___Total_A_R_L_N__1_ := KEL.Aggregates.SumNG(__EE300079.Exp2_),KEL.typ.int S_U_M___Total_A_R_L_N__2_ := KEL.Aggregates.SumNG(__EE300079.Exp3_),KEL.typ.int S_U_M___Total_A_R_L_N__3_ := KEL.Aggregates.SumNG(__EE300079.Exp4_),KEL.typ.int S_U_M___Total_A_R_L_N__4_ := KEL.Aggregates.SumNG(__EE300079.Exp5_),KEL.typ.int S_U_M___Total_A_R_L_N__5_ := KEL.Aggregates.SumNG(__EE300079.Total_A_R_L_N_),KEL.typ.int C_O_U_N_T___Exp1_ := COUNT(GROUP),UID},UID,MERGE)),__ST271602_Layout);
  SHARED __ST288953_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28558_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28598_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28638_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28678_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28718_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28518_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171937_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171957_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171976_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171995_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172014_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172028_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC303045(__ST287960_Layout __EE302914, __ST271602_Layout __EE300122) := __EEQP(__EE302914.UID,__EE300122.UID);
  __ST288953_Layout __JT303045(__ST287960_Layout __l, __ST271602_Layout __r) := TRANSFORM
    SELF.C_O_U_N_T___Exp1__1_ := __r.C_O_U_N_T___Exp1_;
    SELF.U_I_D__2_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE303046 := JOIN(__EE302914,__EE300122,__JC303045(LEFT,RIGHT),__JT303045(LEFT,RIGHT),LEFT OUTER,HASH);
  SHARED __EE302835 := __EE298248;
  SHARED __EE302841 := __EE299725;
  SHARED __ST287096_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66459_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout) Trade_Account_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC303191(B_Tradeline_3(__in,__cfg).__ST66452_Layout __EE302835, B_Tradeline_Business_3(__in,__cfg).__ST66530_Layout __EE302841) := __EEQP(__EE302841.Account_,__EE302835.UID);
  __ST287096_Layout __JT303191(B_Tradeline_3(__in,__cfg).__ST66452_Layout __l, B_Tradeline_Business_3(__in,__cfg).__ST66530_Layout __r) := TRANSFORM
    SELF.Data_Sources__1_ := __r.Data_Sources_;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE303192 := JOIN(__EE302841,__EE302835,__JC303191(RIGHT,LEFT),__JT303191(RIGHT,LEFT),INNER,HASH);
  SHARED __ST287432_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66459_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout) Trade_Account_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nint D_P_D1_Total_;
    KEL.typ.nint D_P_D31_Total_;
    KEL.typ.nint D_P_D61_Total_;
    KEL.typ.nint D_P_D91_Total_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __ST287432_Layout __JT303279(__ST287096_Layout __l, B_Tradeline_3(__in,__cfg).__ST66459_Layout __r) := TRANSFORM
    SELF.Total_A_R_L_N__1_ := __r.Total_A_R_L_N_;
    SELF.__RecordCount := __r.__RecordCount;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE303280 := NORMALIZE(__EE303192,__T(LEFT.Records_),__JT303279(LEFT,RIGHT));
  SHARED __ST284003_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.ntyp(E_Business().Typ) Company_;
    KEL.typ.ntyp(E_Tradeline().Typ) Account_;
    KEL.typ.ndataset(E_Tradeline_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.ndataset(B_Tradeline_Business_3(__in,__cfg).__ST27128_Layout) Trade_Account_;
    KEL.typ.nuid U_I_D__1_;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.nstr Account_Key_;
    KEL.typ.ndataset(B_Tradeline_3(__in,__cfg).__ST66459_Layout) Records_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Vendor_Dates_Layout) Vendor_Dates_;
    KEL.typ.ndataset(E_Tradeline(__in,__cfg).Data_Sources_Layout) Data_Sources__1_;
    KEL.typ.nkdate Current_Date_;
    KEL.typ.nkdate Current_Date_First_Of_Month_;
    KEL.typ.nint Current_Month_;
    KEL.typ.nint Current_Year_;
    KEL.typ.nbool Is_Active_;
    KEL.typ.nbool Is_Active1_Y_;
    KEL.typ.bool Is_Carrier_Segment_ := FALSE;
    KEL.typ.bool Is_Fleet_Segment_ := FALSE;
    KEL.typ.bool Is_Materials_Segment_ := FALSE;
    KEL.typ.bool Is_Operations_Segment_ := FALSE;
    KEL.typ.bool Is_Other_Segment_ := FALSE;
    KEL.typ.nint Newest_Record_Age_In_Days_;
    KEL.typ.nint Newest_Record_Age_In_Days1_Y_;
    KEL.typ.nint Total_A_R_L_N_;
    KEL.typ.nkdate Two_Year_Full_Date_;
    KEL.typ.nkdate A_R_Date_;
    KEL.typ.nint Total_A_R_;
    KEL.typ.nint Current_A_R_;
    KEL.typ.nint Aging1_To30_;
    KEL.typ.nint Aging31_To60_;
    KEL.typ.nint Aging61_To90_;
    KEL.typ.nint Aging91_Plus_;
    KEL.typ.nint Credit_Limit_;
    KEL.typ.nint Segment_I_D_;
    KEL.typ.nkdate File_Date_;
    KEL.typ.nstr Status_;
    KEL.typ.nkdate First_Sale_Date_;
    KEL.typ.nkdate Last_Sale_Date_;
    KEL.typ.nkdate A_R_Date_Group_;
    KEL.typ.nint Aging1_To30_L_N_;
    KEL.typ.nint Aging31_To60_L_N_;
    KEL.typ.nint Aging61_To90_L_N_;
    KEL.typ.nint Aging91_Plus_L_N_;
    KEL.typ.nbool Carrier_Segment_;
    KEL.typ.nint Current_A_R_L_N_;
    KEL.typ.nint D_P_D1_Total_;
    KEL.typ.nint D_P_D31_Total_;
    KEL.typ.nint D_P_D61_Total_;
    KEL.typ.nint D_P_D91_Total_;
    KEL.typ.nbool Fleet_Segment_;
    KEL.typ.nbool Is1_Y_Record_;
    KEL.typ.nbool Is_Most_Recent_Active_Record1_Y_;
    KEL.typ.nbool Is_Two_Year_Full_Record_;
    KEL.typ.nbool Materials_Segment_;
    KEL.typ.nint Months_From_First_Of_Current_Month_;
    KEL.typ.nbool Operations_Segment_;
    KEL.typ.nbool Other_Segment_;
    KEL.typ.nint Record_Age_In_Days_;
    KEL.typ.nint Record_Age_In_Days1_Y_;
    KEL.typ.nkdate Record_Date_;
    KEL.typ.nint Total_A_R_L_N__1_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST284003_Layout __ND303397__Project(__ST287432_Layout __PP303281) := TRANSFORM
    SELF.UID := __PP303281.Company_;
    SELF.Data_Sources_ := __PP303281.Data_Sources__1_;
    SELF.U_I_D__1_ := __PP303281.UID;
    SELF.Data_Sources__1_ := __PP303281.Data_Sources_;
    SELF := __PP303281;
  END;
  SHARED __EE303746 := PROJECT(__EE303280,__ND303397__Project(LEFT));
  SHARED __ST284530_Layout := RECORD
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.nint Exp1_;
    KEL.typ.nint Exp2_;
    KEL.typ.nint Exp3_;
    KEL.typ.nint Exp4_;
    KEL.typ.nint Exp5_;
    KEL.typ.nint Exp6_;
    KEL.typ.nint Exp7_;
    KEL.typ.nint Exp8_;
    KEL.typ.nint Exp9_;
    KEL.typ.nint Exp10_;
    KEL.typ.nbool Exp11_;
    KEL.typ.nbool Exp12_;
    KEL.typ.nbool Exp13_;
    KEL.typ.nbool Exp14_;
    KEL.typ.nbool Exp15_;
    KEL.typ.nbool Exp16_;
    KEL.typ.nbool Exp17_;
    KEL.typ.nbool Exp18_;
    KEL.typ.nbool Exp19_;
    KEL.typ.nbool Exp20_;
    KEL.typ.nbool Exp21_;
    KEL.typ.nbool Exp22_;
    KEL.typ.nbool Exp23_;
    KEL.typ.nbool Exp24_;
    KEL.typ.nbool Exp25_;
    KEL.typ.nbool Exp26_;
    KEL.typ.nbool Exp27_;
    KEL.typ.nbool Exp28_;
    KEL.typ.nbool Exp29_;
    KEL.typ.nbool Exp30_;
    KEL.typ.nbool Exp31_;
    KEL.typ.nbool Exp32_;
    KEL.typ.nbool Exp33_;
    KEL.typ.nbool Exp34_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __ST284530_Layout __ND305365__Project(__ST284003_Layout __PP303747) := TRANSFORM
    SELF.Exp1_ := IF(__T(__PP303747.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP303747.D_P_D1_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp2_ := IF(__T(__PP303747.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP303747.D_P_D31_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp3_ := IF(__T(__PP303747.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP303747.D_P_D61_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp4_ := IF(__T(__PP303747.Is_Most_Recent_Active_Record1_Y_),__ECAST(KEL.typ.nint,__PP303747.D_P_D91_Total_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp5_ := IF(__T(__PP303747.Is_Two_Year_Full_Record_),__ECAST(KEL.typ.nint,__PP303747.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp6_ := IF(__T(__AND(__PP303747.Carrier_Segment_,__PP303747.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP303747.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp7_ := IF(__T(__AND(__PP303747.Fleet_Segment_,__PP303747.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP303747.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp8_ := IF(__T(__AND(__PP303747.Materials_Segment_,__PP303747.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP303747.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp9_ := IF(__T(__AND(__PP303747.Operations_Segment_,__PP303747.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP303747.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    SELF.Exp10_ := IF(__T(__AND(__PP303747.Other_Segment_,__PP303747.Is_Two_Year_Full_Record_)),__ECAST(KEL.typ.nint,__PP303747.Total_A_R_L_N__1_),__ECAST(KEL.typ.nint,__N(KEL.typ.int)));
    __CC11237 := 730;
    SELF.Exp11_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging91_Plus_L_N_,>,__CN(0))),__PP303747.Carrier_Segment_);
    SELF.Exp12_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging61_To90_L_N_,>,__CN(0))),__PP303747.Carrier_Segment_);
    SELF.Exp13_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging31_To60_L_N_,>,__CN(0))),__PP303747.Carrier_Segment_);
    SELF.Exp14_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging1_To30_L_N_,>,__CN(0))),__PP303747.Carrier_Segment_);
    SELF.Exp15_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging91_Plus_L_N_,>,__CN(0))),__PP303747.Fleet_Segment_);
    SELF.Exp16_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging61_To90_L_N_,>,__CN(0))),__PP303747.Fleet_Segment_);
    SELF.Exp17_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging31_To60_L_N_,>,__CN(0))),__PP303747.Fleet_Segment_);
    SELF.Exp18_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging1_To30_L_N_,>,__CN(0))),__PP303747.Fleet_Segment_);
    SELF.Exp19_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging91_Plus_L_N_,>,__CN(0))),__PP303747.Materials_Segment_);
    SELF.Exp20_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging61_To90_L_N_,>,__CN(0))),__PP303747.Materials_Segment_);
    SELF.Exp21_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging31_To60_L_N_,>,__CN(0))),__PP303747.Materials_Segment_);
    SELF.Exp22_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging1_To30_L_N_,>,__CN(0))),__PP303747.Materials_Segment_);
    SELF.Exp23_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging91_Plus_L_N_,>,__CN(0))),__PP303747.Operations_Segment_);
    SELF.Exp24_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging61_To90_L_N_,>,__CN(0))),__PP303747.Operations_Segment_);
    SELF.Exp25_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging31_To60_L_N_,>,__CN(0))),__PP303747.Operations_Segment_);
    SELF.Exp26_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging1_To30_L_N_,>,__CN(0))),__PP303747.Operations_Segment_);
    SELF.Exp27_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging91_Plus_L_N_,>,__CN(0))),__PP303747.Other_Segment_);
    SELF.Exp28_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging61_To90_L_N_,>,__CN(0))),__PP303747.Other_Segment_);
    SELF.Exp29_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging31_To60_L_N_,>,__CN(0))),__PP303747.Other_Segment_);
    SELF.Exp30_ := __AND(__AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging1_To30_L_N_,>,__CN(0))),__PP303747.Other_Segment_);
    SELF.Exp31_ := __AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging91_Plus_L_N_,>,__CN(0)));
    SELF.Exp32_ := __AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging61_To90_L_N_,>,__CN(0)));
    SELF.Exp33_ := __AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging31_To60_L_N_,>,__CN(0)));
    SELF.Exp34_ := __AND(__OP2(__PP303747.Record_Age_In_Days_,<=,__CN(__CC11237)),__OP2(__PP303747.Aging1_To30_L_N_,>,__CN(0)));
    SELF := __PP303747;
  END;
  SHARED __EE305536 := PROJECT(__EE303746,__ND305365__Project(LEFT));
  SHARED __ST284710_Layout := RECORD
    KEL.typ.int S_U_M___D_P_D1_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D31_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D61_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D91_Total_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__6_ := 0;
    KEL.typ.int C_O_U_N_T___Records_ := 0;
    KEL.typ.int C_O_U_N_T___Records__1_ := 0;
    KEL.typ.int C_O_U_N_T___Records__2_ := 0;
    KEL.typ.int C_O_U_N_T___Records__3_ := 0;
    KEL.typ.int C_O_U_N_T___Records__4_ := 0;
    KEL.typ.int C_O_U_N_T___Records__5_ := 0;
    KEL.typ.int C_O_U_N_T___Records__6_ := 0;
    KEL.typ.int C_O_U_N_T___Records__7_ := 0;
    KEL.typ.int C_O_U_N_T___Records__8_ := 0;
    KEL.typ.int C_O_U_N_T___Records__9_ := 0;
    KEL.typ.int C_O_U_N_T___Records__10_ := 0;
    KEL.typ.int C_O_U_N_T___Records__11_ := 0;
    KEL.typ.int C_O_U_N_T___Records__12_ := 0;
    KEL.typ.int C_O_U_N_T___Records__13_ := 0;
    KEL.typ.int C_O_U_N_T___Records__14_ := 0;
    KEL.typ.int C_O_U_N_T___Records__15_ := 0;
    KEL.typ.int C_O_U_N_T___Records__16_ := 0;
    KEL.typ.int C_O_U_N_T___Records__17_ := 0;
    KEL.typ.int C_O_U_N_T___Records__18_ := 0;
    KEL.typ.int C_O_U_N_T___Records__19_ := 0;
    KEL.typ.int C_O_U_N_T___Records__20_ := 0;
    KEL.typ.int C_O_U_N_T___Records__21_ := 0;
    KEL.typ.int C_O_U_N_T___Records__22_ := 0;
    KEL.typ.int C_O_U_N_T___Records__23_ := 0;
    KEL.typ.ntyp(E_Business().Typ) UID;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
  END;
  SHARED __EE305741 := PROJECT(__CLEANANDDO(__EE305536,TABLE(__EE305536,{KEL.typ.int S_U_M___D_P_D1_Total_ := KEL.Aggregates.SumNG(__EE305536.Exp1_),KEL.typ.int S_U_M___D_P_D31_Total_ := KEL.Aggregates.SumNG(__EE305536.Exp2_),KEL.typ.int S_U_M___D_P_D61_Total_ := KEL.Aggregates.SumNG(__EE305536.Exp3_),KEL.typ.int S_U_M___D_P_D91_Total_ := KEL.Aggregates.SumNG(__EE305536.Exp4_),KEL.typ.int S_U_M___Total_A_R_L_N__1_ := KEL.Aggregates.SumNG(__EE305536.Exp5_),KEL.typ.int S_U_M___Total_A_R_L_N__2_ := KEL.Aggregates.SumNG(__EE305536.Exp6_),KEL.typ.int S_U_M___Total_A_R_L_N__3_ := KEL.Aggregates.SumNG(__EE305536.Exp7_),KEL.typ.int S_U_M___Total_A_R_L_N__4_ := KEL.Aggregates.SumNG(__EE305536.Exp8_),KEL.typ.int S_U_M___Total_A_R_L_N__5_ := KEL.Aggregates.SumNG(__EE305536.Exp9_),KEL.typ.int S_U_M___Total_A_R_L_N__6_ := KEL.Aggregates.SumNG(__EE305536.Exp10_),KEL.typ.int C_O_U_N_T___Records_ := COUNT(GROUP,__T(__EE305536.Exp11_)),KEL.typ.int C_O_U_N_T___Records__1_ := COUNT(GROUP,__T(__EE305536.Exp12_)),KEL.typ.int C_O_U_N_T___Records__2_ := COUNT(GROUP,__T(__EE305536.Exp13_)),KEL.typ.int C_O_U_N_T___Records__3_ := COUNT(GROUP,__T(__EE305536.Exp14_)),KEL.typ.int C_O_U_N_T___Records__4_ := COUNT(GROUP,__T(__EE305536.Exp15_)),KEL.typ.int C_O_U_N_T___Records__5_ := COUNT(GROUP,__T(__EE305536.Exp16_)),KEL.typ.int C_O_U_N_T___Records__6_ := COUNT(GROUP,__T(__EE305536.Exp17_)),KEL.typ.int C_O_U_N_T___Records__7_ := COUNT(GROUP,__T(__EE305536.Exp18_)),KEL.typ.int C_O_U_N_T___Records__8_ := COUNT(GROUP,__T(__EE305536.Exp19_)),KEL.typ.int C_O_U_N_T___Records__9_ := COUNT(GROUP,__T(__EE305536.Exp20_)),KEL.typ.int C_O_U_N_T___Records__10_ := COUNT(GROUP,__T(__EE305536.Exp21_)),KEL.typ.int C_O_U_N_T___Records__11_ := COUNT(GROUP,__T(__EE305536.Exp22_)),KEL.typ.int C_O_U_N_T___Records__12_ := COUNT(GROUP,__T(__EE305536.Exp23_)),KEL.typ.int C_O_U_N_T___Records__13_ := COUNT(GROUP,__T(__EE305536.Exp24_)),KEL.typ.int C_O_U_N_T___Records__14_ := COUNT(GROUP,__T(__EE305536.Exp25_)),KEL.typ.int C_O_U_N_T___Records__15_ := COUNT(GROUP,__T(__EE305536.Exp26_)),KEL.typ.int C_O_U_N_T___Records__16_ := COUNT(GROUP,__T(__EE305536.Exp27_)),KEL.typ.int C_O_U_N_T___Records__17_ := COUNT(GROUP,__T(__EE305536.Exp28_)),KEL.typ.int C_O_U_N_T___Records__18_ := COUNT(GROUP,__T(__EE305536.Exp29_)),KEL.typ.int C_O_U_N_T___Records__19_ := COUNT(GROUP,__T(__EE305536.Exp30_)),KEL.typ.int C_O_U_N_T___Records__20_ := COUNT(GROUP,__T(__EE305536.Exp31_)),KEL.typ.int C_O_U_N_T___Records__21_ := COUNT(GROUP,__T(__EE305536.Exp32_)),KEL.typ.int C_O_U_N_T___Records__22_ := COUNT(GROUP,__T(__EE305536.Exp33_)),KEL.typ.int C_O_U_N_T___Records__23_ := COUNT(GROUP,__T(__EE305536.Exp34_)),UID},UID,MERGE)),__ST284710_Layout);
  SHARED __ST289965_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Data_Sources_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28558_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28598_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28638_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28678_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28718_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28518_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171937_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171957_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171976_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171995_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172014_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172028_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__1_;
    KEL.typ.int S_U_M___Total_A_R_L_N_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__1_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__2_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__3_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__4_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__5_ := 0;
    KEL.typ.int C_O_U_N_T___Exp1__1_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__2_;
    KEL.typ.int S_U_M___D_P_D1_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D31_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D61_Total_ := 0;
    KEL.typ.int S_U_M___D_P_D91_Total_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__6_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__7_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__8_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__9_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__10_ := 0;
    KEL.typ.int S_U_M___Total_A_R_L_N__11_ := 0;
    KEL.typ.int C_O_U_N_T___Records_ := 0;
    KEL.typ.int C_O_U_N_T___Records__1_ := 0;
    KEL.typ.int C_O_U_N_T___Records__2_ := 0;
    KEL.typ.int C_O_U_N_T___Records__3_ := 0;
    KEL.typ.int C_O_U_N_T___Records__4_ := 0;
    KEL.typ.int C_O_U_N_T___Records__5_ := 0;
    KEL.typ.int C_O_U_N_T___Records__6_ := 0;
    KEL.typ.int C_O_U_N_T___Records__7_ := 0;
    KEL.typ.int C_O_U_N_T___Records__8_ := 0;
    KEL.typ.int C_O_U_N_T___Records__9_ := 0;
    KEL.typ.int C_O_U_N_T___Records__10_ := 0;
    KEL.typ.int C_O_U_N_T___Records__11_ := 0;
    KEL.typ.int C_O_U_N_T___Records__12_ := 0;
    KEL.typ.int C_O_U_N_T___Records__13_ := 0;
    KEL.typ.int C_O_U_N_T___Records__14_ := 0;
    KEL.typ.int C_O_U_N_T___Records__15_ := 0;
    KEL.typ.int C_O_U_N_T___Records__16_ := 0;
    KEL.typ.int C_O_U_N_T___Records__17_ := 0;
    KEL.typ.int C_O_U_N_T___Records__18_ := 0;
    KEL.typ.int C_O_U_N_T___Records__19_ := 0;
    KEL.typ.int C_O_U_N_T___Records__20_ := 0;
    KEL.typ.int C_O_U_N_T___Records__21_ := 0;
    KEL.typ.int C_O_U_N_T___Records__22_ := 0;
    KEL.typ.int C_O_U_N_T___Records__23_ := 0;
    KEL.typ.ntyp(E_Business().Typ) U_I_D__3_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  __JC305747(__ST288953_Layout __EE303046, __ST284710_Layout __EE305741) := __EEQP(__EE303046.UID,__EE305741.UID);
  __ST289965_Layout __JT305747(__ST288953_Layout __l, __ST284710_Layout __r) := TRANSFORM
    SELF.S_U_M___Total_A_R_L_N__6_ := __r.S_U_M___Total_A_R_L_N__1_;
    SELF.S_U_M___Total_A_R_L_N__7_ := __r.S_U_M___Total_A_R_L_N__2_;
    SELF.S_U_M___Total_A_R_L_N__8_ := __r.S_U_M___Total_A_R_L_N__3_;
    SELF.S_U_M___Total_A_R_L_N__9_ := __r.S_U_M___Total_A_R_L_N__4_;
    SELF.S_U_M___Total_A_R_L_N__10_ := __r.S_U_M___Total_A_R_L_N__5_;
    SELF.S_U_M___Total_A_R_L_N__11_ := __r.S_U_M___Total_A_R_L_N__6_;
    SELF.U_I_D__3_ := __r.UID;
    SELF := __l;
    SELF := __r;
  END;
  SHARED __EE305928 := JOIN(__EE303046,__EE305741,__JC305747(LEFT,RIGHT),__JT305747(LEFT,RIGHT),LEFT OUTER,HASH);
  EXPORT __ST59691_Layout := RECORD
    KEL.typ.nstr Source_;
    KEL.typ.nstr Translated_Source_Code_;
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  EXPORT __ST59677_Layout := RECORD
    KEL.typ.nuid UID;
    KEL.typ.nint Ult_I_D_;
    KEL.typ.nint Org_I_D_;
    KEL.typ.nint Sele_I_D_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Company_Names_Layout) Company_Names_;
    KEL.typ.ndataset(E_Business(__in,__cfg).Tax_I_Ds_Layout) Tax_I_Ds_;
    KEL.typ.ndataset(__ST59691_Layout) Data_Sources_;
    KEL.typ.int B2b_Actv_T_L_Bal_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Carr_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Flt_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Mat_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Ops_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_In_Oth_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Bal_Tot_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Carr_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Flt_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Mat_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Ops_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Actv_T_L_In_Oth_Cnt_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L1p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L31p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L61p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.int B2b_Bal_On_Actv_T_L91p_Dpd_Tot_Arch1_Y_No_Cap_ := 0;
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Carr_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Flt_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Mat_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Ops_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_In_Oth_Str24_Mfull_ := '';
    KEL.typ.str B2b_Ind_Of_Mon_W_T_L_Str24_Mfull_ := '';
    KEL.typ.nint B2b_Mon_W_T_L_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_;
    KEL.typ.nint B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_;
    KEL.typ.int B2b_T_L_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.nint B2b_T_L_Bal_In_Carr_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28558_Layout) B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Flt_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28598_Layout) B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Mat_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28638_Layout) B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Ops_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28678_Layout) B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_In_Oth_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28718_Layout) B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    KEL.typ.nint B2b_T_L_Bal_Max2_Y_No_Cap_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST28518_Layout) B2b_T_L_Bal_Newest_Date2_Y_;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.nint B2b_T_L_Cnt_Ev_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171937_Layout) B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171957_Layout) B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171976_Layout) B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST171995_Layout) B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172014_Layout) B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    KEL.typ.ndataset(B_Business_3(__in,__cfg).__ST172028_Layout) B2b_T_L_Group_Total_A_R_L_N_Sum_;
    KEL.typ.int B2b_T_L_In_Carr_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Carr_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Flt_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Mat_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Ops_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Bal24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt24_Mfull_No_Cap_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_ := 0;
    KEL.typ.int B2b_T_L_In_Oth_Cnt2_Y_No_Cap_ := 0;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Carr_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Flt_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Mat_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Ops_;
    KEL.typ.nfloat B2b_T_L_Modified_N_Count_In_Oth_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Carr_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Flt_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Mat_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Ops_;
    KEL.typ.nfloat B2b_T_L_S_T_D_Devation_Population_In_Oth_;
    KEL.typ.str B2b_T_L_Worst_Perf_In_Carr_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Flt_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Mat_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Ops_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_In_Oth_Index2_Y_ := '';
    KEL.typ.str B2b_T_L_Worst_Perf_Index2_Y_ := '';
    KEL.typ.epoch Date_First_Seen_ := 0;
    KEL.typ.epoch Date_Last_Seen_ := 0;
    KEL.typ.int __RecordCount := 0;
  END;
  SHARED __ST59677_Layout __ND305937__Project(__ST289965_Layout __PP305933) := TRANSFORM
    __EE305931 := __PP305933.Data_Sources_;
    __ST59691_Layout __ND306126__Project(E_Business(__in,__cfg).Data_Sources_Layout __PP306122) := TRANSFORM
      SELF.Translated_Source_Code_ := FN_Compile.FN_Source_Group(__ECAST(KEL.typ.nstr,__PP306122.Source_));
      SELF := __PP306122;
    END;
    SELF.Data_Sources_ := __PROJECT(__EE305931,__ND306126__Project(LEFT));
    __CC3820 := -99998;
    SELF.B2b_Actv_T_L_Bal_Arch1_Y_ := IF(__PP305933.B2b_Actv_T_L_Cnt_Arch1_Y_ = 0,__CC3820,KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_Bal_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Carr_Arch1_Y_ := IF(__PP305933.B2b_Actv_T_L_In_Carr_Cnt_Arch1_Y_ = 0,__CC3820,KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_Bal_In_Carr_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Carr_Tot_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N_;
    SELF.B2b_Actv_T_L_Bal_In_Flt_Arch1_Y_ := IF(__PP305933.B2b_Actv_T_L_In_Flt_Cnt_Arch1_Y_ = 0,__CC3820,KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_Bal_In_Flt_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Flt_Tot_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__1_;
    SELF.B2b_Actv_T_L_Bal_In_Mat_Arch1_Y_ := IF(__PP305933.B2b_Actv_T_L_In_Mat_Cnt_Arch1_Y_ = 0,__CC3820,KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_Bal_In_Mat_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Mat_Tot_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__2_;
    SELF.B2b_Actv_T_L_Bal_In_Ops_Arch1_Y_ := IF(__PP305933.B2b_Actv_T_L_In_Ops_Cnt_Arch1_Y_ = 0,__CC3820,KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_Bal_In_Ops_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Ops_Tot_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__3_;
    SELF.B2b_Actv_T_L_Bal_In_Oth_Arch1_Y_ := IF(__PP305933.B2b_Actv_T_L_In_Oth_Cnt_Arch1_Y_ = 0,__CC3820,KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_Bal_In_Oth_Tot_Arch1_Y_No_Cap_,0,99999999));
    SELF.B2b_Actv_T_L_Bal_In_Oth_Tot_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__4_;
    SELF.B2b_Actv_T_L_Bal_Tot_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__5_;
    SELF.B2b_Actv_T_L_Cnt_No_Cap_ := __PP305933.C_O_U_N_T___Exp1__1_;
    SELF.B2b_Actv_T_L_In_Carr_Cnt_ := KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_In_Carr_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Flt_Cnt_ := KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_In_Flt_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Mat_Cnt_ := KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_In_Mat_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Ops_Cnt_ := KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_In_Ops_Cnt_No_Cap_,0,999);
    SELF.B2b_Actv_T_L_In_Oth_Cnt_ := KEL.Routines.BoundsFold(__PP305933.B2b_Actv_T_L_In_Oth_Cnt_No_Cap_,0,999);
    SELF.B2b_Bal_On_Actv_T_L1p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP305933.S_U_M___D_P_D1_Total_;
    SELF.B2b_Bal_On_Actv_T_L31p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP305933.S_U_M___D_P_D31_Total_;
    SELF.B2b_Bal_On_Actv_T_L61p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP305933.S_U_M___D_P_D61_Total_;
    SELF.B2b_Bal_On_Actv_T_L91p_Dpd_Tot_Arch1_Y_No_Cap_ := __PP305933.S_U_M___D_P_D91_Total_;
    SELF.B2b_T_L_Bal24_Mfull_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__6_;
    __EE306289 := __PP305933.B2b_T_L_Bal_In_Carr_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Carr_Max2_Y_No_Cap_ := (__T(__EE306289))[1].Total_A_R_L_N_;
    __EE306304 := __PP305933.B2b_T_L_Bal_In_Flt_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Flt_Max2_Y_No_Cap_ := (__T(__EE306304))[1].Total_A_R_L_N_;
    __EE306319 := __PP305933.B2b_T_L_Bal_In_Mat_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Mat_Max2_Y_No_Cap_ := (__T(__EE306319))[1].Total_A_R_L_N_;
    __EE306334 := __PP305933.B2b_T_L_Bal_In_Ops_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Ops_Max2_Y_No_Cap_ := (__T(__EE306334))[1].Total_A_R_L_N_;
    __EE306349 := __PP305933.B2b_T_L_Bal_In_Oth_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_In_Oth_Max2_Y_No_Cap_ := (__T(__EE306349))[1].Total_A_R_L_N_;
    __EE306364 := __PP305933.B2b_T_L_Bal_Newest_Date2_Y_;
    SELF.B2b_T_L_Bal_Max2_Y_No_Cap_ := (__T(__EE306364))[1].Total_A_R_L_N_;
    SELF.B2b_T_L_Cnt_Ev_ := __FN3(KEL.Routines.BoundsFold,__CN(__PP305933.C_O_U_N_T___Exp1_),__CN(0),__CN(9999));
    SELF.B2b_T_L_In_Carr_Bal24_Mfull_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__7_;
    SELF.B2b_T_L_In_Flt_Bal24_Mfull_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__8_;
    SELF.B2b_T_L_In_Mat_Bal24_Mfull_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__9_;
    SELF.B2b_T_L_In_Ops_Bal24_Mfull_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__10_;
    SELF.B2b_T_L_In_Oth_Bal24_Mfull_No_Cap_ := __PP305933.S_U_M___Total_A_R_L_N__11_;
    SELF.B2b_T_L_Modified_N_Count_ := __FN1(SQRT,__OP2(__PP305933.B2b_Mon_W_T_L_Cnt24_Mfull_,/,__OP2(__PP305933.B2b_Mon_W_T_L_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Carr_ := __FN1(SQRT,__OP2(__PP305933.B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_,/,__OP2(__PP305933.B2b_Mon_W_T_L_In_Carr_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Flt_ := __FN1(SQRT,__OP2(__PP305933.B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_,/,__OP2(__PP305933.B2b_Mon_W_T_L_In_Flt_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Mat_ := __FN1(SQRT,__OP2(__PP305933.B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_,/,__OP2(__PP305933.B2b_Mon_W_T_L_In_Mat_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Ops_ := __FN1(SQRT,__OP2(__PP305933.B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_,/,__OP2(__PP305933.B2b_Mon_W_T_L_In_Ops_Cnt24_Mfull_,-,__CN(1))));
    SELF.B2b_T_L_Modified_N_Count_In_Oth_ := __FN1(SQRT,__OP2(__PP305933.B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_,/,__OP2(__PP305933.B2b_Mon_W_T_L_In_Oth_Cnt24_Mfull_,-,__CN(1))));
    __EE306503 := __PP305933.B2b_T_L_Group_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_ := KEL.Aggregates.CalcStdDevNN(__EE306503,__CN(__T(__EE306503).Total_A_R_L_N_Sum_));
    __EE306517 := __PP305933.B2b_T_L_Group_Carr_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Carr_ := KEL.Aggregates.CalcStdDevNN(__EE306517,__CN(__T(__EE306517).Total_A_R_L_N_Sum_));
    __EE306531 := __PP305933.B2b_T_L_Group_Flt_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Flt_ := KEL.Aggregates.CalcStdDevNN(__EE306531,__CN(__T(__EE306531).Total_A_R_L_N_Sum_));
    __EE306545 := __PP305933.B2b_T_L_Group_Mat_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Mat_ := KEL.Aggregates.CalcStdDevNN(__EE306545,__CN(__T(__EE306545).Total_A_R_L_N_Sum_));
    __EE306559 := __PP305933.B2b_T_L_Group_Ops_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Ops_ := KEL.Aggregates.CalcStdDevNN(__EE306559,__CN(__T(__EE306559).Total_A_R_L_N_Sum_));
    __EE306573 := __PP305933.B2b_T_L_Group_Oth_Total_A_R_L_N_Sum_;
    SELF.B2b_T_L_S_T_D_Devation_Population_In_Oth_ := KEL.Aggregates.CalcStdDevNN(__EE306573,__CN(__T(__EE306573).Total_A_R_L_N_Sum_));
    __CC3817 := '-99998';
    SELF.B2b_T_L_Worst_Perf_In_Carr_Index2_Y_ := MAP(__PP305933.B2b_T_L_In_Carr_Cnt2_Y_ = 0=>__CC3817,__PP305933.C_O_U_N_T___Records_ <> 0=>(KEL.typ.str)4,__PP305933.C_O_U_N_T___Records__1_ <> 0=>(KEL.typ.str)3,__PP305933.C_O_U_N_T___Records__2_ <> 0=>(KEL.typ.str)2,__PP305933.C_O_U_N_T___Records__3_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Flt_Index2_Y_ := MAP(__PP305933.B2b_T_L_In_Flt_Cnt2_Y_ = 0=>__CC3817,__PP305933.C_O_U_N_T___Records__4_ <> 0=>(KEL.typ.str)4,__PP305933.C_O_U_N_T___Records__5_ <> 0=>(KEL.typ.str)3,__PP305933.C_O_U_N_T___Records__6_ <> 0=>(KEL.typ.str)2,__PP305933.C_O_U_N_T___Records__7_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Mat_Index2_Y_ := MAP(__PP305933.B2b_T_L_In_Mat_Cnt2_Y_ = 0=>__CC3817,__PP305933.C_O_U_N_T___Records__8_ <> 0=>(KEL.typ.str)4,__PP305933.C_O_U_N_T___Records__9_ <> 0=>(KEL.typ.str)3,__PP305933.C_O_U_N_T___Records__10_ <> 0=>(KEL.typ.str)2,__PP305933.C_O_U_N_T___Records__11_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Ops_Index2_Y_ := MAP(__PP305933.B2b_T_L_In_Ops_Cnt2_Y_ = 0=>__CC3817,__PP305933.C_O_U_N_T___Records__12_ <> 0=>(KEL.typ.str)4,__PP305933.C_O_U_N_T___Records__13_ <> 0=>(KEL.typ.str)3,__PP305933.C_O_U_N_T___Records__14_ <> 0=>(KEL.typ.str)2,__PP305933.C_O_U_N_T___Records__15_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_In_Oth_Index2_Y_ := MAP(__PP305933.B2b_T_L_In_Oth_Cnt2_Y_ = 0=>__CC3817,__PP305933.C_O_U_N_T___Records__16_ <> 0=>(KEL.typ.str)4,__PP305933.C_O_U_N_T___Records__17_ <> 0=>(KEL.typ.str)3,__PP305933.C_O_U_N_T___Records__18_ <> 0=>(KEL.typ.str)2,__PP305933.C_O_U_N_T___Records__19_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF.B2b_T_L_Worst_Perf_Index2_Y_ := MAP(__PP305933.B2b_T_L_Cnt2_Y_ = 0=>__CC3817,__PP305933.C_O_U_N_T___Records__20_ <> 0=>(KEL.typ.str)4,__PP305933.C_O_U_N_T___Records__21_ <> 0=>(KEL.typ.str)3,__PP305933.C_O_U_N_T___Records__22_ <> 0=>(KEL.typ.str)2,__PP305933.C_O_U_N_T___Records__23_ <> 0=>(KEL.typ.str)1,(KEL.typ.str)0);
    SELF := __PP305933;
  END;
  EXPORT __ENH_Business_2 := PROJECT(__EE305928,__ND305937__Project(LEFT));
END;
