IMPORT Seed_Files, Risk_Indicators;

EXPORT TestSeed_Function(
	DATASET(Risk_Indicators.Layout_Input) inData,
	STRING20 TestDataTableName
	) := FUNCTION
	Test_Data_Table_Name := StringLib.StringToUpperCase(TestDataTableName);
	
	ProfileBooster.Layouts.Layout_PB_BatchOut create_output(inData le, Seed_Files.Key_ProfileBooster ri) := TRANSFORM
		SELF.AcctNo 																								:= [];
		SELF.seq 																										:= le.seq;
		SELF.LexID 																									:= [];
		self.attributes.version1.DoNotMail													:= ri.DoNotMail;
		self.attributes.version1.VerifiedProspectFound							:= ri.VerifiedProspectFound;
		self.attributes.version1.VerifiedName												:= ri.VerifiedName;
		self.attributes.version1.VerifiedSSN												:= ri.VerifiedSSN;
		self.attributes.version1.VerifiedPhone											:= ri.VerifiedPhone;
		self.attributes.version1.VerifiedCurrResMatchIndex					:= ri.VerifiedCurrResMatchIndex;
		self.attributes.version1.ProspectTimeOnRecord								:= ri.ProspectTimeOnRecord;
		self.attributes.version1.ProspectTimeLastUpdate							:= ri.ProspectTimeLastUpdate;
		self.attributes.version1.ProspectLastUpdate12Mo							:= ri.ProspectLastUpdate12Mo;
		self.attributes.version1.ProspectAge												:= ri.ProspectAge;
		self.attributes.version1.ProspectGender											:= ri.ProspectGender;
		self.attributes.version1.ProspectMaritalStatus							:= ri.ProspectMaritalStatus;
		self.attributes.version1.ProspectEstimatedIncomeRange				:= ri.ProspectEstimatedIncomeRange;
		self.attributes.version1.ProspectDeceased										:= ri.ProspectDeceased;
		self.attributes.version1.ProspectCollegeAttending						:= ri.ProspectCollegeAttending;
		self.attributes.version1.ProspectCollegeAttended						:= ri.ProspectCollegeAttended;
		self.attributes.version1.ProspectCollegeProgramType					:= ri.ProspectCollegeProgramType;
		self.attributes.version1.ProspectCollegePrivate							:= ri.ProspectCollegePrivate;
		self.attributes.version1.ProspectCollegeTier								:= ri.ProspectCollegeTier;
		self.attributes.version1.ProspectBankingExperience					:= ri.ProspectBankingExperience;
		self.attributes.version1.AssetCurrOwner											:= ri.AssetCurrOwner;
		self.attributes.version1.PropCurrOwner											:= ri.PropCurrOwner;
		self.attributes.version1.PropCurrOwnedCnt										:= ri.PropCurrOwnedCnt;
		self.attributes.version1.PropCurrOwnedAssessedTtl						:= ri.PropCurrOwnedAssessedTtl;
		self.attributes.version1.PropCurrOwnedAVMTtl								:= ri.PropCurrOwnedAVMTtl;
		self.attributes.version1.PropTimeLastSale										:= ri.PropTimeLastSale;
		self.attributes.version1.PropEverOwnedCnt										:= ri.PropEverOwnedCnt;
		self.attributes.version1.PropEverSoldCnt										:= ri.PropEverSoldCnt;
		self.attributes.version1.PropSoldCnt12Mo										:= ri.PropSoldCnt12Mo;
		self.attributes.version1.PropSoldRatio											:= ri.PropSoldRatio;
		self.attributes.version1.PropPurchaseCnt12Mo								:= ri.PropPurchaseCnt12Mo;
		self.attributes.version1.PPCurrOwner												:= ri.PPCurrOwner;
		self.attributes.version1.PPCurrOwnedCnt											:= ri.PPCurrOwnedCnt;
		self.attributes.version1.PPCurrOwnedAutoCnt									:= ri.PPCurrOwnedAutoCnt;
		self.attributes.version1.PPCurrOwnedMtrcycleCnt							:= ri.PPCurrOwnedMtrcycleCnt;
		self.attributes.version1.PPCurrOwnedAircrftCnt							:= ri.PPCurrOwnedAircrftCnt;
		self.attributes.version1.PPCurrOwnedWtrcrftCnt							:= ri.PPCurrOwnedWtrcrftCnt;
		self.attributes.version1.LifeEvTimeLastMove									:= ri.LifeEvTimeLastMove;
		self.attributes.version1.LifeEvNameChange										:= ri.LifeEvNameChange;
		self.attributes.version1.LifeEvNameChangeCnt12Mo						:= ri.LifeEvNameChangeCnt12Mo;
		self.attributes.version1.LifeEvTimeFirstAssetPurchase				:= ri.LifeEvTimeFirstAssetPurchase;
		self.attributes.version1.LifeEvTimeLastAssetPurchase				:= ri.LifeEvTimeLastAssetPurchase;
		self.attributes.version1.LifeEvEverResidedCnt								:= ri.LifeEvEverResidedCnt;
		self.attributes.version1.LifeEvLastMoveTaxRatioDiff					:= ri.LifeEvLastMoveTaxRatioDiff;
		self.attributes.version1.LifeEvEconTrajectory								:= ri.LifeEvEconTrajectory;
		self.attributes.version1.LifeEvEconTrajectoryIndex					:= ri.LifeEvEconTrajectoryIndex;
		self.attributes.version1.ResCurrOwnershipIndex							:= ri.ResCurrOwnershipIndex;
		self.attributes.version1.ResCurrAVMValue										:= ri.ResCurrAVMValue;
		self.attributes.version1.ResCurrAVMValue12Mo								:= ri.ResCurrAVMValue12Mo;
		self.attributes.version1.ResCurrAVMRatioDiff12Mo						:= ri.ResCurrAVMRatioDiff12Mo;
		self.attributes.version1.ResCurrAVMValue60Mo								:= ri.ResCurrAVMValue60Mo;
		self.attributes.version1.ResCurrAVMRatioDiff60Mo						:= ri.ResCurrAVMRatioDiff60Mo;
		self.attributes.version1.ResCurrAVMCntyRatio								:= ri.ResCurrAVMCntyRatio;
		self.attributes.version1.ResCurrAVMTractRatio								:= ri.ResCurrAVMTractRatio;
		self.attributes.version1.ResCurrAVMBlockRatio								:= ri.ResCurrAVMBlockRatio;
		self.attributes.version1.ResCurrDwellType										:= ri.ResCurrDwellType;
		self.attributes.version1.ResCurrDwellTypeIndex							:= ri.ResCurrDwellTypeIndex;
		self.attributes.version1.ResCurrMortgageType								:= ri.ResCurrMortgageType;
		self.attributes.version1.ResCurrMortgageAmount							:= ri.ResCurrMortgageAmount;
		self.attributes.version1.ResCurrBusinessCnt									:= ri.ResCurrBusinessCnt;
		self.attributes.version1.ResInputOwnershipIndex							:= ri.ResInputOwnershipIndex;
		self.attributes.version1.ResInputAVMValue										:= ri.ResInputAVMValue;
		self.attributes.version1.ResInputAVMValue12Mo								:= ri.ResInputAVMValue12Mo;
		self.attributes.version1.ResInputAVMRatioDiff12Mo						:= ri.ResInputAVMRatioDiff12Mo;
		self.attributes.version1.ResInputAVMValue60Mo								:= ri.ResInputAVMValue60Mo;
		self.attributes.version1.ResInputAVMRatioDiff60Mo						:= ri.ResInputAVMRatioDiff60Mo;
		self.attributes.version1.ResInputAVMCntyRatio								:= ri.ResInputAVMCntyRatio;
		self.attributes.version1.ResInputAVMTractRatio							:= ri.ResInputAVMTractRatio;
		self.attributes.version1.ResInputAVMBlockRatio							:= ri.ResInputAVMBlockRatio;
		self.attributes.version1.ResInputDwellType									:= ri.ResInputDwellType;
		self.attributes.version1.ResInputDwellTypeIndex							:= ri.ResInputDwellTypeIndex;
		self.attributes.version1.ResInputMortgageType								:= ri.ResInputMortgageType;
		self.attributes.version1.ResInputMortgageAmount							:= ri.ResInputMortgageAmount;
		self.attributes.version1.ResInputBusinessCnt								:= ri.ResInputBusinessCnt;
		self.attributes.version1.CrtRecCnt													:= ri.CrtRecCnt;
		self.attributes.version1.CrtRecCnt12Mo											:= ri.CrtRecCnt12Mo;
		self.attributes.version1.CrtRecTimeNewest										:= ri.CrtRecTimeNewest;
		self.attributes.version1.CrtRecFelonyCnt										:= ri.CrtRecFelonyCnt;
		self.attributes.version1.CrtRecFelonyCnt12Mo								:= ri.CrtRecFelonyCnt12Mo;
		self.attributes.version1.CrtRecFelonyTimeNewest							:= ri.CrtRecFelonyTimeNewest;
		self.attributes.version1.CrtRecMsdmeanCnt										:= ri.CrtRecMsdmeanCnt;
		self.attributes.version1.CrtRecMsdmeanCnt12Mo								:= ri.CrtRecMsdmeanCnt12Mo;
		self.attributes.version1.CrtRecMsdmeanTimeNewest						:= ri.CrtRecMsdmeanTimeNewest;
		self.attributes.version1.CrtRecEvictionCnt									:= ri.CrtRecEvictionCnt;
		self.attributes.version1.CrtRecEvictionCnt12Mo							:= ri.CrtRecEvictionCnt12Mo;
		self.attributes.version1.CrtRecEvictionTimeNewest						:= ri.CrtRecEvictionTimeNewest;
		self.attributes.version1.CrtRecLienJudgCnt									:= ri.CrtRecLienJudgCnt;
		self.attributes.version1.CrtRecLienJudgCnt12Mo							:= ri.CrtRecLienJudgCnt12Mo;
		self.attributes.version1.CrtRecLienJudgTimeNewest						:= ri.CrtRecLienJudgTimeNewest;
		self.attributes.version1.CrtRecLienJudgAmtTtl								:= ri.CrtRecLienJudgAmtTtl;
		self.attributes.version1.CrtRecBkrptCnt											:= ri.CrtRecBkrptCnt;
		self.attributes.version1.CrtRecBkrptCnt12Mo									:= ri.CrtRecBkrptCnt12Mo;
		self.attributes.version1.CrtRecBkrptTimeNewest							:= ri.CrtRecBkrptTimeNewest;
		self.attributes.version1.CrtRecSeverityIndex								:= ri.CrtRecSeverityIndex;
		self.attributes.version1.OccProfLicense											:= ri.OccProfLicense;
		self.attributes.version1.OccProfLicenseCategory							:= ri.OccProfLicenseCategory;
		self.attributes.version1.OccBusinessAssociation							:= ri.OccBusinessAssociation;
		self.attributes.version1.OccBusinessAssociationTime					:= ri.OccBusinessAssociationTime;
		self.attributes.version1.OccBusinessTitleLeadership					:= ri.OccBusinessTitleLeadership;
		self.attributes.version1.InterestSportPerson								:= ri.InterestSportPerson;
		self.attributes.version1.HHTeenagerMmbrCnt									:= ri.HHTeenagerMmbrCnt;
		self.attributes.version1.HHYoungAdultMmbrCnt								:= ri.HHYoungAdultMmbrCnt;
		self.attributes.version1.HHMiddleAgeMmbrCnt									:= ri.HHMiddleAgeMmbrCnt;
		self.attributes.version1.HHSeniorMmbrCnt										:= ri.HHSeniorMmbrCnt;
		self.attributes.version1.HHElderlyMmbrCnt										:= ri.HHElderlyMmbrCnt;
		self.attributes.version1.HHCnt															:= ri.HHCnt;
		self.attributes.version1.HHEstimatedIncomeRange							:= ri.HHEstimatedIncomeRange;
		self.attributes.version1.HHCollegeAttendedMmbrCnt						:= ri.HHCollegeAttendedMmbrCnt;
		self.attributes.version1.HHCollege2yrAttendedMmbrCnt				:= ri.HHCollege2yrAttendedMmbrCnt;
		self.attributes.version1.HHCollege4yrAttendedMmbrCnt				:= ri.HHCollege4yrAttendedMmbrCnt;
		self.attributes.version1.HHCollegeGradAttendedMmbrCnt				:= ri.HHCollegeGradAttendedMmbrCnt;
		self.attributes.version1.HHCollegePrivateMmbrCnt						:= ri.HHCollegePrivateMmbrCnt;
		self.attributes.version1.HHCollegeTierMmbrHighest						:= ri.HHCollegeTierMmbrHighest;
		self.attributes.version1.HHPropCurrOwnerMmbrCnt							:= ri.HHPropCurrOwnerMmbrCnt;
		self.attributes.version1.HHPropCurrOwnedCnt									:= ri.HHPropCurrOwnedCnt;
		self.attributes.version1.HHPropCurrAVMHighest								:= ri.HHPropCurrAVMHighest;
		self.attributes.version1.HHPPCurrOwnedCnt										:= ri.HHPPCurrOwnedCnt;
		self.attributes.version1.HHPPCurrOwnedAutoCnt								:= ri.HHPPCurrOwnedAutoCnt;
		self.attributes.version1.HHPPCurrOwnedMtrcycleCnt						:= ri.HHPPCurrOwnedMtrcycleCnt;
		self.attributes.version1.HHPPCurrOwnedAircrftCnt						:= ri.HHPPCurrOwnedAircrftCnt;
		self.attributes.version1.HHPPCurrOwnedWtrcrftCnt						:= ri.HHPPCurrOwnedWtrcrftCnt;
		self.attributes.version1.HHCrtRecMmbrCnt										:= ri.HHCrtRecMmbrCnt;
		self.attributes.version1.HHCrtRecMmbrCnt12Mo								:= ri.HHCrtRecMmbrCnt12Mo;
		self.attributes.version1.HHCrtRecFelonyMmbrCnt							:= ri.HHCrtRecFelonyMmbrCnt;
		self.attributes.version1.HHCrtRecFelonyMmbrCnt12Mo					:= ri.HHCrtRecFelonyMmbrCnt12Mo;
		self.attributes.version1.HHCrtRecMsdmeanMmbrCnt							:= ri.HHCrtRecMsdmeanMmbrCnt;
		self.attributes.version1.HHCrtRecMsdmeanMmbrCnt12Mo					:= ri.HHCrtRecMsdmeanMmbrCnt12Mo;
		self.attributes.version1.HHCrtRecEvictionMmbrCnt						:= ri.HHCrtRecEvictionMmbrCnt;
		self.attributes.version1.HHCrtRecEvictionMmbrCnt12Mo				:= ri.HHCrtRecEvictionMmbrCnt12Mo;
		self.attributes.version1.HHCrtRecLienJudgMmbrCnt						:= ri.HHCrtRecLienJudgMmbrCnt;
		self.attributes.version1.HHCrtRecLienJudgMmbrCnt12Mo				:= ri.HHCrtRecLienJudgMmbrCnt12Mo;
		self.attributes.version1.HHCrtRecLienJudgAmtTtl							:= ri.HHCrtRecLienJudgAmtTtl;
		self.attributes.version1.HHCrtRecBkrptMmbrCnt								:= ri.HHCrtRecBkrptMmbrCnt;
		self.attributes.version1.HHCrtRecBkrptMmbrCnt12Mo						:= ri.HHCrtRecBkrptMmbrCnt12Mo;
		self.attributes.version1.HHCrtRecBkrptMmbrCnt24Mo						:= ri.HHCrtRecBkrptMmbrCnt24Mo;
		self.attributes.version1.HHOccProfLicMmbrCnt								:= ri.HHOccProfLicMmbrCnt;
		self.attributes.version1.HHOccBusinessAssocMmbrCnt					:= ri.HHOccBusinessAssocMmbrCnt;
		self.attributes.version1.HHInterestSportPersonMmbrCnt				:= ri.HHInterestSportPersonMmbrCnt;
		self.attributes.version1.RaATeenageMmbrCnt									:= ri.RaATeenageMmbrCnt;
		self.attributes.version1.RaAYoungAdultMmbrCnt								:= ri.RaAYoungAdultMmbrCnt;
		self.attributes.version1.RaAMiddleAgeMmbrCnt								:= ri.RaAMiddleAgeMmbrCnt;
		self.attributes.version1.RaASeniorMmbrCnt										:= ri.RaASeniorMmbrCnt;
		self.attributes.version1.RaAElderlyMmbrCnt									:= ri.RaAElderlyMmbrCnt;
		self.attributes.version1.RaAHHCnt														:= ri.RaAHHCnt;
		self.attributes.version1.RaAMmbrCnt													:= ri.RaAMmbrCnt;
		self.attributes.version1.RaAMedIncomeRange									:= ri.RaAMedIncomeRange;
		self.attributes.version1.RaACollegeAttendedMmbrCnt					:= ri.RaACollegeAttendedMmbrCnt;
		self.attributes.version1.RaACollege2yrAttendedMmbrCnt				:= ri.RaACollege2yrAttendedMmbrCnt;
		self.attributes.version1.RaACollege4yrAttendedMmbrCnt				:= ri.RaACollege4yrAttendedMmbrCnt;
		self.attributes.version1.RaACollegeGradAttendedMmbrCnt			:= ri.RaACollegeGradAttendedMmbrCnt;
		self.attributes.version1.RaACollegePrivateMmbrCnt						:= ri.RaACollegePrivateMmbrCnt;
		self.attributes.version1.RaACollegeTopTierMmbrCnt						:= ri.RaACollegeTopTierMmbrCnt;
		self.attributes.version1.RaACollegeMidTierMmbrCnt						:= ri.RaACollegeMidTierMmbrCnt;
		self.attributes.version1.RaACollegeLowTierMmbrCnt						:= ri.RaACollegeLowTierMmbrCnt;
		self.attributes.version1.RaAPropCurrOwnerMmbrCnt						:= ri.RaAPropCurrOwnerMmbrCnt;
		self.attributes.version1.RaAPropOwnerAVMHighest							:= ri.RaAPropOwnerAVMHighest;
		self.attributes.version1.RaAPropOwnerAVMMed									:= ri.RaAPropOwnerAVMMed;
		self.attributes.version1.RaAPPCurrOwnerMmbrCnt							:= ri.RaAPPCurrOwnerMmbrCnt;
		self.attributes.version1.RaAPPCurrOwnerAutoMmbrCnt					:= ri.RaAPPCurrOwnerAutoMmbrCnt;
		self.attributes.version1.RaAPPCurrOwnerMtrcycleMmbrCnt			:= ri.RaAPPCurrOwnerMtrcycleMmbrCnt;
		self.attributes.version1.RaAPPCurrOwnerAircrftMmbrCnt				:= ri.RaAPPCurrOwnerAircrftMmbrCnt;
		self.attributes.version1.RaAPPCurrOwnerWtrcrftMmbrCnt				:= ri.RaAPPCurrOwnerWtrcrftMmbrCnt;
		self.attributes.version1.RaACrtRecMmbrCnt										:= ri.RaACrtRecMmbrCnt;
		self.attributes.version1.RaACrtRecMmbrCnt12Mo								:= ri.RaACrtRecMmbrCnt12Mo;
		self.attributes.version1.RaACrtRecFelonyMmbrCnt							:= ri.RaACrtRecFelonyMmbrCnt;
		self.attributes.version1.RaACrtRecFelonyMmbrCnt12Mo					:= ri.RaACrtRecFelonyMmbrCnt12Mo;
		self.attributes.version1.RaACrtRecMsdmeanMmbrCnt						:= ri.RaACrtRecMsdmeanMmbrCnt;
		self.attributes.version1.RaACrtRecMsdmeanMmbrCnt12Mo				:= ri.RaACrtRecMsdmeanMmbrCnt12Mo;
		self.attributes.version1.RaACrtRecEvictionMmbrCnt						:= ri.RaACrtRecEvictionMmbrCnt;
		self.attributes.version1.RaACrtRecEvictionMmbrCnt12Mo				:= ri.RaACrtRecEvictionMmbrCnt12Mo;
		self.attributes.version1.RaACrtRecLienJudgMmbrCnt						:= ri.RaACrtRecLienJudgMmbrCnt;
		self.attributes.version1.RaACrtRecLienJudgMmbrCnt12Mo				:= ri.RaACrtRecLienJudgMmbrCnt12Mo;
		self.attributes.version1.RaACrtRecLienJudgAmtMax						:= ri.RaACrtRecLienJudgAmtMax;
		self.attributes.version1.RaACrtRecBkrptMmbrCnt36Mo					:= ri.RaACrtRecBkrptMmbrCnt36Mo;
		self.attributes.version1.RaAOccProfLicMmbrCnt								:= ri.RaAOccProfLicMmbrCnt;
		self.attributes.version1.RaAOccBusinessAssocMmbrCnt					:= ri.RaAOccBusinessAssocMmbrCnt;
		self.attributes.version1.RaAInterestSportPersonMmbrCnt			:= ri.RaAInterestSportPersonMmbrCnt;		
		self.attributes.version1.PPCurrOwnedAutoVIN			:= ri.PPCurrOwnedAutoVIN;
		self.attributes.version1.PPCurrOwnedAutoYear			:= ri.PPCurrOwnedAutoYear;
		self.attributes.version1.PPCurrOwnedAutoMake			:= ri.PPCurrOwnedAutoMake;
		self.attributes.version1.PPCurrOwnedAutoModel			:= ri.PPCurrOwnedAutoModel;
		self.attributes.version1.PPCurrOwnedAutoSeries			:= ri.PPCurrOwnedAutoSeries;
		self.attributes.version1.PPCurrOwnedAutoType			:= ri.PPCurrOwnedAutoType;	
		
    self.attributes.version1.score1 := ri.score1;
    self.attributes.version1.scorename1 := ri.scorename1;
    self.attributes.version1.reason1 := ri.reason1;
    self.attributes.version1.reason2 := ri.reason2;
    self.attributes.version1.reason3 := ri.reason3;
    self.attributes.version1.reason4 := ri.reason4;
    self.attributes.version1.reason5 := ri.reason5;
    self.attributes.version1.reason6 := ri.reason6;
	END;
	
	ProfileBooster_rec := JOIN(inData, Seed_Files.Key_ProfileBooster, 
		KEYED(RIGHT.dataset_name = Test_Data_Table_Name)
		and KEYED(RIGHT.hashvalue = Seed_Files.Hash_InstantID((STRING20)LEFT.fname, (STRING20)LEFT.lname,
			(STRING9)LEFT.ssn, '', (STRING5)LEFT.in_zipCode, (STRING10)LEFT.phone10, '')),
		create_output(LEFT,RIGHT), LEFT OUTER, ATMOST(100),KEEP(1));
	RETURN ProfileBooster_rec;
END;

