IMPORT Std;

EXPORT Spray_Global_SID_In(STRING version, CONST VARSTRING eclsourceip, STRING thor_name):= FUNCTION

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//Linux Directory Location/////////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	ccpaDir 			:= '/data/data_999/phones/ccpa/';
	
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//Orbit Global_SID File Name///////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	root					:= '~thor_data400::in::ccpa::orbit_global_sid';
	
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////																										
	//Clear Orbit Global_SID Superfile/////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	clrFile				:= FileServices.RemoveOwnedSubFiles(root, TRUE);

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
	//Spray Latest Orbit File Onto Thor////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	sprayFile 		:= Std.File.SprayVariable(eclsourceip,
																					ccpaDir + version[1..8] + '/*.txt',
																					,
																					'\t',
																					'\r\n',
																					,
																					STD.System.Thorlib.Group(),
																					root+'_'+version,
																					,
																					,
																					,
																					TRUE,
																					FALSE,
																					TRUE);

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//Add Latest Orbit File Into Superfile/////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	addRaw 				:= sequential(FileServices.StartSuperFileTransaction(),
															FileServices.RemoveOwnedSubFiles(root, TRUE),
															Fileservices.AddSuperfile(root, root+'_'+version),
															FileServices.FinishSuperFileTransaction());	

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	//Run Thor Spray///////////////////////////////////////////////////////////////////////////////////////////////////
	///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	orbitSpray 		:= SEQUENTIAL(clrFile,	
															sprayFile,
															addRaw);
			
	RETURN orbitSpray;

END;  