import risk_indicators;

export popCBDAttributes( string acctno ) := MODULE

export identityv1(dataset(Layout_CBDAttributes) attributes) := FUNCTION

	Models.Layout_Parameters intoIdentityV1(attributes le, integer c) := TRANSFORM
		self.name := map(	c=1 => 'BillToAgeOldestRecord',
											c=2 => 'ShipToAgeOldestRecord',
											c=3 => 'BillToAgeNewestRecord', 
											c=4 => 'ShipToAgeNewestRecord',
											c=5 => 'BillToRecentUpdate',
											c=6 => 'ShipToRecentUpdate',
											c=7 => 'BillToSrcsConfirmIDAddrCount',
											c=8 => 'ShipToSrcsConfirmIDAddrCount',
											c=9 => 'BillToInvalidAddr', 
											c=10 => 'ShipToInvalidAddr',
											c=11 => 'BillToInvalidPhone',
											c=12 => 'ShipToInvalidPhone',
											c=13 => 'BillToVerificationFailure',
											c=14 => 'ShipToVerificationFailure',
											c=15 => 'BillToVerifiedName',
											c=16 => 'ShipToVerifiedName',
											c=17 => 'BillToVerifiedPhone',
											c=18 => 'ShipToVerifiedPhone',
											c=19 => 'BillToVerifiedPhoneFullName',
											c=20 => 'ShipToVerifiedPhoneFullName',
											c=21 => 'BillToVerifiedPhoneLastName', 
											c=22 => 'ShipToVerifiedPhoneLastName',
											c=23 => 'BillToVerifiedAddress',
											c=24 => 'ShipToVerifiedAddress',
											c=25 => 'BillToInferredMinimumAge',
											c=26 => 'ShipToInferredMinimumAge',
											c=27 => 'BillToAddrIdentitiesCount',
											c=28 => 'ShipToAddrIdentitiesCount',
											c=29 => 'BillToAddrPhoneCount',
											c=30 => 'ShipToAddrPhoneCount',
											c=31 => 'BillToAddrIdentitiesRecentCount',
											c=32 => 'ShipToAddrIdentitiesRecentCount',
											c=33 => 'BillToAddrPhoneRecentCount',
											c=34 => 'ShipToAddrPhoneRecentCount',
											c=35 => 'BillToPhoneIdentitiesCount',
											c=36 => 'ShipToPhoneIdentitiesCount',
											c=37 => 'BillToPhoneListedDifferentNameAddress',
											c=38 => 'ShipToPhoneListedDifferentNameAddress',
											c=39 => 'BillToPhoneIdentitiesRecentCount',
											c=40 => 'ShipToPhoneIdentitiesRecentCount',
											c=41 => 'BillToAddrStability',
											c=42 => 'ShipToAddrStability',
											c=43 => 'BillToStatusMostRecent',
											c=44 => 'ShipToStatusMostRecent',
											c=45 => 'BillToAddrChangeCount03',
											c=46 => 'ShipToAddrChangeCount03',
											c=47 => 'BillToPropOwnedCount',
											c=48 => 'ShipToPropOwnedCount',
											c=49 => 'BillToPropOwnedTaxTotal',	
											c=50 => 'ShipToPropOwnedTaxTotal',	
											c=51 => 'BillToWatercraftCount',
											c=52 => 'ShipToWatercraftCount',
											c=53 => 'BillToAircraftCount',
											c=54 => 'ShipToAircraftCount',
											c=55 => 'BillToWealthIndex',
											c=56 => 'ShipToWealthIndex',
											c=57 => 'BillToDerogCount',
											c=58 => 'ShipToDerogCount',
											c=59 => 'BillToDerogAge',
											c=60 => 'ShipToDerogAge',
											c=61 => 'BillToFelonyCount',
											c=62 => 'ShipToFelonyCount',
											c=63 => 'BillToFelonyAge',
											c=64 => 'ShipToFelonyAge',
											c=65 => 'BillToEvictionAge',
											c=66 => 'ShipToEvictionAge',
											c=67 => 'BillToEvictionCount',
											c=68 => 'ShipToEvictionCount',
											c=69 => 'BillToProfLicAge',
											c=70 => 'ShipToProfLicAge',
											c=71 => 'BillToProfLicCount',
											c=72 => 'ShipToProfLicCount',
											c=73 => 'BillToPhoneStatus',
											c=74 => 'ShipToPhoneStatus',
											c=75 => 'BillToPhonePager',
											c=76 => 'ShipToPhonePager',
											c=77 => 'BillToPhoneMobile',
											c=78 => 'ShipToPhoneMobile',
											c=79 => 'BillToPhoneEDAAgeOldestRecord',
											c=80 => 'ShipToPhoneEDAAgeOldestRecord',
											c=81 => 'BillToPhoneEDAAgeNewestRecord',
											c=82 => 'ShipToPhoneEDAAgeNewestRecord',
											c=83 => 'BillToPhoneOtherAgeOldestRecord',
											c=84 => 'ShipToPhoneOtherAgeOldestRecord',
											c=85 => 'BillToPhoneOtherAgeNewestRecord',
											c=86 => 'ShipToPhoneOtherAgeNewestRecord',
											c=87 => 'BillToInvalidPhoneZip',
											c=88 => 'ShipToInvalidPhoneZip',
											c=89 => 'BillToPhoneAddrDist',
											c=90 => 'ShipToPhoneAddrDist',
											c=91 => 'BillToAddrHighRisk',
											c=92 => 'ShipToAddrHighRisk',
											c=93 => 'BillToInputPhoneHighRisk',
											c=94 => 'ShipToInputPhoneHighRisk',
											c=95 => 'BillToInputAddrPrison',
											c=96 => 'ShipToInputAddrPrison',
											c=97 => 'BillToInputZipPOBox',
											c=98 => 'ShipToInputZipPOBox',
											c=99 => 'BillToInputZipCorpMil',
											'ShipToInputZipCorpMil');
							
		self.value := map(	c=1 => le.identityv1.BillToAgeOldestRecord,
												c=2 => le.identityv1.ShipToAgeOldestRecord,
												c=3 => le.identityv1.BillToAgeNewestRecord, 
												c=4 => le.identityv1.ShipToAgeNewestRecord,
												c=5 => le.identityv1.BillToRecentUpdate,
												c=6 => le.identityv1.ShipToRecentUpdate,
												c=7 => le.identityv1.BillToSrcsConfirmIDAddrCount,
												c=8 => le.identityv1.ShipToSrcsConfirmIDAddrCount,
												c=9 => le.identityv1.BillToInvalidAddr, 
												c=10 => le.identityv1.ShipToInvalidAddr,
												c=11 => le.identityv1.BillToInvalidPhone,
												c=12 => le.identityv1.ShipToInvalidPhone,
												c=13 => le.identityv1.BillToVerificationFailure,
												c=14 => le.identityv1.ShipToVerificationFailure,
												c=15 => le.identityv1.BillToVerifiedName,
												c=16 => le.identityv1.ShipToVerifiedName,
												c=17 => le.identityv1.BillToVerifiedPhone,
												c=18 => le.identityv1.ShipToVerifiedPhone,
												c=19 => le.identityv1.BillToVerifiedPhoneFullName,
												c=20 => le.identityv1.ShipToVerifiedPhoneFullName,
												c=21 => le.identityv1.BillToVerifiedPhoneLastName, 
												c=22 => le.identityv1.ShipToVerifiedPhoneLastName,
												c=23 => le.identityv1.BillToVerifiedAddress,
												c=24 => le.identityv1.ShipToVerifiedAddress,
												c=25 => le.identityv1.BillToInferredMinimumAge,
												c=26 => le.identityv1.ShipToInferredMinimumAge,
												c=27 => le.identityv1.BillToAddrIdentitiesCount,
												c=28 => le.identityv1.ShipToAddrIdentitiesCount,
												c=29 => le.identityv1.BillToAddrPhoneCount,
												c=30 => le.identityv1.ShipToAddrPhoneCount,
												c=31 => le.identityv1.BillToAddrIdentitiesRecentCount,
												c=32 => le.identityv1.ShipToAddrIdentitiesRecentCount,
												c=33 => le.identityv1.BillToAddrPhoneRecentCount,
												c=34 => le.identityv1.ShipToAddrPhoneRecentCount,
												c=35 => le.identityv1.BillToPhoneIdentitiesCount,
												c=36 => le.identityv1.ShipToPhoneIdentitiesCount,
												c=37 => le.identityv1.BillToPhoneListedDifferentNameAddress,
												c=38 => le.identityv1.ShipToPhoneListedDifferentNameAddress,
												c=39 => le.identityv1.BillToPhoneIdentitiesRecentCount,
												c=40 => le.identityv1.ShipToPhoneIdentitiesRecentCount,
												c=41 => le.identityv1.BillToAddrStability,
												c=42 => le.identityv1.ShipToAddrStability,
												c=43 => le.identityv1.BillToStatusMostRecent,
												c=44 => le.identityv1.ShipToStatusMostRecent,
												c=45 => le.identityv1.BillToAddrChangeCount03,
												c=46 => le.identityv1.ShipToAddrChangeCount03,
												c=47 => le.identityv1.BillToPropOwnedCount,
												c=48 => le.identityv1.ShipToPropOwnedCount,
												c=49 => le.identityv1.BillToPropOwnedTaxTotal,	
												c=50 => le.identityv1.ShipToPropOwnedTaxTotal,	
												c=51 => le.identityv1.BillToWatercraftCount,
												c=52 => le.identityv1.ShipToWatercraftCount,
												c=53 => le.identityv1.BillToAircraftCount,
												c=54 => le.identityv1.ShipToAircraftCount,
												c=55 => le.identityv1.BillToWealthIndex,
												c=56 => le.identityv1.ShipToWealthIndex,
												c=57 => le.identityv1.BillToDerogCount,
												c=58 => le.identityv1.ShipToDerogCount,
												c=59 => le.identityv1.BillToDerogAge,
												c=60 => le.identityv1.ShipToDerogAge,
												c=61 => le.identityv1.BillToFelonyCount,
												c=62 => le.identityv1.ShipToFelonyCount,
												c=63 => le.identityv1.BillToFelonyAge,
												c=64 => le.identityv1.ShipToFelonyAge,
												c=65 => le.identityv1.BillToEvictionAge,
												c=66 => le.identityv1.ShipToEvictionAge,
												c=67 => le.identityv1.BillToEvictionCount,
												c=68 => le.identityv1.ShipToEvictionCount,
												c=69 => le.identityv1.BillToProfLicAge,
												c=70 => le.identityv1.ShipToProfLicAge,
												c=71 => le.identityv1.BillToProfLicCount,
												c=72 => le.identityv1.ShipToProfLicCount,
												c=73 => le.identityv1.BillToPhoneStatus,
												c=74 => le.identityv1.ShipToPhoneStatus,
												c=75 => le.identityv1.BillToPhonePager,
												c=76 => le.identityv1.ShipToPhonePager,
												c=77 => le.identityv1.BillToPhoneMobile,
												c=78 => le.identityv1.ShipToPhoneMobile,
												c=79 => le.identityv1.BillToPhoneEDAAgeOldestRecord,
												c=80 => le.identityv1.ShipToPhoneEDAAgeOldestRecord,
												c=81 => le.identityv1.BillToPhoneEDAAgeNewestRecord,
												c=82 => le.identityv1.ShipToPhoneEDAAgeNewestRecord,
												c=83 => le.identityv1.BillToPhoneOtherAgeOldestRecord,
												c=84 => le.identityv1.ShipToPhoneOtherAgeOldestRecord,
												c=85 => le.identityv1.BillToPhoneOtherAgeNewestRecord,
												c=86 => le.identityv1.ShipToPhoneOtherAgeNewestRecord,
												c=87 => le.identityv1.BillToInvalidPhoneZip,
												c=88 => le.identityv1.ShipToInvalidPhoneZip,
												c=89 => le.identityv1.BillToPhoneAddrDist,
												c=90 => le.identityv1.ShipToPhoneAddrDist,
												c=91 => le.identityv1.BillToAddrHighRisk,
												c=92 => le.identityv1.ShipToAddrHighRisk,
												c=93 => le.identityv1.BillToInputPhoneHighRisk,
												c=94 => le.identityv1.ShipToInputPhoneHighRisk,
												c=95 => le.identityv1.BillToInputAddrPrison,
												c=96 => le.identityv1.ShipToInputAddrPrison,
												c=97 => le.identityv1.BillToInputZipPOBox,
												c=98 => le.identityv1.ShipToInputZipPOBox,
												c=99 => le.identityv1.BillToInputZipCorpMil,
												le.identityv1.ShipToInputZipCorpMil);
	END;
	name_pairs1 :=  normalize(attributes, 100, intoIdentityV1(left, counter));
	identityV1 := project(name_pairs1, transform(Models.Layouts.layout_attribute, self.attribute := left));

	return dataset( [ {acctno, 'IdentityV1', risk_indicators.BillingIndex.CBD_IdentityAttr_v1, identityV1} ], Models.Layouts.Layout_AttributeGroup );
END;



export relationshipv1(dataset(Layout_CBDAttributes) attributes) := FUNCTION

	Models.Layout_Parameters intoRelationshipV1(attributes le, integer c) := TRANSFORM
		self.name := map(	c=1 => 'BillToShipToSameIdentity',
											c=2 => 'BillToShipToSameName',
											c=3 => 'BillToShipToSameAddr',
											c=4 => 'BillToFNameFoundEmail',
											c=5 => 'BillToLNameFoundEmail',
											c=6 => 'ShipToFNameFoundEmail',
											c=7 => 'ShipToLNameFoundEmail',
											c=8 => 'BillToPhoneBillToAddrDist',
											c=9 => 'ShipToPhoneShipToAddrDist',
											c=10 => 'BillToPhoneShipToAddrDist',
											c=11 => 'BillToShipToPhoneDist',
											c=12 => 'BillToShipToAddrDist',
											c=13 => 'BillToAddrShipToPhoneDist',
											c=14 => 'BillToShipToRelative',
											'BillToShipToCommonRelative');
							
		self.value := map(	c=1 => le.relationshipv1.BillToShipToSameIdentity,
												c=2 => le.relationshipv1.BillToShipToSameName,
												c=3 => le.relationshipv1.BillToShipToSameAddr,
												c=4 => le.relationshipv1.BillToFNameFoundEmail,
												c=5 => le.relationshipv1.BillToLNameFoundEmail,
												c=6 => le.relationshipv1.ShipToFNameFoundEmail,
												c=7 => le.relationshipv1.ShipToLNameFoundEmail,
												c=8 => le.relationshipv1.BillToPhoneBillToAddrDist,
												c=9 => le.relationshipv1.ShipToPhoneShipToAddrDist,
												c=10 => le.relationshipv1.BillToPhoneShipToAddrDist,
												c=11 => le.relationshipv1.BillToShipToPhoneDist,
												c=12 => le.relationshipv1.BillToShipToAddrDist,
												c=13 => le.relationshipv1.BillToAddrShipToPhoneDist,
												c=14 => le.relationshipv1.BillToShipToRelative,
												le.relationshipv1.BillToShipToCommonRelative);
	END;
	name_pairs1 :=  normalize(attributes, 15, intoRelationshipV1(left, counter));
	relationshipV1 := project(name_pairs1, transform(Models.Layouts.layout_attribute, self.attribute := left));

	return dataset( [ {acctno, 'RelationshipV1', risk_indicators.BillingIndex.CBD_RelationshipAttr_v1, relationshipV1} ], Models.Layouts.Layout_AttributeGroup );
END;

/************************************************************************************************************/
	export Identityv4(dataset(Layout_CBDAttributes) attributes) := FUNCTION
		Models.Layout_Parameters intoIdentityV4(attributes le, integer c) := TRANSFORM
			self.name := map(
				c=1   => 'BillToAgeOldestRecord',
				c=2   => 'ShipToAgeOldestRecord',
				c=3   => 'BillToAgeNewestRecord',
				c=4   => 'ShipToAgeNewestRecord',
				c=5   => 'BillToRecentUpdate',
				c=6   => 'ShipToRecentUpdate',
				c=7   => 'BillToSrcsConfirmIDAddrCount',
				c=8   => 'ShipToSrcsConfirmIDAddrCount',
				c=9   => 'BillToVerificationFailure',
				c=10  => 'ShipToVerificationFailure',
				c=11  => 'BillToVerifiedName',
				c=12  => 'ShipToVerifiedName',
				c=13  => 'BillToVerifiedPhone',
				c=14  => 'ShipToVerifiedPhone',
				c=15  => 'BillToVerifiedAddress',
				c=16  => 'ShipToVerifiedAddress',
				c=17  => 'BillToAssetVerifiedIdentity',
				c=18  => 'ShipToAssetVerifiedIdentity',
				c=19  => 'BillToPropRealVerifiedIdentity',
				c=20  => 'ShipToPropRealVerifiedIdentity',
				c=21  => 'BillToPropRealSourceCount',
				c=22  => 'ShipToPropRealSourceCount',
				c=23  => 'BillToPropPersVerifiedIdentity',
				c=24  => 'ShipToPropPersVerifiedIdentity',
				c=25  => 'BillToPropPersSourceCount',
				c=26  => 'ShipToPropPersSourceCount',
				c=27  => 'BillToInferredMinimumAge',
				c=28  => 'ShipToInferredMinimumAge',
				c=29  => 'BillToAddrIdentityCount',
				c=30  => 'ShipToAddrIdentityCount',
				c=31  => 'BillToAddrPhoneCount',
				c=32  => 'ShipToAddrPhoneCount',
				c=33  => 'BillToAddrIdentityRecentCount',
				c=34  => 'ShipToAddrIdentityRecentCount',
				c=35  => 'BillToAddrPhoneRecentCount',
				c=36  => 'ShipToAddrPhoneRecentCount',
				c=37  => 'BillToPhoneIdentityCount',
				c=38  => 'ShipToPhoneIdentityCount',
				c=39  => 'BillToPhoneIdentityRecentCount',
				c=40  => 'ShipToPhoneIdentityRecentCount',
				c=41  => 'BillToAddrStability',
				c=42  => 'ShipToAddrStability',
				c=43  => 'BillToStatusMostRecent',
				c=44  => 'ShipToStatusMostRecent',
				c=45  => 'BillToAddrChangeCount03',
				c=46  => 'ShipToAddrChangeCount03',
				c=47  => 'BillToFraudDerogSeverityIndex',
				c=48  => 'ShipToFraudDerogSeverityIndex',
				c=49  => 'BillToDerogCount',
				c=50  => 'ShipToDerogCount',
				c=51  => 'BillToDerogRecentCount',
				c=52  => 'ShipToDerogRecentCount',
				c=53  => 'BillToDerogAge',
				c=54  => 'ShipToDerogAge',
				c=55  => 'BillToFelonyCount',
				c=56  => 'ShipToFelonyCount',
				c=57  => 'BillToFelonyAge',
				c=58  => 'ShipToFelonyAge',
				c=59  => 'BillToEvictionCount',
				c=60  => 'ShipToEvictionCount',
				c=61  => 'BillToEvictionAge',
				c=62  => 'ShipToEvictionAge',
				c=63  => 'BillToProfLicCount',
				c=64  => 'ShipToProfLicCount',
				c=65  => 'BillToPhoneMobile',
				c=66  => 'ShipToPhoneMobile',
				c=67  => 'BillToProfLicAge',
				c=68  => 'ShipToProfLicAge',
				c=69  => 'BillToPhoneEDAAgeOldestRecord',
				c=70  => 'ShipToPhoneEDAAgeOldestRecord',
				c=71  => 'BillToPhoneEDAAgeNewestRecord',
				c=72  => 'ShipToPhoneEDAAgeNewestRecord',
				c=73  => 'BillToPhoneOthAgeOldestRecord',
				c=74  => 'ShipToPhoneOthAgeOldestRecord',
				c=75  => 'BillToPhoneOthAgeNewestRecord',
				c=76  => 'ShipToPhoneOthAgeNewestRecord',
				c=77  => 'BillToAddrHighRisk',
				c=78  => 'ShipToAddrHighRisk',
				c=79  => 'BillToInputPhoneHighRisk',
				c=80  => 'ShipToInputPhoneHighRisk',
				c=81  => 'BillToInputPhoneProblems',
				c=82  => 'ShipToInputPhoneProblems',
				c=83  => 'BillToInputAddrProblems',
				c=84  => 'ShipToInputAddrProblems',
				''
			);

			self.value := map(
				c=1   => le.IdentityV4.BillToAgeOldestRecord,
				c=2   => le.IdentityV4.ShipToAgeOldestRecord,
				c=3   => le.IdentityV4.BillToAgeNewestRecord,
				c=4   => le.IdentityV4.ShipToAgeNewestRecord,
				c=5   => le.IdentityV4.BillToRecentUpdate,
				c=6   => le.IdentityV4.ShipToRecentUpdate,
				c=7   => le.IdentityV4.BillToSrcsConfirmIDAddrCount,
				c=8   => le.IdentityV4.ShipToSrcsConfirmIDAddrCount,
				c=9   => le.IdentityV4.BillToVerificationFailure,
				c=10  => le.IdentityV4.ShipToVerificationFailure,
				c=11  => le.IdentityV4.BillToVerifiedName,
				c=12  => le.IdentityV4.ShipToVerifiedName,
				c=13  => le.IdentityV4.BillToVerifiedPhone,
				c=14  => le.IdentityV4.ShipToVerifiedPhone,
				c=15  => le.IdentityV4.BillToVerifiedAddress,
				c=16  => le.IdentityV4.ShipToVerifiedAddress,
				c=17  => le.IdentityV4.BillToAssetVerifiedIdentity,
				c=18  => le.IdentityV4.ShipToAssetVerifiedIdentity,
				c=19  => le.IdentityV4.BillToPropRealVerifiedIdentity,
				c=20  => le.IdentityV4.ShipToPropRealVerifiedIdentity,
				c=21  => le.IdentityV4.BillToPropRealSourceCount,
				c=22  => le.IdentityV4.ShipToPropRealSourceCount,
				c=23  => le.IdentityV4.BillToPropPersVerifiedIdentity,
				c=24  => le.IdentityV4.ShipToPropPersVerifiedIdentity,
				c=25  => le.IdentityV4.BillToPropPersSourceCount,
				c=26  => le.IdentityV4.ShipToPropPersSourceCount,
				c=27  => le.IdentityV4.BillToInferredMinimumAge,
				c=28  => le.IdentityV4.ShipToInferredMinimumAge,
				c=29  => le.IdentityV4.BillToAddrIdentityCount,
				c=30  => le.IdentityV4.ShipToAddrIdentityCount,
				c=31  => le.IdentityV4.BillToAddrPhoneCount,
				c=32  => le.IdentityV4.ShipToAddrPhoneCount,
				c=33  => le.IdentityV4.BillToAddrIdentityRecentCount,
				c=34  => le.IdentityV4.ShipToAddrIdentityRecentCount,
				c=35  => le.IdentityV4.BillToAddrPhoneRecentCount,
				c=36  => le.IdentityV4.ShipToAddrPhoneRecentCount,
				c=37  => le.IdentityV4.BillToPhoneIdentityCount,
				c=38  => le.IdentityV4.ShipToPhoneIdentityCount,
				c=39  => le.IdentityV4.BillToPhoneIdentityRecentCount,
				c=40  => le.IdentityV4.ShipToPhoneIdentityRecentCount,
				c=41  => le.IdentityV4.BillToAddrStability,
				c=42  => le.IdentityV4.ShipToAddrStability,
				c=43  => le.IdentityV4.BillToStatusMostRecent,
				c=44  => le.IdentityV4.ShipToStatusMostRecent,
				c=45  => le.IdentityV4.BillToAddrChangeCount03,
				c=46  => le.IdentityV4.ShipToAddrChangeCount03,
				c=47  => le.IdentityV4.BillToFraudDerogSeverityIndex,
				c=48  => le.IdentityV4.ShipToFraudDerogSeverityIndex,
				c=49  => le.IdentityV4.BillToDerogCount,
				c=50  => le.IdentityV4.ShipToDerogCount,
				c=51  => le.IdentityV4.BillToDerogRecentCount,
				c=52  => le.IdentityV4.ShipToDerogRecentCount,
				c=53  => le.IdentityV4.BillToDerogAge,
				c=54  => le.IdentityV4.ShipToDerogAge,
				c=55  => le.IdentityV4.BillToFelonyCount,
				c=56  => le.IdentityV4.ShipToFelonyCount,
				c=57  => le.IdentityV4.BillToFelonyAge,
				c=58  => le.IdentityV4.ShipToFelonyAge,
				c=59  => le.IdentityV4.BillToEvictionCount,
				c=60  => le.IdentityV4.ShipToEvictionCount,
				c=61  => le.IdentityV4.BillToEvictionAge,
				c=62  => le.IdentityV4.ShipToEvictionAge,
				c=63  => le.IdentityV4.BillToProfLicCount,
				c=64  => le.IdentityV4.ShipToProfLicCount,
				c=65  => le.IdentityV4.BillToPhoneMobile,
				c=66  => le.IdentityV4.ShipToPhoneMobile,
				c=67  => le.IdentityV4.BillToProfLicAge,
				c=68  => le.IdentityV4.ShipToProfLicAge,
				c=69  => le.IdentityV4.BillToPhoneEDAAgeOldestRecord,
				c=70  => le.IdentityV4.ShipToPhoneEDAAgeOldestRecord,
				c=71  => le.IdentityV4.BillToPhoneEDAAgeNewestRecord,
				c=72  => le.IdentityV4.ShipToPhoneEDAAgeNewestRecord,
				c=73  => le.IdentityV4.BillToPhoneOthAgeOldestRecord,
				c=74  => le.IdentityV4.ShipToPhoneOthAgeOldestRecord,
				c=75  => le.IdentityV4.BillToPhoneOthAgeNewestRecord,
				c=76  => le.IdentityV4.ShipToPhoneOthAgeNewestRecord,
				c=77  => le.IdentityV4.BillToAddrHighRisk,
				c=78  => le.IdentityV4.ShipToAddrHighRisk,
				c=79  => le.IdentityV4.BillToInputPhoneHighRisk,
				c=80  => le.IdentityV4.ShipToInputPhoneHighRisk,
				c=81  => le.IdentityV4.BillToInputPhoneProblems,
				c=82  => le.IdentityV4.ShipToInputPhoneProblems,
				c=83  => le.IdentityV4.BillToInputAddrProblems,
				c=84  => le.IdentityV4.ShipToInputAddrProblems,
				''
			);
		END;
		name_pairs :=  normalize(attributes, 84, intoIdentityV4(left, counter));
		IdentityV4 := project(name_pairs, transform(Models.Layouts.layout_attribute, self.attribute := left));
		return dataset( [ {acctno, 'IdentityV4', risk_indicators.BillingIndex.CBD_IdentityAttr_v4, IdentityV4} ], Models.Layouts.Layout_AttributeGroup );
	END;

	export Relationshipv4(dataset(Layout_CBDAttributes) attributes) := FUNCTION
		Models.Layout_Parameters intoRelationshipV4(attributes le, integer c) := TRANSFORM
			self.name := map(
				c=1   => 'BillToShipToSameIdentity',
				c=2   => 'BillToShipToSameName',
				c=3   => 'BillToShipToSameAddr',
				c=4   => 'BillToFNameFoundEmail',
				c=5   => 'ShipToFNameFoundEmail',
				c=6   => 'BillToLNameFoundEmail',
				c=7   => 'ShipToLNameFoundEmail',
				c=8   => 'BillToPhoneBillToAddrDist',
				c=9   => 'ShipToPhoneShipToAddrDist',
				c=10  => 'BillToPhoneShipToAddrDist',
				c=11  => 'BillToShipToPhoneDist',
				c=12  => 'BillToShipToAddrDist',
				c=13  => 'BillToAddrShipToPhoneDist',
				c=14  => 'BillToShipToRelative',
				c=15  => 'BillToShipToCommonRelative',
				''
			);

			self.value := map(
				c=1   => le.RelationshipV4.BillToShipToSameIdentity,
				c=2   => le.RelationshipV4.BillToShipToSameName,
				c=3   => le.RelationshipV4.BillToShipToSameAddr,
				c=4   => le.RelationshipV4.BillToFNameFoundEmail,
				c=5   => le.RelationshipV4.ShipToFNameFoundEmail,
				c=6   => le.RelationshipV4.BillToLNameFoundEmail,
				c=7   => le.RelationshipV4.ShipToLNameFoundEmail,
				c=8   => le.RelationshipV4.BillToPhoneBillToAddrDist,
				c=9   => le.RelationshipV4.ShipToPhoneShipToAddrDist,
				c=10  => le.RelationshipV4.BillToPhoneShipToAddrDist,
				c=11  => le.RelationshipV4.BillToShipToPhoneDist,
				c=12  => le.RelationshipV4.BillToShipToAddrDist,
				c=13  => le.RelationshipV4.BillToAddrShipToPhoneDist,
				c=14  => le.RelationshipV4.BillToShipToRelative,
				c=15  => le.RelationshipV4.BillToShipToCommonRelative,
				''
			);
		END;
		name_pairs :=  normalize(attributes, 15, intoRelationshipV4(left, counter));
		RelationshipV4 := project(name_pairs, transform(Models.Layouts.layout_attribute, self.attribute := left));
		return dataset( [ {acctno, 'RelationshipV4', risk_indicators.BillingIndex.CBD_RelationshipAttr_v4, relationshipV4} ], Models.Layouts.Layout_AttributeGroup );
	END;

	export Velocityv4(dataset(Layout_CBDAttributes) attributes) := FUNCTION
		Models.Layout_Parameters intoVelocityV4(attributes le, integer c) := TRANSFORM
			self.name := map(
				c=1   => 'BillToSearchCBDAgeOldestRecord',
				c=2   => 'ShipToSearchCBDAgeOldestRecord',
				c=3   => 'BillToSearchCBDAgeNewestRecord',
				c=4   => 'ShipToSearchCBDAgeNewestRecord',
				c=5   => 'BillToSearchCBDCount',
				c=6   => 'ShipToSearchCBDCount',
				c=7   => 'BillToSearchCBDCount01',
				c=8   => 'ShipToSearchCBDCount01',
				c=9   => 'BillToSearchCBDIdentityAddr',
				c=10  => 'ShipToSearchCBDIdentityAddr',
				c=11  => 'BillToSearchCBDAddrIdentity',
				c=12  => 'ShipToSearchCBDAddrIdentity',
				c=13  => 'BillToSearchCBDIdentityPhone',
				c=14  => 'ShipToSearchCBDIdentityPhone',
				c=15  => 'BillToSearchOthAgeOldestRecord',
				c=16  => 'ShipToSearchOthAgeOldestRecord',
				c=17  => 'BillToSearchOthAgeNewestRecord',
				c=18  => 'ShipToSearchOthAgeNewestRecord',
				c=19  => 'BillToSearchOthCount',
				c=20  => 'ShipToSearchOthCount',
				c=21  => 'BillToSearchOthCount01',
				c=22  => 'ShipToSearchOthCount01',
				c=23  => 'BillToSearchLocateCount',
				c=24  => 'ShipToSearchLocateCount',
				c=25  => 'BillToSearchLocateCount01',
				c=26  => 'ShipToSearchLocateCount01',
				c=27  => 'BillToSearchRetailCount',
				c=28  => 'ShipToSearchRetailCount',
				c=29  => 'BillToSearchRetailCount01',
				c=30  => 'ShipToSearchRetailCount01',
				c=31  => 'BillToSearchOthAddrIdentity',
				c=32  => 'ShipToSearchOthAddrIdentity',
				''
			);

			self.value := map(
				c=1   => le.VelocityV4.BillToSearchCBDAgeOldestRecord,
				c=2   => le.VelocityV4.ShipToSearchCBDAgeOldestRecord,
				c=3   => le.VelocityV4.BillToSearchCBDAgeNewestRecord,
				c=4   => le.VelocityV4.ShipToSearchCBDAgeNewestRecord,
				c=5   => le.VelocityV4.BillToSearchCBDCount,
				c=6   => le.VelocityV4.ShipToSearchCBDCount,
				c=7   => le.VelocityV4.BillToSearchCBDCount01,
				c=8   => le.VelocityV4.ShipToSearchCBDCount01,
				c=9   => le.VelocityV4.BillToSearchCBDIdentityAddr,
				c=10  => le.VelocityV4.ShipToSearchCBDIdentityAddr,
				c=11  => le.VelocityV4.BillToSearchCBDAddrIdentity,
				c=12  => le.VelocityV4.ShipToSearchCBDAddrIdentity,
				c=13  => le.VelocityV4.BillToSearchCBDIdentityPhone,
				c=14  => le.VelocityV4.ShipToSearchCBDIdentityPhone,
				c=15  => le.VelocityV4.BillToSearchOthAgeOldestRecord,
				c=16  => le.VelocityV4.ShipToSearchOthAgeOldestRecord,
				c=17  => le.VelocityV4.BillToSearchOthAgeNewestRecord,
				c=18  => le.VelocityV4.ShipToSearchOthAgeNewestRecord,
				c=19  => le.VelocityV4.BillToSearchOthCount,
				c=20  => le.VelocityV4.ShipToSearchOthCount,
				c=21  => le.VelocityV4.BillToSearchOthCount01,
				c=22  => le.VelocityV4.ShipToSearchOthCount01,
				c=23  => le.VelocityV4.BillToSearchLocateCount,
				c=24  => le.VelocityV4.ShipToSearchLocateCount,
				c=25  => le.VelocityV4.BillToSearchLocateCount01,
				c=26  => le.VelocityV4.ShipToSearchLocateCount01,
				c=27  => le.VelocityV4.BillToSearchRetailCount,
				c=28  => le.VelocityV4.ShipToSearchRetailCount,
				c=29  => le.VelocityV4.BillToSearchRetailCount01,
				c=30  => le.VelocityV4.ShipToSearchRetailCount01,
				c=31  => le.VelocityV4.BillToSearchOthAddrIdentity,
				c=32  => le.VelocityV4.ShipToSearchOthAddrIdentity,
				''
			);
		END;
		name_pairs :=  normalize(attributes, 32, intoVelocityV4(left, counter));
		VelocityV4 := project(name_pairs, transform(Models.Layouts.layout_attribute, self.attribute := left));
		return dataset( [ {acctno, 'VelocityV4', risk_indicators.BillingIndex.CBD_VelocityAttr_v4, VelocityV4} ], Models.Layouts.Layout_AttributeGroup );
	END;

END;