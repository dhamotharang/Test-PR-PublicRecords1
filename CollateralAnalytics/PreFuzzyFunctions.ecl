import std, collateralanalytics;

export PreFuzzyFunctions:=module

export  MLS_AC_TYPE_PREPROCESS(string inrow=''):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0K'=>'Mini Split',
    trimmed='N/K'=>'TYPE UNKNOWN',
    trimmed='UNKNOWN'=>'TYPE UNKNOWN',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='19'=>'Varies By Unit',
    trimmed='1A'=>'Two Window/Wall',
    trimmed='1L'=>'1 Wall A/C',
    trimmed='1W'=>'1 Window A/C',
    trimmed='25'=>'Two Central',
    trimmed='2F'=>'2+ Ceiling Fans',
    trimmed='2L'=>'2+ Wall A/C',
    trimmed='2U'=>'3+ Window/Wall',
    trimmed='2W'=>'2+ Window A/C',
    trimmed='34'=>'A/C - Other',
    trimmed='3R'=>'Paddle Fans',
    trimmed='5N'=>'One Central',
    trimmed='73'=>'Individual Meters',
    trimmed='75'=>'Hvac',
    trimmed='77'=>'Ridge Vent',
    trimmed='8D'=>'Fresh Air Ventilation',
    trimmed='9E'=>'Individual Systems',
    trimmed='AC'=>'Air Conditioning',
    trimmed='AE'=>'Air Exchanger',
    trimmed='AF'=>'Attic fan',
    trimmed='AS'=>'AC Split',
    trimmed='AV'=>'Attic Ventilator',
    trimmed='B5'=>'Shared Cooling',
    trimmed='BW'=>'Thermal Fan',
    trimmed='C6'=>'Ceiling Fans',
    trimmed='C7'=>'Electric Air Filter',
    trimmed='C8'=>'Other Cooling',
    trimmed='C9'=>'Geothermal',
    trimmed='CB'=>'Central air conditioning in building',
    trimmed='CE'=>'Central - Electric',
    trimmed='CG'=>'Central - Gas',
    trimmed='CH'=>'Chiller',
    trimmed='CO'=>'Common',
    trimmed='CR'=>'Forced Air',
    trimmed='CT'=>'Central',
    trimmed='CU'=>'Central air conditioning in unit',
    trimmed='CX'=>'Combination',
    trimmed='D2'=>'Whole House Fan',
    trimmed='DL'=>'Dual',
    trimmed='DT'=>'Cool Towers',
    trimmed='DU'=>'Ducts',
    trimmed='EA'=>'Electric',
    trimmed='EF'=>'Exhaust Fan',
    trimmed='EN'=>'Monitor',
    trimmed='EP'=>'Evaporative',
    trimmed='ER'=>'Refrigerated Space',
    trimmed='FD'=>'Combo',
    trimmed='FF'=>'Ceiling Hung',
    trimmed='FG'=>'One Window/Wall',
    trimmed='G4'=>'Allowance',
    trimmed='GA'=>'Gas',
    trimmed='GR'=>'Ground',
    trimmed='GU'=>'Wall Gas',
    trimmed='HH'=>'Heat Pump',
    trimmed='HN'=>'Humidity Control',
    trimmed='HR'=>'Total Area',
    trimmed='HW'=>'Individual Cooling',
    trimmed='IE'=>'Humidistat',
    trimmed='IL'=>'Reverse Cycle',
    trimmed='JE'=>'Cooling Towers',
    trimmed='KW'=>'Multiple A/C Units',
    trimmed='L9'=>'Three+ Central',
    trimmed='LH'=>'Wall Air Conditioning',
    trimmed='MC'=>'Evaporative Roof',
    trimmed='MY'=>'Plenum',
    trimmed='MZ'=>'Multi-Zoned',
    trimmed='NO'=>'No Air Conditioning',
    trimmed='NX'=>'Multiple Type',
    trimmed='OP'=>'Optional',
    trimmed='PG'=>'Propane Gas',
    trimmed='PT'=>'Partial',
    trimmed='R5'=>'Both Refrigeration And Evaporative',
    trimmed='RA'=>'Room Refrigerator',
    trimmed='RD'=>'Radiant',
    trimmed='SM'=>'Separate Meters',
    trimmed='SN'=>'Multiple Units',
    trimmed='SO'=>'Solar',
    trimmed='SV'=>'Swamp cooler',
    trimmed='SW'=>'Roof Mounted',
    trimmed='T9'=>'Office Area Only',
    trimmed='UH'=>'Evaporative Window',
    trimmed='W7'=>'Cool Air',
    trimmed='WC'=>'Water Cooling',
    trimmed='WD'=>'Window unit(s)',
    trimmed='WF'=>'Window Fan(S)',
    trimmed='WG'=>'Fans',
    trimmed='WL'=>'Wall unit(s)',
    trimmed='WX'=>'Window/Wall Unit(s)',
    trimmed='XW'=>'Multiple Window/Wall Unit(s)',
    trimmed='Z7'=>'Hvac Equipment',
    trimmed='ZD'=>'Zoned/Dual',
    trimmed='ZG'=>'A/C - Zone',
    trimmed='ZN'=>'Zoned',
    
    inrow);
        
    return cleaned;
end;



export  MLS_PARKING_TYPE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='6'=>'1-Car Parking',
    std.str.find(inrow,'NO CO',1)<>0=>'Uncovered',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='0F'=>'Deeded Parking',
    trimmed='1G'=>'Boat Parking',
    trimmed='1H'=>'51-100 Spaces',
    trimmed='1K'=>'Open Parking',
    trimmed='1L'=>'RV parking',
    trimmed='1N'=>'Underground Parking',
    trimmed='1O'=>'Unpaved',
    trimmed='1Q'=>'Brick Driveway',
    trimmed='1R'=>'Circular Driveway',
    trimmed='1T'=>'Deco Driveway',
    trimmed='1U'=>'No Truck/RV Parking',
    trimmed='1V'=>'Over 100',
    trimmed='1W'=>'Side Entry',
    trimmed='26'=>'1 Car',
    trimmed='28'=>'Bus/Rv Garage',
    trimmed='2C'=>'2 Car Garage',
    trimmed='2F'=>'1-25 Spaces',
    trimmed='2P'=>'CARPORT 2 CAR',
    trimmed='34'=>'Special Purchase',
    trimmed='3C'=>'3 Car Garage',
    trimmed='3F'=>'26+ Spaces',
    trimmed='3O'=>'Free Standing',
    trimmed='3P'=>'3+ Carports',
    trimmed='46'=>'Connecting',
    trimmed='4C'=>'Detached',
    trimmed='4E'=>'Valet Parking',
    trimmed='4N'=>'3+  Parking Spaces',
    trimmed='4W'=>'0-5',
    trimmed='59'=>'Space Per Unit - 2',
    trimmed='5A'=>'Outdoor Space',
    trimmed='5P'=>'Stamped Concrete Drive',
    trimmed='5Z'=>'Back Load',
    trimmed='7A'=>'Free Parking',
    trimmed='7B'=>'Rented/Permit Parking',
    trimmed='7C'=>'1 Detached - Carport',
    trimmed='7J'=>'Extra Space Avail.',
    trimmed='7R'=>'Less Than 1 Per Unit',
    trimmed='8E'=>'2 Attached - Carport',
    trimmed='91'=>'4+ Cars',
    trimmed='92'=>'Off Public Road',
    trimmed='9G'=>'Dirt',
    trimmed='9Q'=>'Carport-Triple',
    trimmed='9R'=>'Fee Parking',
    trimmed='AC'=>'Attached Carport',
    trimmed='AIJ'=>'Driveway - Combination',
    trimmed='AM'=>'Partially Paved',
    trimmed='AN'=>'Attached + Detached',
    trimmed='AP'=>'Asphalt',
    trimmed='AR'=>'Room For Truck Parking',
    trimmed='AT'=>'Attended',
    trimmed='BI'=>'Built-In Garage',
    trimmed='BQ'=>'Near Public Transit',
    trimmed='C3'=>'3+ Cars',
    trimmed='CA'=>'Covered Park Lot',
    trimmed='CD'=>'Concrete Driveway',
    trimmed='CF'=>'Unpaved Lot',
    trimmed='CG'=>'Converted Garage',
    trimmed='CK'=>'Parking Deck',
    trimmed='CM'=>'Compact',
    trimmed='CP'=>'Carport',
    trimmed='CR'=>'Guest Parking - Checkin Required',
    trimmed='CV'=>'Covered',
    trimmed='D4'=>'16-25',
    trimmed='D9'=>'Deck',
    trimmed='DC'=>'Detached Carport',
    trimmed='DDX'=>'Air Conditioned Garage',
    trimmed='DG'=>'Direct Garage Access',
    trimmed='DJ'=>'Open Spaces',
    trimmed='DP'=>'Disabled Parking',
    trimmed='DR'=>'Driveway',
    trimmed='DS'=>'Drive Space',
    trimmed='E0'=>'Motorcycle Storage',
    trimmed='E4L'=>'Workshop',
    trimmed='FC'=>'Fenced',
    trimmed='FE'=>'Front Entrance',
    trimmed='FG'=>'Finished Garage',
    trimmed='FN'=>'26-50',
    trimmed='FU'=>'2 Carport',
    trimmed='FV'=>'Drive Under/Built-In',
    trimmed='FY'=>'Indoor Space',
    trimmed='FZ'=>'26-50 Spaces',
    trimmed='G3'=>'1 Car Garage',
    trimmed='GA'=>'Garage',
    trimmed='GC'=>'Golf Cart Parking',
    trimmed='GH'=>'parking structure',
    trimmed='GO'=>'Paved Areas',
    trimmed='GP'=>'Guest Parking',
    trimmed='GR'=>'Gravel',
    trimmed='GT'=>'Gated Parking',
    trimmed='GU'=>'Guest Parking - Under 10',
    trimmed='GZ0'=>'Rv Hook-Ups',
    trimmed='HD'=>'Driveway-Dirt',
    trimmed='HG'=>'Heated Garage',
    trimmed='HJ'=>'Electric Vehicle Charging Station(S)',
    trimmed='HJ9'=>'Subterr Side By Side',
    trimmed='HP'=>'Handicap Parking',
    trimmed='HT'=>'43261',
    trimmed='HY'=>'2 Detached - Carport',
    trimmed='HZ'=>'Assigned Parking Space',
    trimmed='I7'=>'Automatic Driveway Gate',
    trimmed='IG'=>'Prepaid',
    trimmed='IM'=>'Alley Entrance',
    trimmed='J3'=>'Rv Garage',
    trimmed='JA'=>'Off Private Road',
    trimmed='JJ5'=>'Rv Possible',
    trimmed='JS'=>'1 - 5 Spaces',
    trimmed='KD'=>'3+ Attached - Carport',
    trimmed='KF'=>'Load Space',
    trimmed='KK'=>'Rear Entry',
    trimmed='KL'=>'Kitchen Level',
    trimmed='KUU'=>'Above Street Level Parking',
    trimmed='KV'=>'One Car/Unit',
    trimmed='LA'=>'Large Area',
    trimmed='LE'=>'Leased',
    trimmed='LG'=>'Lighted',
    trimmed='LL'=>'Lower Level Parking',
    trimmed='LN'=>'Stone',
    trimmed='LO'=>'Lot',
    trimmed='LU'=>'Limited Use',
    trimmed='M9'=>'Enclosed',
    trimmed='MA'=>'Maintenance Agreement',
    trimmed='ME'=>'Off & On Street',
    trimmed='ML'=>'Main Level Parking',
    trimmed='MQ'=>'Carport-Double',
    trimmed='NA'=>'3+Car Parking',
    trimmed='ND'=>'No Driveway',
    trimmed='NE'=>'Rear Parking',
    trimmed='NO'=>'No Covered Parking',
    trimmed='NP'=>'None',
    trimmed='NS'=>'No Street Parking',
    trimmed='NV'=>'Attached',
    trimmed='O7'=>'Paved',
    trimmed='OA'=>'One Additional Parking Space',
    trimmed='OB2'=>'Parking Space',
    trimmed='OE'=>'Garage And Carport',
    trimmed='OF'=>'Off Street',
    trimmed='OG'=>'Oversized Garage',
    trimmed='OI'=>'Off Site',
    trimmed='OJ'=>'On Site',
    trimmed='OP'=>'Oversized Parking',
    trimmed='OR'=>'On Street',
    trimmed='OS'=>'Open Space',
    trimmed='OT'=>'Other Parking',
    trimmed='OU'=>'Outside',
    trimmed='P01'=>'Deck(s)',
    trimmed='P02'=>'Gravel Driveway',
    trimmed='P03'=>'Driveway Pavers',
    trimmed='P05'=>'Interior Access',
    trimmed='P06'=>'Metered',
    trimmed='P08'=>'Overhead Storage',
    trimmed='P09'=>'Parking Fee',
    trimmed='P1'=>'Pay Public',
    trimmed='P10'=>'Parking Space Conveys',
    trimmed='P11'=>'Permit/Decal',
    trimmed='P13'=>'Private Garage',
    trimmed='P14'=>'RV Covered',
    trimmed='P15'=>'RV Gated',
    trimmed='P16'=>'RV Hookups',
    trimmed='P19'=>'Community Garage',
    trimmed='P20'=>'Under Home Parking',
    trimmed='P21'=>'Above Street Level',
    trimmed='P23'=>'Gated Underground Parking',
    trimmed='P24'=>'Porte-Cochere',
    trimmed='P25'=>'Pull Through',
    trimmed='P26'=>'RV Complex/Park',
    trimmed='P27'=>'RV Enclosed',
    trimmed='P28'=>'RV Garage',
    trimmed='PA'=>'Additional Charge',
    trimmed='PB'=>'3 Carport',
    trimmed='PC'=>'Comm Area',
    trimmed='PD'=>'Paved Driveway',
    trimmed='PG'=>'Parking Garage',
    trimmed='PI'=>'Included',
    trimmed='PO'=>'11 - 20 Spaces',
    trimmed='PP'=>'Parking Pad',
    trimmed='PQ'=>'Public Lot/Garage',
    trimmed='PR'=>'Private',
    trimmed='PS'=>'Paved Lot',
    trimmed='PU'=>'Public',
    trimmed='PW'=>'3+ Car Garage',
    trimmed='PZ'=>'43419',
    trimmed='QP'=>'Additional Parking',
    trimmed='R2'=>'Surface',
    trimmed='RA'=>'Space Per Unit - 1',
    trimmed='RM'=>'Remote',
    trimmed='RP'=>'1-10 Spaces',
    trimmed='RR'=>'Rear Entrance',
    trimmed='RS'=>'Reserved',
    trimmed='S8'=>'51-100',
    trimmed='SC'=>'Secured',
    trimmed='SD'=>'Shared Driveway',
    trimmed='SF'=>'Self-Park',
    trimmed='SG'=>'Side Rear Garage Entry',
    trimmed='SL'=>'1 Car Carport',
    trimmed='SM'=>'See Remarks',
    trimmed='SO'=>'Storage Room',
    trimmed='SR'=>'Side/Rear',
    trimmed='SS'=>'Side by Side',
    trimmed='ST'=>'Street Parking',
    trimmed='SU'=>'Subterranean Parking',
    trimmed='SW'=>'Stone Driveway',
    trimmed='T2'=>'Garage-Ground Level',
    trimmed='TA'=>'Tenant Parking - Assigned',
    trimmed='TC'=>'Tenant Parking - Covered',
    trimmed='TD'=>'Tandem',
    trimmed='TG'=>'Tar and Gravel',
    trimmed='TK'=>'Pad Only (Off Street)',
    trimmed='TM'=>'Two or More Additional Parking Space',
    trimmed='TO'=>'Tenant Parking - Open',
    trimmed='TP'=>'Tandem-Private',
    trimmed='TS'=>'Tandem-Shared',
    trimmed='TT'=>'Tenant Parking - Tandem',
    trimmed='TU'=>'Tenant Parking - Unassigned',
    trimmed='U4'=>'Extra Parking',
    trimmed='U5'=>'Deeded Stall(S)',
    trimmed='UA'=>'Unassigned',
    trimmed='UC'=>'Under Building Closed',
    trimmed='UG'=>'Unfinished Garage',
    trimmed='UN'=>'Uncovered',
    trimmed='UO'=>'Under Building Open',
    trimmed='UP'=>'Unpaved',
    trimmed='UT'=>'Unit Garage',
    trimmed='UZ'=>'Metered',
    trimmed='V8'=>'Garage-Under Building',
    trimmed='VAL'=>'Valet Parking',
    trimmed='VE'=>'1 Parking Space',
    trimmed='VF'=>'Valet Off Site',
    trimmed='VH'=>'3+ Detached - Carport',
    trimmed='VN'=>'Valet On Site',
    trimmed='W4'=>'Controlled Entrance',
    trimmed='WB'=>'2 Spaces Per Unt',
    trimmed='WT'=>'Carport-Single',
    trimmed='X0'=>'Exposed Aggregate Drive',
    trimmed='X8'=>'Offsite',
    trimmed='XI'=>'Parking-Under Building',
    trimmed='XL'=>'Special Rental',
    trimmed='XZ'=>'1 Or More Per Unit',
    trimmed='Y5X'=>'Rv Paved',
    trimmed='YK8'=>'Built-In Storage',
    trimmed='YT'=>'3 Parking Spaces',
    trimmed='YU'=>'Units Vary',
    trimmed='ZH'=>'1 Attached - Carport',
    trimmed='ZK'=>'6 - 10 Spaces',
    trimmed='ZR'=>'Area',
    trimmed='ZW'=>'2 Parking Spaces',
    STD.STR.FilterOut(trimmed,'0123456789')=''=>'',
    std.str.find(trimmed,'NO COVERED',1)<>0=>'Uncovered',
    std.str.find(trimmed,'NO',1)<>0=>'None',
    std.str.find(trimmed,'.5',1)<>0=>STD.Str.FindReplace(trimmed,'.5',''),
    std.str.find(trimmed,'1/2',1)<>0=>STD.Str.FindReplace(trimmed,'1/2',''),
    std.str.find(trimmed,'10',1)<>0=>STD.Str.FindReplace(trimmed,'10','TEN'),
    std.str.find(trimmed,'1',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'1','ONE'),
    std.str.find(trimmed,'2',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'2','TWO'),
    std.str.find(trimmed,'3',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'3','THREE'),
    std.str.find(trimmed,'4',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'4','FOUR'),
    std.str.find(trimmed,'5',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'5','FIVE'),
    std.str.find(trimmed,'6',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'6','SIX'),    
    inrow);
        
    return cleaned;
end;

export  MLS_PARKING_TYPE_PREPROCESS_Round2(string inrow):=function
        trimmed:=trim(inrow,left,right);
        
        Fix1:=STD.Str.FindReplace(trimmed,'.5','');
        Fix2:=if(std.str.find(Fix1,'1',1)<>0 and std.str.find(Fix1,'10',1)=0 and std.str.find(Fix1,'-',1)=0,STD.Str.FindReplace(Fix1,'1','ONE'),Fix1);
        Fix3:=if(std.str.find(Fix2,'2',1)<>0 and std.str.find(Fix2,'-',1)=0,STD.Str.FindReplace(Fix2,'2','TWO'),Fix2);
        Fix4:=if(std.str.find(Fix3,'3',1)<>0 and std.str.find(Fix3,'-',1)=0,STD.Str.FindReplace(Fix3,'3','THREE'),Fix3);
        Fix5:=if(std.str.find(Fix4,'4',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix4,'4','FOUR'),Fix4);
        Fix6:=if(std.str.find(Fix5,'5',1)<>0 and std.str.find(Fix5,'-',1)=0,STD.Str.FindReplace(Fix5,'5','FIVE'),Fix5);
        Fix7:=if(std.str.find(Fix6,'6',1)<>0 and std.str.find(Fix6,'-',1)=0,STD.Str.FindReplace(Fix6,'6','SIX'),Fix6);
        Fix8:=if(std.str.find(Fix7,'10',1)<>0 and std.str.find(Fix7,'-',1)=0,STD.Str.FindReplace(Fix7,'10','TEN'),Fix7);
        Fix9 :=STD.Str.FindReplace(Fix8 ,'RV PARKING','RV');
        Fix10:=STD.Str.FindReplace(Fix9 ,'GARAGE DOOR OPENER','DOOR OPENER');
        Fix11:=STD.Str.FindReplace(Fix10,'PARKING PAD','PAD');
        Fix12:=STD.Str.FindReplace(Fix11,'OTHER PARKING','OTHER');
        Fix13:=STD.Str.FindReplace(Fix12,'OPEN PARKING','OPEN');
        Fix14:=STD.Str.FindReplace(Fix13,'OPEN SPACE','OPEN');
        Fix15:=STD.Str.FindReplace(Fix14,'OPEN PARKING','OPEN');
        Fix16:=STD.Str.FindReplace(Fix15,'STREET PARKING','STREET');
        Fix17:=if(std.str.find(Fix16,'DRIVEWAY',1)=0,STD.Str.FindReplace(Fix16,'DRIVE','DRIVEWAY'),Fix16);
        Fix18:=STD.Str.FindReplace(Fix17,'POTENTIAL SPACE','POTENTIAL');
        Fix19:=STD.Str.FindReplace(Fix18,'PAVED DRIVEWAY','PAVED');
        return Fix19;
    end;


export  MLS_GARAGE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0R'=>'Attic Lift',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='2B'=>'4+ Car Detached Garage',
    trimmed='30'=>'Door With Opener W/Contro',
    trimmed='52'=>'4+ Car Attached Carport',
    trimmed='5C'=>'Slab',
    trimmed='6I'=>'Tall Door',
    trimmed='6K'=>'5+ Car Attached',
    trimmed='6P'=>'2 Car Attached Garage',
    trimmed='6X'=>'Drive Under/Built-In',
    trimmed='7S'=>'2 Car Detached Garage',
    trimmed='80'=>'7 Foot Or More High Garage Door',
    trimmed='92'=>'Combination',
    trimmed='9H'=>'Extended Length Garage',
    trimmed='9II'=>'Washer/Dryer Hookups',
    trimmed='A1'=>'1 Assigned Space',
    trimmed='A2'=>'2+ Assigned Spaces',
    trimmed='AD'=>'Automatic Garage Door',
    trimmed='AG'=>'Assigned',
    trimmed='AM'=>'Rv Garage',
    trimmed='AUX'=>'Available',
    trimmed='B6'=>'Attached',
    trimmed='BC'=>'Boat Storage',
    trimmed='BG'=>'Bathroom',
    trimmed='BI'=>'Built-In',
    trimmed='BS'=>'Basement',
    trimmed='C4'=>'Converted',
    trimmed='CA'=>'Barn',
    trimmed='CF'=>'Concrete Floor',
    trimmed='CH'=>'Awning - Car',
    trimmed='CP'=>'Carport',
    trimmed='CY'=>'Door W/Opener W/Controls',
    trimmed='D2'=>'3 Car Detached Garage',
    trimmed='DA'=>'Direct Access',
    trimmed='DI5'=>'Garage - Two Door',
    trimmed='DP'=>'3 Car Attached Garage',
    trimmed='EG'=>'Electricity',
    trimmed='EI'=>'Common Area',
    trimmed='ES'=>'Entry - Swing-In',
    trimmed='FD'=>'Floor Drain',
    trimmed='FE'=>'Front Entrance',
    trimmed='FM'=>'4 or more car garage',
    trimmed='FN'=>'Finished',
    trimmed='G01'=>'Sink in Garage',
    trimmed='G02'=>'Workbench in Garage',
    trimmed='G03'=>'4+ Doors',
    trimmed='G04'=>'Extended Length',
    trimmed='G05'=>'3 Door',
    trimmed='G06'=>'2 Door',
    trimmed='G07'=>'5 to 9 Door',
    trimmed='G08'=>'4 Door',
    trimmed='G3'=>'Separate Storage Area',
    trimmed='GC'=>'Golf Cart',
    trimmed='GD'=>'Garage Door Opener',
    trimmed='GH'=>'1 Car Attached Garage',
    trimmed='GO'=>'Transmitter(S)',
    trimmed='GR'=>'Garage',
    trimmed='GU'=>'Guest',
    trimmed='HT'=>'Heated',
    trimmed='IA'=>'Interior Access',
    trimmed='IE'=>'Sink in Garage',
    trimmed='IYZ'=>'Garage - Three Door',
    trimmed='J7'=>'3 Car Attached Carport',
    trimmed='JD'=>'Door W/Opener No Controls',
    trimmed='JM'=>'4+ Car Detached Carport',
    trimmed='JQ'=>'Rv Workshop',
    trimmed='K1'=>'Integral',
    trimmed='K5'=>'Undersized Garage',
    trimmed='LE'=>'Leased',
    trimmed='LZ'=>'Extra Garage',
    trimmed='M3'=>'3+ Car Garage',
    trimmed='MB'=>'Insulated Garage',
    trimmed='MD'=>'Door-Multi',
    trimmed='MG'=>'Multiple',
    trimmed='ML'=>'Main Level',
    trimmed='N9'=>'Fenced',
    trimmed='NG1'=>'1 Garage',
    trimmed='NG2'=>'2 Garages',
    trimmed='NG3'=>'3 Garages',
    trimmed='NG4'=>'4 Garages',
    trimmed='NO'=>'No Garage',
    trimmed='O1'=>'1.5 Car Garage',
    trimmed='O2'=>'2.5 Car Garage',
    trimmed='OG'=>'Oversized Garage',
    trimmed='OM'=>'1 Car Attached Carport',
    trimmed='OS'=>'See Property Description Remarks',
    trimmed='OT'=>'Other',
    trimmed='OW'=>'Owned',
    trimmed='PB'=>'Bole Barn',
    trimmed='PE'=>'4+ Car Attached Garage',
    trimmed='PJ'=>'3 Car Detached Carport',
    trimmed='PP'=>'Side Yard Access',
    trimmed='PQ'=>'1 Car Detached Garage',
    trimmed='PT'=>'Pull Through',
    trimmed='PZ'=>'Porte-Cochere',
    trimmed='Q9'=>'1 Car Garage',
    trimmed='QR'=>'Keyless Entry',
    trimmed='RE'=>'Rented',
    trimmed='RK'=>'Detached',
    trimmed='RR'=>'Rear Entrance',
    trimmed='SD'=>'Second Garage',
    trimmed='SE'=>'Side Entrance Garage',
    trimmed='SF'=>'Electric Door Opener',
    trimmed='SO'=>'Door-Single',
    trimmed='SP'=>'Secured Parking',
    trimmed='SS'=>'Side by Side',
    trimmed='ST'=>'Storage',
    trimmed='T7'=>'Space Included',
    trimmed='TD'=>'Tandem',
    trimmed='TI'=>'Single-Wide Driveway',
    trimmed='TU'=>'Tuck Under',
    trimmed='UG'=>'Unassigned',
    trimmed='UN'=>'Underground',
    trimmed='UT'=>'Utility Garage',
    trimmed='V1'=>'2 Car Attached Carport',
    trimmed='V4'=>'Garage Bay(S)',
    trimmed='VE'=>'Drive Through',
    trimmed='VG'=>'1 Car Detached Carport',
    trimmed='W0'=>'Public Garage',
    trimmed='WA'=>'Wheelchair Access',
    trimmed='WD'=>'Washer/Dryer Hookup',
    trimmed='WN'=>'Attached Garage Cabinets',
    trimmed='WS'=>'Workshop',
    trimmed='WT'=>'Water',
    trimmed='X5U'=>'Garage - 4+ Doors',
    trimmed='Y0'=>'5+ Car Detached',
    trimmed='YW'=>'2 Car Detached Carport',
    trimmed='ZM'=>'Double-Wide Driveway',
    std.str.find(trimmed,'NOGARAGE',1)<>0=>'NONE',
    STD.STR.FilterOut(trimmed,'0123456789')=''=>'',
    std.str.find(trimmed,'.5',1)<>0=>STD.Str.FindReplace(trimmed,'.5',''),
    std.str.find(trimmed,'1/2',1)<>0=>STD.Str.FindReplace(trimmed,'1/2',''),
    std.str.find(trimmed,'10',1)<>0=>STD.Str.FindReplace(trimmed,'10','TEN'),
    std.str.find(trimmed,'1',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'1','ONE'),
    std.str.find(trimmed,'2',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'2','TWO'),
    std.str.find(trimmed,'3',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'3','THREE'),
    std.str.find(trimmed,'4',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'4','FOUR'),
    std.str.find(trimmed,'5',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'5','FIVE'),
    std.str.find(trimmed,'6',1)<>0 and std.str.find(trimmed,'-',1)=0=>STD.Str.FindReplace(trimmed,'6','SIX'),    
    inrow);
        
    return cleaned;
end;

export  MLS_GARAGE_PREPROCESS_Round2(string inrow):=function
        trimmed:=trim(inrow,left,right);
        Fix1:=STD.Str.FindReplace(trimmed ,'1-2 STEP ENTRY','');
        Fix2:=STD.Str.FindReplace(Fix1,'.5','');
        Fix3:=STD.Str.FindReplace(Fix2,'1/2','');
        Fix4:=if(std.str.find(Fix3,'1',1)<>0 and std.str.find(Fix3,'10',1)=0 and std.str.find(Fix3,'-',1)=0,STD.Str.FindReplace(Fix3,'1','ONE'),Fix3);
        Fix5:=if(std.str.find(Fix4,'2',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix4,'2','TWO'),Fix4);
        Fix6:=if(std.str.find(Fix5,'3',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix5,'3','THREE'),Fix5);
        Fix7:=if(std.str.find(Fix6,'4',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix6,'4','FOUR'),Fix6);
        Fix8:=if(std.str.find(Fix7,'5',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix7,'5','FIVE'),Fix7);
        Fix9:=if(std.str.find(Fix8,'6',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix8,'6','SIX'),Fix8);
        Fix10:=if(std.str.find(Fix9,'10',1)<>0 and std.str.find(Fix4,'-',1)=0,STD.Str.FindReplace(Fix9,'10','TEN'),Fix9);
        Fix11:=std.str.FindReplace(Fix10,'UNCOVERED','OPEN');
        return Fix11;
    end;



export  MLS_ROOF_COVER_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0C'=>'Wood Rafters',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    (std.str.find(inrow,'DIMENSION',1)<>0) and (std.str.find(inrow,'SHING',1)<>0)=>'Shingles',
    trimmed='0J'=>'Woodruff',
    trimmed='0T'=>'Shingles',
    trimmed='0X'=>'Gabled',
    trimmed='1B'=>'Vulcanized Rubber',
    trimmed='27'=>'Sloped',
    trimmed='2K'=>'Ridged',
    trimmed='2L'=>'Wood Shake',
    trimmed='4G'=>'Solar Shingles',
    trimmed='4R'=>'Cool/White',
    trimmed='5F'=>'Steel Joints',
    trimmed='5M'=>'Heavy Composition',
    trimmed='6W'=>'Steel Deck',
    trimmed='A1'=>'Skylight',
    trimmed='A3'=>'Barrel',
    trimmed='AA'=>'Built Up',
    trimmed='AC'=>'Asphalt/Composition',
    trimmed='AH'=>'Architectural Shingle',
    trimmed='AL'=>'Aluminum',
    trimmed='AP'=>'Shingle-asphalt',
    trimmed='AQ'=>'Shingle-asphalt/fiberglass',
    trimmed='AR'=>'Shingle-architectural',
    trimmed='AS'=>'Shingle-asbestos',
    trimmed='AT'=>'Asphalt',
    trimmed='BH'=>'Bahama',
    trimmed='BI'=>'Bituthene',
    trimmed='BU'=>'Barrel Tiles',
    trimmed='BX'=>'Vegetated',
    trimmed='CE'=>'Cement',
    trimmed='CM'=>'Composite',
    trimmed='CN'=>'Concrete',
    trimmed='CP'=>'Copper',
    trimmed='CS'=>'Cedar/shake',
    trimmed='CY'=>'Clay',
    trimmed='DR'=>'Age Over 8 Years',
    trimmed='EK'=>'Galvanized',
    trimmed='EL'=>'Elastomeric',
    trimmed='EZ'=>'Wood Joist',
    trimmed='F3'=>'Other - See Remarks',
    trimmed='FB'=>'Fiberglass',
    trimmed='FG'=>'Shingle-fiber glass',
    trimmed='FL'=>'Flat',
    trimmed='FM'=>'Foam',
    trimmed='FR'=>'Fire Retardant',
    trimmed='GL'=>'Composite Shingle',
    trimmed='GV'=>'Wood Joints',
    trimmed='HI'=>'Hip',
    trimmed='HSH'=>'36+',
    trimmed='I3'=>'Corrugated Steel',
    trimmed='I4'=>'Other Roofing',
    trimmed='I5'=>'Roof Over',
    trimmed='IN'=>'Insulated',
    trimmed='IV'=>'Stone-Coated Steel',
    trimmed='J3'=>'Tar Pebble',
    trimmed='KU'=>'Steel Roof Trusses',
    trimmed='LU'=>'Composition Shingle',
    trimmed='ME'=>'Metal',
    trimmed='MH'=>'Sawtooth',
    trimmed='MS'=>'Polyurethane',
    trimmed='N3'=>'Aluminum Over Tar',
    trimmed='NN'=>'Tile/Slate',
    trimmed='PG'=>'Pitch & Gravel',
    trimmed='PI'=>'Pitch',
    trimmed='QG'=>'GRAVEL ROOF',
    trimmed='RF1'=>'Common Roof',
    trimmed='RF2'=>'Concrete Shake',
    trimmed='RF3'=>'Concrete Tile',
    trimmed='RF4'=>'Mansard',
    trimmed='RF5'=>'Metal Shake',
    trimmed='RF6'=>'Synthetic',
    trimmed='RK'=>'Rock',
    trimmed='RL'=>'Rolled',
    trimmed='RU'=>'Rubber',
    trimmed='SB'=>'Slag/built up',
    trimmed='SH'=>'Shake',
    trimmed='SI'=>'Shingle',
    trimmed='SL'=>'Slate',
    trimmed='SN'=>'Stone',
    trimmed='SP'=>'Spanish Clay Tile',
    trimmed='SW'=>'Shingle-wood',
    trimmed='T8'=>'Simulated Shake',
    trimmed='TD'=>'Overlay',
    trimmed='TG'=>'Tar and gravel',
    trimmed='TGC'=>'Gravel',
    trimmed='TI'=>'Tile',
    trimmed='V3'=>'Wood Trusses',
    trimmed='WC'=>'Wood/Cedar',
    trimmed='WR'=>'Wood',
    trimmed='XA'=>'Manufactured',
    trimmed='YD'=>'Steel Joist',
    trimmed='YK'=>'Non-Combustable',
    trimmed='YU'=>'Flat Tile',
    trimmed='YV'=>'Asbestos',
    trimmed='YW'=>'Asphalt/Fiberglass',
    trimmed='YX'=>'Membrane',
    trimmed='ZQ'=>'Urethane',
    trimmed='PREFINISHED WOOD'=>'WOOD',
    
    inrow);
        
    return cleaned;
end;


export  MLS_HEATING_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0X'=>'Hot Water-Oil',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='15'=>'Shared Heat',
    trimmed='1Q'=>'Energy Storage',
    trimmed='2E'=>'90% Forced Air',
    trimmed='31'=>'Multiple Furnaces',
    trimmed='3C'=>'Auxillary',
    trimmed='3D'=>'Plenum',
    trimmed='4A'=>'Solar On Grid',
    trimmed='4Y'=>'Oil Hot Water',
    trimmed='51'=>'Jet',
    trimmed='52'=>'Electric Hot Water',
    trimmed='54'=>'Pellet Stove',
    trimmed='5C'=>'Heat Pump - Gas Backup',
    trimmed='63'=>'Perimeter',
    trimmed='6L'=>'Dual Fuel/Off Peak',
    trimmed='6X'=>'Coal Stove',
    trimmed='7I'=>'Panel',
    trimmed='7N'=>'Butane',
    trimmed='7Q'=>'Wind Turbine/Power',
    trimmed='7S'=>'Forced Gas',
    trimmed='87'=>'Desuperheater',
    trimmed='8A'=>'Individual Furnace',
    trimmed='8E'=>'Office Only',
    trimmed='8P'=>'Bio Fuel',
    trimmed='8Q'=>'Hot Water-Gas',
    trimmed='8S'=>'Solar Passive',
    trimmed='93'=>'Heat Strip',
    trimmed='9C'=>'Solar Rough-In',
    trimmed='9N'=>'Central Furnace',
    trimmed='AM'=>'Gas Forced Air',
    trimmed='BB'=>'Baseboard',
    trimmed='BE'=>'Baseboard - Electric',
    trimmed='BG'=>'Bottled Gas/Propane',
    trimmed='BL'=>'Boiler',
    trimmed='BO'=>'Solar Off Grid',
    trimmed='BS'=>'Ceiling',
    trimmed='BW'=>'Baseboard - Water',
    trimmed='C3'=>'Baseboard/Cove',
    trimmed='C5'=>'Solar Active',
    trimmed='CA'=>'To Lot Line',
    trimmed='CB'=>'Central heat in building',
    trimmed='CC'=>'Central Oil',
    trimmed='CE'=>'Central',
    trimmed='CG'=>'Central Gas',
    trimmed='CJ'=>'Forced Electric',
    trimmed='CL'=>'Ceiling Electric',
    trimmed='CM'=>'Common',
    trimmed='CO'=>'Coal',
    trimmed='CQ'=>'Convection Heating',
    trimmed='CR'=>'Circulator',
    trimmed='CT'=>'Central Electric',
    trimmed='CU'=>'Central heat in unit',
    trimmed='CW'=>'Circulator Hot Water',
    trimmed='CX'=>'Propane Leased',
    trimmed='D7'=>'Renewable',
    trimmed='D8'=>'Wall Gas',
    trimmed='DN'=>'Total Area',
    trimmed='DS'=>'Dual Systems',
    trimmed='DU'=>'Ducts',
    trimmed='E8'=>'In-Street',
    trimmed='EB'=>'Radiant Baseboard',
    trimmed='EC'=>'Electric',
    trimmed='EE'=>'Energy Star Heating System',
    trimmed='EP'=>'Evaporative',
    trimmed='EV'=>'Wall/Floor Heat',
    trimmed='F2'=>'Hvac = 16 Seer',
    trimmed='F9'=>'Electric Forced Air',
    trimmed='FA'=>'Forced Air',
    trimmed='FM'=>'Radiant In-Floor',
    trimmed='FP'=>'Fireplace',
    trimmed='FR'=>'Portable',
    trimmed='FS'=>'Programmable Thermostat',
    trimmed='FU'=>'Floor Furnace',
    trimmed='G6'=>'Conversion',
    trimmed='GD'=>'Oil Forced Air',
    trimmed='GH'=>'Gas Pack',
    trimmed='GJ'=>'Gas Jets',
    trimmed='GR'=>'Gravity',
    trimmed='GT'=>'Geothermal',
    trimmed='HC'=>'Hot Water Coil',
    trimmed='HE1'=>'Pellets',
    trimmed='HE2'=>'Fireplace',
    trimmed='HE3'=>'Wall/Gravity',
    trimmed='HE4'=>'Combination Heating',
    trimmed='HFL'=>'Hot Water Radiant Floor',
    trimmed='HP'=>'Heat Pump',
    trimmed='HQ'=>'Ventilation',
    trimmed='HU'=>'Heat Recovery Unit',
    trimmed='HW'=>'Hot Water',
    trimmed='HY'=>'Hydro Heat',
    trimmed='IM'=>'Individual Meters',
    trimmed='IN'=>'Individual Units',
    trimmed='IR'=>'Individual Rm Controls',
    trimmed='JL'=>'Solar Photovoltaic',
    trimmed='KB'=>'One Furnace',
    trimmed='KE'=>'Kerosene',
    trimmed='KU'=>'Heat Pump - Electric Backup',
    trimmed='KV'=>'Combo',
    trimmed='KZ'=>'L.P. Gas Furnace',
    trimmed='LP'=>'Pellet',
    trimmed='LV'=>'See Property Description Remarks',
    trimmed='LY'=>'Zoned Heat',
    trimmed='MC'=>'Office Area Only',
    trimmed='ME'=>'Heating Meter',
    trimmed='MU'=>'Multiple Units',
    trimmed='MW'=>'Fae',
    trimmed='MZ'=>'Multi Zoned',
    trimmed='N4'=>'Heat Pump - Oil Backup',
    trimmed='NA'=>'Natural Gas-Hook up Available',
    trimmed='NG'=>'Natural Gas',
    trimmed='NM'=>'Warm Air',
    trimmed='NO'=>'None',
    trimmed='OL'=>'Oil',
    trimmed='OT'=>'Other',
    trimmed='P6'=>'Reverse Cycle Unit',
    trimmed='P8'=>'Ceiling Cable',
    trimmed='PB'=>'Outdoor Furnace',
    trimmed='PEL'=>'Pellet',
    trimmed='PN'=>'Ground Source',
    trimmed='PT'=>'Partial',
    trimmed='PY'=>'Modine',
    trimmed='Q8'=>'Hvac = 13 Seer',
    trimmed='QG'=>'Combination',
    trimmed='R1'=>'Propane Owned',
    trimmed='RA'=>'Radiant',
    trimmed='RB'=>'Rented Burner',
    trimmed='RD'=>'Radiator',
    trimmed='SA'=>'Slab',
    trimmed='SEA'=>'S/W Changeover',
    trimmed='SH'=>'Stove Heater',
    trimmed='SL'=>'Solar Active/Passive',
    trimmed='SO'=>'Solar',
    trimmed='SO1'=>'Solar Heat Other',
    trimmed='SO2'=>'Solar Panels',
    trimmed='SO3'=>'Solar Screens',
    trimmed='SP'=>'Space heater',
    trimmed='ST'=>'Steam',
    trimmed='TN'=>'Electronic Air Filter',
    trimmed='UC'=>'Fuel Oil',
    trimmed='UD'=>'Gravity Furnace',
    trimmed='VH'=>'Monitor',
    trimmed='WA'=>'Wood Burning Aux',
    trimmed='WB'=>'Wood Burning Stove',
    trimmed='WF'=>'Wall Furnace',
    trimmed='WN'=>'Window Unit(s)',
    trimmed='WO'=>'Wood',
    trimmed='WU'=>'Wall Unit',
    trimmed='WW'=>'Wood Furnace',
    trimmed='WY'=>'Energy Star Unit(S)',
    trimmed='XI'=>'Suspended Ceiling',
    trimmed='XK'=>'Mini Split',
    trimmed='Y0'=>'Geo-Exchange',
    trimmed='Y8'=>'Geothermal Heat Pump',
    trimmed='YN'=>'Wall Electric',
    trimmed='YT'=>'S/W Changeover',
    trimmed='YU'=>'Alternative',
    trimmed='ZC'=>'Indirect Tank',
    trimmed='ZD'=>'Ceiling Hung',
    trimmed='ZN'=>'Free Standing Oil',
    trimmed='ZO'=>'Zoned',
    
    inrow);
        
    return cleaned;
end;

export  MLS_FLOOR_TYPE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='31'=>'Oak',
    std.str.find(inrow,'NO ',1)<>0=>'NONE',
    trimmed='4L'=>'Heavy',
    trimmed='7F'=>'Resilient-Some',
    trimmed='8C'=>'Softwood',
    trimmed='91'=>'Pavers',
    trimmed='9B'=>'Heated Floors',
    trimmed='B0'=>'Cement',
    trimmed='BAM'=>'Bamboo',
    trimmed='BF'=>'Brick flooring',
    trimmed='BP'=>'Painted Floors',
    trimmed='CLA'=>'Clay',
    trimmed='CM'=>'Clay-Mexican Tile',
    trimmed='CR'=>'Concrete',
    trimmed='CW'=>'bamboo',
    trimmed='DF'=>'Dirt Floor',
    trimmed='DI'=>'Vinyl/Tile',
    trimmed='FE'=>'Resilent',
    trimmed='FH'=>'Cork',
    trimmed='FL1'=>'Allowance to Buyer',
    trimmed='FL2'=>'Brick/Pavers',
    trimmed='GM'=>'Saltillo',
    trimmed='GO'=>'Grouted Tile',
    trimmed='GR'=>'Granite',
    trimmed='HA4'=>'Low Pile Carpeting',
    trimmed='HG'=>'Heated',
    trimmed='HW'=>'Hardwood',
    trimmed='I6'=>'Laminated Wood',
    trimmed='I7'=>'Asphalt',
    trimmed='I8'=>'Slate',
    trimmed='I9'=>'Ceramic Tile',
    trimmed='IG'=>'Decorative Concrete',
    trimmed='IT'=>'Italian Tile',
    trimmed='JS'=>'Heavy Duty',
    trimmed='K4'=>'Weight',
    trimmed='KP'=>'Carpet',
    trimmed='KV'=>'Unfinished',
    trimmed='LI'=>'Linoleum',
    trimmed='LJ'=>'Ceramic',
    trimmed='LQ'=>'Terrazzo',
    trimmed='LV'=>'Laminated',
    trimmed='LX'=>'Vinyl',
    trimmed='MB'=>'Marble',
    trimmed='MIX'=>'Mixed',
    trimmed='MJ'=>'Wood',
    trimmed='MS'=>'Marble/Stone',
    trimmed='N9'=>'Insulated Floors',
    trimmed='O7'=>'Resin Tile',
    trimmed='OT'=>'Other',
    trimmed='PAV'=>'Pavers',
    trimmed='PB'=>'Particle Board',
    trimmed='PC'=>'Part Carpet',
    trimmed='PDF'=>'Adobe',
    trimmed='PG'=>'Pergo',
    trimmed='PH'=>'Part Hardwood',
    trimmed='PI'=>'Pine Floor',
    trimmed='PQ'=>'Parquet',
    trimmed='PR'=>'Porcelain',
    trimmed='PS'=>'Quarry Tile',
    trimmed='PW'=>'Plywood',
    trimmed='Q0'=>'Terracotta',
    trimmed='RF'=>'Raised Foundation',
    trimmed='S6'=>'Wood Under Carpet',
    trimmed='SD'=>'D\'hanis Tile',
    trimmed='SN'=>'Stone',
    trimmed='SW'=>'Simulated Wood',
    trimmed='TB'=>'Reinforced',
    trimmed='TI'=>'Tile',
    trimmed='TR'=>'Travertine',
    trimmed='U6'=>'Load Stress Floor',
    trimmed='V1'=>'Stained Concrete',
    trimmed='VL'=>'Vinyl/Linoleum',
    trimmed='WA'=>'Wall to Wall Carpet',
    trimmed='WC'=>'Wood with Carpet',
    trimmed='WW'=>'Wall to Wall',
    trimmed='X19'=>'Subfloor - Slab Other Story',
    trimmed='X20'=>'Subfloor - Slab Over Crawl Space',
    trimmed='X21'=>'Subfloor - Slab On Grade',
    trimmed='X22'=>'Subfloor - Wood Other Story',
    trimmed='X23'=>'Subfloor - Wood Over Crawl Space',
    
    inrow);
        
    return cleaned;
end;

export  MLS_POOL_TYPE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0T'=>'Automatic Chlorination',
    std.str.find(inrow,'NO',1)<>0=>'None',
    std.str.find(inrow,':N',1)<>0=>'None',
    std.str.find(inrow,':Y',1)<>0=>'Pool',
    std.str.find(inrow,'N/K',1)<>0=>'None',
    std.str.find(inrow,'COMMU',1)<>0=>'COMMUNITY',
    trimmed='1I'=>'POOL WITH SPA',
    trimmed='1K'=>'Self Cleaning',
    trimmed='37'=>'Fenced Pool',
    trimmed='3ND'=>'Pebble',
    trimmed='4K'=>'Space Heat Passive',
    trimmed='61'=>'Pool Perimeter Fence',
    trimmed='8M'=>'Cleaning System',
    trimmed='8S'=>'Membership Available',
    trimmed='90'=>'Membership Included',
    trimmed='AE'=>'Lined',
    trimmed='AG'=>'Above ground',
    trimmed='AQ'=>'Spa Adjoining Pool',
    trimmed='ASS'=>'Association Pool',
    trimmed='BB'=>'Black Bottom',
    trimmed='BRD'=>'Diving Board',
    trimmed='CB'=>'Cabana',
    trimmed='CD'=>'Cool Deck',
    trimmed='CH'=>'Child safety fence',
    trimmed='CHL'=>'Auto Chlorinator',
    trimmed='CP'=>'Community Pool',
    trimmed='CY'=>'Courtyard Pool',
    trimmed='DB'=>'Diamond Brite',
    trimmed='DD'=>'Spa - Private',
    trimmed='DF'=>'Spa - Heated',
    trimmed='DI'=>'Spa - Above Ground',
    trimmed='DJ'=>'Spa',
    trimmed='DOM'=>'Domed',
    trimmed='DV'=>'Diving',
    trimmed='E9'=>'Pool Bath',
    trimmed='EL'=>'Electric',
    trimmed='EN'=>'Enclosed',
    trimmed='EP'=>'Permits',
    trimmed='EXR'=>'Exercise Pool',
    trimmed='FAL'=>'Waterfall',
    trimmed='FE'=>'Liner',
    trimmed='FG'=>'Fiberglass',
    trimmed='FHT'=>'Heated And Filtered',
    trimmed='FIL'=>'Filtered Only (No Heat)',
    trimmed='FOU'=>'Fountain',
    trimmed='FT'=>'Filtered',
    trimmed='GAT'=>'Safety Gate',
    trimmed='GH'=>'Gas Heated',
    trimmed='GI'=>'Gunite',
    trimmed='HP'=>'Heat Pump',
    trimmed='HT'=>'Heated',
    trimmed='ID'=>'Indoor',
    trimmed='IG'=>'In-ground',
    trimmed='JP'=>'Jet Pool',
    trimmed='L7'=>'Slide',
    trimmed='LH'=>'Chlorine',
    trimmed='LIN'=>'Liner',
    trimmed='LP'=>'Lap',
    trimmed='MB'=>'Possible Pool Site',
    trimmed='MG'=>'Salt Water System',
    trimmed='NC'=>'Screen Enclosed',
    trimmed='NEG'=>'Negative Edge/Infinity Pool',
    trimmed='NH'=>'No Heat',
    trimmed='NO'=>'No Pool',
    trimmed='NP'=>'No Permits',
    trimmed='OT'=>'Other',
    trimmed='PAS'=>'Space Heat Passive',
    trimmed='PC'=>'Pool Cover',
    trimmed='PD'=>'Polly Pebble Deck',
    trimmed='PO1'=>'Pool Heat - Propane',
    trimmed='PP'=>'Pool Sweep',
    trimmed='PV'=>'Private',
    trimmed='Q1'=>'Diving Board',
    trimmed='ROD'=>'Rooftop Swimming Pool',
    trimmed='RR'=>'River Rock Deck',
    trimmed='RS'=>'Sport',
    trimmed='SC'=>'Solar Cover',
    trimmed='SJ'=>'Saltwater',
    trimmed='SLD'=>'Water Slide',
    trimmed='SO'=>'Solar heated',
    trimmed='SOC'=>'Solar Cover',
    trimmed='SP'=>'Combo Spa/Pool',
    trimmed='SW'=>'Swimming pool',
    trimmed='SZ'=>'Exercise',
    trimmed='TI'=>'Tiled',
    trimmed='VN'=>'Vinyl',
    trimmed='WU'=>'Infinity Edge',
    trimmed='YN'=>'Child Fence',
    trimmed='YO'=>'Concrete',
    trimmed='YP'=>'Equipment Included',
    trimmed='YQ'=>'Auto Cleaner',
    trimmed='YR'=>'Spa/Hot Tub',
    trimmed='YS'=>'Bath',
    trimmed='YT'=>'Caged',
    trimmed='POOL:0'=>'None'   ,
    
    inrow);
        
    return cleaned;
end;

export  MLS_PROP_STYLE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0E'=>'Neo Classical',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='0I'=>'Florida Cottage',
    trimmed='0J'=>'Mission',
    trimmed='1B'=>'Unit Type - 1 bedroom',
    trimmed='1F'=>'First Floor Multi Story',
    trimmed='1S'=>'One Story',
    trimmed='1T'=>'Pueblo',
    trimmed='2A'=>'Rock',
    trimmed='2B'=>'Unit Type - 2 bedroom',
    trimmed='2E'=>'Mobile/Land',
    trimmed='2F'=>'Second Floor Multi Story',
    trimmed='2S'=>'Two Story ',
    trimmed='2T'=>'Manufactured Housing',
    trimmed='2V'=>'Over Storefront',
    trimmed='31'=>'Raised Rambler',
    trimmed='33'=>'Architecture-Other',
    trimmed='3A'=>'Mobile/Single',
    trimmed='3B'=>'Unit Type - 3 bedroom',
    trimmed='3F'=>'Third Floor Multi Story',
    trimmed='3S'=>'Three Story',
    trimmed='3Z'=>'Macgregor',
    trimmed='4K'=>'Creole',
    trimmed='4O'=>'Mobile/Doublewide',
    trimmed='4W'=>'Single Building',
    trimmed='4Y'=>'Walkout Cape Cod',
    trimmed='5D'=>'Semi Attached',
    trimmed='66'=>'New Orleans',
    trimmed='68'=>'International',
    trimmed='6H'=>'String',
    trimmed='6R'=>'Rehab Needed',
    trimmed='7C'=>'Log Cabin',
    trimmed='7I'=>'Add On Manufact/Mobile',
    trimmed='80'=>'Barn Type',
    trimmed='82'=>'Santa Barara',
    trimmed='89'=>'Mansard',
    trimmed='8L'=>'Round',
    trimmed='95'=>'Acadian',
    trimmed='9D'=>'Dwelling W/Rental',
    trimmed='9L'=>'Dallas',
    trimmed='9O'=>'None',
    trimmed='A3'=>'Reverse 1.5 Story',
    trimmed='A9'=>'Affixed Mobile Home',
    trimmed='AD'=>'Capecod',
    trimmed='AE'=>'Marina',
    trimmed='AI'=>'Ranch',
    trimmed='AJ'=>'Contemporary',
    trimmed='AL'=>'Agricultural land',
    trimmed='AM'=>'Hacienda',
    trimmed='AO'=>'Manor/Village',
    trimmed='AP'=>'Apartment',
    trimmed='AQ'=>'Tudor',
    trimmed='AR'=>'Atrium Split',
    trimmed='ARC'=>'Architectural',
    trimmed='ART'=>'Art Deco',
    trimmed='AS'=>'American 4 Square',
    trimmed='AT'=>'Antique',
    trimmed='AW'=>'Expando',
    trimmed='B0'=>'Under Construction',
    trimmed='B1'=>'Attached Villa',
    trimmed='B2'=>'Proposed Construction',
    trimmed='B3'=>'Detached Villa',
    trimmed='B4'=>'Mobile Home',
    trimmed='B5'=>'Townhouse',
    trimmed='B6'=>'Midrise',
    trimmed='B7'=>'Highrise',
    trimmed='B8'=>'Garden Apartment',
    trimmed='B9'=>'Boat Slip',
    trimmed='BAR'=>'Santa Barbara',
    trimmed='BC'=>'Manufactured',
    trimmed='BD'=>'Edwardian',
    trimmed='BDT'=>'Barn Type',
    trimmed='BEA'=>'Beaux Arts',
    trimmed='BL'=>'Bungalow',
    trimmed='BM'=>'Bermuda',
    trimmed='BS'=>'Brownstone',
    trimmed='BSH'=>'Brown Shingle',
    trimmed='BX'=>'2-3-4 Plex',
    trimmed='C9'=>'Territorial',
    trimmed='CA'=>'Cabin',
    trimmed='CB'=>'Camelback',
    trimmed='CBN'=>'Calif Bungalow',
    trimmed='CE'=>'Trinity',
    trimmed='CF'=>'Craftsman',
    trimmed='CFT'=>'Arts And Crafts',
    trimmed='CG'=>'Pre-Fabricated',
    trimmed='CH'=>'Carriage House',
    trimmed='CL'=>'Chalet',
    trimmed='CO'=>'Condominium',
    trimmed='CP'=>'Coop condominium',
    trimmed='CR'=>'Cluster',
    trimmed='CS'=>'California Split',
    trimmed='CT'=>'Cottage',
    trimmed='CU'=>'Country style',
    trimmed='CY'=>'Colonial',
    trimmed='D0'=>'Proposed Construction',
    trimmed='D2'=>'Mediterranean',
    trimmed='D3'=>'Fourplex',
    trimmed='D7'=>'Maintenance Free',
    trimmed='D8'=>'Modular Home',
    trimmed='D9'=>'Under Construction',
    trimmed='DC'=>'Dutch Colonial',
    trimmed='DE'=>'Free Standing/Detached',
    trimmed='DM'=>'Dome',
    trimmed='DT'=>'Detached',
    trimmed='DU'=>'Duplex',
    trimmed='DW'=>'Double-wide',
    trimmed='E1'=>'Residential Land',
    trimmed='E2'=>'Residential Acreage',
    trimmed='E3'=>'Other',
    trimmed='E4'=>'Multi-Family',
    trimmed='E5'=>'Commercial',
    trimmed='E9'=>'Single Family',
    trimmed='EA'=>'Earth Contact',
    trimmed='EC'=>'European',
    trimmed='EDW'=>'Edwardian',
    trimmed='EG'=>'Post Modern',
    trimmed='EL'=>'English',
    trimmed='EQ'=>'Earth Home',
    trimmed='EU'=>'End Unit',
    trimmed='EV'=>'Elevator',
    trimmed='EX'=>'Rooming House',
    trimmed='F0'=>'Business',
    trimmed='F2'=>'Efficiency',
    trimmed='F4'=>'Retail',
    trimmed='F5'=>'Business Opportunity',
    trimmed='F6'=>'Office',
    trimmed='F7'=>'Industrial',
    trimmed='F8'=>'Multi-Family',
    trimmed='F9'=>'Land',
    trimmed='FB'=>'Redwood/Glass',
    trimmed='FE'=>'Federal',
    trimmed='FF'=>'Stick Built',
    trimmed='FH'=>'Farmhouse',
    trimmed='FN'=>'French Normandy',
    trimmed='FP'=>'French Provincial',
    trimmed='FS'=>'Front/Back Split',
    trimmed='FW'=>'Beaux Arts',
    trimmed='FZ'=>'Reverse',
    trimmed='G0'=>'Split Level',
    trimmed='G1'=>'Office Building',
    trimmed='G6'=>'Manuf. Single Wide',
    trimmed='G7'=>'Manuf. Triple Wide',
    trimmed='GA'=>'Garrison',
    trimmed='GB'=>'Gambrel/Dutch',
    trimmed='GD'=>'Garden Down',
    trimmed='Gem'=>'Twin Home/Gemini',
    trimmed='GF'=>'Ground Floor',
    trimmed='GG'=>'Georgian',
    trimmed='GK'=>'Condo',
    trimmed='GM'=>'French Country',
    trimmed='GR'=>'Greek',
    trimmed='GS'=>'Greystone',
    trimmed='GU'=>'Garden Up',
    trimmed='GW'=>'Raised 1.5 Story',
    trimmed='H2'=>'Patio Home',
    trimmed='H3'=>'Florida Style',
    trimmed='H4'=>'Pre Construction',
    trimmed='H5'=>'Under Construction',
    trimmed='H6'=>'A-Frame',
    trimmed='HC'=>'Hunting Camp',
    trimmed='HR'=>'House and Rental',
    trimmed='HS'=>'Historic',
    trimmed='HT'=>'Modern/Hi-Tech',
    trimmed='I1'=>'Earth Berm',
    trimmed='I4'=>'Manuf. Double Wide',
    trimmed='IF'=>'Inverted Floor Plan',
    trimmed='JJ'=>'Valley Manor House',
    trimmed='K6'=>'Coastal',
    trimmed='K9'=>'Garden',
    trimmed='L7'=>'Manufactured/Doublewide',
    trimmed='LF'=>'Loft',
    trimmed='LG'=>'Log',
    trimmed='LI'=>'Link',
    trimmed='LJ'=>'Other - See Remarks',
    trimmed='LR'=>'Low-Rise 6-',
    trimmed='M5'=>'Five or more family',
    trimmed='M9'=>'Texas Hill Country',
    trimmed='MA'=>'Mansion',
    trimmed='MAC'=>'Macgregor',
    trimmed='MAR'=>'Marina',
    trimmed='MC'=>'Monterey Colonial',
    trimmed='MD'=>'Manufactured with Deed',
    trimmed='ML'=>'Multi-Level',
    trimmed='MN'=>'Mobile/No Land',
    trimmed='MO'=>'Modified Single Wide',
    trimmed='MP'=>'Morrish/Mooresque',
    trimmed='MQ'=>'Garden 1-4 Floors',
    trimmed='MZ'=>'Houseboat',
    trimmed='NC'=>'Non-Conforming',
    trimmed='NE'=>'Yurt',
    trimmed='NF'=>'New England',
    trimmed='NL'=>'Beach House',
    trimmed='NN'=>'Dutch Provincial',
    trimmed='NO'=>'Normandy',
    trimmed='NP'=>'Converted Barn',
    trimmed='NS'=>'Vintage',
    trimmed='NZ'=>'No unit above or below',
    trimmed='O2'=>'Art Deco',
    trimmed='O4'=>'Caribbean',
    trimmed='O8'=>'Loft With Bedrooms',
    trimmed='OB'=>'Spanish',
    trimmed='OC'=>'L-Shaped',
    trimmed='OL'=>'Mobile',
    trimmed='OP'=>'Open Plan',
    trimmed='OS'=>'Other Style',
    trimmed='P7'=>'Solar Home',
    trimmed='P9'=>'Low-Rise',
    trimmed='PAT'=>'Patio Home',
    trimmed='PBE'=>'Post & Beam',
    trimmed='PDF'=>'Adobe',
    trimmed='PF'=>'Airlite',
    trimmed='PMD'=>'Post Modern',
    trimmed='PNT'=>'Penthouse',
    trimmed='PR'=>'Prairie',
    trimmed='PRJ'=>'New Project',
    trimmed='PUE'=>'Pueblo',
    trimmed='PY'=>'Penthouse',
    trimmed='Q6'=>'High Cube',
    trimmed='QB'=>'Brown Shingle',
    trimmed='QD'=>'Quad Wide',
    trimmed='QE'=>'Twin Home/Gemini',
    trimmed='QI'=>'Courtyard',
    trimmed='QJ'=>'Custom',
    trimmed='QL'=>'Quad Level',
    trimmed='QM'=>'Elevated',
    trimmed='QN'=>'Handyman',
    trimmed='QP'=>'Key West',
    trimmed='QR'=>'Maintenance Free',
    trimmed='QV'=>'Spanish/Mediterranean',
    trimmed='QW'=>'Villa',
    trimmed='QX'=>'Quadruplex',
    trimmed='R5'=>'Early American',
    trimmed='RA'=>'Rancher/Rambler',
    trimmed='RB'=>'High-Rise',
    trimmed='RGL'=>'Redwood/Glass',
    trimmed='RR'=>'Raised Ranch',
    trimmed='RT'=>'Row Townhouse',
    trimmed='RU'=>'Rustic',
    trimmed='S7'=>'Straight Thru',
    trimmed='SB'=>'Salt Box',
    trimmed='SC'=>'Southern Colonial',
    trimmed='SCL'=>'Spanish Colonial',
    trimmed='SD'=>'Studio/efficiency',
    trimmed='SE'=>'Santa Fe',
    trimmed='SF'=>'Split Foyer',
    trimmed='SG'=>'Single',
    trimmed='SH'=>'Split House',
    trimmed='SL'=>'Solar',
    trimmed='SM'=>'Semi-Detached',
    trimmed='SN'=>'Southwestern',
    trimmed='SO'=>'Shotgun',
    trimmed='SP'=>'Side/Side Split',
    trimmed='SPA'=>'Spanish',
    trimmed='SS'=>'Side/Side',
    trimmed='ST'=>'Stilt House',
    trimmed='ST1'=>'Garden Condo',
    trimmed='ST2'=>'Garden Home',
    trimmed='ST3'=>'Monterey/Hacienda/Adobe',
    trimmed='ST4'=>'Other',
    trimmed='ST5'=>'Tudor/French Normandy',
    trimmed='ST6'=>'Patio/Garden',
    trimmed='ST7'=>'Mission',
    trimmed='ST8'=>'Morrish/Mooresque',
    trimmed='ST9'=>'Neo Classical',
    trimmed='STR'=>'String',
    trimmed='SU'=>'Summer Home',
    trimmed='SW'=>'Single-wide',
    trimmed='SY'=>'Split Entry',
    trimmed='T3'=>'Bed & Breakfast',
    trimmed='TC'=>'Tuscan',
    trimmed='TCS'=>'Torca Condo Style',
    trimmed='TD'=>'Provincial',
    trimmed='TER'=>'Territorial',
    trimmed='TL'=>'Tri level',
    trimmed='TR'=>'Transitional',
    trimmed='TS'=>'Time share',
    trimmed='TW'=>'Triple Wide',
    trimmed='TWG'=>'Twin Home/Gemini',
    trimmed='TX'=>'Triplex',
    trimmed='TZ'=>'Traditional',
    trimmed='U5'=>'Garage/Park Space',
    trimmed='UD'=>'Up/Down',
    trimmed='UL'=>'Converted Dwelling',
    trimmed='UNK'=>'Unknown',
    trimmed='UV'=>'New England',
    trimmed='V2'=>'Tear Down',
    trimmed='VA'=>'Back-To-Back',
    trimmed='VC'=>'Golf',
    trimmed='VH'=>'Vacation Home',
    trimmed='VIN'=>'Vintage',
    trimmed='VT'=>'Victorian',
    trimmed='W0'=>'Arts And Crafts',
    trimmed='WE'=>'Western',
    trimmed='WI'=>'Williamsburg',
    trimmed='WU'=>'Walk-Up',
    trimmed='XA'=>'Dutch',
    trimmed='XE'=>'U-Shaped',
    trimmed='XK'=>'Dutch Queen Anne',
    trimmed='XN'=>'Unit/Flat',
    trimmed='XS'=>'Antebellum',
    trimmed='Y5'=>'Bilonial',
    trimmed='YF'=>'Mid Century',
    trimmed='YRT'=>'Yurt',
    trimmed='Z6'=>'Post & Beam',
    trimmed='ZM'=>'Pre-Civil War',
    trimmed='ZX'=>'Rambler',
    
    inrow);
        
    return cleaned;
end;

export  MLS_FIREPLACE_TYPE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='6'=>'Second Level',
    std.str.find(inrow,'N/K',1)<>0=>'None',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    std.str.find(inrow,'NON ',1)<>0=>'None',
    trimmed='7'=>'One Prefab',
    trimmed='0P'=>'Woodburning',
    trimmed='1F'=>'One Fireplace',
    trimmed='29'=>'Third Level',
    trimmed='2P'=>'2 or More Fireplaces',
    trimmed='2R'=>'Gas Stove',
    trimmed='3G'=>'Coal',
    trimmed='3N'=>'Outside Fireplace',
    trimmed='3P'=>'See Property Description Remarks',
    trimmed='3QH'=>'Bath',
    trimmed='4E'=>'Den/Library',
    trimmed='4V'=>'Air Circulating',
    trimmed='80'=>'First Level',
    trimmed='86'=>'Vented Sealed Fireplace',
    trimmed='8T'=>'In Other Room',
    trimmed='AB'=>'See-Through Fireplace',
    trimmed='AO'=>'Main Level',
    trimmed='BA'=>'Basement',
    trimmed='BD'=>'Bedroom',
    trimmed='BI'=>'Built In',
    trimmed='BL'=>'Blower',
    trimmed='BR'=>'Bonus Room',
    trimmed='C3'=>'Four',
    trimmed='C6'=>'Upper Level',
    trimmed='CE'=>'Ceramic',
    trimmed='CJ'=>'In Keeping Room',
    trimmed='CL'=>'Cultured',
    trimmed='CON'=>'Concrete Fireplace',
    trimmed='CR'=>'Circular',
    trimmed='CU'=>'Custom',
    trimmed='D0'=>'Pre-Fab',
    trimmed='DE'=>'Decorative',
    trimmed='DN'=>'Den',
    trimmed='DR'=>'Dining Room',
    trimmed='DS'=>'Double-sided',
    trimmed='EB'=>'Brick',
    trimmed='EG'=>'Electric Log',
    trimmed='EL'=>'Electric',
    trimmed='ET'=>'Direct Vent',
    trimmed='EW'=>'Not Functional',
    trimmed='FAN'=>'Blower Fan',
    trimmed='FB'=>'Factory Built',
    trimmed='FF'=>'Fireplace',
    trimmed='FG'=>'Fireplace Glass Door',
    trimmed='FL'=>'Family & Living Room',
    trimmed='FN'=>'Natural',
    trimmed='FO'=>'Fireplace Footing',
    trimmed='FP'=>'Fire Pit',
    trimmed='FR'=>'Family Room',
    trimmed='FS'=>'Fireplace Screen',
    trimmed='FU'=>'Library',
    trimmed='FV'=>'Rec Room Fireplace',
    trimmed='FY'=>'Foyer',
    trimmed='FZ'=>'Freestanding',
    trimmed='GAM'=>'Game Room',
    trimmed='GB'=>'Gas Burning',
    trimmed='GJ'=>'Mock Fireplace',
    trimmed='GL'=>'Gas logs',
    trimmed='GN'=>'Rec/Rumpus Room',
    trimmed='GP'=>'Gas lighter/pipe',
    trimmed='GR'=>'Great Room',
    trimmed='GS'=>'Gas Starter',
    trimmed='GST'=>'Guest House',
    trimmed='GW'=>'Sun Room',
    trimmed='HL'=>'Heatilator',
    trimmed='HR'=>'Hearth Room',
    trimmed='HX'=>'Stove',
    trimmed='IF'=>'Includes Accessories',
    trimmed='IO'=>'Inoperable',
    trimmed='IS'=>'Insert',
    trimmed='J2'=>'Lower Level',
    trimmed='JQ'=>'Non-Wood Burning',
    trimmed='KT'=>'Kitchen',
    trimmed='KU'=>'Flue',
    trimmed='LD'=>'Bedroom Fireplace',
    trimmed='LIB'=>'Library',
    trimmed='LM'=>'Living & Master Bedroom',
    trimmed='LR'=>'Living Room',
    trimmed='MA'=>'Masonry',
    trimmed='MB'=>'Master Bedroom',
    trimmed='ME'=>'Master Retreat',
    trimmed='MH'=>'Master Bathroom',
    trimmed='MN'=>'Mantel',
    trimmed='MR'=>'Marble',
    trimmed='MT'=>'Metal',
    trimmed='N5'=>'dual fireplace',
    trimmed='NJ'=>'Prefab',
    trimmed='NO'=>'No Fireplace',
    trimmed='OF'=>'Outdoor Fireplace',
    trimmed='OPT'=>'New Construction Option',
    trimmed='OT'=>'Other Fireplace',
    trimmed='PA'=>'Propane',
    trimmed='PK'=>'Combination',
    trimmed='PL'=>'Playroom',
    trimmed='PS'=>'Pellet Stove',
    trimmed='Q8'=>'Den Fireplace',
    trimmed='QF'=>'Natural Fireplace',
    trimmed='RH'=>'Raised Hearth',
    trimmed='RO'=>'Rock',
    trimmed='RR'=>'Recreation Room',
    trimmed='SD'=>'Study',
    trimmed='SLA'=>'Slate',
    trimmed='ST'=>'Stone',
    trimmed='T4'=>'Wood/Coal Stove',
    trimmed='TI'=>'Tile',
    trimmed='TW'=>'Two-Way',
    trimmed='UD'=>'Fan',
    trimmed='UM'=>'Loft',
    trimmed='V3'=>'Two Prefab',
    trimmed='V5'=>'Media Room',
    trimmed='VL'=>'Ventless',
    trimmed='WF'=>'Wood Framed',
    trimmed='WN'=>'Wood-burning',
    trimmed='WS'=>'Wood Stove',
    trimmed='Y2Q'=>'Gas & Wood',
    trimmed='Y3'=>'See Through',
    trimmed='YP'=>'Stove Insert',
    trimmed='Z8'=>'Artificial Faced',
    trimmed='ZC'=>'Zero Clearance',
    
    inrow);
        
    return cleaned;
end;


export  MLS_CONSTRUCTION_TYPE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='0Y'=>'Brick/Stone',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='11'=>'Concrete Block With Brick',
    trimmed='33'=>'Recycled/Renewable Materials/Resources Used',
    trimmed='38'=>'Steel Joists',
    trimmed='3C'=>'Stone/Wood',
    trimmed='3D'=>'Concrete/Steel',
    trimmed='3F'=>'Steel And Glass',
    trimmed='3G'=>'Stone/Vinyl',
    trimmed='3Q'=>'Pre-Engineered',
    trimmed='3X'=>'Mobile W/Stick Addit',
    trimmed='4E'=>'Bar Joists',
    trimmed='4M'=>'3 Sides Masonry',
    trimmed='4Y'=>'Advanced Framing System',
    trimmed='6F'=>'Shingles',
    trimmed='6G'=>'Manufactured/Singlewide',
    trimmed='7V'=>'Leed-Gold',
    trimmed='8M'=>'Heavy Load',
    trimmed='8T'=>'Batt Insulation',
    trimmed='9E'=>'Imitation Stone',
    trimmed='AA'=>'Aluminum/Asbestos',
    trimmed='AB'=>'Asbestos',
    trimmed='AD'=>'Adobe',
    trimmed='AG'=>'Above Ground',
    trimmed='ALC'=>'Alcan',
    trimmed='AP'=>'Asphalt',
    trimmed='AS'=>'Aluminum Siding',
    trimmed='AV'=>'Aluminum/Vinyl',
    trimmed='AX'=>'Straw Bale',
    trimmed='B9'=>'Stick Built',
    trimmed='BA'=>'Brick/Aluminum',
    trimmed='BB'=>'Board/Baten',
    trimmed='BC'=>'Brick/Cedar',
    trimmed='BE'=>'Brick Accent',
    trimmed='BF'=>'Brick Front',
    trimmed='BI'=>'Brick Imitation',
    trimmed='BK'=>'Brick',
    trimmed='BL'=>'Block',
    trimmed='BN'=>'Brick-Norwegian ',
    trimmed='BO'=>'Brick/Asbestos',
    trimmed='BR'=>'Brick/Frame',
    trimmed='BS'=>'Brick & Wood Siding',
    trimmed='BT'=>'Brick Trim',
    trimmed='BU'=>'Brick/Stucco',
    trimmed='BV'=>'Brick Veneer',
    trimmed='BW'=>'Brick/Wood',
    trimmed='BY'=>'Brick/Vinyl',
    trimmed='CB'=>'Concrete Block Stucco',
    trimmed='CBN'=>'Combination',
    trimmed='CC'=>'CC Perimeter',
    trimmed='CD'=>'Cedar Exterior',
    trimmed='CDS'=>'Cedar Siding',
    trimmed='CE'=>'Concrete',
    trimmed='CF'=>'Fiber Cement Siding',
    trimmed='CH'=>'Composite Shingle',
    trimmed='CI'=>'Pole Bldg',
    trimmed='CL'=>'Cinder Block',
    trimmed='CM'=>'Construction Complete',
    trimmed='CO'=>'Concrete Siding',
    trimmed='CO1'=>'Built on Site',
    trimmed='CP'=>'Clapboard',
    trimmed='CPN'=>'Composition',
    trimmed='CS'=>'Concrete Block/Spraycrete',
    trimmed='D3'=>'Framed On Lot',
    trimmed='DG'=>'Tabby',
    trimmed='DR'=>'Dryvit',
    trimmed='DU'=>'Solar Thermal Evacuated Tubes',
    trimmed='DW'=>'Double Wall',
    trimmed='E3'=>'Siding-Asbestos',
    trimmed='EA'=>'Earth Sheltered',
    trimmed='ED'=>'Leed-Platinum',
    trimmed='EI'=>'Exterior Insulation Finish Sys',
    trimmed='EJ'=>'Exterior Rock',
    trimmed='EM'=>'Elevated Construction',
    trimmed='EQ'=>'Exterior Stucco',
    trimmed='ET'=>'Stone/Rock',
    trimmed='F0'=>'Unknown-Btv',
    trimmed='F2'=>'Mobile/Doublewide',
    trimmed='FC'=>'Full Copper Plumbing',
    trimmed='FD'=>'Thermal Mass Construction',
    trimmed='FG'=>'Flagstone',
    trimmed='FI'=>'Fiberglass',
    trimmed='FO'=>'Construction: 5 years or less',
    trimmed='FR'=>'Frame',
    trimmed='FRS'=>'Freestanding',
    trimmed='FY'=>'Construction: 5-10 Years',
    trimmed='GA'=>'Skirting - Aluminum',
    trimmed='GB'=>'Skirting - Block',
    trimmed='GC'=>'New Construction',
    trimmed='GF'=>'Skirting - Fiberglass',
    trimmed='GL'=>'Glass',
    trimmed='GO'=>'Skirting - Wood Products',
    trimmed='GP'=>'Wood-Lap',
    trimmed='GR'=>'Skirting - Brick',
    trimmed='GW'=>'Skirting - Wood',
    trimmed='HB'=>'Hardboard',
    trimmed='HG'=>'Hardwood Flooring',
    trimmed='HP'=>'Hardi Plank',
    trimmed='HR'=>'Stone/Aluminum',
    trimmed='HT'=>'Hollow Tile',
    trimmed='I1'=>'Structured Insulation Panels',
    trimmed='IB'=>'InsulBrick',
    trimmed='IF'=>'2 Sides Masonry',
    trimmed='IH'=>'Energy Recovery Ventilation',
    trimmed='IW'=>'Manufactured/Doublewide',
    trimmed='IZ'=>'Cement Fiber',
    trimmed='J3'=>'Light Weight Concrete',
    trimmed='J6'=>'Existing Structure',
    trimmed='J7'=>'Mobile/Singlewide',
    trimmed='JR'=>'Brickote',
    trimmed='JU'=>'Brick And Stone',
    trimmed='JW'=>'Leed-Silver',
    trimmed='L3'=>'Cement Coated',
    trimmed='LG'=>'Log',
    trimmed='LGS'=>'Log Siding',
    trimmed='LP'=>'Lap',
    trimmed='LV'=>'Cellulose Insulation',
    trimmed='LW'=>'Solar Thermal Water Heating',
    trimmed='M1'=>'Factory Built',
    trimmed='MA'=>'Mason',
    trimmed='MA1'=>'Masonry on 1 Side',
    trimmed='MA2'=>'Masonry on 2 Sides',
    trimmed='MA3'=>'Masonry on 3 Sides',
    trimmed='MA4'=>'Masonry on All Sides',
    trimmed='MAS'=>'Masonite',
    trimmed='MB'=>'Mobile Home',
    trimmed='MC'=>'Masonite - Color Lock',
    trimmed='MM'=>'Manufactured/Modular',
    trimmed='MR'=>'Plywood Siding',
    trimmed='MT'=>'Metal',
    trimmed='MX'=>'Mixed',
    trimmed='NA'=>'Needs Repair',
    trimmed='NL'=>'Construction: Never Lived In',
    trimmed='O0'=>'Nahb Green-Gold',
    trimmed='OD'=>'Structural Insulated Pane',
    trimmed='OG'=>'Built Off the Ground',
    trimmed='OS'=>'Other Siding',
    trimmed='OT'=>'Other Construction',
    trimmed='P0'=>'Metal/Vinyl',
    trimmed='PB'=>'Post and Beam',
    trimmed='PCP'=>'Partial Copper Plumbing',
    trimmed='PE'=>'Piers',
    trimmed='PF'=>'Prefab',
    trimmed='PI'=>'Plaster',
    trimmed='PL'=>'Piling',
    trimmed='PO'=>'Press Board Siding',
    trimmed='PP'=>'Construction Proposed',
    trimmed='PS'=>'Precast Stone',
    trimmed='PT'=>'Combination',
    trimmed='Q2'=>'Unknown - Btv',
    trimmed='QA'=>'No Real Property',
    trimmed='QT'=>'Insulated Concrete Forms',
    trimmed='QY'=>'Spray Foam Insulation',
    trimmed='R5'=>'Wood Shingle',
    trimmed='R7'=>'Permastone',
    trimmed='RA'=>'Rough Sawn Siding',
    trimmed='RE'=>'Reinforced Concrete',
    trimmed='RO'=>'Rock',
    trimmed='RS'=>'Redwood Siding',
    trimmed='RU'=>'Polystyrene',
    trimmed='S1'=>'Single Wall',
    trimmed='S2'=>'Stone Siding',
    trimmed='S3'=>'Stucco Siding',
    trimmed='S4'=>'Synthetic Stucco Siding',
    trimmed='SA'=>'Stucco Real',
    trimmed='SB'=>'Stilt',
    trimmed='SBK'=>'Slump Block',
    trimmed='SC'=>'Spraycrete',
    trimmed='SD'=>'Stucco - Hard Coat',
    trimmed='SE'=>'Steel Frame',
    trimmed='SF'=>'Stucco/Frame',
    trimmed='SG'=>'Shake',
    trimmed='SH'=>'Shingle',
    trimmed='SI'=>'Siding',
    trimmed='SL'=>'Slab',
    trimmed='SM'=>'Stone Trim',
    trimmed='SN'=>'Stone',
    trimmed='SR'=>'Stone and Frame',
    trimmed='SS'=>'Stucco EIFS',
    trimmed='ST'=>'Stucco',
    trimmed='STR'=>'Straw Bale',
    trimmed='SU'=>'Site Built',
    trimmed='SV'=>'Stone Veneer',
    trimmed='SW'=>'Stem Wall',
    trimmed='SY'=>'Stucco - Synthetic',
    trimmed='SZ'=>'Slate',
    trimmed='TE'=>'Insulation Foam In Place',
    trimmed='TG'=>'To Be Built',
    trimmed='TR'=>'Foam',
    trimmed='TS'=>'T111 Siding',
    trimmed='TU'=>'Tilt-Up',
    trimmed='UC'=>'Under Construction',
    trimmed='UG'=>'Underground',
    trimmed='UH'=>'1 Side Masonry',
    trimmed='UN'=>'Unreinforced Masonry',
    trimmed='UNK'=>'Unknown',
    trimmed='V4'=>'Relocated',
    trimmed='V9'=>'Concrete Based Siding',
    trimmed='VE'=>'No-Maintenance Trim',
    trimmed='VEN'=>'Veneer',
    trimmed='VI'=>'Modular',
    trimmed='VO'=>'Nahb Green-Bronze',
    trimmed='VS'=>'Vinyl Siding',
    trimmed='VTL'=>'Vertical Siding',
    trimmed='VY'=>'Vinyl',
    trimmed='WA'=>'Wood/Composition',
    trimmed='WD'=>'Wood',
    trimmed='WS'=>'Wood Siding',
    trimmed='WT'=>'Wood/Stucco',
    trimmed='WZ'=>'Hud Standard Manufactured',
    trimmed='X7H'=>'Energy Efficient',
    trimmed='XE'=>'Never Occupied',
    trimmed='XF'=>'4 Sides Masonry',
    trimmed='XP'=>'Concrete Block',
    trimmed='XQ'=>'Steel',
    trimmed='XQS'=>'Steel Siding',
    trimmed='XR'=>'Stucco Over Frame',
    trimmed='XS'=>'Brick Exterior',
    trimmed='XT'=>'Precast Concrete',
    trimmed='XU'=>'Poured Concrete',
    trimmed='XV'=>'Wood Frame',
    trimmed='Y5R'=>'Full Copper Plumbing',
    trimmed='YB'=>'Wood Based Siding',
    trimmed='YI'=>'Pre-Stress',
    trimmed='YL'=>'Common Wall',
    trimmed='YW'=>'Blown-In Insulation',
    trimmed='Z2'=>'Insulation Blown',
    trimmed='Z4'=>'Nahb Green-Silver',
    trimmed='ZM'=>'Cement Plank',
    std.str.find(inrow,'CBS',1)<>0=>'CONCRETE BLOCK/STUCCO',
    
    inrow);
        
    return cleaned;
end;


export  MLS_FOUNDATION_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='1'=>'Treated Posts',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='1I'=>'Stacked Block',
    trimmed='1K'=>'Post Tension Slab',
    trimmed='69'=>'Insulated Concrete',
    trimmed='86'=>'Not Applicable',
    trimmed='8VK'=>'Foundation - Quake Bracing',
    trimmed='99Y'=>'Foundation - Other',
    trimmed='AH'=>'Anchor and Hitch',
    trimmed='AS'=>'Partial',
    trimmed='BL'=>'Block',
    trimmed='BM'=>'Brick/Mortar',
    trimmed='BO'=>'Brick Over Foundation',
    trimmed='BR'=>'Brick',
    trimmed='C5'=>'Post And Pier',
    trimmed='CA'=>'Conventional',
    trimmed='CB'=>'Concrete Block',
    trimmed='CBF'=>'Capped Brick',
    trimmed='CG'=>'Concrete Grid',
    trimmed='CO'=>'Combo',
    trimmed='CP'=>'Concrete Perimeter',
    trimmed='CS'=>'Crawl Space',
    trimmed='CV'=>'Vapor Barrier',
    trimmed='EC'=>'Metal',
    trimmed='EE'=>'Basement',
    trimmed='FHA'=>'Foundation - FHA Approved',
    trimmed='FJ'=>'Concrete Foundation',
    trimmed='FK'=>'Raised Foundation',
    trimmed='FN'=>'Stringers',
    trimmed='FO'=>'Slab Foundation',
    trimmed='FT'=>'Footing',
    trimmed='HD'=>'Heavy Duty Footings',
    trimmed='HF'=>'Poured Concrete',
    trimmed='IF'=>'Chain Wall',
    trimmed='JAK'=>'Foundation - Pier Jacks',
    trimmed='JR'=>'Pier & Beam',
    trimmed='MO'=>'Masonry',
    trimmed='MP'=>'Masonry Perimeter',
    trimmed='N1'=>'Poured Footer',
    trimmed='NI'=>'Cedar Post',
    trimmed='NON'=>'Foundation - None',
    trimmed='O9'=>'French Drain',
    trimmed='OT'=>'Other',
    trimmed='PE'=>'Perimeter',
    trimmed='PER'=>'Foundation - Permanent',
    trimmed='PI'=>'Pilings',
    trimmed='PO'=>'Pillars/Post',
    trimmed='PP'=>'Post/Pier Foundation',
    trimmed='Q1'=>'None',
    trimmed='QB'=>'Quake Bracing',
    trimmed='QT'=>'Underpinning',
    trimmed='RE'=>'Stone & Rubble',
    trimmed='SK'=>'Skirted',
    trimmed='SL'=>'Sono Tubes',
    trimmed='SO'=>'Stone',
    trimmed='SR'=>'Slab/Raised Foundation',
    trimmed='SU'=>'Foundation Off Grade',
    trimmed='T4'=>'Sump Hole',
    trimmed='TIE'=>'Foundation - Tie Down',
    trimmed='WD'=>'Wood',
    trimmed='YA'=>'Block/Brick Foundation',
    trimmed='Z6'=>'Post Tension',
    
    inrow);
        
    return cleaned;
end;

export  MLS_SEWER_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='10'=>'Betterment',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    trimmed='1D'=>'Sub-Surface',
    trimmed='1N'=>'Community Sewer',
    trimmed='2Z'=>'Water Lateral To Lot',
    trimmed='3B'=>'Leach',
    trimmed='3F'=>'Needs Sewer',
    trimmed='3L'=>'Well Needed',
    trimmed='3Y'=>'Chemical',
    trimmed='41'=>'Shared Sewer',
    trimmed='44'=>'Needs Hook-Up',
    trimmed='4F'=>'Conventional Septic Installed',
    trimmed='52'=>'Sewer Lift',
    trimmed='5Z'=>'Regional Waste System',
    trimmed='67'=>'Lo-Fl Chlorine',
    trimmed='6L'=>'Sewer System',
    trimmed='73'=>'Sewer Lateral To Lot',
    trimmed='82'=>'Sewer-In And Connected',
    trimmed='8O'=>'Sand Mound',
    trimmed='A1'=>'Assessments',
    trimmed='A9'=>'Other Sewer Type',
    trimmed='AB'=>'Abandoned Septic',
    trimmed='AE'=>'Aerator',
    trimmed='AP'=>'Septic Needed',
    trimmed='AS'=>'Association',
    trimmed='AT'=>'Aerobic Treatment Unit',
    trimmed='B1'=>'Bonds',
    trimmed='B9'=>'Drainage Outlet',
    trimmed='BA'=>'Baseline',
    trimmed='BH'=>'Buyer pays hookup fee',
    trimmed='BQ'=>'Cluster',
    trimmed='BU'=>'Serial Distribution',
    trimmed='BV'=>'Waste Water Utility',
    trimmed='C1'=>'Cesspool',
    trimmed='CA'=>'Central Sewer Available',
    trimmed='CF'=>'Cap and Fill Septic',
    trimmed='CS'=>'Central Sewer',
    trimmed='CW'=>'Central Water',
    trimmed='CY'=>'City Sewer',
    trimmed='D1'=>'Drain Field',
    trimmed='D5'=>'Public/City',
    trimmed='DOS'=>'Pressure Dose',
    trimmed='DP'=>'Septic In And Connected',
    trimmed='EP'=>'Effluent Pump',
    trimmed='EVF'=>'Site Evaluation On File',
    trimmed='EW'=>'Existing Well',
    trimmed='F7'=>'City/Public',
    trimmed='GI'=>'Package Plant',
    trimmed='GP'=>'Grinder Pump',
    trimmed='GS'=>'Gravity Septic System',
    trimmed='HM'=>'Hook-up moratorium in effect',
    trimmed='HT'=>'Holding Tank',
    trimmed='I1'=>'In Street on Bond',
    trimmed='I2'=>'In Street Paid',
    trimmed='I3'=>'In, Connected & Paid',
    trimmed='IF'=>'Drainfield',
    trimmed='IT'=>'sewer included in tax',
    trimmed='J6'=>'Town',
    trimmed='JT'=>'Jet Aeration',
    trimmed='JX'=>'Perc Required',
    trimmed='JY'=>'Wetlands',
    trimmed='KX'=>'Sewer-In & Connected',
    trimmed='LG'=>'Lagoon',
    trimmed='LK'=>'Aerobic Septic',
    trimmed='LPP'=>'Low Pressure Pipe (Lpp)',
    trimmed='LS'=>'Lpp Septic',
    trimmed='LZ'=>'Well Restricted Area',
    trimmed='MD'=>'Mound Septic System',
    trimmed='MS'=>'Mini Sewer',
    trimmed='MU'=>'Municipality',
    trimmed='N5'=>'Shallow Placement',
    trimmed='NC'=>'Not Connected',
    trimmed='NM'=>'Within 1000 Feet',
    trimmed='NPT'=>'Not Applied For Permit',
    trimmed='NS'=>'No Sewer',
    trimmed='O1'=>'Out House',
    trimmed='OC'=>'Treatment Plant',
    trimmed='OT'=>'Other',
    trimmed='PA'=>'Pending Sewer Area',
    trimmed='PB'=>'Pending Service Area',
    trimmed='PC'=>'Public Septic System',
    trimmed='PD'=>'Fee Paid',
    trimmed='PE'=>'Peat System',
    trimmed='PL'=>'Public Sewer Available',
    trimmed='PR'=>'Pressure Dose',
    trimmed='PS'=>'Public Sewer',
    trimmed='PT'=>'Pre-Treatment',
    trimmed='QT'=>'Annex Agree Req.',
    trimmed='RA'=>'Aerobic Septic Sys',
    trimmed='S7'=>'Conventional Septic Required',
    trimmed='SA'=>'Sewer-Sanitary',
    trimmed='SB'=>'Septic Applied For Permit',
    trimmed='SC'=>'Sewer Connected',
    trimmed='SD'=>'Septic Permit On File',
    trimmed='SE'=>'Septic',
    trimmed='SF'=>'Sand Filter',
    trimmed='SH'=>'Shared Septic System',
    trimmed='SI'=>'Perc Approved',
    trimmed='SN'=>'Sewer service near by',
    trimmed='SO'=>'Sewer service on-site',
    trimmed='SP'=>'Septic Pump',
    trimmed='SR'=>'Sewer at Street',
    trimmed='SS'=>'Private Sewer System',
    trimmed='ST'=>'Storm Sewer',
    trimmed='SV'=>'Sewer Available',
    trimmed='SY'=>'Septic System Required',
    trimmed='SZ'=>'Needed',
    trimmed='TH'=>'Public Site',
    trimmed='TL'=>'Public Not Lateral',
    trimmed='TPM'=>'Lateral/Tap - Off Main',
    trimmed='TPS'=>'Lateral/Tap - On Site',
    trimmed='U2'=>'Seepage Tank',
    trimmed='UE'=>'Sand Lined Trenches',
    trimmed='UK'=>'Unknown',
    trimmed='UU'=>'Underground',
    trimmed='V0'=>'Standard Trench',
    trimmed='VC'=>'Detention Pond',
    trimmed='VK'=>'Pump Required',
    trimmed='W2'=>'To Lot Line',
    trimmed='WN'=>'Aerobicseptic Sys',
    trimmed='WR'=>'Well Required',
    trimmed='Y1'=>'Stream Discharge',
    trimmed='Y4'=>'Needs Septic',
    trimmed='Y6'=>'Retaining Pond',
    trimmed='YA'=>'Ridge Vent/Turbines',
    trimmed='Z1'=>'Conventional Septic Available',
    trimmed='Z9'=>'Tap-On Avaliable',
    trimmed='ZL'=>'Perc Failed',
    trimmed='ZS'=>'Public Sewer On Property',
    
    inrow);
        
    return cleaned;
end;

export  MLS_PROPERTY_CONDITION_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
    cleaned:=map(std.str.find(inrow,'ABOVE',1)<>0=>'EXCELLENT',
    std.str.find(inrow,'BELOW',1)<>0=>'BELOW AVERAGE'    ,
    std.str.find(inrow,'AVG',1)<>0=>'AVERAGE',
    std.str.find(inrow,'BAV',1)<>0=>'BELOW AVERAGE',
    std.str.find(inrow,'ECO',1)<>0=>'ECONOMICAL',
    std.str.find(inrow,'EXC',1)<>0=>'EXCELLENT',
    std.str.find(inrow,'FAR',1)<>0=>'FAIR'    ,
    std.str.find(inrow,'GDD',1)<>0=>'GOOD' ,
    std.str.find(inrow,'LOW',1)<>0=>'LOW' ,
    std.str.find(inrow,'LUX',1)<>0=>'LUXURY' ,
    std.str.find(inrow,'NON',1)<>0=>'NONE' ,
    std.str.find(inrow,'PRR',1)<>0=>'POOR' ,
    std.str.find(inrow,'UNK',1)<>0=>'TYPE UNKNOWN' ,
    std.str.find(inrow,'MNT',1)<>0=>'EXCELLENT'    ,
    std.str.find(inrow,'MINT',1)<>0=>'EXCELLENT' ,
    std.str.find(inrow,'FIXER',1)<>0=>'POOR'  ,
    std.str.find(inrow,'SUPERIOR',1)<>0=>'EXCELLENT' ,
    
    inrow);
        
    return cleaned;
end;

export  MLS_PROPERTY_TYPE_PREPROCESS(string inrow):=function
trimmed:=trim(inrow,left,right);
cleaned:=map(trimmed='APT'=>'Apartment',
    trimmed='COM'=>'Commercial',
    trimmed='CON'=>'Condominium (RESIDENTIAL)',
    trimmed='COOP'=>'Coop',
    trimmed='DUP'=>'Duplex',
    trimmed='FARM'=>'House with Acreage',
    trimmed='GDN'=>'Garden Home',
    trimmed='LND'=>'Land',
    trimmed='LSE'=>'For Lease/Rent',
    trimmed='MFG'=>'Manufactured Housing',
    trimmed='MOB'=>'Mobile Home',
    trimmed='MOD'=>'Modular Home',
    trimmed='MUL'=>'Multi Family, Triplex, Fourplex',
    trimmed='OTH'=>'Other',
    trimmed='PAT'=>'Patio Home',
    trimmed='PUD'=>'Planned Unit Development, Zero Lot Line, Cluster',
    trimmed='RDUP'=>'Duplex',
    trimmed='RNT'=>'RENTAL PROPERTY',
    trimmed='RQUA'=>'MULTI-FAMILY PROPERTY',
    trimmed='RTRI'=>'MULTI-FAMILY PROPERTY',
    trimmed='SFA'=>'Single Family Attached',
    trimmed='SFD'=>'Single Family Detached',
    trimmed='SFR'=>'Single Family Residential',
    trimmed='TIME'=>'Time Share, Fractional Interest',
    trimmed='TWIN'=>'Twin Home (1/2 of a Duplex)',
    trimmed='TWN'=>'Townhouse',
    trimmed='UNK'=>'Unknown - Most Likely SFD',
    trimmed='VILLA'=>'Villa',
    std.str.find(inrow,'NO ',1)<>0=>'None',
    
    inrow);
        
    return cleaned;
end;

end;