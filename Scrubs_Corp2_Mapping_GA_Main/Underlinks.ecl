// This is a super-sloppy match which is then scored and graded.
// Designed to let you know where the underlinks are lurking
IMPORT SALT34,ut,std;
EXPORT Underlinks(DATASET(layout_in_file) ih,UNSIGNED MatchThreshold = Config.MatchThreshold) := MODULE
SHARED LowerMatchThreshold := MatchThreshold-6; // Consider up to Threshold - 6
SHARED h := match_candidates(ih).candidates;
SHARED s := Specificities(ih).Specificities[1];
 
  dt := debug(ih,s,MatchThreshold).sample_match_join;
  RawResults := matches(ih,MatchThreshold).MAC_DoJoins(h,dt);
EXPORT RRF := RawResults(Conf>=LowerMatchThreshold);
  R := RECORD
    TotalCnt := COUNT(GROUP);
  END;
EXPORT ForceFails := TABLE(RRF,R);
  ds := RRF;
  R := RECORD
    ds;
    SALT34.StrType Summary;
  END;
  R tosummary(ds le) := TRANSFORM
    SELF := le;
    SELF.Summary := IF(le.dt_vendor_first_reported_Score = 0,'','|'+IF(le.dt_vendor_first_reported_Score < 0,'-','')+'dt_vendor_first_reported')+IF(le.dt_vendor_last_reported_Score = 0,'','|'+IF(le.dt_vendor_last_reported_Score < 0,'-','')+'dt_vendor_last_reported')+IF(le.dt_first_seen_Score = 0,'','|'+IF(le.dt_first_seen_Score < 0,'-','')+'dt_first_seen')+IF(le.dt_last_seen_Score = 0,'','|'+IF(le.dt_last_seen_Score < 0,'-','')+'dt_last_seen')+IF(le.corp_ra_dt_first_seen_Score = 0,'','|'+IF(le.corp_ra_dt_first_seen_Score < 0,'-','')+'corp_ra_dt_first_seen')+IF(le.corp_ra_dt_last_seen_Score = 0,'','|'+IF(le.corp_ra_dt_last_seen_Score < 0,'-','')+'corp_ra_dt_last_seen')+IF(le.corp_key_Score = 0,'','|'+IF(le.corp_key_Score < 0,'-','')+'corp_key')+IF(le.corp_supp_key_Score = 0,'','|'+IF(le.corp_supp_key_Score < 0,'-','')+'corp_supp_key')+IF(le.corp_vendor_Score = 0,'','|'+IF(le.corp_vendor_Score < 0,'-','')+'corp_vendor')+IF(le.corp_vendor_county_Score = 0,'','|'+IF(le.corp_vendor_county_Score < 0,'-','')+'corp_vendor_county')+IF(le.corp_vendor_subcode_Score = 0,'','|'+IF(le.corp_vendor_subcode_Score < 0,'-','')+'corp_vendor_subcode')+IF(le.corp_state_origin_Score = 0,'','|'+IF(le.corp_state_origin_Score < 0,'-','')+'corp_state_origin')+IF(le.corp_process_date_Score = 0,'','|'+IF(le.corp_process_date_Score < 0,'-','')+'corp_process_date')+IF(le.corp_orig_sos_charter_nbr_Score = 0,'','|'+IF(le.corp_orig_sos_charter_nbr_Score < 0,'-','')+'corp_orig_sos_charter_nbr')+IF(le.corp_legal_name_Score = 0,'','|'+IF(le.corp_legal_name_Score < 0,'-','')+'corp_legal_name')+IF(le.corp_ln_name_type_cd_Score = 0,'','|'+IF(le.corp_ln_name_type_cd_Score < 0,'-','')+'corp_ln_name_type_cd')+IF(le.corp_ln_name_type_desc_Score = 0,'','|'+IF(le.corp_ln_name_type_desc_Score < 0,'-','')+'corp_ln_name_type_desc')+IF(le.corp_supp_nbr_Score = 0,'','|'+IF(le.corp_supp_nbr_Score < 0,'-','')+'corp_supp_nbr')+IF(le.corp_name_comment_Score = 0,'','|'+IF(le.corp_name_comment_Score < 0,'-','')+'corp_name_comment')+IF(le.corp_address1_type_cd_Score = 0,'','|'+IF(le.corp_address1_type_cd_Score < 0,'-','')+'corp_address1_type_cd')+IF(le.corp_address1_type_desc_Score = 0,'','|'+IF(le.corp_address1_type_desc_Score < 0,'-','')+'corp_address1_type_desc')+IF(le.corp_address1_line1_Score = 0,'','|'+IF(le.corp_address1_line1_Score < 0,'-','')+'corp_address1_line1')+IF(le.corp_address1_line2_Score = 0,'','|'+IF(le.corp_address1_line2_Score < 0,'-','')+'corp_address1_line2')+IF(le.corp_address1_line3_Score = 0,'','|'+IF(le.corp_address1_line3_Score < 0,'-','')+'corp_address1_line3')+IF(le.corp_address1_effective_date_Score = 0,'','|'+IF(le.corp_address1_effective_date_Score < 0,'-','')+'corp_address1_effective_date')+IF(le.corp_address2_type_cd_Score = 0,'','|'+IF(le.corp_address2_type_cd_Score < 0,'-','')+'corp_address2_type_cd')+IF(le.corp_address2_type_desc_Score = 0,'','|'+IF(le.corp_address2_type_desc_Score < 0,'-','')+'corp_address2_type_desc')+IF(le.corp_address2_line1_Score = 0,'','|'+IF(le.corp_address2_line1_Score < 0,'-','')+'corp_address2_line1')+IF(le.corp_address2_line2_Score = 0,'','|'+IF(le.corp_address2_line2_Score < 0,'-','')+'corp_address2_line2')+IF(le.corp_address2_line3_Score = 0,'','|'+IF(le.corp_address2_line3_Score < 0,'-','')+'corp_address2_line3')+IF(le.corp_address2_effective_date_Score = 0,'','|'+IF(le.corp_address2_effective_date_Score < 0,'-','')+'corp_address2_effective_date')+IF(le.corp_phone_number_Score = 0,'','|'+IF(le.corp_phone_number_Score < 0,'-','')+'corp_phone_number')+IF(le.corp_phone_number_type_cd_Score = 0,'','|'+IF(le.corp_phone_number_type_cd_Score < 0,'-','')+'corp_phone_number_type_cd')+IF(le.corp_phone_number_type_desc_Score = 0,'','|'+IF(le.corp_phone_number_type_desc_Score < 0,'-','')+'corp_phone_number_type_desc')+IF(le.corp_fax_nbr_Score = 0,'','|'+IF(le.corp_fax_nbr_Score < 0,'-','')+'corp_fax_nbr')+IF(le.corp_email_address_Score = 0,'','|'+IF(le.corp_email_address_Score < 0,'-','')+'corp_email_address')+IF(le.corp_web_address_Score = 0,'','|'+IF(le.corp_web_address_Score < 0,'-','')+'corp_web_address')+IF(le.corp_filing_reference_nbr_Score = 0,'','|'+IF(le.corp_filing_reference_nbr_Score < 0,'-','')+'corp_filing_reference_nbr')+IF(le.corp_filing_date_Score = 0,'','|'+IF(le.corp_filing_date_Score < 0,'-','')+'corp_filing_date')+IF(le.corp_filing_cd_Score = 0,'','|'+IF(le.corp_filing_cd_Score < 0,'-','')+'corp_filing_cd')+IF(le.corp_filing_desc_Score = 0,'','|'+IF(le.corp_filing_desc_Score < 0,'-','')+'corp_filing_desc')+IF(le.corp_status_cd_Score = 0,'','|'+IF(le.corp_status_cd_Score < 0,'-','')+'corp_status_cd')+IF(le.corp_status_desc_Score = 0,'','|'+IF(le.corp_status_desc_Score < 0,'-','')+'corp_status_desc')+IF(le.corp_status_date_Score = 0,'','|'+IF(le.corp_status_date_Score < 0,'-','')+'corp_status_date')+IF(le.corp_standing_Score = 0,'','|'+IF(le.corp_standing_Score < 0,'-','')+'corp_standing')+IF(le.corp_status_comment_Score = 0,'','|'+IF(le.corp_status_comment_Score < 0,'-','')+'corp_status_comment')+IF(le.corp_ticker_symbol_Score = 0,'','|'+IF(le.corp_ticker_symbol_Score < 0,'-','')+'corp_ticker_symbol')+IF(le.corp_stock_exchange_Score = 0,'','|'+IF(le.corp_stock_exchange_Score < 0,'-','')+'corp_stock_exchange')+IF(le.corp_inc_state_Score = 0,'','|'+IF(le.corp_inc_state_Score < 0,'-','')+'corp_inc_state')+IF(le.corp_inc_county_Score = 0,'','|'+IF(le.corp_inc_county_Score < 0,'-','')+'corp_inc_county')+IF(le.corp_inc_date_Score = 0,'','|'+IF(le.corp_inc_date_Score < 0,'-','')+'corp_inc_date')+IF(le.corp_anniversary_month_Score = 0,'','|'+IF(le.corp_anniversary_month_Score < 0,'-','')+'corp_anniversary_month')+IF(le.corp_fed_tax_id_Score = 0,'','|'+IF(le.corp_fed_tax_id_Score < 0,'-','')+'corp_fed_tax_id')+IF(le.corp_state_tax_id_Score = 0,'','|'+IF(le.corp_state_tax_id_Score < 0,'-','')+'corp_state_tax_id')+IF(le.corp_term_exist_cd_Score = 0,'','|'+IF(le.corp_term_exist_cd_Score < 0,'-','')+'corp_term_exist_cd')+IF(le.corp_term_exist_exp_Score = 0,'','|'+IF(le.corp_term_exist_exp_Score < 0,'-','')+'corp_term_exist_exp')+IF(le.corp_term_exist_desc_Score = 0,'','|'+IF(le.corp_term_exist_desc_Score < 0,'-','')+'corp_term_exist_desc')+IF(le.corp_foreign_domestic_ind_Score = 0,'','|'+IF(le.corp_foreign_domestic_ind_Score < 0,'-','')+'corp_foreign_domestic_ind')+IF(le.corp_forgn_state_cd_Score = 0,'','|'+IF(le.corp_forgn_state_cd_Score < 0,'-','')+'corp_forgn_state_cd')+IF(le.corp_forgn_state_desc_Score = 0,'','|'+IF(le.corp_forgn_state_desc_Score < 0,'-','')+'corp_forgn_state_desc')+IF(le.corp_forgn_sos_charter_nbr_Score = 0,'','|'+IF(le.corp_forgn_sos_charter_nbr_Score < 0,'-','')+'corp_forgn_sos_charter_nbr')+IF(le.corp_forgn_date_Score = 0,'','|'+IF(le.corp_forgn_date_Score < 0,'-','')+'corp_forgn_date')+IF(le.corp_forgn_fed_tax_id_Score = 0,'','|'+IF(le.corp_forgn_fed_tax_id_Score < 0,'-','')+'corp_forgn_fed_tax_id')+IF(le.corp_forgn_state_tax_id_Score = 0,'','|'+IF(le.corp_forgn_state_tax_id_Score < 0,'-','')+'corp_forgn_state_tax_id')+IF(le.corp_forgn_term_exist_cd_Score = 0,'','|'+IF(le.corp_forgn_term_exist_cd_Score < 0,'-','')+'corp_forgn_term_exist_cd')+IF(le.corp_forgn_term_exist_exp_Score = 0,'','|'+IF(le.corp_forgn_term_exist_exp_Score < 0,'-','')+'corp_forgn_term_exist_exp')+IF(le.corp_forgn_term_exist_desc_Score = 0,'','|'+IF(le.corp_forgn_term_exist_desc_Score < 0,'-','')+'corp_forgn_term_exist_desc')+IF(le.corp_orig_org_structure_cd_Score = 0,'','|'+IF(le.corp_orig_org_structure_cd_Score < 0,'-','')+'corp_orig_org_structure_cd')+IF(le.corp_orig_org_structure_desc_Score = 0,'','|'+IF(le.corp_orig_org_structure_desc_Score < 0,'-','')+'corp_orig_org_structure_desc')+IF(le.corp_for_profit_ind_Score = 0,'','|'+IF(le.corp_for_profit_ind_Score < 0,'-','')+'corp_for_profit_ind')+IF(le.corp_public_or_private_ind_Score = 0,'','|'+IF(le.corp_public_or_private_ind_Score < 0,'-','')+'corp_public_or_private_ind')+IF(le.corp_sic_code_Score = 0,'','|'+IF(le.corp_sic_code_Score < 0,'-','')+'corp_sic_code')+IF(le.corp_naic_code_Score = 0,'','|'+IF(le.corp_naic_code_Score < 0,'-','')+'corp_naic_code')+IF(le.corp_orig_bus_type_cd_Score = 0,'','|'+IF(le.corp_orig_bus_type_cd_Score < 0,'-','')+'corp_orig_bus_type_cd')+IF(le.corp_orig_bus_type_desc_Score = 0,'','|'+IF(le.corp_orig_bus_type_desc_Score < 0,'-','')+'corp_orig_bus_type_desc')+IF(le.corp_entity_desc_Score = 0,'','|'+IF(le.corp_entity_desc_Score < 0,'-','')+'corp_entity_desc')+IF(le.corp_certificate_nbr_Score = 0,'','|'+IF(le.corp_certificate_nbr_Score < 0,'-','')+'corp_certificate_nbr')+IF(le.corp_internal_nbr_Score = 0,'','|'+IF(le.corp_internal_nbr_Score < 0,'-','')+'corp_internal_nbr')+IF(le.corp_previous_nbr_Score = 0,'','|'+IF(le.corp_previous_nbr_Score < 0,'-','')+'corp_previous_nbr')+IF(le.corp_microfilm_nbr_Score = 0,'','|'+IF(le.corp_microfilm_nbr_Score < 0,'-','')+'corp_microfilm_nbr')+IF(le.corp_amendments_filed_Score = 0,'','|'+IF(le.corp_amendments_filed_Score < 0,'-','')+'corp_amendments_filed')+IF(le.corp_acts_Score = 0,'','|'+IF(le.corp_acts_Score < 0,'-','')+'corp_acts')+IF(le.corp_partnership_ind_Score = 0,'','|'+IF(le.corp_partnership_ind_Score < 0,'-','')+'corp_partnership_ind')+IF(le.corp_mfg_ind_Score = 0,'','|'+IF(le.corp_mfg_ind_Score < 0,'-','')+'corp_mfg_ind')+IF(le.corp_addl_info_Score = 0,'','|'+IF(le.corp_addl_info_Score < 0,'-','')+'corp_addl_info')+IF(le.corp_taxes_Score = 0,'','|'+IF(le.corp_taxes_Score < 0,'-','')+'corp_taxes')+IF(le.corp_franchise_taxes_Score = 0,'','|'+IF(le.corp_franchise_taxes_Score < 0,'-','')+'corp_franchise_taxes')+IF(le.corp_tax_program_cd_Score = 0,'','|'+IF(le.corp_tax_program_cd_Score < 0,'-','')+'corp_tax_program_cd')+IF(le.corp_tax_program_desc_Score = 0,'','|'+IF(le.corp_tax_program_desc_Score < 0,'-','')+'corp_tax_program_desc')+IF(le.corp_ra_full_name_Score = 0,'','|'+IF(le.corp_ra_full_name_Score < 0,'-','')+'corp_ra_full_name')+IF(le.corp_ra_fname_Score = 0,'','|'+IF(le.corp_ra_fname_Score < 0,'-','')+'corp_ra_fname')+IF(le.corp_ra_mname_Score = 0,'','|'+IF(le.corp_ra_mname_Score < 0,'-','')+'corp_ra_mname')+IF(le.corp_ra_lname_Score = 0,'','|'+IF(le.corp_ra_lname_Score < 0,'-','')+'corp_ra_lname')+IF(le.corp_ra_suffix_Score = 0,'','|'+IF(le.corp_ra_suffix_Score < 0,'-','')+'corp_ra_suffix')+IF(le.corp_ra_title_cd_Score = 0,'','|'+IF(le.corp_ra_title_cd_Score < 0,'-','')+'corp_ra_title_cd')+IF(le.corp_ra_title_desc_Score = 0,'','|'+IF(le.corp_ra_title_desc_Score < 0,'-','')+'corp_ra_title_desc')+IF(le.corp_ra_fein_Score = 0,'','|'+IF(le.corp_ra_fein_Score < 0,'-','')+'corp_ra_fein')+IF(le.corp_ra_ssn_Score = 0,'','|'+IF(le.corp_ra_ssn_Score < 0,'-','')+'corp_ra_ssn')+IF(le.corp_ra_dob_Score = 0,'','|'+IF(le.corp_ra_dob_Score < 0,'-','')+'corp_ra_dob')+IF(le.corp_ra_effective_date_Score = 0,'','|'+IF(le.corp_ra_effective_date_Score < 0,'-','')+'corp_ra_effective_date')+IF(le.corp_ra_resign_date_Score = 0,'','|'+IF(le.corp_ra_resign_date_Score < 0,'-','')+'corp_ra_resign_date')+IF(le.corp_ra_no_comp_Score = 0,'','|'+IF(le.corp_ra_no_comp_Score < 0,'-','')+'corp_ra_no_comp')+IF(le.corp_ra_no_comp_igs_Score = 0,'','|'+IF(le.corp_ra_no_comp_igs_Score < 0,'-','')+'corp_ra_no_comp_igs')+IF(le.corp_ra_addl_info_Score = 0,'','|'+IF(le.corp_ra_addl_info_Score < 0,'-','')+'corp_ra_addl_info')+IF(le.corp_ra_address_type_cd_Score = 0,'','|'+IF(le.corp_ra_address_type_cd_Score < 0,'-','')+'corp_ra_address_type_cd')+IF(le.corp_ra_address_type_desc_Score = 0,'','|'+IF(le.corp_ra_address_type_desc_Score < 0,'-','')+'corp_ra_address_type_desc')+IF(le.corp_ra_address_line1_Score = 0,'','|'+IF(le.corp_ra_address_line1_Score < 0,'-','')+'corp_ra_address_line1')+IF(le.corp_ra_address_line2_Score = 0,'','|'+IF(le.corp_ra_address_line2_Score < 0,'-','')+'corp_ra_address_line2')+IF(le.corp_ra_address_line3_Score = 0,'','|'+IF(le.corp_ra_address_line3_Score < 0,'-','')+'corp_ra_address_line3')+IF(le.corp_ra_phone_number_Score = 0,'','|'+IF(le.corp_ra_phone_number_Score < 0,'-','')+'corp_ra_phone_number')+IF(le.corp_ra_phone_number_type_cd_Score = 0,'','|'+IF(le.corp_ra_phone_number_type_cd_Score < 0,'-','')+'corp_ra_phone_number_type_cd')+IF(le.corp_ra_phone_number_type_desc_Score = 0,'','|'+IF(le.corp_ra_phone_number_type_desc_Score < 0,'-','')+'corp_ra_phone_number_type_desc')+IF(le.corp_ra_fax_nbr_Score = 0,'','|'+IF(le.corp_ra_fax_nbr_Score < 0,'-','')+'corp_ra_fax_nbr')+IF(le.corp_ra_email_address_Score = 0,'','|'+IF(le.corp_ra_email_address_Score < 0,'-','')+'corp_ra_email_address')+IF(le.corp_ra_web_address_Score = 0,'','|'+IF(le.corp_ra_web_address_Score < 0,'-','')+'corp_ra_web_address')+IF(le.corp_prep_addr1_line1_Score = 0,'','|'+IF(le.corp_prep_addr1_line1_Score < 0,'-','')+'corp_prep_addr1_line1')+IF(le.corp_prep_addr1_last_line_Score = 0,'','|'+IF(le.corp_prep_addr1_last_line_Score < 0,'-','')+'corp_prep_addr1_last_line')+IF(le.corp_prep_addr2_line1_Score = 0,'','|'+IF(le.corp_prep_addr2_line1_Score < 0,'-','')+'corp_prep_addr2_line1')+IF(le.corp_prep_addr2_last_line_Score = 0,'','|'+IF(le.corp_prep_addr2_last_line_Score < 0,'-','')+'corp_prep_addr2_last_line')+IF(le.ra_prep_addr_line1_Score = 0,'','|'+IF(le.ra_prep_addr_line1_Score < 0,'-','')+'ra_prep_addr_line1')+IF(le.ra_prep_addr_last_line_Score = 0,'','|'+IF(le.ra_prep_addr_last_line_Score < 0,'-','')+'ra_prep_addr_last_line')+IF(le.cont_filing_reference_nbr_Score = 0,'','|'+IF(le.cont_filing_reference_nbr_Score < 0,'-','')+'cont_filing_reference_nbr')+IF(le.cont_filing_date_Score = 0,'','|'+IF(le.cont_filing_date_Score < 0,'-','')+'cont_filing_date')+IF(le.cont_filing_cd_Score = 0,'','|'+IF(le.cont_filing_cd_Score < 0,'-','')+'cont_filing_cd')+IF(le.cont_filing_desc_Score = 0,'','|'+IF(le.cont_filing_desc_Score < 0,'-','')+'cont_filing_desc')+IF(le.cont_type_cd_Score = 0,'','|'+IF(le.cont_type_cd_Score < 0,'-','')+'cont_type_cd')+IF(le.cont_type_desc_Score = 0,'','|'+IF(le.cont_type_desc_Score < 0,'-','')+'cont_type_desc')+IF(le.cont_full_name_Score = 0,'','|'+IF(le.cont_full_name_Score < 0,'-','')+'cont_full_name')+IF(le.cont_fname_Score = 0,'','|'+IF(le.cont_fname_Score < 0,'-','')+'cont_fname')+IF(le.cont_mname_Score = 0,'','|'+IF(le.cont_mname_Score < 0,'-','')+'cont_mname')+IF(le.cont_lname_Score = 0,'','|'+IF(le.cont_lname_Score < 0,'-','')+'cont_lname')+IF(le.cont_suffix_Score = 0,'','|'+IF(le.cont_suffix_Score < 0,'-','')+'cont_suffix')+IF(le.cont_title1_desc_Score = 0,'','|'+IF(le.cont_title1_desc_Score < 0,'-','')+'cont_title1_desc')+IF(le.cont_title2_desc_Score = 0,'','|'+IF(le.cont_title2_desc_Score < 0,'-','')+'cont_title2_desc')+IF(le.cont_title3_desc_Score = 0,'','|'+IF(le.cont_title3_desc_Score < 0,'-','')+'cont_title3_desc')+IF(le.cont_title4_desc_Score = 0,'','|'+IF(le.cont_title4_desc_Score < 0,'-','')+'cont_title4_desc')+IF(le.cont_title5_desc_Score = 0,'','|'+IF(le.cont_title5_desc_Score < 0,'-','')+'cont_title5_desc')+IF(le.cont_fein_Score = 0,'','|'+IF(le.cont_fein_Score < 0,'-','')+'cont_fein')+IF(le.cont_ssn_Score = 0,'','|'+IF(le.cont_ssn_Score < 0,'-','')+'cont_ssn')+IF(le.cont_dob_Score = 0,'','|'+IF(le.cont_dob_Score < 0,'-','')+'cont_dob')+IF(le.cont_status_cd_Score = 0,'','|'+IF(le.cont_status_cd_Score < 0,'-','')+'cont_status_cd')+IF(le.cont_status_desc_Score = 0,'','|'+IF(le.cont_status_desc_Score < 0,'-','')+'cont_status_desc')+IF(le.cont_effective_date_Score = 0,'','|'+IF(le.cont_effective_date_Score < 0,'-','')+'cont_effective_date')+IF(le.cont_effective_cd_Score = 0,'','|'+IF(le.cont_effective_cd_Score < 0,'-','')+'cont_effective_cd')+IF(le.cont_effective_desc_Score = 0,'','|'+IF(le.cont_effective_desc_Score < 0,'-','')+'cont_effective_desc')+IF(le.cont_addl_info_Score = 0,'','|'+IF(le.cont_addl_info_Score < 0,'-','')+'cont_addl_info')+IF(le.cont_address_type_cd_Score = 0,'','|'+IF(le.cont_address_type_cd_Score < 0,'-','')+'cont_address_type_cd')+IF(le.cont_address_type_desc_Score = 0,'','|'+IF(le.cont_address_type_desc_Score < 0,'-','')+'cont_address_type_desc')+IF(le.cont_address_line1_Score = 0,'','|'+IF(le.cont_address_line1_Score < 0,'-','')+'cont_address_line1')+IF(le.cont_address_line2_Score = 0,'','|'+IF(le.cont_address_line2_Score < 0,'-','')+'cont_address_line2')+IF(le.cont_address_line3_Score = 0,'','|'+IF(le.cont_address_line3_Score < 0,'-','')+'cont_address_line3')+IF(le.cont_address_effective_date_Score = 0,'','|'+IF(le.cont_address_effective_date_Score < 0,'-','')+'cont_address_effective_date')+IF(le.cont_address_county_Score = 0,'','|'+IF(le.cont_address_county_Score < 0,'-','')+'cont_address_county')+IF(le.cont_phone_number_Score = 0,'','|'+IF(le.cont_phone_number_Score < 0,'-','')+'cont_phone_number')+IF(le.cont_phone_number_type_cd_Score = 0,'','|'+IF(le.cont_phone_number_type_cd_Score < 0,'-','')+'cont_phone_number_type_cd')+IF(le.cont_phone_number_type_desc_Score = 0,'','|'+IF(le.cont_phone_number_type_desc_Score < 0,'-','')+'cont_phone_number_type_desc')+IF(le.cont_fax_nbr_Score = 0,'','|'+IF(le.cont_fax_nbr_Score < 0,'-','')+'cont_fax_nbr')+IF(le.cont_email_address_Score = 0,'','|'+IF(le.cont_email_address_Score < 0,'-','')+'cont_email_address')+IF(le.cont_web_address_Score = 0,'','|'+IF(le.cont_web_address_Score < 0,'-','')+'cont_web_address')+IF(le.corp_acres_Score = 0,'','|'+IF(le.corp_acres_Score < 0,'-','')+'corp_acres')+IF(le.corp_action_Score = 0,'','|'+IF(le.corp_action_Score < 0,'-','')+'corp_action')+IF(le.corp_action_date_Score = 0,'','|'+IF(le.corp_action_date_Score < 0,'-','')+'corp_action_date')+IF(le.corp_action_employment_security_approval_date_Score = 0,'','|'+IF(le.corp_action_employment_security_approval_date_Score < 0,'-','')+'corp_action_employment_security_approval_date')+IF(le.corp_action_pending_cd_Score = 0,'','|'+IF(le.corp_action_pending_cd_Score < 0,'-','')+'corp_action_pending_cd')+IF(le.corp_action_pending_desc_Score = 0,'','|'+IF(le.corp_action_pending_desc_Score < 0,'-','')+'corp_action_pending_desc')+IF(le.corp_action_statement_of_intent_date_Score = 0,'','|'+IF(le.corp_action_statement_of_intent_date_Score < 0,'-','')+'corp_action_statement_of_intent_date')+IF(le.corp_action_tax_dept_approval_date_Score = 0,'','|'+IF(le.corp_action_tax_dept_approval_date_Score < 0,'-','')+'corp_action_tax_dept_approval_date')+IF(le.corp_acts2_Score = 0,'','|'+IF(le.corp_acts2_Score < 0,'-','')+'corp_acts2')+IF(le.corp_acts3_Score = 0,'','|'+IF(le.corp_acts3_Score < 0,'-','')+'corp_acts3')+IF(le.corp_additional_principals_Score = 0,'','|'+IF(le.corp_additional_principals_Score < 0,'-','')+'corp_additional_principals')+IF(le.corp_address_office_type_Score = 0,'','|'+IF(le.corp_address_office_type_Score < 0,'-','')+'corp_address_office_type')+IF(le.corp_agent_assign_date_Score = 0,'','|'+IF(le.corp_agent_assign_date_Score < 0,'-','')+'corp_agent_assign_date')+IF(le.corp_agent_commercial_Score = 0,'','|'+IF(le.corp_agent_commercial_Score < 0,'-','')+'corp_agent_commercial')+IF(le.corp_agent_country_Score = 0,'','|'+IF(le.corp_agent_country_Score < 0,'-','')+'corp_agent_country')+IF(le.corp_agent_county_Score = 0,'','|'+IF(le.corp_agent_county_Score < 0,'-','')+'corp_agent_county')+IF(le.corp_agent_status_cd_Score = 0,'','|'+IF(le.corp_agent_status_cd_Score < 0,'-','')+'corp_agent_status_cd')+IF(le.corp_agent_status_desc_Score = 0,'','|'+IF(le.corp_agent_status_desc_Score < 0,'-','')+'corp_agent_status_desc')+IF(le.corp_agent_id_Score = 0,'','|'+IF(le.corp_agent_id_Score < 0,'-','')+'corp_agent_id')+IF(le.corp_agriculture_flag_Score = 0,'','|'+IF(le.corp_agriculture_flag_Score < 0,'-','')+'corp_agriculture_flag')+IF(le.corp_authorized_partners_Score = 0,'','|'+IF(le.corp_authorized_partners_Score < 0,'-','')+'corp_authorized_partners')+IF(le.corp_comment_Score = 0,'','|'+IF(le.corp_comment_Score < 0,'-','')+'corp_comment')+IF(le.corp_consent_flag_for_protected_name_Score = 0,'','|'+IF(le.corp_consent_flag_for_protected_name_Score < 0,'-','')+'corp_consent_flag_for_protected_name')+IF(le.corp_converted_Score = 0,'','|'+IF(le.corp_converted_Score < 0,'-','')+'corp_converted')+IF(le.corp_converted_from_Score = 0,'','|'+IF(le.corp_converted_from_Score < 0,'-','')+'corp_converted_from')+IF(le.corp_country_of_formation_Score = 0,'','|'+IF(le.corp_country_of_formation_Score < 0,'-','')+'corp_country_of_formation')+IF(le.corp_date_of_organization_meeting_Score = 0,'','|'+IF(le.corp_date_of_organization_meeting_Score < 0,'-','')+'corp_date_of_organization_meeting')+IF(le.corp_delayed_effective_date_Score = 0,'','|'+IF(le.corp_delayed_effective_date_Score < 0,'-','')+'corp_delayed_effective_date')+IF(le.corp_directors_from_to_Score = 0,'','|'+IF(le.corp_directors_from_to_Score < 0,'-','')+'corp_directors_from_to')+IF(le.corp_dissolved_date_Score = 0,'','|'+IF(le.corp_dissolved_date_Score < 0,'-','')+'corp_dissolved_date')+IF(le.corp_farm_exemptions_Score = 0,'','|'+IF(le.corp_farm_exemptions_Score < 0,'-','')+'corp_farm_exemptions')+IF(le.corp_farm_qual_date_Score = 0,'','|'+IF(le.corp_farm_qual_date_Score < 0,'-','')+'corp_farm_qual_date')+IF(le.corp_farm_status_cd_Score = 0,'','|'+IF(le.corp_farm_status_cd_Score < 0,'-','')+'corp_farm_status_cd')+IF(le.corp_farm_status_desc_Score = 0,'','|'+IF(le.corp_farm_status_desc_Score < 0,'-','')+'corp_farm_status_desc')+IF(le.corp_fiscal_year_month_Score = 0,'','|'+IF(le.corp_fiscal_year_month_Score < 0,'-','')+'corp_fiscal_year_month')+IF(le.corp_foreign_fiduciary_capacity_in_state_Score = 0,'','|'+IF(le.corp_foreign_fiduciary_capacity_in_state_Score < 0,'-','')+'corp_foreign_fiduciary_capacity_in_state')+IF(le.corp_governing_statute_Score = 0,'','|'+IF(le.corp_governing_statute_Score < 0,'-','')+'corp_governing_statute')+IF(le.corp_has_members_Score = 0,'','|'+IF(le.corp_has_members_Score < 0,'-','')+'corp_has_members')+IF(le.corp_has_vested_managers_Score = 0,'','|'+IF(le.corp_has_vested_managers_Score < 0,'-','')+'corp_has_vested_managers')+IF(le.corp_home_incorporated_county_Score = 0,'','|'+IF(le.corp_home_incorporated_county_Score < 0,'-','')+'corp_home_incorporated_county')+IF(le.corp_home_state_name_Score = 0,'','|'+IF(le.corp_home_state_name_Score < 0,'-','')+'corp_home_state_name')+IF(le.corp_is_professional_Score = 0,'','|'+IF(le.corp_is_professional_Score < 0,'-','')+'corp_is_professional')+IF(le.corp_is_non_profit_irs_approved_Score = 0,'','|'+IF(le.corp_is_non_profit_irs_approved_Score < 0,'-','')+'corp_is_non_profit_irs_approved')+IF(le.corp_last_renewal_date_Score = 0,'','|'+IF(le.corp_last_renewal_date_Score < 0,'-','')+'corp_last_renewal_date')+IF(le.corp_last_renewal_year_Score = 0,'','|'+IF(le.corp_last_renewal_year_Score < 0,'-','')+'corp_last_renewal_year')+IF(le.corp_license_type_Score = 0,'','|'+IF(le.corp_license_type_Score < 0,'-','')+'corp_license_type')+IF(le.corp_llc_managed_desc_Score = 0,'','|'+IF(le.corp_llc_managed_desc_Score < 0,'-','')+'corp_llc_managed_desc')+IF(le.corp_llc_managed_ind_Score = 0,'','|'+IF(le.corp_llc_managed_ind_Score < 0,'-','')+'corp_llc_managed_ind')+IF(le.corp_management_desc_Score = 0,'','|'+IF(le.corp_management_desc_Score < 0,'-','')+'corp_management_desc')+IF(le.corp_management_type_Score = 0,'','|'+IF(le.corp_management_type_Score < 0,'-','')+'corp_management_type')+IF(le.corp_manager_managed_Score = 0,'','|'+IF(le.corp_manager_managed_Score < 0,'-','')+'corp_manager_managed')+IF(le.corp_merged_corporation_id_Score = 0,'','|'+IF(le.corp_merged_corporation_id_Score < 0,'-','')+'corp_merged_corporation_id')+IF(le.corp_merged_fein_Score = 0,'','|'+IF(le.corp_merged_fein_Score < 0,'-','')+'corp_merged_fein')+IF(le.corp_merger_allowed_flag_Score = 0,'','|'+IF(le.corp_merger_allowed_flag_Score < 0,'-','')+'corp_merger_allowed_flag')+IF(le.corp_merger_date_Score = 0,'','|'+IF(le.corp_merger_date_Score < 0,'-','')+'corp_merger_date')+IF(le.corp_merger_desc_Score = 0,'','|'+IF(le.corp_merger_desc_Score < 0,'-','')+'corp_merger_desc')+IF(le.corp_merger_effective_date_Score = 0,'','|'+IF(le.corp_merger_effective_date_Score < 0,'-','')+'corp_merger_effective_date')+IF(le.corp_merger_id_Score = 0,'','|'+IF(le.corp_merger_id_Score < 0,'-','')+'corp_merger_id')+IF(le.corp_merger_indicator_Score = 0,'','|'+IF(le.corp_merger_indicator_Score < 0,'-','')+'corp_merger_indicator')+IF(le.corp_merger_name_Score = 0,'','|'+IF(le.corp_merger_name_Score < 0,'-','')+'corp_merger_name')+IF(le.corp_merger_type_converted_to_cd_Score = 0,'','|'+IF(le.corp_merger_type_converted_to_cd_Score < 0,'-','')+'corp_merger_type_converted_to_cd')+IF(le.corp_merger_type_converted_to_desc_Score = 0,'','|'+IF(le.corp_merger_type_converted_to_desc_Score < 0,'-','')+'corp_merger_type_converted_to_desc')+IF(le.corp_naics_desc_Score = 0,'','|'+IF(le.corp_naics_desc_Score < 0,'-','')+'corp_naics_desc')+IF(le.corp_name_effective_date_Score = 0,'','|'+IF(le.corp_name_effective_date_Score < 0,'-','')+'corp_name_effective_date')+IF(le.corp_name_reservation_date_Score = 0,'','|'+IF(le.corp_name_reservation_date_Score < 0,'-','')+'corp_name_reservation_date')+IF(le.corp_name_reservation_desc_Score = 0,'','|'+IF(le.corp_name_reservation_desc_Score < 0,'-','')+'corp_name_reservation_desc')+IF(le.corp_name_reservation_expiration_date_Score = 0,'','|'+IF(le.corp_name_reservation_expiration_date_Score < 0,'-','')+'corp_name_reservation_expiration_date')+IF(le.corp_name_reservation_nbr_Score = 0,'','|'+IF(le.corp_name_reservation_nbr_Score < 0,'-','')+'corp_name_reservation_nbr')+IF(le.corp_name_reservation_type_Score = 0,'','|'+IF(le.corp_name_reservation_type_Score < 0,'-','')+'corp_name_reservation_type')+IF(le.corp_name_status_cd_Score = 0,'','|'+IF(le.corp_name_status_cd_Score < 0,'-','')+'corp_name_status_cd')+IF(le.corp_name_status_date_Score = 0,'','|'+IF(le.corp_name_status_date_Score < 0,'-','')+'corp_name_status_date')+IF(le.corp_name_status_desc_Score = 0,'','|'+IF(le.corp_name_status_desc_Score < 0,'-','')+'corp_name_status_desc')+IF(le.corp_non_profit_irs_approved_purpose_Score = 0,'','|'+IF(le.corp_non_profit_irs_approved_purpose_Score < 0,'-','')+'corp_non_profit_irs_approved_purpose')+IF(le.corp_non_profit_solicit_donations_Score = 0,'','|'+IF(le.corp_non_profit_solicit_donations_Score < 0,'-','')+'corp_non_profit_solicit_donations')+IF(le.corp_nbr_of_amendments_Score = 0,'','|'+IF(le.corp_nbr_of_amendments_Score < 0,'-','')+'corp_nbr_of_amendments')+IF(le.corp_nbr_of_initial_llc_members_Score = 0,'','|'+IF(le.corp_nbr_of_initial_llc_members_Score < 0,'-','')+'corp_nbr_of_initial_llc_members')+IF(le.corp_nbr_of_partners_Score = 0,'','|'+IF(le.corp_nbr_of_partners_Score < 0,'-','')+'corp_nbr_of_partners')+IF(le.corp_operating_agreement_Score = 0,'','|'+IF(le.corp_operating_agreement_Score < 0,'-','')+'corp_operating_agreement')+IF(le.corp_opt_in_llc_act_desc_Score = 0,'','|'+IF(le.corp_opt_in_llc_act_desc_Score < 0,'-','')+'corp_opt_in_llc_act_desc')+IF(le.corp_opt_in_llc_act_ind_Score = 0,'','|'+IF(le.corp_opt_in_llc_act_ind_Score < 0,'-','')+'corp_opt_in_llc_act_ind')+IF(le.corp_organizational_comments_Score = 0,'','|'+IF(le.corp_organizational_comments_Score < 0,'-','')+'corp_organizational_comments')+IF(le.corp_partner_contributions_total_Score = 0,'','|'+IF(le.corp_partner_contributions_total_Score < 0,'-','')+'corp_partner_contributions_total')+IF(le.corp_partner_terms_Score = 0,'','|'+IF(le.corp_partner_terms_Score < 0,'-','')+'corp_partner_terms')+IF(le.corp_percentage_voters_required_to_approve_amendments_Score = 0,'','|'+IF(le.corp_percentage_voters_required_to_approve_amendments_Score < 0,'-','')+'corp_percentage_voters_required_to_approve_amendments')+IF(le.corp_profession_Score = 0,'','|'+IF(le.corp_profession_Score < 0,'-','')+'corp_profession')+IF(le.corp_province_Score = 0,'','|'+IF(le.corp_province_Score < 0,'-','')+'corp_province')+IF(le.corp_public_mutual_corporation_Score = 0,'','|'+IF(le.corp_public_mutual_corporation_Score < 0,'-','')+'corp_public_mutual_corporation')+IF(le.corp_purpose_Score = 0,'','|'+IF(le.corp_purpose_Score < 0,'-','')+'corp_purpose')+IF(le.corp_ra_required_flag_Score = 0,'','|'+IF(le.corp_ra_required_flag_Score < 0,'-','')+'corp_ra_required_flag')+IF(le.corp_registered_counties_Score = 0,'','|'+IF(le.corp_registered_counties_Score < 0,'-','')+'corp_registered_counties')+IF(le.corp_regulated_ind_Score = 0,'','|'+IF(le.corp_regulated_ind_Score < 0,'-','')+'corp_regulated_ind')+IF(le.corp_renewal_date_Score = 0,'','|'+IF(le.corp_renewal_date_Score < 0,'-','')+'corp_renewal_date')+IF(le.corp_standing_other_Score = 0,'','|'+IF(le.corp_standing_other_Score < 0,'-','')+'corp_standing_other')+IF(le.corp_survivor_corporation_id_Score = 0,'','|'+IF(le.corp_survivor_corporation_id_Score < 0,'-','')+'corp_survivor_corporation_id')+IF(le.corp_tax_base_Score = 0,'','|'+IF(le.corp_tax_base_Score < 0,'-','')+'corp_tax_base')+IF(le.corp_tax_standing_Score = 0,'','|'+IF(le.corp_tax_standing_Score < 0,'-','')+'corp_tax_standing')+IF(le.corp_termination_cd_Score = 0,'','|'+IF(le.corp_termination_cd_Score < 0,'-','')+'corp_termination_cd')+IF(le.corp_termination_desc_Score = 0,'','|'+IF(le.corp_termination_desc_Score < 0,'-','')+'corp_termination_desc')+IF(le.corp_termination_date_Score = 0,'','|'+IF(le.corp_termination_date_Score < 0,'-','')+'corp_termination_date')+IF(le.corp_trademark_business_mark_type_Score = 0,'','|'+IF(le.corp_trademark_business_mark_type_Score < 0,'-','')+'corp_trademark_business_mark_type')+IF(le.corp_trademark_cancelled_date_Score = 0,'','|'+IF(le.corp_trademark_cancelled_date_Score < 0,'-','')+'corp_trademark_cancelled_date')+IF(le.corp_trademark_class_desc1_Score = 0,'','|'+IF(le.corp_trademark_class_desc1_Score < 0,'-','')+'corp_trademark_class_desc1')+IF(le.corp_trademark_class_desc2_Score = 0,'','|'+IF(le.corp_trademark_class_desc2_Score < 0,'-','')+'corp_trademark_class_desc2')+IF(le.corp_trademark_class_desc3_Score = 0,'','|'+IF(le.corp_trademark_class_desc3_Score < 0,'-','')+'corp_trademark_class_desc3')+IF(le.corp_trademark_class_desc4_Score = 0,'','|'+IF(le.corp_trademark_class_desc4_Score < 0,'-','')+'corp_trademark_class_desc4')+IF(le.corp_trademark_class_desc5_Score = 0,'','|'+IF(le.corp_trademark_class_desc5_Score < 0,'-','')+'corp_trademark_class_desc5')+IF(le.corp_trademark_class_desc6_Score = 0,'','|'+IF(le.corp_trademark_class_desc6_Score < 0,'-','')+'corp_trademark_class_desc6')+IF(le.corp_trademark_classification_nbr_Score = 0,'','|'+IF(le.corp_trademark_classification_nbr_Score < 0,'-','')+'corp_trademark_classification_nbr')+IF(le.corp_trademark_disclaimer1_Score = 0,'','|'+IF(le.corp_trademark_disclaimer1_Score < 0,'-','')+'corp_trademark_disclaimer1')+IF(le.corp_trademark_disclaimer2_Score = 0,'','|'+IF(le.corp_trademark_disclaimer2_Score < 0,'-','')+'corp_trademark_disclaimer2')+IF(le.corp_trademark_expiration_date_Score = 0,'','|'+IF(le.corp_trademark_expiration_date_Score < 0,'-','')+'corp_trademark_expiration_date')+IF(le.corp_trademark_filing_date_Score = 0,'','|'+IF(le.corp_trademark_filing_date_Score < 0,'-','')+'corp_trademark_filing_date')+IF(le.corp_trademark_first_use_date_Score = 0,'','|'+IF(le.corp_trademark_first_use_date_Score < 0,'-','')+'corp_trademark_first_use_date')+IF(le.corp_trademark_first_use_date_in_state_Score = 0,'','|'+IF(le.corp_trademark_first_use_date_in_state_Score < 0,'-','')+'corp_trademark_first_use_date_in_state')+IF(le.corp_trademark_keywords_Score = 0,'','|'+IF(le.corp_trademark_keywords_Score < 0,'-','')+'corp_trademark_keywords')+IF(le.corp_trademark_logo_Score = 0,'','|'+IF(le.corp_trademark_logo_Score < 0,'-','')+'corp_trademark_logo')+IF(le.corp_trademark_name_expiration_date_Score = 0,'','|'+IF(le.corp_trademark_name_expiration_date_Score < 0,'-','')+'corp_trademark_name_expiration_date')+IF(le.corp_trademark_nbr_Score = 0,'','|'+IF(le.corp_trademark_nbr_Score < 0,'-','')+'corp_trademark_nbr')+IF(le.corp_trademark_renewal_date_Score = 0,'','|'+IF(le.corp_trademark_renewal_date_Score < 0,'-','')+'corp_trademark_renewal_date')+IF(le.corp_trademark_status_Score = 0,'','|'+IF(le.corp_trademark_status_Score < 0,'-','')+'corp_trademark_status')+IF(le.corp_trademark_used_1_Score = 0,'','|'+IF(le.corp_trademark_used_1_Score < 0,'-','')+'corp_trademark_used_1')+IF(le.corp_trademark_used_2_Score = 0,'','|'+IF(le.corp_trademark_used_2_Score < 0,'-','')+'corp_trademark_used_2')+IF(le.corp_trademark_used_3_Score = 0,'','|'+IF(le.corp_trademark_used_3_Score < 0,'-','')+'corp_trademark_used_3')+IF(le.cont_owner_percentage_Score = 0,'','|'+IF(le.cont_owner_percentage_Score < 0,'-','')+'cont_owner_percentage')+IF(le.cont_country_Score = 0,'','|'+IF(le.cont_country_Score < 0,'-','')+'cont_country')+IF(le.cont_country_mailing_Score = 0,'','|'+IF(le.cont_country_mailing_Score < 0,'-','')+'cont_country_mailing')+IF(le.cont_nondislosure_Score = 0,'','|'+IF(le.cont_nondislosure_Score < 0,'-','')+'cont_nondislosure')+IF(le.cont_prep_addr_line1_Score = 0,'','|'+IF(le.cont_prep_addr_line1_Score < 0,'-','')+'cont_prep_addr_line1')+IF(le.cont_prep_addr_last_line_Score = 0,'','|'+IF(le.cont_prep_addr_last_line_Score < 0,'-','')+'cont_prep_addr_last_line')+IF(le.recordorigin_Score = 0,'','|'+IF(le.recordorigin_Score < 0,'-','')+'recordorigin');
  END;
  P := PROJECT(ds,tosummary(LEFT));
EXPORT Annotated := P;
EXPORT FieldMatches := SORT(TABLE(Annotated,{Summary,Cnt := COUNT(GROUP)},Summary,FEW),-Cnt);
END;
